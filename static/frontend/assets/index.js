var Dx=Object.defineProperty;var Ox=(e,n,t)=>n in e?Dx(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Pt=(e,n,t)=>Ox(e,typeof n!="symbol"?n+"":n,t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Kg(e){const n=Object.create(null);for(const t of e.split(","))n[t]=1;return t=>t in n}const Vi={},Oh=[],Su=()=>{},Ix=()=>!1,_p=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Jg=e=>e.startsWith("onUpdate:"),Eo=Object.assign,Yg=(e,n)=>{const t=e.indexOf(n);t>-1&&e.splice(t,1)},Fx=Object.prototype.hasOwnProperty,Pi=(e,n)=>Fx.call(e,n),rr=Array.isArray,Ih=e=>Kf(e)==="[object Map]",Zh=e=>Kf(e)==="[object Set]",I1=e=>Kf(e)==="[object Date]",wr=e=>typeof e=="function",Is=e=>typeof e=="string",Eu=e=>typeof e=="symbol",Gi=e=>e!==null&&typeof e=="object",Yy=e=>(Gi(e)||wr(e))&&wr(e.then)&&wr(e.catch),Xy=Object.prototype.toString,Kf=e=>Xy.call(e),zx=e=>Kf(e).slice(8,-1),Qy=e=>Kf(e)==="[object Object]",Xg=e=>Is(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Sf=Kg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bp=e=>{const n=Object.create(null);return t=>n[t]||(n[t]=e(t))},jx=/-(\w)/g,Tl=bp(e=>e.replace(jx,(n,t)=>t?t.toUpperCase():"")),Ux=/\B([A-Z])/g,uh=bp(e=>e.replace(Ux,"-$1").toLowerCase()),wp=bp(e=>e.charAt(0).toUpperCase()+e.slice(1)),w0=bp(e=>e?`on${wp(e)}`:""),_c=(e,n)=>!Object.is(e,n),Rd=(e,...n)=>{for(let t=0;t<e.length;t++)e[t](...n)},e_=(e,n,t,r=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:r,value:t})},Yd=e=>{const n=parseFloat(e);return isNaN(n)?e:n},$x=e=>{const n=Is(e)?Number(e):NaN;return isNaN(n)?e:n};let F1;const xp=()=>F1||(F1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Jc(e){if(rr(e)){const n={};for(let t=0;t<e.length;t++){const r=e[t],i=Is(r)?Hx(r):Jc(r);if(i)for(const o in i)n[o]=i[o]}return n}else if(Is(e)||Gi(e))return e}const qx=/;(?![^(]*\))/g,Vx=/:([^]+)/,Gx=/\/\*[^]*?\*\//g;function Hx(e){const n={};return e.replace(Gx,"").split(qx).forEach(t=>{if(t){const r=t.split(Vx);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function Yi(e){let n="";if(Is(e))n=e;else if(rr(e))for(let t=0;t<e.length;t++){const r=Yi(e[t]);r&&(n+=r+" ")}else if(Gi(e))for(const t in e)e[t]&&(n+=t+" ");return n.trim()}const Wx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Zx=Kg(Wx);function t_(e){return!!e||e===""}function Kx(e,n){if(e.length!==n.length)return!1;let t=!0;for(let r=0;t&&r<e.length;r++)t=sh(e[r],n[r]);return t}function sh(e,n){if(e===n)return!0;let t=I1(e),r=I1(n);if(t||r)return t&&r?e.getTime()===n.getTime():!1;if(t=Eu(e),r=Eu(n),t||r)return e===n;if(t=rr(e),r=rr(n),t||r)return t&&r?Kx(e,n):!1;if(t=Gi(e),r=Gi(n),t||r){if(!t||!r)return!1;const i=Object.keys(e).length,o=Object.keys(n).length;if(i!==o)return!1;for(const l in e){const h=e.hasOwnProperty(l),g=n.hasOwnProperty(l);if(h&&!g||!h&&g||!sh(e[l],n[l]))return!1}}return String(e)===String(n)}function Qg(e,n){return e.findIndex(t=>sh(t,n))}const n_=e=>!!(e&&e.__v_isRef===!0),Ht=e=>Is(e)?e:e==null?"":rr(e)||Gi(e)&&(e.toString===Xy||!wr(e.toString))?n_(e)?Ht(e.value):JSON.stringify(e,r_,2):String(e),r_=(e,n)=>n_(n)?r_(e,n.value):Ih(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((t,[r,i],o)=>(t[x0(r,o)+" =>"]=i,t),{})}:Zh(n)?{[`Set(${n.size})`]:[...n.values()].map(t=>x0(t))}:Eu(n)?x0(n):Gi(n)&&!rr(n)&&!Qy(n)?String(n):n,x0=(e,n="")=>{var t;return Eu(e)?`Symbol(${(t=e.description)!=null?t:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let La;class i_{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=La,!n&&La&&(this.index=(La.scopes||(La.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].pause();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,t;if(this.scopes)for(n=0,t=this.scopes.length;n<t;n++)this.scopes[n].resume();for(n=0,t=this.effects.length;n<t;n++)this.effects[n].resume()}}run(n){if(this._active){const t=La;try{return La=this,n()}finally{La=t}}}on(){La=this}off(){La=this.parent}stop(n){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function s_(e){return new i_(e)}function o_(){return La}function Jx(e,n=!1){La&&La.cleanups.push(e)}let Ji;const L0=new WeakSet;class a_{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,La&&La.active&&La.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,L0.has(this)&&(L0.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,z1(this),c_(this);const n=Ji,t=Jl;Ji=this,Jl=!0;try{return this.fn()}finally{h_(this),Ji=n,Jl=t,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)nm(n);this.deps=this.depsTail=void 0,z1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?L0.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){eg(this)&&this.run()}get dirty(){return eg(this)}}let l_=0,Cf,Pf;function u_(e,n=!1){if(e.flags|=8,n){e.next=Pf,Pf=e;return}e.next=Cf,Cf=e}function em(){l_++}function tm(){if(--l_>0)return;if(Pf){let n=Pf;for(Pf=void 0;n;){const t=n.next;n.next=void 0,n.flags&=-9,n=t}}let e;for(;Cf;){let n=Cf;for(Cf=void 0;n;){const t=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(r){e||(e=r)}n=t}}if(e)throw e}function c_(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function h_(e){let n,t=e.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),nm(r),Yx(r)):n=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}e.deps=n,e.depsTail=t}function eg(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(f_(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function f_(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===If))return;e.globalVersion=If;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!eg(e)){e.flags&=-3;return}const t=Ji,r=Jl;Ji=e,Jl=!0;try{c_(e);const i=e.fn(e._value);(n.version===0||_c(i,e._value))&&(e._value=i,n.version++)}catch(i){throw n.version++,i}finally{Ji=t,Jl=r,h_(e),e.flags&=-3}}function nm(e,n=!1){const{dep:t,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),t.subs===e&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let o=t.computed.deps;o;o=o.nextDep)nm(o,!0)}!n&&!--t.sc&&t.map&&t.map.delete(t.key)}function Yx(e){const{prevDep:n,nextDep:t}=e;n&&(n.nextDep=t,e.prevDep=void 0),t&&(t.prevDep=n,e.nextDep=void 0)}let Jl=!0;const d_=[];function Ec(){d_.push(Jl),Jl=!1}function Ac(){const e=d_.pop();Jl=e===void 0?!0:e}function z1(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const t=Ji;Ji=void 0;try{n()}finally{Ji=t}}}let If=0;class Xx{constructor(n,t){this.sub=n,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rm{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!Ji||!Jl||Ji===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Ji)t=this.activeLink=new Xx(Ji,this),Ji.deps?(t.prevDep=Ji.depsTail,Ji.depsTail.nextDep=t,Ji.depsTail=t):Ji.deps=Ji.depsTail=t,p_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Ji.depsTail,t.nextDep=void 0,Ji.depsTail.nextDep=t,Ji.depsTail=t,Ji.deps===t&&(Ji.deps=r)}return t}trigger(n){this.version++,If++,this.notify(n)}notify(n){em();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{tm()}}}function p_(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let r=n.deps;r;r=r.nextDep)p_(r)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}const Xd=new WeakMap,th=Symbol(""),tg=Symbol(""),Ff=Symbol("");function oa(e,n,t){if(Jl&&Ji){let r=Xd.get(e);r||Xd.set(e,r=new Map);let i=r.get(t);i||(r.set(t,i=new rm),i.map=r,i.key=t),i.track()}}function Ku(e,n,t,r,i,o){const l=Xd.get(e);if(!l){If++;return}const h=g=>{g&&g.trigger()};if(em(),n==="clear")l.forEach(h);else{const g=rr(e),v=g&&Xg(t);if(g&&t==="length"){const _=Number(r);l.forEach((x,E)=>{(E==="length"||E===Ff||!Eu(E)&&E>=_)&&h(x)})}else switch((t!==void 0||l.has(void 0))&&h(l.get(t)),v&&h(l.get(Ff)),n){case"add":g?v&&h(l.get("length")):(h(l.get(th)),Ih(e)&&h(l.get(tg)));break;case"delete":g||(h(l.get(th)),Ih(e)&&h(l.get(tg)));break;case"set":Ih(e)&&h(l.get(th));break}}tm()}function Qx(e,n){const t=Xd.get(e);return t&&t.get(n)}function Eh(e){const n=ci(e);return n===e?n:(oa(n,"iterate",Ff),Al(e)?n:n.map(aa))}function Lp(e){return oa(e=ci(e),"iterate",Ff),e}const eL={__proto__:null,[Symbol.iterator](){return S0(this,Symbol.iterator,aa)},concat(...e){return Eh(this).concat(...e.map(n=>rr(n)?Eh(n):n))},entries(){return S0(this,"entries",e=>(e[1]=aa(e[1]),e))},every(e,n){return $u(this,"every",e,n,void 0,arguments)},filter(e,n){return $u(this,"filter",e,n,t=>t.map(aa),arguments)},find(e,n){return $u(this,"find",e,n,aa,arguments)},findIndex(e,n){return $u(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return $u(this,"findLast",e,n,aa,arguments)},findLastIndex(e,n){return $u(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return $u(this,"forEach",e,n,void 0,arguments)},includes(...e){return C0(this,"includes",e)},indexOf(...e){return C0(this,"indexOf",e)},join(e){return Eh(this).join(e)},lastIndexOf(...e){return C0(this,"lastIndexOf",e)},map(e,n){return $u(this,"map",e,n,void 0,arguments)},pop(){return lf(this,"pop")},push(...e){return lf(this,"push",e)},reduce(e,...n){return j1(this,"reduce",e,n)},reduceRight(e,...n){return j1(this,"reduceRight",e,n)},shift(){return lf(this,"shift")},some(e,n){return $u(this,"some",e,n,void 0,arguments)},splice(...e){return lf(this,"splice",e)},toReversed(){return Eh(this).toReversed()},toSorted(e){return Eh(this).toSorted(e)},toSpliced(...e){return Eh(this).toSpliced(...e)},unshift(...e){return lf(this,"unshift",e)},values(){return S0(this,"values",aa)}};function S0(e,n,t){const r=Lp(e),i=r[n]();return r!==e&&!Al(e)&&(i._next=i.next,i.next=()=>{const o=i._next();return o.value&&(o.value=t(o.value)),o}),i}const tL=Array.prototype;function $u(e,n,t,r,i,o){const l=Lp(e),h=l!==e&&!Al(e),g=l[n];if(g!==tL[n]){const x=g.apply(e,o);return h?aa(x):x}let v=t;l!==e&&(h?v=function(x,E){return t.call(this,aa(x),E,e)}:t.length>2&&(v=function(x,E){return t.call(this,x,E,e)}));const _=g.call(l,v,r);return h&&i?i(_):_}function j1(e,n,t,r){const i=Lp(e);let o=t;return i!==e&&(Al(e)?t.length>3&&(o=function(l,h,g){return t.call(this,l,h,g,e)}):o=function(l,h,g){return t.call(this,l,aa(h),g,e)}),i[n](o,...r)}function C0(e,n,t){const r=ci(e);oa(r,"iterate",Ff);const i=r[n](...t);return(i===-1||i===!1)&&om(t[0])?(t[0]=ci(t[0]),r[n](...t)):i}function lf(e,n,t=[]){Ec(),em();const r=ci(e)[n].apply(e,t);return tm(),Ac(),r}const nL=Kg("__proto__,__v_isRef,__isVue"),g_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Eu));function rL(e){Eu(e)||(e=String(e));const n=ci(this);return oa(n,"has",e),n.hasOwnProperty(e)}class m_{constructor(n=!1,t=!1){this._isReadonly=n,this._isShallow=t}get(n,t,r){if(t==="__v_skip")return n.__v_skip;const i=this._isReadonly,o=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return o;if(t==="__v_raw")return r===(i?o?dL:b_:o?__:y_).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const l=rr(n);if(!i){let g;if(l&&(g=eL[t]))return g;if(t==="hasOwnProperty")return rL}const h=Reflect.get(n,t,Js(n)?n:r);return(Eu(t)?g_.has(t):nL(t))||(i||oa(n,"get",t),o)?h:Js(h)?l&&Xg(t)?h:h.value:Gi(h)?i?mu(h):Au(h):h}}class v_ extends m_{constructor(n=!1){super(!1,n)}set(n,t,r,i){let o=n[t];if(!this._isShallow){const g=oh(o);if(!Al(r)&&!oh(r)&&(o=ci(o),r=ci(r)),!rr(n)&&Js(o)&&!Js(r))return g?!1:(o.value=r,!0)}const l=rr(n)&&Xg(t)?Number(t)<n.length:Pi(n,t),h=Reflect.set(n,t,r,Js(n)?n:i);return n===ci(i)&&(l?_c(r,o)&&Ku(n,"set",t,r):Ku(n,"add",t,r)),h}deleteProperty(n,t){const r=Pi(n,t);n[t];const i=Reflect.deleteProperty(n,t);return i&&r&&Ku(n,"delete",t,void 0),i}has(n,t){const r=Reflect.has(n,t);return(!Eu(t)||!g_.has(t))&&oa(n,"has",t),r}ownKeys(n){return oa(n,"iterate",rr(n)?"length":th),Reflect.ownKeys(n)}}class iL extends m_{constructor(n=!1){super(!0,n)}set(n,t){return!0}deleteProperty(n,t){return!0}}const sL=new v_,oL=new iL,aL=new v_(!0);const ng=e=>e,wd=e=>Reflect.getPrototypeOf(e);function lL(e,n,t){return function(...r){const i=this.__v_raw,o=ci(i),l=Ih(o),h=e==="entries"||e===Symbol.iterator&&l,g=e==="keys"&&l,v=i[e](...r),_=t?ng:n?rg:aa;return!n&&oa(o,"iterate",g?tg:th),{next(){const{value:x,done:E}=v.next();return E?{value:x,done:E}:{value:h?[_(x[0]),_(x[1])]:_(x),done:E}},[Symbol.iterator](){return this}}}}function xd(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function uL(e,n){const t={get(i){const o=this.__v_raw,l=ci(o),h=ci(i);e||(_c(i,h)&&oa(l,"get",i),oa(l,"get",h));const{has:g}=wd(l),v=n?ng:e?rg:aa;if(g.call(l,i))return v(o.get(i));if(g.call(l,h))return v(o.get(h));o!==l&&o.get(i)},get size(){const i=this.__v_raw;return!e&&oa(ci(i),"iterate",th),Reflect.get(i,"size",i)},has(i){const o=this.__v_raw,l=ci(o),h=ci(i);return e||(_c(i,h)&&oa(l,"has",i),oa(l,"has",h)),i===h?o.has(i):o.has(i)||o.has(h)},forEach(i,o){const l=this,h=l.__v_raw,g=ci(h),v=n?ng:e?rg:aa;return!e&&oa(g,"iterate",th),h.forEach((_,x)=>i.call(o,v(_),v(x),l))}};return Eo(t,e?{add:xd("add"),set:xd("set"),delete:xd("delete"),clear:xd("clear")}:{add(i){!n&&!Al(i)&&!oh(i)&&(i=ci(i));const o=ci(this);return wd(o).has.call(o,i)||(o.add(i),Ku(o,"add",i,i)),this},set(i,o){!n&&!Al(o)&&!oh(o)&&(o=ci(o));const l=ci(this),{has:h,get:g}=wd(l);let v=h.call(l,i);v||(i=ci(i),v=h.call(l,i));const _=g.call(l,i);return l.set(i,o),v?_c(o,_)&&Ku(l,"set",i,o):Ku(l,"add",i,o),this},delete(i){const o=ci(this),{has:l,get:h}=wd(o);let g=l.call(o,i);g||(i=ci(i),g=l.call(o,i)),h&&h.call(o,i);const v=o.delete(i);return g&&Ku(o,"delete",i,void 0),v},clear(){const i=ci(this),o=i.size!==0,l=i.clear();return o&&Ku(i,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=lL(i,e,n)}),t}function im(e,n){const t=uL(e,n);return(r,i,o)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(Pi(t,i)&&i in r?t:r,i,o)}const cL={get:im(!1,!1)},hL={get:im(!1,!0)},fL={get:im(!0,!1)};const y_=new WeakMap,__=new WeakMap,b_=new WeakMap,dL=new WeakMap;function pL(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function gL(e){return e.__v_skip||!Object.isExtensible(e)?0:pL(zx(e))}function Au(e){return oh(e)?e:sm(e,!1,sL,cL,y_)}function w_(e){return sm(e,!1,aL,hL,__)}function mu(e){return sm(e,!0,oL,fL,b_)}function sm(e,n,t,r,i){if(!Gi(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const o=i.get(e);if(o)return o;const l=gL(e);if(l===0)return e;const h=new Proxy(e,l===2?r:t);return i.set(e,h),h}function bc(e){return oh(e)?bc(e.__v_raw):!!(e&&e.__v_isReactive)}function oh(e){return!!(e&&e.__v_isReadonly)}function Al(e){return!!(e&&e.__v_isShallow)}function om(e){return e?!!e.__v_raw:!1}function ci(e){const n=e&&e.__v_raw;return n?ci(n):e}function am(e){return!Pi(e,"__v_skip")&&Object.isExtensible(e)&&e_(e,"__v_skip",!0),e}const aa=e=>Gi(e)?Au(e):e,rg=e=>Gi(e)?mu(e):e;function Js(e){return e?e.__v_isRef===!0:!1}function un(e){return x_(e,!1)}function mL(e){return x_(e,!0)}function x_(e,n){return Js(e)?e:new vL(e,n)}class vL{constructor(n,t){this.dep=new rm,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?n:ci(n),this._value=t?n:aa(n),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(n){const t=this._rawValue,r=this.__v_isShallow||Al(n)||oh(n);n=r?n:ci(n),_c(n,t)&&(this._rawValue=n,this._value=r?n:aa(n),this.dep.trigger())}}function Kn(e){return Js(e)?e.value:e}const yL={get:(e,n,t)=>n==="__v_raw"?e:Kn(Reflect.get(e,n,t)),set:(e,n,t,r)=>{const i=e[n];return Js(i)&&!Js(t)?(i.value=t,!0):Reflect.set(e,n,t,r)}};function L_(e){return bc(e)?e:new Proxy(e,yL)}function _L(e){const n=rr(e)?new Array(e.length):{};for(const t in e)n[t]=wL(e,t);return n}class bL{constructor(n,t,r){this._object=n,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return Qx(ci(this._object),this._key)}}function wL(e,n,t){const r=e[n];return Js(r)?r:new bL(e,n,t)}class xL{constructor(n,t,r){this.fn=n,this.setter=t,this._value=void 0,this.dep=new rm(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=If-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ji!==this)return u_(this,!0),!0}get value(){const n=this.dep.track();return f_(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function LL(e,n,t=!1){let r,i;return wr(e)?r=e:(r=e.get,i=e.set),new xL(r,i,t)}const Ld={},Qd=new WeakMap;let Gc;function SL(e,n=!1,t=Gc){if(t){let r=Qd.get(t);r||Qd.set(t,r=[]),r.push(e)}}function CL(e,n,t=Vi){const{immediate:r,deep:i,once:o,scheduler:l,augmentJob:h,call:g}=t,v=Se=>i?Se:Al(Se)||i===!1||i===0?Ju(Se,1):Ju(Se);let _,x,E,b,R=!1,$=!1;if(Js(e)?(x=()=>e.value,R=Al(e)):bc(e)?(x=()=>v(e),R=!0):rr(e)?($=!0,R=e.some(Se=>bc(Se)||Al(Se)),x=()=>e.map(Se=>{if(Js(Se))return Se.value;if(bc(Se))return v(Se);if(wr(Se))return g?g(Se,2):Se()})):wr(e)?n?x=g?()=>g(e,2):e:x=()=>{if(E){Ec();try{E()}finally{Ac()}}const Se=Gc;Gc=_;try{return g?g(e,3,[b]):e(b)}finally{Gc=Se}}:x=Su,n&&i){const Se=x,De=i===!0?1/0:i;x=()=>Ju(Se(),De)}const Q=o_(),I=()=>{_.stop(),Q&&Q.active&&Yg(Q.effects,_)};if(o&&n){const Se=n;n=(...De)=>{Se(...De),I()}}let W=$?new Array(e.length).fill(Ld):Ld;const ge=Se=>{if(!(!(_.flags&1)||!_.dirty&&!Se))if(n){const De=_.run();if(i||R||($?De.some((Ye,Ve)=>_c(Ye,W[Ve])):_c(De,W))){E&&E();const Ye=Gc;Gc=_;try{const Ve=[De,W===Ld?void 0:$&&W[0]===Ld?[]:W,b];g?g(n,3,Ve):n(...Ve),W=De}finally{Gc=Ye}}}else _.run()};return h&&h(ge),_=new a_(x),_.scheduler=l?()=>l(ge,!1):ge,b=Se=>SL(Se,!1,_),E=_.onStop=()=>{const Se=Qd.get(_);if(Se){if(g)g(Se,4);else for(const De of Se)De();Qd.delete(_)}},n?r?ge(!0):W=_.run():l?l(ge.bind(null,!0),!0):_.run(),I.pause=_.pause.bind(_),I.resume=_.resume.bind(_),I.stop=I,I}function Ju(e,n=1/0,t){if(n<=0||!Gi(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),n--,Js(e))Ju(e.value,n,t);else if(rr(e))for(let r=0;r<e.length;r++)Ju(e[r],n,t);else if(Zh(e)||Ih(e))e.forEach(r=>{Ju(r,n,t)});else if(Qy(e)){for(const r in e)Ju(e[r],n,t);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Ju(e[r],n,t)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Jf(e,n,t,r){try{return r?e(...r):e()}catch(i){Sp(i,n,t)}}function Yl(e,n,t,r){if(wr(e)){const i=Jf(e,n,t,r);return i&&Yy(i)&&i.catch(o=>{Sp(o,n,t)}),i}if(rr(e)){const i=[];for(let o=0;o<e.length;o++)i.push(Yl(e[o],n,t,r));return i}}function Sp(e,n,t,r=!0){const i=n?n.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:l}=n&&n.appContext.config||Vi;if(n){let h=n.parent;const g=n.proxy,v=`https://vuejs.org/error-reference/#runtime-${t}`;for(;h;){const _=h.ec;if(_){for(let x=0;x<_.length;x++)if(_[x](e,g,v)===!1)return}h=h.parent}if(o){Ec(),Jf(o,null,10,[e,g,v]),Ac();return}}PL(e,t,i,r,l)}function PL(e,n,t,r=!0,i=!1){if(i)throw e;console.error(e)}const Sa=[];let vu=-1;const Fh=[];let dc=null,Th=0;const S_=Promise.resolve();let ep=null;function Ds(e){const n=ep||S_;return e?n.then(this?e.bind(this):e):n}function EL(e){let n=vu+1,t=Sa.length;for(;n<t;){const r=n+t>>>1,i=Sa[r],o=zf(i);o<e||o===e&&i.flags&2?n=r+1:t=r}return n}function lm(e){if(!(e.flags&1)){const n=zf(e),t=Sa[Sa.length-1];!t||!(e.flags&2)&&n>=zf(t)?Sa.push(e):Sa.splice(EL(n),0,e),e.flags|=1,C_()}}function C_(){ep||(ep=S_.then(E_))}function AL(e){rr(e)?Fh.push(...e):dc&&e.id===-1?dc.splice(Th+1,0,e):e.flags&1||(Fh.push(e),e.flags|=1),C_()}function U1(e,n,t=vu+1){for(;t<Sa.length;t++){const r=Sa[t];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;Sa.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function P_(e){if(Fh.length){const n=[...new Set(Fh)].sort((t,r)=>zf(t)-zf(r));if(Fh.length=0,dc){dc.push(...n);return}for(dc=n,Th=0;Th<dc.length;Th++){const t=dc[Th];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}dc=null,Th=0}}const zf=e=>e.id==null?e.flags&2?-1:1/0:e.id;function E_(e){try{for(vu=0;vu<Sa.length;vu++){const n=Sa[vu];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Jf(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;vu<Sa.length;vu++){const n=Sa[vu];n&&(n.flags&=-2)}vu=-1,Sa.length=0,P_(),ep=null,(Sa.length||Fh.length)&&E_()}}let Ca=null,A_=null;function tp(e){const n=Ca;return Ca=e,A_=e&&e.type.__scopeId||null,n}function vc(e,n=Ca,t){if(!n||e._n)return e;const r=(...i)=>{r._d&&tv(-1);const o=tp(n);let l;try{l=e(...i)}finally{tp(o),r._d&&tv(1)}return l};return r._n=!0,r._c=!0,r._d=!0,r}function Dn(e,n){if(Ca===null)return e;const t=kp(Ca),r=e.dirs||(e.dirs=[]);for(let i=0;i<n.length;i++){let[o,l,h,g=Vi]=n[i];o&&(wr(o)&&(o={mounted:o,updated:o}),o.deep&&Ju(l),r.push({dir:o,instance:t,value:l,oldValue:void 0,arg:h,modifiers:g}))}return e}function zc(e,n,t,r){const i=e.dirs,o=n&&n.dirs;for(let l=0;l<i.length;l++){const h=i[l];o&&(h.oldValue=o[l].value);let g=h.dir[r];g&&(Ec(),Yl(g,t,8,[e.el,h,e,n]),Ac())}}const M_=Symbol("_vte"),k_=e=>e.__isTeleport,Ef=e=>e&&(e.disabled||e.disabled===""),$1=e=>e&&(e.defer||e.defer===""),q1=e=>typeof SVGElement<"u"&&e instanceof SVGElement,V1=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,ig=(e,n)=>{const t=e&&e.to;return Is(t)?n?n(t):null:t},T_={name:"Teleport",__isTeleport:!0,process(e,n,t,r,i,o,l,h,g,v){const{mc:_,pc:x,pbc:E,o:{insert:b,querySelector:R,createText:$,createComment:Q}}=v,I=Ef(n.props);let{shapeFlag:W,children:ge,dynamicChildren:Se}=n;if(e==null){const De=n.el=$(""),Ye=n.anchor=$("");b(De,t,r),b(Ye,t,r);const Ve=(K,ce)=>{W&16&&(i&&i.isCE&&(i.ce._teleportTarget=K),_(ge,K,ce,i,o,l,h,g))},O=()=>{const K=n.target=ig(n.props,R),ce=B_(K,n,$,b);K&&(l!=="svg"&&q1(K)?l="svg":l!=="mathml"&&V1(K)&&(l="mathml"),I||(Ve(K,ce),Dd(n,!1)))};I&&(Ve(t,Ye),Dd(n,!0)),$1(n.props)?xa(()=>{O(),n.el.__isMounted=!0},o):O()}else{if($1(n.props)&&!e.el.__isMounted){xa(()=>{T_.process(e,n,t,r,i,o,l,h,g,v),delete e.el.__isMounted},o);return}n.el=e.el,n.targetStart=e.targetStart;const De=n.anchor=e.anchor,Ye=n.target=e.target,Ve=n.targetAnchor=e.targetAnchor,O=Ef(e.props),K=O?t:Ye,ce=O?De:Ve;if(l==="svg"||q1(Ye)?l="svg":(l==="mathml"||V1(Ye))&&(l="mathml"),Se?(E(e.dynamicChildren,Se,K,i,o,l,h),cm(e,n,!0)):g||x(e,n,K,ce,i,o,l,h,!1),I)O?n.props&&e.props&&n.props.to!==e.props.to&&(n.props.to=e.props.to):Sd(n,t,De,v,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const H=n.target=ig(n.props,R);H&&Sd(n,H,null,v,0)}else O&&Sd(n,Ye,Ve,v,1);Dd(n,I)}},remove(e,n,t,{um:r,o:{remove:i}},o){const{shapeFlag:l,children:h,anchor:g,targetStart:v,targetAnchor:_,target:x,props:E}=e;if(x&&(i(v),i(_)),o&&i(g),l&16){const b=o||!Ef(E);for(let R=0;R<h.length;R++){const $=h[R];r($,n,t,b,!!$.dynamicChildren)}}},move:Sd,hydrate:ML};function Sd(e,n,t,{o:{insert:r},m:i},o=2){o===0&&r(e.targetAnchor,n,t);const{el:l,anchor:h,shapeFlag:g,children:v,props:_}=e,x=o===2;if(x&&r(l,n,t),(!x||Ef(_))&&g&16)for(let E=0;E<v.length;E++)i(v[E],n,t,2);x&&r(h,n,t)}function ML(e,n,t,r,i,o,{o:{nextSibling:l,parentNode:h,querySelector:g,insert:v,createText:_}},x){const E=n.target=ig(n.props,g);if(E){const b=Ef(n.props),R=E._lpa||E.firstChild;if(n.shapeFlag&16)if(b)n.anchor=x(l(e),n,h(e),t,r,i,o),n.targetStart=R,n.targetAnchor=R&&l(R);else{n.anchor=l(e);let $=R;for(;$;){if($&&$.nodeType===8){if($.data==="teleport start anchor")n.targetStart=$;else if($.data==="teleport anchor"){n.targetAnchor=$,E._lpa=n.targetAnchor&&l(n.targetAnchor);break}}$=l($)}n.targetAnchor||B_(E,n,_,v),x(R&&l(R),n,E,t,r,i,o)}Dd(n,b)}return n.anchor&&l(n.anchor)}const P0=T_;function Dd(e,n){const t=e.ctx;if(t&&t.ut){let r,i;for(n?(r=e.el,i=e.anchor):(r=e.targetStart,i=e.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}function B_(e,n,t,r){const i=n.targetStart=t(""),o=n.targetAnchor=t("");return i[M_]=o,e&&(r(i,e),r(o,e)),o}const pc=Symbol("_leaveCb"),Cd=Symbol("_enterCb");function kL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Bl(()=>{e.isMounted=!0}),Ep(()=>{e.isUnmounting=!0}),e}const xl=[Function,Array],N_={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xl,onEnter:xl,onAfterEnter:xl,onEnterCancelled:xl,onBeforeLeave:xl,onLeave:xl,onAfterLeave:xl,onLeaveCancelled:xl,onBeforeAppear:xl,onAppear:xl,onAfterAppear:xl,onAppearCancelled:xl},R_=e=>{const n=e.subTree;return n.component?R_(n.component):n},TL={name:"BaseTransition",props:N_,setup(e,{slots:n}){const t=MS(),r=kL();return()=>{const i=n.default&&I_(n.default(),!0);if(!i||!i.length)return;const o=D_(i),l=ci(e),{mode:h}=l;if(r.isLeaving)return E0(o);const g=G1(o);if(!g)return E0(o);let v=sg(g,l,r,t,x=>v=x);g.type!==qa&&jf(g,v);let _=t.subTree&&G1(t.subTree);if(_&&_.type!==qa&&!Wc(g,_)&&R_(t).type!==qa){let x=sg(_,l,r,t);if(jf(_,x),h==="out-in"&&g.type!==qa)return r.isLeaving=!0,x.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete x.afterLeave,_=void 0},E0(o);h==="in-out"&&g.type!==qa?x.delayLeave=(E,b,R)=>{const $=O_(r,_);$[String(_.key)]=_,E[pc]=()=>{b(),E[pc]=void 0,delete v.delayedLeave,_=void 0},v.delayedLeave=()=>{R(),delete v.delayedLeave,_=void 0}}:_=void 0}else _&&(_=void 0);return o}}};function D_(e){let n=e[0];if(e.length>1){for(const t of e)if(t.type!==qa){n=t;break}}return n}const BL=TL;function O_(e,n){const{leavingVNodes:t}=e;let r=t.get(n.type);return r||(r=Object.create(null),t.set(n.type,r)),r}function sg(e,n,t,r,i){const{appear:o,mode:l,persisted:h=!1,onBeforeEnter:g,onEnter:v,onAfterEnter:_,onEnterCancelled:x,onBeforeLeave:E,onLeave:b,onAfterLeave:R,onLeaveCancelled:$,onBeforeAppear:Q,onAppear:I,onAfterAppear:W,onAppearCancelled:ge}=n,Se=String(e.key),De=O_(t,e),Ye=(K,ce)=>{K&&Yl(K,r,9,ce)},Ve=(K,ce)=>{const H=ce[1];Ye(K,ce),rr(K)?K.every(D=>D.length<=1)&&H():K.length<=1&&H()},O={mode:l,persisted:h,beforeEnter(K){let ce=g;if(!t.isMounted)if(o)ce=Q||g;else return;K[pc]&&K[pc](!0);const H=De[Se];H&&Wc(e,H)&&H.el[pc]&&H.el[pc](),Ye(ce,[K])},enter(K){let ce=v,H=_,D=x;if(!t.isMounted)if(o)ce=I||v,H=W||_,D=ge||x;else return;let V=!1;const z=K[Cd]=U=>{V||(V=!0,U?Ye(D,[K]):Ye(H,[K]),O.delayedLeave&&O.delayedLeave(),K[Cd]=void 0)};ce?Ve(ce,[K,z]):z()},leave(K,ce){const H=String(e.key);if(K[Cd]&&K[Cd](!0),t.isUnmounting)return ce();Ye(E,[K]);let D=!1;const V=K[pc]=z=>{D||(D=!0,ce(),z?Ye($,[K]):Ye(R,[K]),K[pc]=void 0,De[H]===e&&delete De[H])};De[H]=e,b?Ve(b,[K,V]):V()},clone(K){const ce=sg(K,n,t,r,i);return i&&i(ce),ce}};return O}function E0(e){if(Cp(e))return e=Lc(e),e.children=null,e}function G1(e){if(!Cp(e))return k_(e.type)&&e.children?D_(e.children):e;const{shapeFlag:n,children:t}=e;if(t){if(n&16)return t[0];if(n&32&&wr(t.default))return t.default()}}function jf(e,n){e.shapeFlag&6&&e.component?(e.transition=n,jf(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function I_(e,n=!1,t){let r=[],i=0;for(let o=0;o<e.length;o++){let l=e[o];const h=t==null?l.key:String(t)+String(l.key!=null?l.key:o);l.type===Un?(l.patchFlag&128&&i++,r=r.concat(I_(l.children,n,h))):(n||l.type!==qa)&&r.push(h!=null?Lc(l,{key:h}):l)}if(i>1)for(let o=0;o<r.length;o++)r[o].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Pa(e,n){return wr(e)?Eo({name:e.name},n,{setup:e}):e}function F_(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function np(e,n,t,r,i=!1){if(rr(e)){e.forEach((R,$)=>np(R,n&&(rr(n)?n[$]:n),t,r,i));return}if(Af(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&np(e,n,t,r.component.subTree);return}const o=r.shapeFlag&4?kp(r.component):r.el,l=i?null:o,{i:h,r:g}=e,v=n&&n.r,_=h.refs===Vi?h.refs={}:h.refs,x=h.setupState,E=ci(x),b=x===Vi?()=>!1:R=>Pi(E,R);if(v!=null&&v!==g&&(Is(v)?(_[v]=null,b(v)&&(x[v]=null)):Js(v)&&(v.value=null)),wr(g))Jf(g,h,12,[l,_]);else{const R=Is(g),$=Js(g);if(R||$){const Q=()=>{if(e.f){const I=R?b(g)?x[g]:_[g]:g.value;i?rr(I)&&Yg(I,o):rr(I)?I.includes(o)||I.push(o):R?(_[g]=[o],b(g)&&(x[g]=_[g])):(g.value=[o],e.k&&(_[e.k]=g.value))}else R?(_[g]=l,b(g)&&(x[g]=l)):$&&(g.value=l,e.k&&(_[e.k]=l))};l?(Q.id=-1,xa(Q,t)):Q()}}}xp().requestIdleCallback;xp().cancelIdleCallback;const Af=e=>!!e.type.__asyncLoader,Cp=e=>e.type.__isKeepAlive;function NL(e,n){z_(e,"a",n)}function RL(e,n){z_(e,"da",n)}function z_(e,n,t=Po){const r=e.__wdc||(e.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Pp(n,r,t),t){let i=t.parent;for(;i&&i.parent;)Cp(i.parent.vnode)&&DL(r,n,t,i),i=i.parent}}function DL(e,n,t,r){const i=Pp(n,e,r,!0);Kh(()=>{Yg(r[n],i)},t)}function Pp(e,n,t=Po,r=!1){if(t){const i=t[e]||(t[e]=[]),o=n.__weh||(n.__weh=(...l)=>{Ec();const h=Yf(t),g=Yl(n,t,e,l);return h(),Ac(),g});return r?i.unshift(o):i.push(o),o}}const Qu=e=>(n,t=Po)=>{(!$f||e==="sp")&&Pp(e,(...r)=>n(...r),t)},OL=Qu("bm"),Bl=Qu("m"),IL=Qu("bu"),FL=Qu("u"),Ep=Qu("bum"),Kh=Qu("um"),zL=Qu("sp"),jL=Qu("rtg"),UL=Qu("rtc");function $L(e,n=Po){Pp("ec",e,n)}const qL="components";function VL(e,n){return HL(qL,e,!0,n)||e}const GL=Symbol.for("v-ndc");function HL(e,n,t=!0,r=!1){const i=Ca||Po;if(i){const o=i.type;{const h=RS(o,!1);if(h&&(h===n||h===Tl(n)||h===wp(Tl(n))))return o}const l=H1(i[e]||o[e],n)||H1(i.appContext[e],n);return!l&&r?o:l}}function H1(e,n){return e&&(e[n]||e[Tl(n)]||e[wp(Tl(n))])}function kr(e,n,t,r){let i;const o=t,l=rr(e);if(l||Is(e)){const h=l&&bc(e);let g=!1;h&&(g=!Al(e),e=Lp(e)),i=new Array(e.length);for(let v=0,_=e.length;v<_;v++)i[v]=n(g?aa(e[v]):e[v],v,void 0,o)}else if(typeof e=="number"){i=new Array(e);for(let h=0;h<e;h++)i[h]=n(h+1,h,void 0,o)}else if(Gi(e))if(e[Symbol.iterator])i=Array.from(e,(h,g)=>n(h,g,void 0,o));else{const h=Object.keys(e);i=new Array(h.length);for(let g=0,v=h.length;g<v;g++){const _=h[g];i[g]=n(e[_],_,g,o)}}else i=[];return i}const og=e=>e?i2(e)?kp(e):og(e.parent):null,Mf=Eo(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>og(e.parent),$root:e=>og(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>U_(e),$forceUpdate:e=>e.f||(e.f=()=>{lm(e.update)}),$nextTick:e=>e.n||(e.n=Ds.bind(e.proxy)),$watch:e=>pS.bind(e)}),A0=(e,n)=>e!==Vi&&!e.__isScriptSetup&&Pi(e,n),WL={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:o,accessCache:l,type:h,appContext:g}=e;let v;if(n[0]!=="$"){const b=l[n];if(b!==void 0)switch(b){case 1:return r[n];case 2:return i[n];case 4:return t[n];case 3:return o[n]}else{if(A0(r,n))return l[n]=1,r[n];if(i!==Vi&&Pi(i,n))return l[n]=2,i[n];if((v=e.propsOptions[0])&&Pi(v,n))return l[n]=3,o[n];if(t!==Vi&&Pi(t,n))return l[n]=4,t[n];ag&&(l[n]=0)}}const _=Mf[n];let x,E;if(_)return n==="$attrs"&&oa(e.attrs,"get",""),_(e);if((x=h.__cssModules)&&(x=x[n]))return x;if(t!==Vi&&Pi(t,n))return l[n]=4,t[n];if(E=g.config.globalProperties,Pi(E,n))return E[n]},set({_:e},n,t){const{data:r,setupState:i,ctx:o}=e;return A0(i,n)?(i[n]=t,!0):r!==Vi&&Pi(r,n)?(r[n]=t,!0):Pi(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(o[n]=t,!0)},has({_:{data:e,setupState:n,accessCache:t,ctx:r,appContext:i,propsOptions:o}},l){let h;return!!t[l]||e!==Vi&&Pi(e,l)||A0(n,l)||(h=o[0])&&Pi(h,l)||Pi(r,l)||Pi(Mf,l)||Pi(i.config.globalProperties,l)},defineProperty(e,n,t){return t.get!=null?e._.accessCache[n]=0:Pi(t,"value")&&this.set(e,n,t.value,null),Reflect.defineProperty(e,n,t)}};function W1(e){return rr(e)?e.reduce((n,t)=>(n[t]=null,n),{}):e}let ag=!0;function ZL(e){const n=U_(e),t=e.proxy,r=e.ctx;ag=!1,n.beforeCreate&&Z1(n.beforeCreate,e,"bc");const{data:i,computed:o,methods:l,watch:h,provide:g,inject:v,created:_,beforeMount:x,mounted:E,beforeUpdate:b,updated:R,activated:$,deactivated:Q,beforeDestroy:I,beforeUnmount:W,destroyed:ge,unmounted:Se,render:De,renderTracked:Ye,renderTriggered:Ve,errorCaptured:O,serverPrefetch:K,expose:ce,inheritAttrs:H,components:D,directives:V,filters:z}=n;if(v&&KL(v,r,null),l)for(const ue in l){const ie=l[ue];wr(ie)&&(r[ue]=ie.bind(t))}if(i){const ue=i.call(t,t);Gi(ue)&&(e.data=Au(ue))}if(ag=!0,o)for(const ue in o){const ie=o[ue],Ae=wr(ie)?ie.bind(t,t):wr(ie.get)?ie.get.bind(t,t):Su,Me=!wr(ie)&&wr(ie.set)?ie.set.bind(t):Su,st=Rr({get:Ae,set:Me});Object.defineProperty(r,ue,{enumerable:!0,configurable:!0,get:()=>st.value,set:X=>st.value=X})}if(h)for(const ue in h)j_(h[ue],r,t,ue);if(g){const ue=wr(g)?g.call(t):g;Reflect.ownKeys(ue).forEach(ie=>{Od(ie,ue[ie])})}_&&Z1(_,e,"c");function G(ue,ie){rr(ie)?ie.forEach(Ae=>ue(Ae.bind(t))):ie&&ue(ie.bind(t))}if(G(OL,x),G(Bl,E),G(IL,b),G(FL,R),G(NL,$),G(RL,Q),G($L,O),G(UL,Ye),G(jL,Ve),G(Ep,W),G(Kh,Se),G(zL,K),rr(ce))if(ce.length){const ue=e.exposed||(e.exposed={});ce.forEach(ie=>{Object.defineProperty(ue,ie,{get:()=>t[ie],set:Ae=>t[ie]=Ae})})}else e.exposed||(e.exposed={});De&&e.render===Su&&(e.render=De),H!=null&&(e.inheritAttrs=H),D&&(e.components=D),V&&(e.directives=V),K&&F_(e)}function KL(e,n,t=Su){rr(e)&&(e=lg(e));for(const r in e){const i=e[r];let o;Gi(i)?"default"in i?o=Ml(i.from||r,i.default,!0):o=Ml(i.from||r):o=Ml(i),Js(o)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):n[r]=o}}function Z1(e,n,t){Yl(rr(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,t)}function j_(e,n,t,r){let i=r.includes(".")?Q_(t,r):()=>t[r];if(Is(e)){const o=n[e];wr(o)&&Co(i,o)}else if(wr(e))Co(i,e.bind(t));else if(Gi(e))if(rr(e))e.forEach(o=>j_(o,n,t,r));else{const o=wr(e.handler)?e.handler.bind(t):n[e.handler];wr(o)&&Co(i,o,e)}}function U_(e){const n=e.type,{mixins:t,extends:r}=n,{mixins:i,optionsCache:o,config:{optionMergeStrategies:l}}=e.appContext,h=o.get(n);let g;return h?g=h:!i.length&&!t&&!r?g=n:(g={},i.length&&i.forEach(v=>rp(g,v,l,!0)),rp(g,n,l)),Gi(n)&&o.set(n,g),g}function rp(e,n,t,r=!1){const{mixins:i,extends:o}=n;o&&rp(e,o,t,!0),i&&i.forEach(l=>rp(e,l,t,!0));for(const l in n)if(!(r&&l==="expose")){const h=JL[l]||t&&t[l];e[l]=h?h(e[l],n[l]):n[l]}return e}const JL={data:K1,props:J1,emits:J1,methods:yf,computed:yf,beforeCreate:_a,created:_a,beforeMount:_a,mounted:_a,beforeUpdate:_a,updated:_a,beforeDestroy:_a,beforeUnmount:_a,destroyed:_a,unmounted:_a,activated:_a,deactivated:_a,errorCaptured:_a,serverPrefetch:_a,components:yf,directives:yf,watch:XL,provide:K1,inject:YL};function K1(e,n){return n?e?function(){return Eo(wr(e)?e.call(this,this):e,wr(n)?n.call(this,this):n)}:n:e}function YL(e,n){return yf(lg(e),lg(n))}function lg(e){if(rr(e)){const n={};for(let t=0;t<e.length;t++)n[e[t]]=e[t];return n}return e}function _a(e,n){return e?[...new Set([].concat(e,n))]:n}function yf(e,n){return e?Eo(Object.create(null),e,n):n}function J1(e,n){return e?rr(e)&&rr(n)?[...new Set([...e,...n])]:Eo(Object.create(null),W1(e),W1(n??{})):n}function XL(e,n){if(!e)return n;if(!n)return e;const t=Eo(Object.create(null),e);for(const r in n)t[r]=_a(e[r],n[r]);return t}function $_(){return{app:null,config:{isNativeTag:Ix,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QL=0;function eS(e,n){return function(r,i=null){wr(r)||(r=Eo({},r)),i!=null&&!Gi(i)&&(i=null);const o=$_(),l=new WeakSet,h=[];let g=!1;const v=o.app={_uid:QL++,_component:r,_props:i,_container:null,_context:o,_instance:null,version:OS,get config(){return o.config},set config(_){},use(_,...x){return l.has(_)||(_&&wr(_.install)?(l.add(_),_.install(v,...x)):wr(_)&&(l.add(_),_(v,...x))),v},mixin(_){return o.mixins.includes(_)||o.mixins.push(_),v},component(_,x){return x?(o.components[_]=x,v):o.components[_]},directive(_,x){return x?(o.directives[_]=x,v):o.directives[_]},mount(_,x,E){if(!g){const b=v._ceVNode||Xi(r,i);return b.appContext=o,E===!0?E="svg":E===!1&&(E=void 0),e(b,_,E),g=!0,v._container=_,_.__vue_app__=v,kp(b.component)}},onUnmount(_){h.push(_)},unmount(){g&&(Yl(h,v._instance,16),e(null,v._container),delete v._container.__vue_app__)},provide(_,x){return o.provides[_]=x,v},runWithContext(_){const x=nh;nh=v;try{return _()}finally{nh=x}}};return v}}let nh=null;function Od(e,n){if(Po){let t=Po.provides;const r=Po.parent&&Po.parent.provides;r===t&&(t=Po.provides=Object.create(r)),t[e]=n}}function Ml(e,n,t=!1){const r=Po||Ca;if(r||nh){const i=nh?nh._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return t&&wr(n)?n.call(r&&r.proxy):n}}function tS(){return!!(Po||Ca||nh)}const q_={},V_=()=>Object.create(q_),G_=e=>Object.getPrototypeOf(e)===q_;function nS(e,n,t,r=!1){const i={},o=V_();e.propsDefaults=Object.create(null),H_(e,n,i,o);for(const l in e.propsOptions[0])l in i||(i[l]=void 0);t?e.props=r?i:w_(i):e.type.props?e.props=i:e.props=o,e.attrs=o}function rS(e,n,t,r){const{props:i,attrs:o,vnode:{patchFlag:l}}=e,h=ci(i),[g]=e.propsOptions;let v=!1;if((r||l>0)&&!(l&16)){if(l&8){const _=e.vnode.dynamicProps;for(let x=0;x<_.length;x++){let E=_[x];if(Ap(e.emitsOptions,E))continue;const b=n[E];if(g)if(Pi(o,E))b!==o[E]&&(o[E]=b,v=!0);else{const R=Tl(E);i[R]=ug(g,h,R,b,e,!1)}else b!==o[E]&&(o[E]=b,v=!0)}}}else{H_(e,n,i,o)&&(v=!0);let _;for(const x in h)(!n||!Pi(n,x)&&((_=uh(x))===x||!Pi(n,_)))&&(g?t&&(t[x]!==void 0||t[_]!==void 0)&&(i[x]=ug(g,h,x,void 0,e,!0)):delete i[x]);if(o!==h)for(const x in o)(!n||!Pi(n,x))&&(delete o[x],v=!0)}v&&Ku(e.attrs,"set","")}function H_(e,n,t,r){const[i,o]=e.propsOptions;let l=!1,h;if(n)for(let g in n){if(Sf(g))continue;const v=n[g];let _;i&&Pi(i,_=Tl(g))?!o||!o.includes(_)?t[_]=v:(h||(h={}))[_]=v:Ap(e.emitsOptions,g)||(!(g in r)||v!==r[g])&&(r[g]=v,l=!0)}if(o){const g=ci(t),v=h||Vi;for(let _=0;_<o.length;_++){const x=o[_];t[x]=ug(i,g,x,v[x],e,!Pi(v,x))}}return l}function ug(e,n,t,r,i,o){const l=e[t];if(l!=null){const h=Pi(l,"default");if(h&&r===void 0){const g=l.default;if(l.type!==Function&&!l.skipFactory&&wr(g)){const{propsDefaults:v}=i;if(t in v)r=v[t];else{const _=Yf(i);r=v[t]=g.call(null,n),_()}}else r=g;i.ce&&i.ce._setProp(t,r)}l[0]&&(o&&!h?r=!1:l[1]&&(r===""||r===uh(t))&&(r=!0))}return r}const iS=new WeakMap;function W_(e,n,t=!1){const r=t?iS:n.propsCache,i=r.get(e);if(i)return i;const o=e.props,l={},h=[];let g=!1;if(!wr(e)){const _=x=>{g=!0;const[E,b]=W_(x,n,!0);Eo(l,E),b&&h.push(...b)};!t&&n.mixins.length&&n.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}if(!o&&!g)return Gi(e)&&r.set(e,Oh),Oh;if(rr(o))for(let _=0;_<o.length;_++){const x=Tl(o[_]);Y1(x)&&(l[x]=Vi)}else if(o)for(const _ in o){const x=Tl(_);if(Y1(x)){const E=o[_],b=l[x]=rr(E)||wr(E)?{type:E}:Eo({},E),R=b.type;let $=!1,Q=!0;if(rr(R))for(let I=0;I<R.length;++I){const W=R[I],ge=wr(W)&&W.name;if(ge==="Boolean"){$=!0;break}else ge==="String"&&(Q=!1)}else $=wr(R)&&R.name==="Boolean";b[0]=$,b[1]=Q,($||Pi(b,"default"))&&h.push(x)}}const v=[l,h];return Gi(e)&&r.set(e,v),v}function Y1(e){return e[0]!=="$"&&!Sf(e)}const Z_=e=>e[0]==="_"||e==="$stable",um=e=>rr(e)?e.map(bu):[bu(e)],sS=(e,n,t)=>{if(n._n)return n;const r=vc((...i)=>um(n(...i)),t);return r._c=!1,r},K_=(e,n,t)=>{const r=e._ctx;for(const i in e){if(Z_(i))continue;const o=e[i];if(wr(o))n[i]=sS(i,o,r);else if(o!=null){const l=um(o);n[i]=()=>l}}},J_=(e,n)=>{const t=um(n);e.slots.default=()=>t},Y_=(e,n,t)=>{for(const r in n)(t||r!=="_")&&(e[r]=n[r])},oS=(e,n,t)=>{const r=e.slots=V_();if(e.vnode.shapeFlag&32){const i=n._;i?(Y_(r,n,t),t&&e_(r,"_",i,!0)):K_(n,r)}else n&&J_(e,n)},aS=(e,n,t)=>{const{vnode:r,slots:i}=e;let o=!0,l=Vi;if(r.shapeFlag&32){const h=n._;h?t&&h===1?o=!1:Y_(i,n,t):(o=!n.$stable,K_(n,i)),l=n}else n&&(J_(e,n),l={default:1});if(o)for(const h in i)!Z_(h)&&l[h]==null&&delete i[h]},xa=wS;function lS(e){return uS(e)}function uS(e,n){const t=xp();t.__VUE__=!0;const{insert:r,remove:i,patchProp:o,createElement:l,createText:h,createComment:g,setText:v,setElementText:_,parentNode:x,nextSibling:E,setScopeId:b=Su,insertStaticContent:R}=e,$=(oe,re,xe,ye=null,le=null,Ue=null,Ie=void 0,Ce=null,qe=!!re.dynamicChildren)=>{if(oe===re)return;oe&&!Wc(oe,re)&&(ye=ne(oe),X(oe,le,Ue,!0),oe=null),re.patchFlag===-2&&(qe=!1,re.dynamicChildren=null);const{type:Re,ref:rt,shapeFlag:Ze}=re;switch(Re){case Mp:Q(oe,re,xe,ye);break;case qa:I(oe,re,xe,ye);break;case Id:oe==null&&W(re,xe,ye,Ie);break;case Un:D(oe,re,xe,ye,le,Ue,Ie,Ce,qe);break;default:Ze&1?De(oe,re,xe,ye,le,Ue,Ie,Ce,qe):Ze&6?V(oe,re,xe,ye,le,Ue,Ie,Ce,qe):(Ze&64||Ze&128)&&Re.process(oe,re,xe,ye,le,Ue,Ie,Ce,qe,se)}rt!=null&&le&&np(rt,oe&&oe.ref,Ue,re||oe,!re)},Q=(oe,re,xe,ye)=>{if(oe==null)r(re.el=h(re.children),xe,ye);else{const le=re.el=oe.el;re.children!==oe.children&&v(le,re.children)}},I=(oe,re,xe,ye)=>{oe==null?r(re.el=g(re.children||""),xe,ye):re.el=oe.el},W=(oe,re,xe,ye)=>{[oe.el,oe.anchor]=R(oe.children,re,xe,ye,oe.el,oe.anchor)},ge=({el:oe,anchor:re},xe,ye)=>{let le;for(;oe&&oe!==re;)le=E(oe),r(oe,xe,ye),oe=le;r(re,xe,ye)},Se=({el:oe,anchor:re})=>{let xe;for(;oe&&oe!==re;)xe=E(oe),i(oe),oe=xe;i(re)},De=(oe,re,xe,ye,le,Ue,Ie,Ce,qe)=>{re.type==="svg"?Ie="svg":re.type==="math"&&(Ie="mathml"),oe==null?Ye(re,xe,ye,le,Ue,Ie,Ce,qe):K(oe,re,le,Ue,Ie,Ce,qe)},Ye=(oe,re,xe,ye,le,Ue,Ie,Ce)=>{let qe,Re;const{props:rt,shapeFlag:Ze,transition:gt,dirs:_t}=oe;if(qe=oe.el=l(oe.type,Ue,rt&&rt.is,rt),Ze&8?_(qe,oe.children):Ze&16&&O(oe.children,qe,null,ye,le,M0(oe,Ue),Ie,Ce),_t&&zc(oe,null,ye,"created"),Ve(qe,oe,oe.scopeId,Ie,ye),rt){for(const tn in rt)tn!=="value"&&!Sf(tn)&&o(qe,tn,null,rt[tn],Ue,ye);"value"in rt&&o(qe,"value",null,rt.value,Ue),(Re=rt.onVnodeBeforeMount)&&fu(Re,ye,oe)}_t&&zc(oe,null,ye,"beforeMount");const $t=cS(le,gt);$t&&gt.beforeEnter(qe),r(qe,re,xe),((Re=rt&&rt.onVnodeMounted)||$t||_t)&&xa(()=>{Re&&fu(Re,ye,oe),$t&&gt.enter(qe),_t&&zc(oe,null,ye,"mounted")},le)},Ve=(oe,re,xe,ye,le)=>{if(xe&&b(oe,xe),ye)for(let Ue=0;Ue<ye.length;Ue++)b(oe,ye[Ue]);if(le){let Ue=le.subTree;if(re===Ue||t2(Ue.type)&&(Ue.ssContent===re||Ue.ssFallback===re)){const Ie=le.vnode;Ve(oe,Ie,Ie.scopeId,Ie.slotScopeIds,le.parent)}}},O=(oe,re,xe,ye,le,Ue,Ie,Ce,qe=0)=>{for(let Re=qe;Re<oe.length;Re++){const rt=oe[Re]=Ce?gc(oe[Re]):bu(oe[Re]);$(null,rt,re,xe,ye,le,Ue,Ie,Ce)}},K=(oe,re,xe,ye,le,Ue,Ie)=>{const Ce=re.el=oe.el;let{patchFlag:qe,dynamicChildren:Re,dirs:rt}=re;qe|=oe.patchFlag&16;const Ze=oe.props||Vi,gt=re.props||Vi;let _t;if(xe&&jc(xe,!1),(_t=gt.onVnodeBeforeUpdate)&&fu(_t,xe,re,oe),rt&&zc(re,oe,xe,"beforeUpdate"),xe&&jc(xe,!0),(Ze.innerHTML&&gt.innerHTML==null||Ze.textContent&&gt.textContent==null)&&_(Ce,""),Re?ce(oe.dynamicChildren,Re,Ce,xe,ye,M0(re,le),Ue):Ie||ie(oe,re,Ce,null,xe,ye,M0(re,le),Ue,!1),qe>0){if(qe&16)H(Ce,Ze,gt,xe,le);else if(qe&2&&Ze.class!==gt.class&&o(Ce,"class",null,gt.class,le),qe&4&&o(Ce,"style",Ze.style,gt.style,le),qe&8){const $t=re.dynamicProps;for(let tn=0;tn<$t.length;tn++){const Qe=$t[tn],Yt=Ze[Qe],Qt=gt[Qe];(Qt!==Yt||Qe==="value")&&o(Ce,Qe,Yt,Qt,le,xe)}}qe&1&&oe.children!==re.children&&_(Ce,re.children)}else!Ie&&Re==null&&H(Ce,Ze,gt,xe,le);((_t=gt.onVnodeUpdated)||rt)&&xa(()=>{_t&&fu(_t,xe,re,oe),rt&&zc(re,oe,xe,"updated")},ye)},ce=(oe,re,xe,ye,le,Ue,Ie)=>{for(let Ce=0;Ce<re.length;Ce++){const qe=oe[Ce],Re=re[Ce],rt=qe.el&&(qe.type===Un||!Wc(qe,Re)||qe.shapeFlag&70)?x(qe.el):xe;$(qe,Re,rt,null,ye,le,Ue,Ie,!0)}},H=(oe,re,xe,ye,le)=>{if(re!==xe){if(re!==Vi)for(const Ue in re)!Sf(Ue)&&!(Ue in xe)&&o(oe,Ue,re[Ue],null,le,ye);for(const Ue in xe){if(Sf(Ue))continue;const Ie=xe[Ue],Ce=re[Ue];Ie!==Ce&&Ue!=="value"&&o(oe,Ue,Ce,Ie,le,ye)}"value"in xe&&o(oe,"value",re.value,xe.value,le)}},D=(oe,re,xe,ye,le,Ue,Ie,Ce,qe)=>{const Re=re.el=oe?oe.el:h(""),rt=re.anchor=oe?oe.anchor:h("");let{patchFlag:Ze,dynamicChildren:gt,slotScopeIds:_t}=re;_t&&(Ce=Ce?Ce.concat(_t):_t),oe==null?(r(Re,xe,ye),r(rt,xe,ye),O(re.children||[],xe,rt,le,Ue,Ie,Ce,qe)):Ze>0&&Ze&64&&gt&&oe.dynamicChildren?(ce(oe.dynamicChildren,gt,xe,le,Ue,Ie,Ce),(re.key!=null||le&&re===le.subTree)&&cm(oe,re,!0)):ie(oe,re,xe,rt,le,Ue,Ie,Ce,qe)},V=(oe,re,xe,ye,le,Ue,Ie,Ce,qe)=>{re.slotScopeIds=Ce,oe==null?re.shapeFlag&512?le.ctx.activate(re,xe,ye,Ie,qe):z(re,xe,ye,le,Ue,Ie,qe):U(oe,re,qe)},z=(oe,re,xe,ye,le,Ue,Ie)=>{const Ce=oe.component=AS(oe,ye,le);if(Cp(oe)&&(Ce.ctx.renderer=se),kS(Ce,!1,Ie),Ce.asyncDep){if(le&&le.registerDep(Ce,G,Ie),!oe.el){const qe=Ce.subTree=Xi(qa);I(null,qe,re,xe)}}else G(Ce,oe,re,xe,le,Ue,Ie)},U=(oe,re,xe)=>{const ye=re.component=oe.component;if(_S(oe,re,xe))if(ye.asyncDep&&!ye.asyncResolved){ue(ye,re,xe);return}else ye.next=re,ye.update();else re.el=oe.el,ye.vnode=re},G=(oe,re,xe,ye,le,Ue,Ie)=>{const Ce=()=>{if(oe.isMounted){let{next:Ze,bu:gt,u:_t,parent:$t,vnode:tn}=oe;{const wt=X_(oe);if(wt){Ze&&(Ze.el=tn.el,ue(oe,Ze,Ie)),wt.asyncDep.then(()=>{oe.isUnmounted||Ce()});return}}let Qe=Ze,Yt;jc(oe,!1),Ze?(Ze.el=tn.el,ue(oe,Ze,Ie)):Ze=tn,gt&&Rd(gt),(Yt=Ze.props&&Ze.props.onVnodeBeforeUpdate)&&fu(Yt,$t,Ze,tn),jc(oe,!0);const Qt=Q1(oe),Zt=oe.subTree;oe.subTree=Qt,$(Zt,Qt,x(Zt.el),ne(Zt),oe,le,Ue),Ze.el=Qt.el,Qe===null&&bS(oe,Qt.el),_t&&xa(_t,le),(Yt=Ze.props&&Ze.props.onVnodeUpdated)&&xa(()=>fu(Yt,$t,Ze,tn),le)}else{let Ze;const{el:gt,props:_t}=re,{bm:$t,m:tn,parent:Qe,root:Yt,type:Qt}=oe,Zt=Af(re);jc(oe,!1),$t&&Rd($t),!Zt&&(Ze=_t&&_t.onVnodeBeforeMount)&&fu(Ze,Qe,re),jc(oe,!0);{Yt.ce&&Yt.ce._injectChildStyle(Qt);const wt=oe.subTree=Q1(oe);$(null,wt,xe,ye,oe,le,Ue),re.el=wt.el}if(tn&&xa(tn,le),!Zt&&(Ze=_t&&_t.onVnodeMounted)){const wt=re;xa(()=>fu(Ze,Qe,wt),le)}(re.shapeFlag&256||Qe&&Af(Qe.vnode)&&Qe.vnode.shapeFlag&256)&&oe.a&&xa(oe.a,le),oe.isMounted=!0,re=xe=ye=null}};oe.scope.on();const qe=oe.effect=new a_(Ce);oe.scope.off();const Re=oe.update=qe.run.bind(qe),rt=oe.job=qe.runIfDirty.bind(qe);rt.i=oe,rt.id=oe.uid,qe.scheduler=()=>lm(rt),jc(oe,!0),Re()},ue=(oe,re,xe)=>{re.component=oe;const ye=oe.vnode.props;oe.vnode=re,oe.next=null,rS(oe,re.props,ye,xe),aS(oe,re.children,xe),Ec(),U1(oe),Ac()},ie=(oe,re,xe,ye,le,Ue,Ie,Ce,qe=!1)=>{const Re=oe&&oe.children,rt=oe?oe.shapeFlag:0,Ze=re.children,{patchFlag:gt,shapeFlag:_t}=re;if(gt>0){if(gt&128){Me(Re,Ze,xe,ye,le,Ue,Ie,Ce,qe);return}else if(gt&256){Ae(Re,Ze,xe,ye,le,Ue,Ie,Ce,qe);return}}_t&8?(rt&16&&he(Re,le,Ue),Ze!==Re&&_(xe,Ze)):rt&16?_t&16?Me(Re,Ze,xe,ye,le,Ue,Ie,Ce,qe):he(Re,le,Ue,!0):(rt&8&&_(xe,""),_t&16&&O(Ze,xe,ye,le,Ue,Ie,Ce,qe))},Ae=(oe,re,xe,ye,le,Ue,Ie,Ce,qe)=>{oe=oe||Oh,re=re||Oh;const Re=oe.length,rt=re.length,Ze=Math.min(Re,rt);let gt;for(gt=0;gt<Ze;gt++){const _t=re[gt]=qe?gc(re[gt]):bu(re[gt]);$(oe[gt],_t,xe,null,le,Ue,Ie,Ce,qe)}Re>rt?he(oe,le,Ue,!0,!1,Ze):O(re,xe,ye,le,Ue,Ie,Ce,qe,Ze)},Me=(oe,re,xe,ye,le,Ue,Ie,Ce,qe)=>{let Re=0;const rt=re.length;let Ze=oe.length-1,gt=rt-1;for(;Re<=Ze&&Re<=gt;){const _t=oe[Re],$t=re[Re]=qe?gc(re[Re]):bu(re[Re]);if(Wc(_t,$t))$(_t,$t,xe,null,le,Ue,Ie,Ce,qe);else break;Re++}for(;Re<=Ze&&Re<=gt;){const _t=oe[Ze],$t=re[gt]=qe?gc(re[gt]):bu(re[gt]);if(Wc(_t,$t))$(_t,$t,xe,null,le,Ue,Ie,Ce,qe);else break;Ze--,gt--}if(Re>Ze){if(Re<=gt){const _t=gt+1,$t=_t<rt?re[_t].el:ye;for(;Re<=gt;)$(null,re[Re]=qe?gc(re[Re]):bu(re[Re]),xe,$t,le,Ue,Ie,Ce,qe),Re++}}else if(Re>gt)for(;Re<=Ze;)X(oe[Re],le,Ue,!0),Re++;else{const _t=Re,$t=Re,tn=new Map;for(Re=$t;Re<=gt;Re++){const on=re[Re]=qe?gc(re[Re]):bu(re[Re]);on.key!=null&&tn.set(on.key,Re)}let Qe,Yt=0;const Qt=gt-$t+1;let Zt=!1,wt=0;const He=new Array(Qt);for(Re=0;Re<Qt;Re++)He[Re]=0;for(Re=_t;Re<=Ze;Re++){const on=oe[Re];if(Yt>=Qt){X(on,le,Ue,!0);continue}let Bn;if(on.key!=null)Bn=tn.get(on.key);else for(Qe=$t;Qe<=gt;Qe++)if(He[Qe-$t]===0&&Wc(on,re[Qe])){Bn=Qe;break}Bn===void 0?X(on,le,Ue,!0):(He[Bn-$t]=Re+1,Bn>=wt?wt=Bn:Zt=!0,$(on,re[Bn],xe,null,le,Ue,Ie,Ce,qe),Yt++)}const Kt=Zt?hS(He):Oh;for(Qe=Kt.length-1,Re=Qt-1;Re>=0;Re--){const on=$t+Re,Bn=re[on],kn=on+1<rt?re[on+1].el:ye;He[Re]===0?$(null,Bn,xe,kn,le,Ue,Ie,Ce,qe):Zt&&(Qe<0||Re!==Kt[Qe]?st(Bn,xe,kn,2):Qe--)}}},st=(oe,re,xe,ye,le=null)=>{const{el:Ue,type:Ie,transition:Ce,children:qe,shapeFlag:Re}=oe;if(Re&6){st(oe.component.subTree,re,xe,ye);return}if(Re&128){oe.suspense.move(re,xe,ye);return}if(Re&64){Ie.move(oe,re,xe,se);return}if(Ie===Un){r(Ue,re,xe);for(let Ze=0;Ze<qe.length;Ze++)st(qe[Ze],re,xe,ye);r(oe.anchor,re,xe);return}if(Ie===Id){ge(oe,re,xe);return}if(ye!==2&&Re&1&&Ce)if(ye===0)Ce.beforeEnter(Ue),r(Ue,re,xe),xa(()=>Ce.enter(Ue),le);else{const{leave:Ze,delayLeave:gt,afterLeave:_t}=Ce,$t=()=>r(Ue,re,xe),tn=()=>{Ze(Ue,()=>{$t(),_t&&_t()})};gt?gt(Ue,$t,tn):tn()}else r(Ue,re,xe)},X=(oe,re,xe,ye=!1,le=!1)=>{const{type:Ue,props:Ie,ref:Ce,children:qe,dynamicChildren:Re,shapeFlag:rt,patchFlag:Ze,dirs:gt,cacheIndex:_t}=oe;if(Ze===-2&&(le=!1),Ce!=null&&np(Ce,null,xe,oe,!0),_t!=null&&(re.renderCache[_t]=void 0),rt&256){re.ctx.deactivate(oe);return}const $t=rt&1&&gt,tn=!Af(oe);let Qe;if(tn&&(Qe=Ie&&Ie.onVnodeBeforeUnmount)&&fu(Qe,re,oe),rt&6)Z(oe.component,xe,ye);else{if(rt&128){oe.suspense.unmount(xe,ye);return}$t&&zc(oe,null,re,"beforeUnmount"),rt&64?oe.type.remove(oe,re,xe,se,ye):Re&&!Re.hasOnce&&(Ue!==Un||Ze>0&&Ze&64)?he(Re,re,xe,!1,!0):(Ue===Un&&Ze&384||!le&&rt&16)&&he(qe,re,xe),ye&&Ee(oe)}(tn&&(Qe=Ie&&Ie.onVnodeUnmounted)||$t)&&xa(()=>{Qe&&fu(Qe,re,oe),$t&&zc(oe,null,re,"unmounted")},xe)},Ee=oe=>{const{type:re,el:xe,anchor:ye,transition:le}=oe;if(re===Un){N(xe,ye);return}if(re===Id){Se(oe);return}const Ue=()=>{i(xe),le&&!le.persisted&&le.afterLeave&&le.afterLeave()};if(oe.shapeFlag&1&&le&&!le.persisted){const{leave:Ie,delayLeave:Ce}=le,qe=()=>Ie(xe,Ue);Ce?Ce(oe.el,Ue,qe):qe()}else Ue()},N=(oe,re)=>{let xe;for(;oe!==re;)xe=E(oe),i(oe),oe=xe;i(re)},Z=(oe,re,xe)=>{const{bum:ye,scope:le,job:Ue,subTree:Ie,um:Ce,m:qe,a:Re}=oe;X1(qe),X1(Re),ye&&Rd(ye),le.stop(),Ue&&(Ue.flags|=8,X(Ie,oe,re,xe)),Ce&&xa(Ce,re),xa(()=>{oe.isUnmounted=!0},re),re&&re.pendingBranch&&!re.isUnmounted&&oe.asyncDep&&!oe.asyncResolved&&oe.suspenseId===re.pendingId&&(re.deps--,re.deps===0&&re.resolve())},he=(oe,re,xe,ye=!1,le=!1,Ue=0)=>{for(let Ie=Ue;Ie<oe.length;Ie++)X(oe[Ie],re,xe,ye,le)},ne=oe=>{if(oe.shapeFlag&6)return ne(oe.component.subTree);if(oe.shapeFlag&128)return oe.suspense.next();const re=E(oe.anchor||oe.el),xe=re&&re[M_];return xe?E(xe):re};let te=!1;const ee=(oe,re,xe)=>{oe==null?re._vnode&&X(re._vnode,null,null,!0):$(re._vnode||null,oe,re,null,null,null,xe),re._vnode=oe,te||(te=!0,U1(),P_(),te=!1)},se={p:$,um:X,m:st,r:Ee,mt:z,mc:O,pc:ie,pbc:ce,n:ne,o:e};return{render:ee,hydrate:void 0,createApp:eS(ee)}}function M0({type:e,props:n},t){return t==="svg"&&e==="foreignObject"||t==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:t}function jc({effect:e,job:n},t){t?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function cS(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function cm(e,n,t=!1){const r=e.children,i=n.children;if(rr(r)&&rr(i))for(let o=0;o<r.length;o++){const l=r[o];let h=i[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=i[o]=gc(i[o]),h.el=l.el),!t&&h.patchFlag!==-2&&cm(l,h)),h.type===Mp&&(h.el=l.el)}}function hS(e){const n=e.slice(),t=[0];let r,i,o,l,h;const g=e.length;for(r=0;r<g;r++){const v=e[r];if(v!==0){if(i=t[t.length-1],e[i]<v){n[r]=i,t.push(r);continue}for(o=0,l=t.length-1;o<l;)h=o+l>>1,e[t[h]]<v?o=h+1:l=h;v<e[t[o]]&&(o>0&&(n[r]=t[o-1]),t[o]=r)}}for(o=t.length,l=t[o-1];o-- >0;)t[o]=l,l=n[l];return t}function X_(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:X_(n)}function X1(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const fS=Symbol.for("v-scx"),dS=()=>Ml(fS);function cg(e,n){return hm(e,null,n)}function Co(e,n,t){return hm(e,n,t)}function hm(e,n,t=Vi){const{immediate:r,deep:i,flush:o,once:l}=t,h=Eo({},t),g=n&&r||!n&&o!=="post";let v;if($f){if(o==="sync"){const b=dS();v=b.__watcherHandles||(b.__watcherHandles=[])}else if(!g){const b=()=>{};return b.stop=Su,b.resume=Su,b.pause=Su,b}}const _=Po;h.call=(b,R,$)=>Yl(b,_,R,$);let x=!1;o==="post"?h.scheduler=b=>{xa(b,_&&_.suspense)}:o!=="sync"&&(x=!0,h.scheduler=(b,R)=>{R?b():lm(b)}),h.augmentJob=b=>{n&&(b.flags|=4),x&&(b.flags|=2,_&&(b.id=_.uid,b.i=_))};const E=CL(e,n,h);return $f&&(v?v.push(E):g&&E()),E}function pS(e,n,t){const r=this.proxy,i=Is(e)?e.includes(".")?Q_(r,e):()=>r[e]:e.bind(r,r);let o;wr(n)?o=n:(o=n.handler,t=n);const l=Yf(this),h=hm(i,o.bind(r),t);return l(),h}function Q_(e,n){const t=n.split(".");return()=>{let r=e;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const gS=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Tl(n)}Modifiers`]||e[`${uh(n)}Modifiers`];function mS(e,n,...t){if(e.isUnmounted)return;const r=e.vnode.props||Vi;let i=t;const o=n.startsWith("update:"),l=o&&gS(r,n.slice(7));l&&(l.trim&&(i=t.map(_=>Is(_)?_.trim():_)),l.number&&(i=t.map(Yd)));let h,g=r[h=w0(n)]||r[h=w0(Tl(n))];!g&&o&&(g=r[h=w0(uh(n))]),g&&Yl(g,e,6,i);const v=r[h+"Once"];if(v){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,Yl(v,e,6,i)}}function e2(e,n,t=!1){const r=n.emitsCache,i=r.get(e);if(i!==void 0)return i;const o=e.emits;let l={},h=!1;if(!wr(e)){const g=v=>{const _=e2(v,n,!0);_&&(h=!0,Eo(l,_))};!t&&n.mixins.length&&n.mixins.forEach(g),e.extends&&g(e.extends),e.mixins&&e.mixins.forEach(g)}return!o&&!h?(Gi(e)&&r.set(e,null),null):(rr(o)?o.forEach(g=>l[g]=null):Eo(l,o),Gi(e)&&r.set(e,l),l)}function Ap(e,n){return!e||!_p(n)?!1:(n=n.slice(2).replace(/Once$/,""),Pi(e,n[0].toLowerCase()+n.slice(1))||Pi(e,uh(n))||Pi(e,n))}function Q1(e){const{type:n,vnode:t,proxy:r,withProxy:i,propsOptions:[o],slots:l,attrs:h,emit:g,render:v,renderCache:_,props:x,data:E,setupState:b,ctx:R,inheritAttrs:$}=e,Q=tp(e);let I,W;try{if(t.shapeFlag&4){const Se=i||r,De=Se;I=bu(v.call(De,Se,_,x,b,E,R)),W=h}else{const Se=n;I=bu(Se.length>1?Se(x,{attrs:h,slots:l,emit:g}):Se(x,null)),W=n.props?h:vS(h)}}catch(Se){kf.length=0,Sp(Se,e,1),I=Xi(qa)}let ge=I;if(W&&$!==!1){const Se=Object.keys(W),{shapeFlag:De}=ge;Se.length&&De&7&&(o&&Se.some(Jg)&&(W=yS(W,o)),ge=Lc(ge,W,!1,!0))}return t.dirs&&(ge=Lc(ge,null,!1,!0),ge.dirs=ge.dirs?ge.dirs.concat(t.dirs):t.dirs),t.transition&&jf(ge,t.transition),I=ge,tp(Q),I}const vS=e=>{let n;for(const t in e)(t==="class"||t==="style"||_p(t))&&((n||(n={}))[t]=e[t]);return n},yS=(e,n)=>{const t={};for(const r in e)(!Jg(r)||!(r.slice(9)in n))&&(t[r]=e[r]);return t};function _S(e,n,t){const{props:r,children:i,component:o}=e,{props:l,children:h,patchFlag:g}=n,v=o.emitsOptions;if(n.dirs||n.transition)return!0;if(t&&g>=0){if(g&1024)return!0;if(g&16)return r?ev(r,l,v):!!l;if(g&8){const _=n.dynamicProps;for(let x=0;x<_.length;x++){const E=_[x];if(l[E]!==r[E]&&!Ap(v,E))return!0}}}else return(i||h)&&(!h||!h.$stable)?!0:r===l?!1:r?l?ev(r,l,v):!0:!!l;return!1}function ev(e,n,t){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const o=r[i];if(n[o]!==e[o]&&!Ap(t,o))return!0}return!1}function bS({vnode:e,parent:n},t){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=t,n=n.parent;else break}}const t2=e=>e.__isSuspense;function wS(e,n){n&&n.pendingBranch?rr(e)?n.effects.push(...e):n.effects.push(e):AL(e)}const Un=Symbol.for("v-fgt"),Mp=Symbol.for("v-txt"),qa=Symbol.for("v-cmt"),Id=Symbol.for("v-stc"),kf=[];let ll=null;function Xe(e=!1){kf.push(ll=e?null:[])}function xS(){kf.pop(),ll=kf[kf.length-1]||null}let Uf=1;function tv(e,n=!1){Uf+=e,e<0&&ll&&n&&(ll.hasOnce=!0)}function n2(e){return e.dynamicChildren=Uf>0?ll||Oh:null,xS(),Uf>0&&ll&&ll.push(e),e}function tt(e,n,t,r,i,o){return n2(M(e,n,t,r,i,o,!0))}function Cu(e,n,t,r,i){return n2(Xi(e,n,t,r,i,!0))}function ip(e){return e?e.__v_isVNode===!0:!1}function Wc(e,n){return e.type===n.type&&e.key===n.key}const r2=({key:e})=>e??null,Fd=({ref:e,ref_key:n,ref_for:t})=>(typeof e=="number"&&(e=""+e),e!=null?Is(e)||Js(e)||wr(e)?{i:Ca,r:e,k:n,f:!!t}:e:null);function M(e,n=null,t=null,r=0,i=null,o=e===Un?0:1,l=!1,h=!1){const g={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&r2(n),ref:n&&Fd(n),scopeId:A_,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Ca};return h?(fm(g,t),o&128&&e.normalize(g)):t&&(g.shapeFlag|=Is(t)?8:16),Uf>0&&!l&&ll&&(g.patchFlag>0||o&6)&&g.patchFlag!==32&&ll.push(g),g}const Xi=LS;function LS(e,n=null,t=null,r=0,i=null,o=!1){if((!e||e===GL)&&(e=qa),ip(e)){const h=Lc(e,n,!0);return t&&fm(h,t),Uf>0&&!o&&ll&&(h.shapeFlag&6?ll[ll.indexOf(e)]=h:ll.push(h)),h.patchFlag=-2,h}if(DS(e)&&(e=e.__vccOpts),n){n=SS(n);let{class:h,style:g}=n;h&&!Is(h)&&(n.class=Yi(h)),Gi(g)&&(om(g)&&!rr(g)&&(g=Eo({},g)),n.style=Jc(g))}const l=Is(e)?1:t2(e)?128:k_(e)?64:Gi(e)?4:wr(e)?2:0;return M(e,n,t,r,i,l,o,!0)}function SS(e){return e?om(e)||G_(e)?Eo({},e):e:null}function Lc(e,n,t=!1,r=!1){const{props:i,ref:o,patchFlag:l,children:h,transition:g}=e,v=n?CS(i||{},n):i,_={__v_isVNode:!0,__v_skip:!0,type:e.type,props:v,key:v&&r2(v),ref:n&&n.ref?t&&o?rr(o)?o.concat(Fd(n)):[o,Fd(n)]:Fd(n):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==Un?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:g,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Lc(e.ssContent),ssFallback:e.ssFallback&&Lc(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return g&&r&&jf(_,g.clone(_)),_}function Ni(e=" ",n=0){return Xi(Mp,null,e,n)}function wc(e,n){const t=Xi(Id,null,e);return t.staticCount=n,t}function yn(e="",n=!1){return n?(Xe(),Cu(qa,null,e)):Xi(qa,null,e)}function bu(e){return e==null||typeof e=="boolean"?Xi(qa):rr(e)?Xi(Un,null,e.slice()):ip(e)?gc(e):Xi(Mp,null,String(e))}function gc(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Lc(e)}function fm(e,n){let t=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(rr(n))t=16;else if(typeof n=="object")if(r&65){const i=n.default;i&&(i._c&&(i._d=!1),fm(e,i()),i._c&&(i._d=!0));return}else{t=32;const i=n._;!i&&!G_(n)?n._ctx=Ca:i===3&&Ca&&(Ca.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else wr(n)?(n={default:n,_ctx:Ca},t=32):(n=String(n),r&64?(t=16,n=[Ni(n)]):t=8);e.children=n,e.shapeFlag|=t}function CS(...e){const n={};for(let t=0;t<e.length;t++){const r=e[t];for(const i in r)if(i==="class")n.class!==r.class&&(n.class=Yi([n.class,r.class]));else if(i==="style")n.style=Jc([n.style,r.style]);else if(_p(i)){const o=n[i],l=r[i];l&&o!==l&&!(rr(o)&&o.includes(l))&&(n[i]=o?[].concat(o,l):l)}else i!==""&&(n[i]=r[i])}return n}function fu(e,n,t,r=null){Yl(e,n,7,[t,r])}const PS=$_();let ES=0;function AS(e,n,t){const r=e.type,i=(n?n.appContext:e.appContext)||PS,o={uid:ES++,vnode:e,type:r,parent:n,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new i_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(i.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:W_(r,i),emitsOptions:e2(r,i),emit:null,emitted:null,propsDefaults:Vi,inheritAttrs:r.inheritAttrs,ctx:Vi,data:Vi,props:Vi,attrs:Vi,slots:Vi,refs:Vi,setupState:Vi,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=n?n.root:o,o.emit=mS.bind(null,o),e.ce&&e.ce(o),o}let Po=null;const MS=()=>Po||Ca;let sp,hg;{const e=xp(),n=(t,r)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(r),o=>{i.length>1?i.forEach(l=>l(o)):i[0](o)}};sp=n("__VUE_INSTANCE_SETTERS__",t=>Po=t),hg=n("__VUE_SSR_SETTERS__",t=>$f=t)}const Yf=e=>{const n=Po;return sp(e),e.scope.on(),()=>{e.scope.off(),sp(n)}},nv=()=>{Po&&Po.scope.off(),sp(null)};function i2(e){return e.vnode.shapeFlag&4}let $f=!1;function kS(e,n=!1,t=!1){n&&hg(n);const{props:r,children:i}=e.vnode,o=i2(e);nS(e,r,o,n),oS(e,i,t);const l=o?TS(e,n):void 0;return n&&hg(!1),l}function TS(e,n){const t=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,WL);const{setup:r}=t;if(r){Ec();const i=e.setupContext=r.length>1?NS(e):null,o=Yf(e),l=Jf(r,e,0,[e.props,i]),h=Yy(l);if(Ac(),o(),(h||e.sp)&&!Af(e)&&F_(e),h){if(l.then(nv,nv),n)return l.then(g=>{rv(e,g)}).catch(g=>{Sp(g,e,0)});e.asyncDep=l}else rv(e,l)}else s2(e)}function rv(e,n,t){wr(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:Gi(n)&&(e.setupState=L_(n)),s2(e)}function s2(e,n,t){const r=e.type;e.render||(e.render=r.render||Su);{const i=Yf(e);Ec();try{ZL(e)}finally{Ac(),i()}}}const BS={get(e,n){return oa(e,"get",""),e[n]}};function NS(e){const n=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,BS),slots:e.slots,emit:e.emit,expose:n}}function kp(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(L_(am(e.exposed)),{get(n,t){if(t in n)return n[t];if(t in Mf)return Mf[t](e)},has(n,t){return t in n||t in Mf}})):e.proxy}function RS(e,n=!0){return wr(e)?e.displayName||e.name:e.name||n&&e.__name}function DS(e){return wr(e)&&"__vccOpts"in e}const Rr=(e,n)=>LL(e,n,$f);function dm(e,n,t){const r=arguments.length;return r===2?Gi(n)&&!rr(n)?ip(n)?Xi(e,null,[n]):Xi(e,n):Xi(e,null,n):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&ip(t)&&(t=[t]),Xi(e,n,t))}const OS="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fg;const iv=typeof window<"u"&&window.trustedTypes;if(iv)try{fg=iv.createPolicy("vue",{createHTML:e=>e})}catch{}const o2=fg?e=>fg.createHTML(e):e=>e,IS="http://www.w3.org/2000/svg",FS="http://www.w3.org/1998/Math/MathML",Zu=typeof document<"u"?document:null,sv=Zu&&Zu.createElement("template"),zS={insert:(e,n,t)=>{n.insertBefore(e,t||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,t,r)=>{const i=n==="svg"?Zu.createElementNS(IS,e):n==="mathml"?Zu.createElementNS(FS,e):t?Zu.createElement(e,{is:t}):Zu.createElement(e);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>Zu.createTextNode(e),createComment:e=>Zu.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Zu.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,t,r,i,o){const l=t?t.previousSibling:n.lastChild;if(i&&(i===o||i.nextSibling))for(;n.insertBefore(i.cloneNode(!0),t),!(i===o||!(i=i.nextSibling)););else{sv.innerHTML=o2(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const h=sv.content;if(r==="svg"||r==="mathml"){const g=h.firstChild;for(;g.firstChild;)h.appendChild(g.firstChild);h.removeChild(g)}n.insertBefore(h,t)}return[l?l.nextSibling:n.firstChild,t?t.previousSibling:n.lastChild]}},ac="transition",uf="animation",qf=Symbol("_vtc"),a2={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jS=Eo({},N_,a2),US=e=>(e.displayName="Transition",e.props=jS,e),ov=US((e,{slots:n})=>dm(BL,$S(e),n)),Uc=(e,n=[])=>{rr(e)?e.forEach(t=>t(...n)):e&&e(...n)},av=e=>e?rr(e)?e.some(n=>n.length>1):e.length>1:!1;function $S(e){const n={};for(const D in e)D in a2||(n[D]=e[D]);if(e.css===!1)return n;const{name:t="v",type:r,duration:i,enterFromClass:o=`${t}-enter-from`,enterActiveClass:l=`${t}-enter-active`,enterToClass:h=`${t}-enter-to`,appearFromClass:g=o,appearActiveClass:v=l,appearToClass:_=h,leaveFromClass:x=`${t}-leave-from`,leaveActiveClass:E=`${t}-leave-active`,leaveToClass:b=`${t}-leave-to`}=e,R=qS(i),$=R&&R[0],Q=R&&R[1],{onBeforeEnter:I,onEnter:W,onEnterCancelled:ge,onLeave:Se,onLeaveCancelled:De,onBeforeAppear:Ye=I,onAppear:Ve=W,onAppearCancelled:O=ge}=n,K=(D,V,z,U)=>{D._enterCancelled=U,$c(D,V?_:h),$c(D,V?v:l),z&&z()},ce=(D,V)=>{D._isLeaving=!1,$c(D,x),$c(D,b),$c(D,E),V&&V()},H=D=>(V,z)=>{const U=D?Ve:W,G=()=>K(V,D,z);Uc(U,[V,G]),lv(()=>{$c(V,D?g:o),qu(V,D?_:h),av(U)||uv(V,r,$,G)})};return Eo(n,{onBeforeEnter(D){Uc(I,[D]),qu(D,o),qu(D,l)},onBeforeAppear(D){Uc(Ye,[D]),qu(D,g),qu(D,v)},onEnter:H(!1),onAppear:H(!0),onLeave(D,V){D._isLeaving=!0;const z=()=>ce(D,V);qu(D,x),D._enterCancelled?(qu(D,E),fv()):(fv(),qu(D,E)),lv(()=>{D._isLeaving&&($c(D,x),qu(D,b),av(Se)||uv(D,r,Q,z))}),Uc(Se,[D,z])},onEnterCancelled(D){K(D,!1,void 0,!0),Uc(ge,[D])},onAppearCancelled(D){K(D,!0,void 0,!0),Uc(O,[D])},onLeaveCancelled(D){ce(D),Uc(De,[D])}})}function qS(e){if(e==null)return null;if(Gi(e))return[k0(e.enter),k0(e.leave)];{const n=k0(e);return[n,n]}}function k0(e){return $x(e)}function qu(e,n){n.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e[qf]||(e[qf]=new Set)).add(n)}function $c(e,n){n.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const t=e[qf];t&&(t.delete(n),t.size||(e[qf]=void 0))}function lv(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let VS=0;function uv(e,n,t,r){const i=e._endId=++VS,o=()=>{i===e._endId&&r()};if(t!=null)return setTimeout(o,t);const{type:l,timeout:h,propCount:g}=GS(e,n);if(!l)return r();const v=l+"end";let _=0;const x=()=>{e.removeEventListener(v,E),o()},E=b=>{b.target===e&&++_>=g&&x()};setTimeout(()=>{_<g&&x()},h+1),e.addEventListener(v,E)}function GS(e,n){const t=window.getComputedStyle(e),r=R=>(t[R]||"").split(", "),i=r(`${ac}Delay`),o=r(`${ac}Duration`),l=cv(i,o),h=r(`${uf}Delay`),g=r(`${uf}Duration`),v=cv(h,g);let _=null,x=0,E=0;n===ac?l>0&&(_=ac,x=l,E=o.length):n===uf?v>0&&(_=uf,x=v,E=g.length):(x=Math.max(l,v),_=x>0?l>v?ac:uf:null,E=_?_===ac?o.length:g.length:0);const b=_===ac&&/\b(transform|all)(,|$)/.test(r(`${ac}Property`).toString());return{type:_,timeout:x,propCount:E,hasTransform:b}}function cv(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((t,r)=>hv(t)+hv(e[r])))}function hv(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function fv(){return document.body.offsetHeight}function HS(e,n,t){const r=e[qf];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):t?e.setAttribute("class",n):e.className=n}const op=Symbol("_vod"),l2=Symbol("_vsh"),_f={beforeMount(e,{value:n},{transition:t}){e[op]=e.style.display==="none"?"":e.style.display,t&&n?t.beforeEnter(e):cf(e,n)},mounted(e,{value:n},{transition:t}){t&&n&&t.enter(e)},updated(e,{value:n,oldValue:t},{transition:r}){!n!=!t&&(r?n?(r.beforeEnter(e),cf(e,!0),r.enter(e)):r.leave(e,()=>{cf(e,!1)}):cf(e,n))},beforeUnmount(e,{value:n}){cf(e,n)}};function cf(e,n){e.style.display=n?e[op]:"none",e[l2]=!n}const WS=Symbol(""),ZS=/(^|;)\s*display\s*:/;function KS(e,n,t){const r=e.style,i=Is(t);let o=!1;if(t&&!i){if(n)if(Is(n))for(const l of n.split(";")){const h=l.slice(0,l.indexOf(":")).trim();t[h]==null&&zd(r,h,"")}else for(const l in n)t[l]==null&&zd(r,l,"");for(const l in t)l==="display"&&(o=!0),zd(r,l,t[l])}else if(i){if(n!==t){const l=r[WS];l&&(t+=";"+l),r.cssText=t,o=ZS.test(t)}}else n&&e.removeAttribute("style");op in e&&(e[op]=o?r.display:"",e[l2]&&(r.display="none"))}const dv=/\s*!important$/;function zd(e,n,t){if(rr(t))t.forEach(r=>zd(e,n,r));else if(t==null&&(t=""),n.startsWith("--"))e.setProperty(n,t);else{const r=JS(e,n);dv.test(t)?e.setProperty(uh(r),t.replace(dv,""),"important"):e[r]=t}}const pv=["Webkit","Moz","ms"],T0={};function JS(e,n){const t=T0[n];if(t)return t;let r=Tl(n);if(r!=="filter"&&r in e)return T0[n]=r;r=wp(r);for(let i=0;i<pv.length;i++){const o=pv[i]+r;if(o in e)return T0[n]=o}return n}const gv="http://www.w3.org/1999/xlink";function mv(e,n,t,r,i,o=Zx(n)){r&&n.startsWith("xlink:")?t==null?e.removeAttributeNS(gv,n.slice(6,n.length)):e.setAttributeNS(gv,n,t):t==null||o&&!t_(t)?e.removeAttribute(n):e.setAttribute(n,o?"":Eu(t)?String(t):t)}function vv(e,n,t,r,i){if(n==="innerHTML"||n==="textContent"){t!=null&&(e[n]=n==="innerHTML"?o2(t):t);return}const o=e.tagName;if(n==="value"&&o!=="PROGRESS"&&!o.includes("-")){const h=o==="OPTION"?e.getAttribute("value")||"":e.value,g=t==null?e.type==="checkbox"?"on":"":String(t);(h!==g||!("_value"in e))&&(e.value=g),t==null&&e.removeAttribute(n),e._value=t;return}let l=!1;if(t===""||t==null){const h=typeof e[n];h==="boolean"?t=t_(t):t==null&&h==="string"?(t="",l=!0):h==="number"&&(t=0,l=!0)}try{e[n]=t}catch{}l&&e.removeAttribute(i||n)}function Yu(e,n,t,r){e.addEventListener(n,t,r)}function YS(e,n,t,r){e.removeEventListener(n,t,r)}const yv=Symbol("_vei");function XS(e,n,t,r,i=null){const o=e[yv]||(e[yv]={}),l=o[n];if(r&&l)l.value=r;else{const[h,g]=QS(n);if(r){const v=o[n]=nC(r,i);Yu(e,h,v,g)}else l&&(YS(e,h,l,g),o[n]=void 0)}}const _v=/(?:Once|Passive|Capture)$/;function QS(e){let n;if(_v.test(e)){n={};let r;for(;r=e.match(_v);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):uh(e.slice(2)),n]}let B0=0;const eC=Promise.resolve(),tC=()=>B0||(eC.then(()=>B0=0),B0=Date.now());function nC(e,n){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Yl(rC(r,t.value),n,5,[r])};return t.value=e,t.attached=tC(),t}function rC(e,n){if(rr(n)){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{t.call(e),e._stopped=!0},n.map(r=>i=>!i._stopped&&r&&r(i))}else return n}const bv=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,iC=(e,n,t,r,i,o)=>{const l=i==="svg";n==="class"?HS(e,r,l):n==="style"?KS(e,t,r):_p(n)?Jg(n)||XS(e,n,t,r,o):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):sC(e,n,r,l))?(vv(e,n,r),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&mv(e,n,r,l,o,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!Is(r))?vv(e,Tl(n),r,o,n):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),mv(e,n,r,l))};function sC(e,n,t,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&bv(n)&&wr(t));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return bv(n)&&Is(t)?!1:n in e}const Sc=e=>{const n=e.props["onUpdate:modelValue"]||!1;return rr(n)?t=>Rd(n,t):n};function oC(e){e.target.composing=!0}function wv(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const kl=Symbol("_assign"),Mr={created(e,{modifiers:{lazy:n,trim:t,number:r}},i){e[kl]=Sc(i);const o=r||i.props&&i.props.type==="number";Yu(e,n?"change":"input",l=>{if(l.target.composing)return;let h=e.value;t&&(h=h.trim()),o&&(h=Yd(h)),e[kl](h)}),t&&Yu(e,"change",()=>{e.value=e.value.trim()}),n||(Yu(e,"compositionstart",oC),Yu(e,"compositionend",wv),Yu(e,"change",wv))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:t,modifiers:{lazy:r,trim:i,number:o}},l){if(e[kl]=Sc(l),e.composing)return;const h=(o||e.type==="number")&&!/^0\d/.test(e.value)?Yd(e.value):e.value,g=n??"";h!==g&&(document.activeElement===e&&e.type!=="range"&&(r&&n===t||i&&e.value.trim()===g)||(e.value=g))}},u2={deep:!0,created(e,n,t){e[kl]=Sc(t),Yu(e,"change",()=>{const r=e._modelValue,i=Vh(e),o=e.checked,l=e[kl];if(rr(r)){const h=Qg(r,i),g=h!==-1;if(o&&!g)l(r.concat(i));else if(!o&&g){const v=[...r];v.splice(h,1),l(v)}}else if(Zh(r)){const h=new Set(r);o?h.add(i):h.delete(i),l(h)}else l(c2(e,o))})},mounted:xv,beforeUpdate(e,n,t){e[kl]=Sc(t),xv(e,n,t)}};function xv(e,{value:n,oldValue:t},r){e._modelValue=n;let i;if(rr(n))i=Qg(n,r.props.value)>-1;else if(Zh(n))i=n.has(r.props.value);else{if(n===t)return;i=sh(n,c2(e,!0))}e.checked!==i&&(e.checked=i)}const aC={created(e,{value:n},t){e.checked=sh(n,t.props.value),e[kl]=Sc(t),Yu(e,"change",()=>{e[kl](Vh(e))})},beforeUpdate(e,{value:n,oldValue:t},r){e[kl]=Sc(r),n!==t&&(e.checked=sh(n,r.props.value))}},Hs={deep:!0,created(e,{value:n,modifiers:{number:t}},r){const i=Zh(n);Yu(e,"change",()=>{const o=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>t?Yd(Vh(l)):Vh(l));e[kl](e.multiple?i?new Set(o):o:o[0]),e._assigning=!0,Ds(()=>{e._assigning=!1})}),e[kl]=Sc(r)},mounted(e,{value:n}){Lv(e,n)},beforeUpdate(e,n,t){e[kl]=Sc(t)},updated(e,{value:n}){e._assigning||Lv(e,n)}};function Lv(e,n){const t=e.multiple,r=rr(n);if(!(t&&!r&&!Zh(n))){for(let i=0,o=e.options.length;i<o;i++){const l=e.options[i],h=Vh(l);if(t)if(r){const g=typeof h;g==="string"||g==="number"?l.selected=n.some(v=>String(v)===String(h)):l.selected=Qg(n,h)>-1}else l.selected=n.has(h);else if(sh(Vh(l),n)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!t&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Vh(e){return"_value"in e?e._value:e.value}function c2(e,n){const t=n?"_trueValue":"_falseValue";return t in e?e[t]:n}const lC={created(e,n,t){Pd(e,n,t,null,"created")},mounted(e,n,t){Pd(e,n,t,null,"mounted")},beforeUpdate(e,n,t,r){Pd(e,n,t,r,"beforeUpdate")},updated(e,n,t,r){Pd(e,n,t,r,"updated")}};function uC(e,n){switch(e){case"SELECT":return Hs;case"TEXTAREA":return Mr;default:switch(n){case"checkbox":return u2;case"radio":return aC;default:return Mr}}}function Pd(e,n,t,r,i){const l=uC(e.tagName,t.props&&t.props.type)[i];l&&l(e,n,t,r)}const cC=["ctrl","shift","alt","meta"],hC={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>cC.some(t=>e[`${t}Key`]&&!n.includes(t))},Tp=(e,n)=>{const t=e._withMods||(e._withMods={}),r=n.join(".");return t[r]||(t[r]=(i,...o)=>{for(let l=0;l<n.length;l++){const h=hC[n[l]];if(h&&h(i,n))return}return e(i,...o)})},fC=Eo({patchProp:iC},zS);let Sv;function dC(){return Sv||(Sv=lS(fC))}const pC=(...e)=>{const n=dC().createApp(...e),{mount:t}=n;return n.mount=r=>{const i=mC(r);if(!i)return;const o=n._component;!wr(o)&&!o.render&&!o.template&&(o.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const l=t(i,!1,gC(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),l},n};function gC(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function mC(e){return Is(e)?document.querySelector(e):e}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let h2;const Bp=e=>h2=e,f2=Symbol();function dg(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Tf;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Tf||(Tf={}));function vC(){const e=s_(!0),n=e.run(()=>un({}));let t=[],r=[];const i=am({install(o){Bp(i),i._a=o,o.provide(f2,i),o.config.globalProperties.$pinia=i,r.forEach(l=>t.push(l)),r=[]},use(o){return this._a?t.push(o):r.push(o),this},_p:t,_a:null,_e:e,_s:new Map,state:n});return i}const d2=()=>{};function Cv(e,n,t,r=d2){e.push(n);const i=()=>{const o=e.indexOf(n);o>-1&&(e.splice(o,1),r())};return!t&&o_()&&Jx(i),i}function Ah(e,...n){e.slice().forEach(t=>{t(...n)})}const yC=e=>e(),Pv=Symbol(),N0=Symbol();function pg(e,n){e instanceof Map&&n instanceof Map?n.forEach((t,r)=>e.set(r,t)):e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const t in n){if(!n.hasOwnProperty(t))continue;const r=n[t],i=e[t];dg(i)&&dg(r)&&e.hasOwnProperty(t)&&!Js(r)&&!bc(r)?e[t]=pg(i,r):e[t]=r}return e}const _C=Symbol();function bC(e){return!dg(e)||!e.hasOwnProperty(_C)}const{assign:fc}=Object;function wC(e){return!!(Js(e)&&e.effect)}function xC(e,n,t,r){const{state:i,actions:o,getters:l}=n,h=t.state.value[e];let g;function v(){h||(t.state.value[e]=i?i():{});const _=_L(t.state.value[e]);return fc(_,o,Object.keys(l||{}).reduce((x,E)=>(x[E]=am(Rr(()=>{Bp(t);const b=t._s.get(e);return l[E].call(b,b)})),x),{}))}return g=p2(e,v,n,t,r,!0),g}function p2(e,n,t={},r,i,o){let l;const h=fc({actions:{}},t),g={deep:!0};let v,_,x=[],E=[],b;const R=r.state.value[e];!o&&!R&&(r.state.value[e]={}),un({});let $;function Q(O){let K;v=_=!1,typeof O=="function"?(O(r.state.value[e]),K={type:Tf.patchFunction,storeId:e,events:b}):(pg(r.state.value[e],O),K={type:Tf.patchObject,payload:O,storeId:e,events:b});const ce=$=Symbol();Ds().then(()=>{$===ce&&(v=!0)}),_=!0,Ah(x,K,r.state.value[e])}const I=o?function(){const{state:K}=t,ce=K?K():{};this.$patch(H=>{fc(H,ce)})}:d2;function W(){l.stop(),x=[],E=[],r._s.delete(e)}const ge=(O,K="")=>{if(Pv in O)return O[N0]=K,O;const ce=function(){Bp(r);const H=Array.from(arguments),D=[],V=[];function z(ue){D.push(ue)}function U(ue){V.push(ue)}Ah(E,{args:H,name:ce[N0],store:De,after:z,onError:U});let G;try{G=O.apply(this&&this.$id===e?this:De,H)}catch(ue){throw Ah(V,ue),ue}return G instanceof Promise?G.then(ue=>(Ah(D,ue),ue)).catch(ue=>(Ah(V,ue),Promise.reject(ue))):(Ah(D,G),G)};return ce[Pv]=!0,ce[N0]=K,ce},Se={_p:r,$id:e,$onAction:Cv.bind(null,E),$patch:Q,$reset:I,$subscribe(O,K={}){const ce=Cv(x,O,K.detached,()=>H()),H=l.run(()=>Co(()=>r.state.value[e],D=>{(K.flush==="sync"?_:v)&&O({storeId:e,type:Tf.direct,events:b},D)},fc({},g,K)));return ce},$dispose:W},De=Au(Se);r._s.set(e,De);const Ve=(r._a&&r._a.runWithContext||yC)(()=>r._e.run(()=>(l=s_()).run(()=>n({action:ge}))));for(const O in Ve){const K=Ve[O];if(Js(K)&&!wC(K)||bc(K))o||(R&&bC(K)&&(Js(K)?K.value=R[O]:pg(K,R[O])),r.state.value[e][O]=K);else if(typeof K=="function"){const ce=ge(K,O);Ve[O]=ce,h.actions[O]=K}}return fc(De,Ve),fc(ci(De),Ve),Object.defineProperty(De,"$state",{get:()=>r.state.value[e],set:O=>{Q(K=>{fc(K,O)})}}),r._p.forEach(O=>{fc(De,l.run(()=>O({store:De,app:r._a,pinia:r,options:h})))}),R&&o&&t.hydrate&&t.hydrate(De.$state,R),v=!0,_=!0,De}/*! #__NO_SIDE_EFFECTS__ */function Np(e,n,t){let r,i;const o=typeof n=="function";typeof e=="string"?(r=e,i=o?t:n):(i=e,r=e.id);function l(h,g){const v=tS();return h=h||(v?Ml(f2,null):null),h&&Bp(h),h=h2,h._s.has(r)||(o?p2(r,n,i,h):xC(r,i,h)),h._s.get(r)}return l.$id=r,l}function g2(e,n){return function(){return e.apply(n,arguments)}}const{toString:LC}=Object.prototype,{getPrototypeOf:pm}=Object,Rp=(e=>n=>{const t=LC.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),eu=e=>(e=e.toLowerCase(),n=>Rp(n)===e),Dp=e=>n=>typeof n===e,{isArray:Jh}=Array,Vf=Dp("undefined");function SC(e){return e!==null&&!Vf(e)&&e.constructor!==null&&!Vf(e.constructor)&&cl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const m2=eu("ArrayBuffer");function CC(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&m2(e.buffer),n}const PC=Dp("string"),cl=Dp("function"),v2=Dp("number"),Op=e=>e!==null&&typeof e=="object",EC=e=>e===!0||e===!1,jd=e=>{if(Rp(e)!=="object")return!1;const n=pm(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},AC=eu("Date"),MC=eu("File"),kC=eu("Blob"),TC=eu("FileList"),BC=e=>Op(e)&&cl(e.pipe),NC=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||cl(e.append)&&((n=Rp(e))==="formdata"||n==="object"&&cl(e.toString)&&e.toString()==="[object FormData]"))},RC=eu("URLSearchParams"),[DC,OC,IC,FC]=["ReadableStream","Request","Response","Headers"].map(eu),zC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xf(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),Jh(e))for(r=0,i=e.length;r<i;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let h;for(r=0;r<l;r++)h=o[r],n.call(null,e[h],h,e)}}function y2(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,i;for(;r-- >0;)if(i=t[r],n===i.toLowerCase())return i;return null}const Yc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_2=e=>!Vf(e)&&e!==Yc;function gg(){const{caseless:e}=_2(this)&&this||{},n={},t=(r,i)=>{const o=e&&y2(n,i)||i;jd(n[o])&&jd(r)?n[o]=gg(n[o],r):jd(r)?n[o]=gg({},r):Jh(r)?n[o]=r.slice():n[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Xf(arguments[r],t);return n}const jC=(e,n,t,{allOwnKeys:r}={})=>(Xf(n,(i,o)=>{t&&cl(i)?e[o]=g2(i,t):e[o]=i},{allOwnKeys:r}),e),UC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),$C=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},qC=(e,n,t,r)=>{let i,o,l;const h={};if(n=n||{},e==null)return n;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)l=i[o],(!r||r(l,e,n))&&!h[l]&&(n[l]=e[l],h[l]=!0);e=t!==!1&&pm(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},VC=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},GC=e=>{if(!e)return null;if(Jh(e))return e;let n=e.length;if(!v2(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},HC=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&pm(Uint8Array)),WC=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const o=i.value;n.call(e,o[0],o[1])}},ZC=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},KC=eu("HTMLFormElement"),JC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),Ev=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),YC=eu("RegExp"),b2=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};Xf(t,(i,o)=>{let l;(l=n(i,o,e))!==!1&&(r[o]=l||i)}),Object.defineProperties(e,r)},XC=e=>{b2(e,(n,t)=>{if(cl(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(cl(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},QC=(e,n)=>{const t={},r=i=>{i.forEach(o=>{t[o]=!0})};return Jh(e)?r(e):r(String(e).split(n)),t},eP=()=>{},tP=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function nP(e){return!!(e&&cl(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const rP=e=>{const n=new Array(10),t=(r,i)=>{if(Op(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[i]=r;const o=Jh(r)?[]:{};return Xf(r,(l,h)=>{const g=t(l,i+1);!Vf(g)&&(o[h]=g)}),n[i]=void 0,o}}return r};return t(e,0)},iP=eu("AsyncFunction"),sP=e=>e&&(Op(e)||cl(e))&&cl(e.then)&&cl(e.catch),w2=((e,n)=>e?setImmediate:n?((t,r)=>(Yc.addEventListener("message",({source:i,data:o})=>{i===Yc&&o===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Yc.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",cl(Yc.postMessage)),oP=typeof queueMicrotask<"u"?queueMicrotask.bind(Yc):typeof process<"u"&&process.nextTick||w2,Gt={isArray:Jh,isArrayBuffer:m2,isBuffer:SC,isFormData:NC,isArrayBufferView:CC,isString:PC,isNumber:v2,isBoolean:EC,isObject:Op,isPlainObject:jd,isReadableStream:DC,isRequest:OC,isResponse:IC,isHeaders:FC,isUndefined:Vf,isDate:AC,isFile:MC,isBlob:kC,isRegExp:YC,isFunction:cl,isStream:BC,isURLSearchParams:RC,isTypedArray:HC,isFileList:TC,forEach:Xf,merge:gg,extend:jC,trim:zC,stripBOM:UC,inherits:$C,toFlatObject:qC,kindOf:Rp,kindOfTest:eu,endsWith:VC,toArray:GC,forEachEntry:WC,matchAll:ZC,isHTMLForm:KC,hasOwnProperty:Ev,hasOwnProp:Ev,reduceDescriptors:b2,freezeMethods:XC,toObjectSet:QC,toCamelCase:JC,noop:eP,toFiniteNumber:tP,findKey:y2,global:Yc,isContextDefined:_2,isSpecCompliantForm:nP,toJSONObject:rP,isAsyncFn:iP,isThenable:sP,setImmediate:w2,asap:oP};function Nr(e,n,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Gt.inherits(Nr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Gt.toJSONObject(this.config),code:this.code,status:this.status}}});const x2=Nr.prototype,L2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{L2[e]={value:e}});Object.defineProperties(Nr,L2);Object.defineProperty(x2,"isAxiosError",{value:!0});Nr.from=(e,n,t,r,i,o)=>{const l=Object.create(x2);return Gt.toFlatObject(e,l,function(g){return g!==Error.prototype},h=>h!=="isAxiosError"),Nr.call(l,e.message,n,t,r,i),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const aP=null;function mg(e){return Gt.isPlainObject(e)||Gt.isArray(e)}function S2(e){return Gt.endsWith(e,"[]")?e.slice(0,-2):e}function Av(e,n,t){return e?e.concat(n).map(function(i,o){return i=S2(i),!t&&o?"["+i+"]":i}).join(t?".":""):n}function lP(e){return Gt.isArray(e)&&!e.some(mg)}const uP=Gt.toFlatObject(Gt,{},null,function(n){return/^is[A-Z]/.test(n)});function Ip(e,n,t){if(!Gt.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Gt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function($,Q){return!Gt.isUndefined(Q[$])});const r=t.metaTokens,i=t.visitor||_,o=t.dots,l=t.indexes,g=(t.Blob||typeof Blob<"u"&&Blob)&&Gt.isSpecCompliantForm(n);if(!Gt.isFunction(i))throw new TypeError("visitor must be a function");function v(R){if(R===null)return"";if(Gt.isDate(R))return R.toISOString();if(!g&&Gt.isBlob(R))throw new Nr("Blob is not supported. Use a Buffer instead.");return Gt.isArrayBuffer(R)||Gt.isTypedArray(R)?g&&typeof Blob=="function"?new Blob([R]):Buffer.from(R):R}function _(R,$,Q){let I=R;if(R&&!Q&&typeof R=="object"){if(Gt.endsWith($,"{}"))$=r?$:$.slice(0,-2),R=JSON.stringify(R);else if(Gt.isArray(R)&&lP(R)||(Gt.isFileList(R)||Gt.endsWith($,"[]"))&&(I=Gt.toArray(R)))return $=S2($),I.forEach(function(ge,Se){!(Gt.isUndefined(ge)||ge===null)&&n.append(l===!0?Av([$],Se,o):l===null?$:$+"[]",v(ge))}),!1}return mg(R)?!0:(n.append(Av(Q,$,o),v(R)),!1)}const x=[],E=Object.assign(uP,{defaultVisitor:_,convertValue:v,isVisitable:mg});function b(R,$){if(!Gt.isUndefined(R)){if(x.indexOf(R)!==-1)throw Error("Circular reference detected in "+$.join("."));x.push(R),Gt.forEach(R,function(I,W){(!(Gt.isUndefined(I)||I===null)&&i.call(n,I,Gt.isString(W)?W.trim():W,$,E))===!0&&b(I,$?$.concat(W):[W])}),x.pop()}}if(!Gt.isObject(e))throw new TypeError("data must be an object");return b(e),n}function Mv(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function gm(e,n){this._pairs=[],e&&Ip(e,this,n)}const C2=gm.prototype;C2.append=function(n,t){this._pairs.push([n,t])};C2.toString=function(n){const t=n?function(r){return n.call(this,r,Mv)}:Mv;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function cP(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function P2(e,n,t){if(!n)return e;const r=t&&t.encode||cP;Gt.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let o;if(i?o=i(n,t):o=Gt.isURLSearchParams(n)?n.toString():new gm(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class kv{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Gt.forEach(this.handlers,function(r){r!==null&&n(r)})}}const E2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hP=typeof URLSearchParams<"u"?URLSearchParams:gm,fP=typeof FormData<"u"?FormData:null,dP=typeof Blob<"u"?Blob:null,pP={isBrowser:!0,classes:{URLSearchParams:hP,FormData:fP,Blob:dP},protocols:["http","https","file","blob","url","data"]},mm=typeof window<"u"&&typeof document<"u",vg=typeof navigator=="object"&&navigator||void 0,gP=mm&&(!vg||["ReactNative","NativeScript","NS"].indexOf(vg.product)<0),mP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vP=mm&&window.location.href||"http://localhost",yP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mm,hasStandardBrowserEnv:gP,hasStandardBrowserWebWorkerEnv:mP,navigator:vg,origin:vP},Symbol.toStringTag,{value:"Module"})),la={...yP,...pP};function _P(e,n){return Ip(e,new la.classes.URLSearchParams,Object.assign({visitor:function(t,r,i,o){return la.isNode&&Gt.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function bP(e){return Gt.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function wP(e){const n={},t=Object.keys(e);let r;const i=t.length;let o;for(r=0;r<i;r++)o=t[r],n[o]=e[o];return n}function A2(e){function n(t,r,i,o){let l=t[o++];if(l==="__proto__")return!0;const h=Number.isFinite(+l),g=o>=t.length;return l=!l&&Gt.isArray(i)?i.length:l,g?(Gt.hasOwnProp(i,l)?i[l]=[i[l],r]:i[l]=r,!h):((!i[l]||!Gt.isObject(i[l]))&&(i[l]=[]),n(t,r,i[l],o)&&Gt.isArray(i[l])&&(i[l]=wP(i[l])),!h)}if(Gt.isFormData(e)&&Gt.isFunction(e.entries)){const t={};return Gt.forEachEntry(e,(r,i)=>{n(bP(r),i,t,0)}),t}return null}function xP(e,n,t){if(Gt.isString(e))try{return(n||JSON.parse)(e),Gt.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const Qf={transitional:E2,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,o=Gt.isObject(n);if(o&&Gt.isHTMLForm(n)&&(n=new FormData(n)),Gt.isFormData(n))return i?JSON.stringify(A2(n)):n;if(Gt.isArrayBuffer(n)||Gt.isBuffer(n)||Gt.isStream(n)||Gt.isFile(n)||Gt.isBlob(n)||Gt.isReadableStream(n))return n;if(Gt.isArrayBufferView(n))return n.buffer;if(Gt.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let h;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return _P(n,this.formSerializer).toString();if((h=Gt.isFileList(n))||r.indexOf("multipart/form-data")>-1){const g=this.env&&this.env.FormData;return Ip(h?{"files[]":n}:n,g&&new g,this.formSerializer)}}return o||i?(t.setContentType("application/json",!1),xP(n)):n}],transformResponse:[function(n){const t=this.transitional||Qf.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(Gt.isResponse(n)||Gt.isReadableStream(n))return n;if(n&&Gt.isString(n)&&(r&&!this.responseType||i)){const l=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(n)}catch(h){if(l)throw h.name==="SyntaxError"?Nr.from(h,Nr.ERR_BAD_RESPONSE,this,null,this.response):h}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:la.classes.FormData,Blob:la.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Gt.forEach(["delete","get","head","post","put","patch"],e=>{Qf.headers[e]={}});const LP=Gt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),SP=e=>{const n={};let t,r,i;return e&&e.split(`
`).forEach(function(l){i=l.indexOf(":"),t=l.substring(0,i).trim().toLowerCase(),r=l.substring(i+1).trim(),!(!t||n[t]&&LP[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},Tv=Symbol("internals");function hf(e){return e&&String(e).trim().toLowerCase()}function Ud(e){return e===!1||e==null?e:Gt.isArray(e)?e.map(Ud):String(e)}function CP(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const PP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function R0(e,n,t,r,i){if(Gt.isFunction(r))return r.call(this,n,t);if(i&&(n=t),!!Gt.isString(n)){if(Gt.isString(r))return n.indexOf(r)!==-1;if(Gt.isRegExp(r))return r.test(n)}}function EP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function AP(e,n){const t=Gt.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(i,o,l){return this[r].call(this,n,i,o,l)},configurable:!0})})}let Va=class{constructor(n){n&&this.set(n)}set(n,t,r){const i=this;function o(h,g,v){const _=hf(g);if(!_)throw new Error("header name must be a non-empty string");const x=Gt.findKey(i,_);(!x||i[x]===void 0||v===!0||v===void 0&&i[x]!==!1)&&(i[x||g]=Ud(h))}const l=(h,g)=>Gt.forEach(h,(v,_)=>o(v,_,g));if(Gt.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Gt.isString(n)&&(n=n.trim())&&!PP(n))l(SP(n),t);else if(Gt.isHeaders(n))for(const[h,g]of n.entries())o(g,h,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=hf(n),n){const r=Gt.findKey(this,n);if(r){const i=this[r];if(!t)return i;if(t===!0)return CP(i);if(Gt.isFunction(t))return t.call(this,i,r);if(Gt.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=hf(n),n){const r=Gt.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||R0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let i=!1;function o(l){if(l=hf(l),l){const h=Gt.findKey(r,l);h&&(!t||R0(r,r[h],h,t))&&(delete r[h],i=!0)}}return Gt.isArray(n)?n.forEach(o):o(n),i}clear(n){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const o=t[r];(!n||R0(this,this[o],o,n,!0))&&(delete this[o],i=!0)}return i}normalize(n){const t=this,r={};return Gt.forEach(this,(i,o)=>{const l=Gt.findKey(r,o);if(l){t[l]=Ud(i),delete t[o];return}const h=n?EP(o):String(o).trim();h!==o&&delete t[o],t[h]=Ud(i),r[h]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Gt.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=n&&Gt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(i=>r.set(i)),r}static accessor(n){const r=(this[Tv]=this[Tv]={accessors:{}}).accessors,i=this.prototype;function o(l){const h=hf(l);r[h]||(AP(i,l),r[h]=!0)}return Gt.isArray(n)?n.forEach(o):o(n),this}};Va.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Gt.reduceDescriptors(Va.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});Gt.freezeMethods(Va);function D0(e,n){const t=this||Qf,r=n||t,i=Va.from(r.headers);let o=r.data;return Gt.forEach(e,function(h){o=h.call(t,o,i.normalize(),n?n.status:void 0)}),i.normalize(),o}function M2(e){return!!(e&&e.__CANCEL__)}function Yh(e,n,t){Nr.call(this,e??"canceled",Nr.ERR_CANCELED,n,t),this.name="CanceledError"}Gt.inherits(Yh,Nr,{__CANCEL__:!0});function k2(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Nr("Request failed with status code "+t.status,[Nr.ERR_BAD_REQUEST,Nr.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function MP(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function kP(e,n){e=e||10;const t=new Array(e),r=new Array(e);let i=0,o=0,l;return n=n!==void 0?n:1e3,function(g){const v=Date.now(),_=r[o];l||(l=v),t[i]=g,r[i]=v;let x=o,E=0;for(;x!==i;)E+=t[x++],x=x%e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),v-l<n)return;const b=_&&v-_;return b?Math.round(E*1e3/b):void 0}}function TP(e,n){let t=0,r=1e3/n,i,o;const l=(v,_=Date.now())=>{t=_,i=null,o&&(clearTimeout(o),o=null),e.apply(null,v)};return[(...v)=>{const _=Date.now(),x=_-t;x>=r?l(v,_):(i=v,o||(o=setTimeout(()=>{o=null,l(i)},r-x)))},()=>i&&l(i)]}const ap=(e,n,t=3)=>{let r=0;const i=kP(50,250);return TP(o=>{const l=o.loaded,h=o.lengthComputable?o.total:void 0,g=l-r,v=i(g),_=l<=h;r=l;const x={loaded:l,total:h,progress:h?l/h:void 0,bytes:g,rate:v||void 0,estimated:v&&h&&_?(h-l)/v:void 0,event:o,lengthComputable:h!=null,[n?"download":"upload"]:!0};e(x)},t)},Bv=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},Nv=e=>(...n)=>Gt.asap(()=>e(...n)),BP=la.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,la.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(la.origin),la.navigator&&/(msie|trident)/i.test(la.navigator.userAgent)):()=>!0,NP=la.hasStandardBrowserEnv?{write(e,n,t,r,i,o){const l=[e+"="+encodeURIComponent(n)];Gt.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Gt.isString(r)&&l.push("path="+r),Gt.isString(i)&&l.push("domain="+i),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function RP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function DP(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function T2(e,n,t){let r=!RP(n);return e&&(r||t==!1)?DP(e,n):n}const Rv=e=>e instanceof Va?{...e}:e;function ah(e,n){n=n||{};const t={};function r(v,_,x,E){return Gt.isPlainObject(v)&&Gt.isPlainObject(_)?Gt.merge.call({caseless:E},v,_):Gt.isPlainObject(_)?Gt.merge({},_):Gt.isArray(_)?_.slice():_}function i(v,_,x,E){if(Gt.isUndefined(_)){if(!Gt.isUndefined(v))return r(void 0,v,x,E)}else return r(v,_,x,E)}function o(v,_){if(!Gt.isUndefined(_))return r(void 0,_)}function l(v,_){if(Gt.isUndefined(_)){if(!Gt.isUndefined(v))return r(void 0,v)}else return r(void 0,_)}function h(v,_,x){if(x in n)return r(v,_);if(x in e)return r(void 0,v)}const g={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:h,headers:(v,_,x)=>i(Rv(v),Rv(_),x,!0)};return Gt.forEach(Object.keys(Object.assign({},e,n)),function(_){const x=g[_]||i,E=x(e[_],n[_],_);Gt.isUndefined(E)&&x!==h||(t[_]=E)}),t}const B2=e=>{const n=ah({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:l,auth:h}=n;n.headers=l=Va.from(l),n.url=P2(T2(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),h&&l.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let g;if(Gt.isFormData(t)){if(la.hasStandardBrowserEnv||la.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((g=l.getContentType())!==!1){const[v,..._]=g?g.split(";").map(x=>x.trim()).filter(Boolean):[];l.setContentType([v||"multipart/form-data",..._].join("; "))}}if(la.hasStandardBrowserEnv&&(r&&Gt.isFunction(r)&&(r=r(n)),r||r!==!1&&BP(n.url))){const v=i&&o&&NP.read(o);v&&l.set(i,v)}return n},OP=typeof XMLHttpRequest<"u",IP=OP&&function(e){return new Promise(function(t,r){const i=B2(e);let o=i.data;const l=Va.from(i.headers).normalize();let{responseType:h,onUploadProgress:g,onDownloadProgress:v}=i,_,x,E,b,R;function $(){b&&b(),R&&R(),i.cancelToken&&i.cancelToken.unsubscribe(_),i.signal&&i.signal.removeEventListener("abort",_)}let Q=new XMLHttpRequest;Q.open(i.method.toUpperCase(),i.url,!0),Q.timeout=i.timeout;function I(){if(!Q)return;const ge=Va.from("getAllResponseHeaders"in Q&&Q.getAllResponseHeaders()),De={data:!h||h==="text"||h==="json"?Q.responseText:Q.response,status:Q.status,statusText:Q.statusText,headers:ge,config:e,request:Q};k2(function(Ve){t(Ve),$()},function(Ve){r(Ve),$()},De),Q=null}"onloadend"in Q?Q.onloadend=I:Q.onreadystatechange=function(){!Q||Q.readyState!==4||Q.status===0&&!(Q.responseURL&&Q.responseURL.indexOf("file:")===0)||setTimeout(I)},Q.onabort=function(){Q&&(r(new Nr("Request aborted",Nr.ECONNABORTED,e,Q)),Q=null)},Q.onerror=function(){r(new Nr("Network Error",Nr.ERR_NETWORK,e,Q)),Q=null},Q.ontimeout=function(){let Se=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const De=i.transitional||E2;i.timeoutErrorMessage&&(Se=i.timeoutErrorMessage),r(new Nr(Se,De.clarifyTimeoutError?Nr.ETIMEDOUT:Nr.ECONNABORTED,e,Q)),Q=null},o===void 0&&l.setContentType(null),"setRequestHeader"in Q&&Gt.forEach(l.toJSON(),function(Se,De){Q.setRequestHeader(De,Se)}),Gt.isUndefined(i.withCredentials)||(Q.withCredentials=!!i.withCredentials),h&&h!=="json"&&(Q.responseType=i.responseType),v&&([E,R]=ap(v,!0),Q.addEventListener("progress",E)),g&&Q.upload&&([x,b]=ap(g),Q.upload.addEventListener("progress",x),Q.upload.addEventListener("loadend",b)),(i.cancelToken||i.signal)&&(_=ge=>{Q&&(r(!ge||ge.type?new Yh(null,e,Q):ge),Q.abort(),Q=null)},i.cancelToken&&i.cancelToken.subscribe(_),i.signal&&(i.signal.aborted?_():i.signal.addEventListener("abort",_)));const W=MP(i.url);if(W&&la.protocols.indexOf(W)===-1){r(new Nr("Unsupported protocol "+W+":",Nr.ERR_BAD_REQUEST,e));return}Q.send(o||null)})},FP=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,i;const o=function(v){if(!i){i=!0,h();const _=v instanceof Error?v:this.reason;r.abort(_ instanceof Nr?_:new Yh(_ instanceof Error?_.message:_))}};let l=n&&setTimeout(()=>{l=null,o(new Nr(`timeout ${n} of ms exceeded`,Nr.ETIMEDOUT))},n);const h=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(v=>{v.unsubscribe?v.unsubscribe(o):v.removeEventListener("abort",o)}),e=null)};e.forEach(v=>v.addEventListener("abort",o));const{signal:g}=r;return g.unsubscribe=()=>Gt.asap(h),g}},zP=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,i;for(;r<t;)i=r+n,yield e.slice(r,i),r=i},jP=async function*(e,n){for await(const t of UP(e))yield*zP(t,n)},UP=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},Dv=(e,n,t,r)=>{const i=jP(e,n);let o=0,l,h=g=>{l||(l=!0,r&&r(g))};return new ReadableStream({async pull(g){try{const{done:v,value:_}=await i.next();if(v){h(),g.close();return}let x=_.byteLength;if(t){let E=o+=x;t(E)}g.enqueue(new Uint8Array(_))}catch(v){throw h(v),v}},cancel(g){return h(g),i.return()}},{highWaterMark:2})},Fp=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",N2=Fp&&typeof ReadableStream=="function",$P=Fp&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),R2=(e,...n)=>{try{return!!e(...n)}catch{return!1}},qP=N2&&R2(()=>{let e=!1;const n=new Request(la.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),Ov=64*1024,yg=N2&&R2(()=>Gt.isReadableStream(new Response("").body)),lp={stream:yg&&(e=>e.body)};Fp&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!lp[n]&&(lp[n]=Gt.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Nr(`Response type '${n}' is not supported`,Nr.ERR_NOT_SUPPORT,r)})})})(new Response);const VP=async e=>{if(e==null)return 0;if(Gt.isBlob(e))return e.size;if(Gt.isSpecCompliantForm(e))return(await new Request(la.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Gt.isArrayBufferView(e)||Gt.isArrayBuffer(e))return e.byteLength;if(Gt.isURLSearchParams(e)&&(e=e+""),Gt.isString(e))return(await $P(e)).byteLength},GP=async(e,n)=>{const t=Gt.toFiniteNumber(e.getContentLength());return t??VP(n)},HP=Fp&&(async e=>{let{url:n,method:t,data:r,signal:i,cancelToken:o,timeout:l,onDownloadProgress:h,onUploadProgress:g,responseType:v,headers:_,withCredentials:x="same-origin",fetchOptions:E}=B2(e);v=v?(v+"").toLowerCase():"text";let b=FP([i,o&&o.toAbortSignal()],l),R;const $=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let Q;try{if(g&&qP&&t!=="get"&&t!=="head"&&(Q=await GP(_,r))!==0){let De=new Request(n,{method:"POST",body:r,duplex:"half"}),Ye;if(Gt.isFormData(r)&&(Ye=De.headers.get("content-type"))&&_.setContentType(Ye),De.body){const[Ve,O]=Bv(Q,ap(Nv(g)));r=Dv(De.body,Ov,Ve,O)}}Gt.isString(x)||(x=x?"include":"omit");const I="credentials"in Request.prototype;R=new Request(n,{...E,signal:b,method:t.toUpperCase(),headers:_.normalize().toJSON(),body:r,duplex:"half",credentials:I?x:void 0});let W=await fetch(R);const ge=yg&&(v==="stream"||v==="response");if(yg&&(h||ge&&$)){const De={};["status","statusText","headers"].forEach(K=>{De[K]=W[K]});const Ye=Gt.toFiniteNumber(W.headers.get("content-length")),[Ve,O]=h&&Bv(Ye,ap(Nv(h),!0))||[];W=new Response(Dv(W.body,Ov,Ve,()=>{O&&O(),$&&$()}),De)}v=v||"text";let Se=await lp[Gt.findKey(lp,v)||"text"](W,e);return!ge&&$&&$(),await new Promise((De,Ye)=>{k2(De,Ye,{data:Se,headers:Va.from(W.headers),status:W.status,statusText:W.statusText,config:e,request:R})})}catch(I){throw $&&$(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new Nr("Network Error",Nr.ERR_NETWORK,e,R),{cause:I.cause||I}):Nr.from(I,I&&I.code,e,R)}}),_g={http:aP,xhr:IP,fetch:HP};Gt.forEach(_g,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Iv=e=>`- ${e}`,WP=e=>Gt.isFunction(e)||e===null||e===!1,D2={getAdapter:e=>{e=Gt.isArray(e)?e:[e];const{length:n}=e;let t,r;const i={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!WP(t)&&(r=_g[(l=String(t)).toLowerCase()],r===void 0))throw new Nr(`Unknown adapter '${l}'`);if(r)break;i[l||"#"+o]=r}if(!r){const o=Object.entries(i).map(([h,g])=>`adapter ${h} `+(g===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(Iv).join(`
`):" "+Iv(o[0]):"as no adapter specified";throw new Nr("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:_g};function O0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Yh(null,e)}function Fv(e){return O0(e),e.headers=Va.from(e.headers),e.data=D0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),D2.getAdapter(e.adapter||Qf.adapter)(e).then(function(r){return O0(e),r.data=D0.call(e,e.transformResponse,r),r.headers=Va.from(r.headers),r},function(r){return M2(r)||(O0(e),r&&r.response&&(r.response.data=D0.call(e,e.transformResponse,r.response),r.response.headers=Va.from(r.response.headers))),Promise.reject(r)})}const O2="1.8.4",zp={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{zp[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const zv={};zp.transitional=function(n,t,r){function i(o,l){return"[Axios v"+O2+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,h)=>{if(n===!1)throw new Nr(i(l," has been removed"+(t?" in "+t:"")),Nr.ERR_DEPRECATED);return t&&!zv[l]&&(zv[l]=!0,console.warn(i(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,h):!0}};zp.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function ZP(e,n,t){if(typeof e!="object")throw new Nr("options must be an object",Nr.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],l=n[o];if(l){const h=e[o],g=h===void 0||l(h,o,e);if(g!==!0)throw new Nr("option "+o+" must be "+g,Nr.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Nr("Unknown option "+o,Nr.ERR_BAD_OPTION)}}const $d={assertOptions:ZP,validators:zp},du=$d.validators;let rh=class{constructor(n){this.defaults=n,this.interceptors={request:new kv,response:new kv}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=ah(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:o}=t;r!==void 0&&$d.assertOptions(r,{silentJSONParsing:du.transitional(du.boolean),forcedJSONParsing:du.transitional(du.boolean),clarifyTimeoutError:du.transitional(du.boolean)},!1),i!=null&&(Gt.isFunction(i)?t.paramsSerializer={serialize:i}:$d.assertOptions(i,{encode:du.function,serialize:du.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),$d.assertOptions(t,{baseUrl:du.spelling("baseURL"),withXsrfToken:du.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Gt.merge(o.common,o[t.method]);o&&Gt.forEach(["delete","get","head","post","put","patch","common"],R=>{delete o[R]}),t.headers=Va.concat(l,o);const h=[];let g=!0;this.interceptors.request.forEach(function($){typeof $.runWhen=="function"&&$.runWhen(t)===!1||(g=g&&$.synchronous,h.unshift($.fulfilled,$.rejected))});const v=[];this.interceptors.response.forEach(function($){v.push($.fulfilled,$.rejected)});let _,x=0,E;if(!g){const R=[Fv.bind(this),void 0];for(R.unshift.apply(R,h),R.push.apply(R,v),E=R.length,_=Promise.resolve(t);x<E;)_=_.then(R[x++],R[x++]);return _}E=h.length;let b=t;for(x=0;x<E;){const R=h[x++],$=h[x++];try{b=R(b)}catch(Q){$.call(this,Q);break}}try{_=Fv.call(this,b)}catch(R){return Promise.reject(R)}for(x=0,E=v.length;x<E;)_=_.then(v[x++],v[x++]);return _}getUri(n){n=ah(this.defaults,n);const t=T2(n.baseURL,n.url,n.allowAbsoluteUrls);return P2(t,n.params,n.paramsSerializer)}};Gt.forEach(["delete","get","head","options"],function(n){rh.prototype[n]=function(t,r){return this.request(ah(r||{},{method:n,url:t,data:(r||{}).data}))}});Gt.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,h){return this.request(ah(h||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}rh.prototype[n]=t(),rh.prototype[n+"Form"]=t(!0)});let KP=class I2{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const l=new Promise(h=>{r.subscribe(h),o=h}).then(i);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,h){r.reason||(r.reason=new Yh(o,l,h),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new I2(function(i){n=i}),cancel:n}}};function JP(e){return function(t){return e.apply(null,t)}}function YP(e){return Gt.isObject(e)&&e.isAxiosError===!0}const bg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bg).forEach(([e,n])=>{bg[n]=e});function F2(e){const n=new rh(e),t=g2(rh.prototype.request,n);return Gt.extend(t,rh.prototype,n,{allOwnKeys:!0}),Gt.extend(t,n,null,{allOwnKeys:!0}),t.create=function(i){return F2(ah(e,i))},t}const Ys=F2(Qf);Ys.Axios=rh;Ys.CanceledError=Yh;Ys.CancelToken=KP;Ys.isCancel=M2;Ys.VERSION=O2;Ys.toFormData=Ip;Ys.AxiosError=Nr;Ys.Cancel=Ys.CanceledError;Ys.all=function(n){return Promise.all(n)};Ys.spread=JP;Ys.isAxiosError=YP;Ys.mergeConfig=ah;Ys.AxiosHeaders=Va;Ys.formToJSON=e=>A2(Gt.isHTMLForm(e)?new FormData(e):e);Ys.getAdapter=D2.getAdapter;Ys.HttpStatusCode=bg;Ys.default=Ys;const{Axios:GI,AxiosError:HI,CanceledError:WI,isCancel:ZI,CancelToken:KI,VERSION:JI,all:YI,Cancel:XI,isAxiosError:QI,spread:eF,toFormData:tF,AxiosHeaders:nF,HttpStatusCode:rF,formToJSON:iF,getAdapter:sF,mergeConfig:oF}=Ys,hn=Au({measures:[],longTasks:[],memorySnapshots:[],framesPerSecond:0,lastFpsUpdate:0,frameCount:0,isRecording:!1,isEnabled:!1,startTime:0,currentOperation:null,operationStack:[],operationHistory:[]});let xc=null,Xc=null;const XP=1e3;function jp(){if(hn.isEnabled){hn.isRecording=!0,hn.startTime=performance.now(),hn.frameCount=0,hn.lastFpsUpdate=performance.now();try{window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&(xc=new PerformanceObserver(e=>{e.getEntries().forEach(t=>{hn.longTasks.push({duration:t.duration,startTime:t.startTime,name:t.name,component:Xl()})})}),xc.observe({entryTypes:["longtask"]}))}catch(e){console.warn("PerformanceObserver pour longues tâches non supporté",e)}QP(),vm()}}function up(){hn.isRecording=!1,xc&&(xc.disconnect(),xc=null),$2()}function wg(){xc&&(xc.disconnect(),xc=null),$2(),hn.measures=[],hn.longTasks=[],hn.memorySnapshots=[],hn.operationHistory=[],hn.frameCount=0,hn.framesPerSecond=0,hn.lastFpsUpdate=0,hn.isEnabled&&jp()}function z2(e,n,t){if(!hn.isEnabled||!hn.isRecording)return()=>{};const r=performance.now(),i=hn.currentOperation;return hn.currentOperation=e,hn.operationStack.push(e),()=>{const o=performance.now()-r;hn.operationStack.pop(),hn.currentOperation=hn.operationStack[hn.operationStack.length-1]||null,hn.measures.push({name:e,startTime:r,duration:o,component:n||Xl(),info:t,parentOperation:i||void 0}),o>10&&hn.operationHistory.push({operation:e,component:n||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}async function j2(e,n,t,r){if(!hn.isEnabled||!hn.isRecording)return n();const i=performance.now(),o=hn.currentOperation;hn.currentOperation=e,hn.operationStack.push(e);try{return await n()}finally{const l=performance.now()-i;hn.operationStack.pop(),hn.currentOperation=hn.operationStack[hn.operationStack.length-1]||null,hn.measures.push({name:e,startTime:i,duration:l,component:t||Xl(),info:r,parentOperation:o||void 0}),l>10&&hn.operationHistory.push({operation:e,component:t||Xl()||"unknown",durationMs:l,timestamp:Date.now()})}}function U2(e,n,t,r){if(!hn.isEnabled||!hn.isRecording)return n();const i=performance.now(),o=hn.currentOperation;hn.currentOperation=e,hn.operationStack.push(e);try{return n()}finally{const l=performance.now()-i;hn.operationStack.pop(),hn.currentOperation=hn.operationStack[hn.operationStack.length-1]||null,hn.measures.push({name:e,startTime:i,duration:l,component:t||Xl(),info:r,parentOperation:o||void 0}),l>10&&hn.operationHistory.push({operation:e,component:t||Xl()||"unknown",durationMs:l,timestamp:Date.now()})}}function vm(){!hn.isEnabled||!hn.isRecording||(performance.memory?hn.memorySnapshots.push({jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize,timestamp:performance.now()}):hn.memorySnapshots.push({timestamp:performance.now()}))}function QP(){Xc!==null&&cancelAnimationFrame(Xc),hn.frameCount=0,hn.lastFpsUpdate=performance.now();function e(){hn.frameCount++;const n=performance.now();n-hn.lastFpsUpdate>=XP&&(hn.framesPerSecond=Math.round(hn.frameCount*1e3/(n-hn.lastFpsUpdate)),hn.frameCount=0,hn.lastFpsUpdate=n),hn.isRecording&&(Xc=requestAnimationFrame(e))}Xc=requestAnimationFrame(e)}function $2(){Xc!==null&&(cancelAnimationFrame(Xc),Xc=null)}function Xl(){return""}function xg(e){hn.isEnabled=e,e&&!hn.isRecording?jp():!e&&hn.isRecording&&up()}function q2(e,n,t){return(...r)=>{if(!hn.isEnabled||!hn.isRecording)return e(...r);const i=performance.now();try{return e(...r)}finally{const o=performance.now()-i;hn.measures.push({name:n,startTime:i,duration:o,component:t||Xl(),info:{args:r}}),o>10&&hn.operationHistory.push({operation:n,component:t||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}}function V2(e,n,t){return async(...r)=>{if(!hn.isEnabled||!hn.isRecording)return await e(...r);const i=performance.now();try{return await e(...r)}finally{const o=performance.now()-i;hn.measures.push({name:n,startTime:i,duration:o,component:t||Xl(),info:{args:r}}),o>10&&hn.operationHistory.push({operation:n,component:t||Xl()||"unknown",durationMs:o,timestamp:Date.now()})}}}function eE(e,n){const t=hn.measures.filter(l=>l.startTime>=e&&l.startTime+l.duration<=n),r=new Map,i=[];t.forEach(l=>{l.parentOperation?(r.has(l.parentOperation)||r.set(l.parentOperation,[]),r.get(l.parentOperation).push(l)):i.push(l)});function o(l){const h=r.get(l.name)||[];return{operation:l.name,duration:l.duration,component:l.component,children:h.sort((g,v)=>v.duration-g.duration).map(g=>o(g))}}return i.sort((l,h)=>h.duration-l.duration).map(l=>o(l))}function Lg(e,n){const t=e||hn.startTime,r=n||performance.now(),i=eE(t,r),o=r-t,l=new Map;function h(v){const _=l.get(v.operation)||{duration:0,component:v.component};_.duration+=v.duration,l.set(v.operation,_),v.children.forEach(x=>h(x))}i.forEach(v=>h(v));const g=Array.from(l.entries()).map(([v,{duration:_,component:x}])=>({operation:v,duration:_,component:x,impact:_/o*100})).sort((v,_)=>_.impact-v.impact).slice(0,10);return{criticalPaths:i,totalTime:o,bottlenecks:g}}function Xh(){const e=un(!1);Bl(()=>{try{const r=new URL(window.location.href).searchParams.get("perf")==="true";e.value=r,xg(r),wg()}catch(t){console.warn("Erreur lors de la vérification du paramètre perf:",t),e.value=!1,xg(!1)}}),Kh(()=>{hn.isRecording&&up()});const n=(t,r)=>{if(!hn.isEnabled||!hn.isRecording)return null;const i=hn.measures.find(v=>v.name===t&&v.startTime===r);if(!i)return null;const o=i.startTime+i.duration,l=hn.measures.filter(v=>v.startTime>=i.startTime&&v.startTime<=o&&v!==i),h=hn.longTasks.filter(v=>v.startTime>=i.startTime&&v.startTime<=o),g=hn.memorySnapshots.filter(v=>v.timestamp>=i.startTime&&v.timestamp<=o);return{operation:{name:i.name,component:i.component,startTime:i.startTime,duration:i.duration,info:i.info},context:{relatedOperations:l.map(v=>({name:v.name,component:v.component,startTime:v.startTime-i.startTime,duration:v.duration,info:v.info})),longTasks:h.map(v=>({duration:v.duration,startTime:v.startTime-i.startTime,name:v.name,component:v.component})),memorySnapshots:g.map(v=>({...v,timestamp:v.timestamp-i.startTime}))},summary:{totalRelatedOperations:l.length,totalLongTasks:h.length,maxLongTaskDuration:Math.max(...h.map(v=>v.duration),0),memoryDelta:g.length>1?(g[g.length-1].usedJSHeapSize||0)-(g[0].usedJSHeapSize||0):0}}};return{isEnabled:mu(un(hn.isEnabled)),isQueryParamEnabled:mu(e),isRecording:mu(un(hn.isRecording)),measures:mu(un(hn.measures)),longTasks:mu(un(hn.longTasks)),memorySnapshots:mu(un(hn.memorySnapshots)),framesPerSecond:mu(un(hn.framesPerSecond)),operationHistory:mu(un(hn.operationHistory)),startRecording:jp,stopRecording:up,clearRecording:wg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:V2,getOperationDetails:n,getSlowOperations:()=>!hn.isEnabled||!hn.isRecording?[]:[...hn.measures].sort((t,r)=>r.duration-t.duration).slice(0,10),getLongTasks:()=>!hn.isEnabled||!hn.isRecording?[]:[...hn.longTasks].sort((t,r)=>r.duration-t.duration),getPerformanceReport:()=>{if(!hn.isEnabled||!hn.isRecording)return null;const t=Lg();return{totalMeasures:hn.measures.length,totalLongTasks:hn.longTasks.length,slowestOperations:[...hn.measures].sort((r,i)=>i.duration-r.duration).slice(0,10),averageFps:hn.framesPerSecond,memoryUsage:hn.memorySnapshots.length>0?hn.memorySnapshots[hn.memorySnapshots.length-1]:null,operationsByComponent:tE(hn.measures),criticalPaths:t.criticalPaths,bottlenecks:t.bottlenecks,recordingDuration:hn.isRecording?performance.now()-hn.startTime:null}},analyzeCriticalPaths:Lg}}function tE(e){if(!hn.isEnabled||!hn.isRecording)return{};const n={};return e.forEach(t=>{const r=t.component||"unknown";n[r]||(n[r]={totalTime:0,callCount:0,operations:{}}),n[r].totalTime+=t.duration,n[r].callCount++,n[r].operations[t.name]||(n[r].operations[t.name]={totalTime:0,callCount:0}),n[r].operations[t.name].totalTime+=t.duration,n[r].operations[t.name].callCount++}),n}const St={startRecording:jp,stopRecording:up,clearRecording:wg,startMeasure:z2,measure:U2,measureAsync:j2,captureMemorySnapshot:vm,createPerformanceTracker:q2,createAsyncPerformanceTracker:V2,setEnabled:xg,analyzeCriticalPaths:Lg},Xn=Ys.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),so=Xh();function G2(e){var r;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((r=t.pop())==null?void 0:r.split(";").shift())||null}Xn.interceptors.request.use(async e=>{const n=so.startMeasure("api_request_interceptor","ApiService");try{const t=G2("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("Request config:",{url:e.url,method:e.method,headers:e.headers,withCredentials:e.withCredentials}),e}finally{n()}},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Xn.interceptors.response.use(e=>e,async e=>{var r,i;const n=so.startMeasure("api_response_interceptor","ApiService"),t=e.config;try{if(((r=e.response)==null?void 0:r.status)===401&&!t._retry&&!((i=t.url)!=null&&i.includes("/token/refresh/"))){t._retry=!0;const o=Ga();try{await so.measureAsync("token_refresh",()=>o.refreshToken(),"ApiService");const l=G2("access_token");if(l)return t.headers.Authorization=`Bearer ${l}`,Xn(t)}catch(l){return await o.logout(),window.location.pathname!=="/login"&&(window.location.href="/login"),Promise.reject(l)}}return Promise.reject(e)}finally{n()}});function nE(e){var t;const n=[];if((t=e.response)!=null&&t.data){const r=e.response.data;typeof r=="object"&&!Array.isArray(r)?Object.entries(r).forEach(([i,o])=>{Array.isArray(o)?o.forEach(l=>{n.push({field:i,message:l})}):typeof o=="string"&&n.push({field:i,message:o})}):typeof r=="string"?n.push({field:"non_field_error",message:r}):r.detail&&n.push({field:"non_field_error",message:r.detail})}else e.message&&n.push({field:"non_field_error",message:`Erreur de connexion: ${e.message}`});return n.length===0&&n.push({field:"non_field_error",message:"Une erreur inconnue s'est produite"}),n}async function qd(e){console.log("[fetchUsersByHierarchy] Récupération des utilisateurs:",e);const n={role:e.role};e.entrepriseId&&(n.entreprise=e.entrepriseId),e.salarieId&&(n.salarie=e.salarieId),e.includeDetails&&(n.include_plans=!0),e.search&&(n.search=e.search),console.log("[fetchUsersByHierarchy] Filtres appliqués:",n);try{const t=await $a.getUsers(n);return console.log(`[fetchUsersByHierarchy] Résultat (${t.data.length} utilisateurs):`,t.data),t.data}catch(t){throw console.error("[fetchUsersByHierarchy] Erreur lors de la récupération des utilisateurs:",t),t}}const $a={async getUsers(e={}){const n=so.startMeasure("get_users","UserService");try{return await so.measureAsync("get_users_request",()=>Xn.get("/users/",{params:e}),"UserService")}finally{n()}},async getUser(e){return await Xn.get(`/users/${e}/`)},async createUser(e){return await Xn.post("/users/",e)},async updateUser(e,n){return await Xn.patch(`/users/${e}/`,n)},async deleteUser(e){return await Xn.delete(`/users/${e}/`)},async getEntreprises(){return await Xn.get("/users/",{params:{role:"ENTREPRISE"}})},async getSalaries(e){const n={role:"SALARIE"};return e&&(n.entreprise=e),await Xn.get("/users/",{params:n})},async getSalarieVisiteurs(e){return await Xn.get("/users/",{params:{role:"VISITEUR",salarie:e}})},async getEntrepriseVisiteurs(e){return await Xn.get("/users/",{params:{role:"VISITEUR",entreprise:e}})},async getUsersByHierarchy(e){const n=so.startMeasure("get_users_hierarchy","UserService");try{const t=so.measure("prepare_hierarchy_filters",()=>{const r={role:e.role};return e.entrepriseId&&(r.entreprise=e.entrepriseId),e.salarieId&&(r.salarie=e.salarieId),e.includeDetails&&(r.include_plans=!0),e.search&&(r.search=e.search),r},"UserService");return await so.measureAsync("get_users_hierarchy_request",()=>Xn.get("/users/",{params:t}),"UserService")}finally{n()}},async getEntrepriseSalaries(e){return await Xn.get("/users/",{params:{role:"SALARIE",entreprise:e}})},async getVisiteurs(e,n){const t={role:"VISITEUR"};return e&&(t.salarie=e),n&&(t.entreprise=n),await Xn.get("/users/",{params:t})},async assignEntrepriseToSalarie(e,n){return await Xn.patch(`/users/${e}/`,{entreprise:n})},async assignSalarieToVisiteur(e,n){return await Xn.patch(`/users/${e}/`,{salarie:n})},formatLogoFileName(e){return so.measure("format_logo_filename",()=>{var i;const n=new Date().getTime(),t=((i=e.name.split(".").pop())==null?void 0:i.toLowerCase())||"";return`${e.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}-${n}.${t}`},"UserService")},async uploadLogo(e){const n=so.startMeasure("upload_logo","UserService");try{const t=new FormData,r=this.formatLogoFileName(e),i=new File([e],r,{type:e.type});return t.append("logo",i),await so.measureAsync("upload_logo_request",()=>Xn.post("/users/upload_logo/",t,{headers:{"Content-Type":"multipart/form-data"}}),"UserService")}finally{n()}}},Ed={async getPlans(){const e=so.startMeasure("get_plans","IrrigationService");try{return await so.measureAsync("get_plans_request",()=>Xn.get("/plans/"),"IrrigationService")}finally{e()}},async createPlan(e){const n=so.startMeasure("create_plan","IrrigationService");try{const t=so.measure("format_plan_data",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationService");return await so.measureAsync("create_plan_request",()=>Xn.post("/plans/",t),"IrrigationService")}finally{n()}},async updatePlan(e,n){const t=so.startMeasure("update_plan","IrrigationService");try{return await so.measureAsync("update_plan_request",()=>Xn.put(`/plans/${e}/`,n),"IrrigationService")}finally{t()}},async deletePlan(e){const n=so.startMeasure("delete_plan","IrrigationService");try{return await so.measureAsync("delete_plan_request",()=>Xn.delete(`/plans/${e}/`),"IrrigationService")}finally{n()}},async getVisiteurPlans(e){return await Xn.get("/plans/",{params:{visiteur:e}})},async createPlanForVisiteur(e){return await Xn.post("/plans/",e)},async getEntreprisePlans(e){return await Xn.get("/plans/",{params:{entreprise:e}})},async getSalariePlans(e){return await Xn.get("/plans/",{params:{salarie:e}})},async createPlanForSalarie(e,n){const t={...e,salarie:n};return await Xn.post("/plans/",t)},async createPlanForEntreprise(e,n){const t={...e,entreprise:n};return await Xn.post("/plans/",t)}};Xn.defaults.baseURL="/api";Xn.defaults.headers.common["Content-Type"]="application/json";Xn.defaults.withCredentials=!0;function Gf(e){var r;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2&&((r=t.pop())==null?void 0:r.split(";").shift())||null}Xn.interceptors.request.use(e=>{const n=Gf("access_token");return n&&(e.headers.Authorization=`Bearer ${n}`),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Xn.interceptors.response.use(e=>e,async e=>{var r,i;const n=Ga(),t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry&&!((i=t.url)!=null&&i.includes("/token/refresh/"))){t._retry=!0;try{if(!Gf("access_token"))throw new Error("No token available");await n.refreshToken();const l=Gf("access_token");if(l)return t.headers.Authorization=`Bearer ${l}`,Xn(t)}catch(o){console.error("Token refresh failed:",o),await n.logout(),window.location.pathname!=="/login"&&(window.location.href="/login")}}return Promise.reject(e)});function rE(e,n,t=1){const r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${n};${i};path=/;secure;samesite=Strict`}function al(e){if(!e)return"-";const n=e.first_name||"",t=e.last_name?e.last_name.toUpperCase():"",r=`${n} ${t}`.trim(),i=e.company_name||e.role||"";return!r&&!i?"-":r?i?`${r} (${i})`:r:`(${i})`}function iE(e="",n=""){return`${(e==null?void 0:e.charAt(0))||""}${(n==null?void 0:n.charAt(0))||""}`.toUpperCase()}const sE={ADMIN:"Administrateur",ENTREPRISE:"Entreprise",SALARIE:"Salarie",VISITEUR:"Visiteur"};function oE(e){return sE[e]||e}function aE(){return"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"}function lE(e){return e?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}async function uE({role:e,entrepriseId:n,salarieId:t,includeDetails:r=!1}){const i={role:e};return n&&(i.entreprise=n),t&&(i.salarie=t),r&&(i.include_plans=!0),(await $a.getUsers(i)).data}const Ga=Np("auth",{state:()=>({user:null,isAuthenticated:!1,mustChangePassword:!1,initialized:!1,loading:!1,error:null,enterprises:[],employees:[],visitors:[]}),getters:{isAdmin:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="admin"},isEntreprise:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="entreprise"},isSalarie:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="salarie"},isVisiteur:e=>{var n;return((n=e.user)==null?void 0:n.user_type)==="visiteur"},currentUser:e=>e.user,hasEnterprise:e=>{var n;return!!((n=e.user)!=null&&n.enterprise_id)},hasEmployee:e=>{var n;return!!((n=e.user)!=null&&n.employee_id)}},actions:{async initialize(e){if(!e){const t=await this.restoreSession();return this.initialized=!0,t}if(e.isAuthenticated&&e.user)return this.user=e.user,this.isAuthenticated=!0,this.mustChangePassword=e.user.must_change_password||!1,this.initialized=!0,!0;const n=await this.restoreSession();return this.initialized=!0,n},async restoreSession(){try{if(!Gf("access_token"))return this.isAuthenticated=!1,this.user=null,!1;const n=await Xn.post("/token/refresh/");return n.data.user?(this.user=n.data.user,this.isAuthenticated=!0,this.mustChangePassword=n.data.user.must_change_password||!1,!0):(await this.fetchUserProfile(),!0)}catch(e){return console.error("Failed to restore session:",e),this.isAuthenticated=!1,this.user=null,!1}},async login(e,n){var t,r,i;try{const o=await Xn.post("/token/",{username:e,password:n});if(!o.data.access)throw new Error("Token d'accès non reçu");document.cookie=`access_token=${o.data.access}; path=/; secure; samesite=Strict`;const l=await this.fetchUserProfile();return this.user=l,this.isAuthenticated=!0,!0}catch(o){throw this.isAuthenticated=!1,this.user=null,((t=o.response)==null?void 0:t.status)===401?new Error("Identifiants incorrects"):(i=(r=o.response)==null?void 0:r.data)!=null&&i.detail?new Error(o.response.data.detail):o}},async logout(){this.user=null,this.isAuthenticated=!1,this.mustChangePassword=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},async checkAuth(){try{return await this.fetchUserProfile(),!0}catch{return this.isAuthenticated=!1,this.user=null,!1}},async fetchUserProfile(){try{const e=await Xn.get("/users/me/");return this.user=e.data,this.isAuthenticated=!0,this.mustChangePassword=e.data.must_change_password||!1,e.data}catch(e){throw this.isAuthenticated=!1,this.user=null,e}},async changePassword(e,n){try{const t=await Xn.post("/users/change_password/",{old_password:e,password:n});return this.user={...this.user,must_change_password:!1},t.data}catch(t){throw console.error("Password change error:",t),t}},async refreshToken(){var e,n;try{if(!Gf("refresh_token"))throw new Error("No refresh token available");const r=await Xn.post("/token/refresh/",{},{withCredentials:!0,_retry:!0}),{access:i}=r.data;if(!i)throw new Error("No access token received");return rE("access_token",i,1),this.isAuthenticated=!0,i}catch(t){throw console.error("Error refreshing token:",{status:(e=t.response)==null?void 0:e.status,data:(n=t.response)==null?void 0:n.data}),this.isAuthenticated=!1,document.cookie="access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",t}},async fetchUsers(e={}){this.loading=!0;try{return(await $a.getUsers(e)).data}catch(n){throw this.error="Erreur lors de la récupération des utilisateurs",n}finally{this.loading=!1}},async fetchEnterprises(){this.loading=!0;try{const e=await $a.getUsers({role:"ENTREPRISE"});return this.enterprises=e.data,this.enterprises}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async fetchEnterpriseEmployees(e){this.loading=!0;try{const n=await $a.getUsers({role:"SALARIE",entreprise:e});return this.employees=n.data,this.employees}catch(n){throw this.error="Erreur lors de la récupération des salaries",n}finally{this.loading=!1}},async fetchEnterpriseVisitors(e){this.loading=!0;try{const n=await $a.getUsers({role:"VISITEUR",entreprise:e});return this.visitors=n.data,this.visitors}catch(n){throw this.error="Erreur lors de la récupération des visiteurs",n}finally{this.loading=!1}},async createUser(e){this.loading=!0;try{return(await $a.createUser(e)).data}catch(n){throw this.error="Erreur lors de la création de l'utilisateur",n}finally{this.loading=!1}},async updateUser(e,n){this.loading=!0;try{return(await $a.updateUser(e,n)).data}catch(t){throw this.error="Erreur lors de la mise à jour de l'utilisateur",t}finally{this.loading=!1}},async deleteUser(e){this.loading=!0;try{return await $a.deleteUser(e),!0}catch(n){throw this.error="Erreur lors de la suppression de l'utilisateur",n}finally{this.loading=!1}},async fetchEnterprisesLegacy(){this.loading=!0;try{const e=await Xn.get("/users/",{params:{role:"entreprise"}});this.enterprises=e.data}catch(e){throw this.error="Erreur lors de la récupération des entreprises",e}finally{this.loading=!1}},async setEnterprise(e,n){this.loading=!0;try{await Xn.patch(`/users/${e}/`,{enterprise:n}),this.user&&this.user.id===e&&(this.user.enterprise_id=n)}catch(t){throw this.error="Erreur lors de la mise à jour de l'entreprise",t}finally{this.loading=!1}},async updateUserRole(e,n){this.loading=!0;try{const t=await Xn.patch(`/users/${e}/`,{role:n});return this.user&&this.user.id===e&&(this.user.user_type=n),t.data}catch(t){throw this.error="Erreur lors de la mise à jour du rôle",t}finally{this.loading=!1}},async updateUserEmail(e){var n;this.loading=!0;try{const t=await Xn.patch(`/users/${(n=this.user)==null?void 0:n.id}/`,{email:e});return this.user&&(this.user.email=e),t.data}catch(t){throw this.error="Erreur lors de la mise à jour de l'email",t}finally{this.loading=!1}},async uploadLogo(e){this.loading=!0;try{const n=await $a.uploadLogo(e);return this.user&&n.data.logo&&(this.user.logo=n.data.logo),n.data}catch(n){throw this.error="Erreur lors du téléversement du logo",n}finally{this.loading=!1}},checkAccess(e){return this.user?e.includes(this.user.user_type):!1},async fetchUsersByRole(e){this.loading=!0;try{return await uE(e)}catch(n){throw console.error(`Error fetching ${e.role}:`,n),n}finally{this.loading=!1}},async fetchEntrepriseSalaries(e){this.loading=!0;try{return(await $a.getUsers({role:"SALARIE",entreprise:e})).data}catch(n){throw this.error="Erreur lors de la récupération des salaries",n}finally{this.loading=!1}},async fetchSalarieVisiteurs(e){this.loading=!0;try{return(await $a.getUsers({role:"VISITEUR",salarie:e})).data}catch(n){throw this.error="Erreur lors de la récupération des visiteurs",n}finally{this.loading=!1}}}});/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Bh=typeof document<"u";function H2(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function cE(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&H2(e.default)}const Ci=Object.assign;function I0(e,n){const t={};for(const r in n){const i=n[r];t[r]=Ql(i)?i.map(e):e(i)}return t}const Bf=()=>{},Ql=Array.isArray,W2=/#/g,hE=/&/g,fE=/\//g,dE=/=/g,pE=/\?/g,Z2=/\+/g,gE=/%5B/g,mE=/%5D/g,K2=/%5E/g,vE=/%60/g,J2=/%7B/g,yE=/%7C/g,Y2=/%7D/g,_E=/%20/g;function ym(e){return encodeURI(""+e).replace(yE,"|").replace(gE,"[").replace(mE,"]")}function bE(e){return ym(e).replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function Sg(e){return ym(e).replace(Z2,"%2B").replace(_E,"+").replace(W2,"%23").replace(hE,"%26").replace(vE,"`").replace(J2,"{").replace(Y2,"}").replace(K2,"^")}function wE(e){return Sg(e).replace(dE,"%3D")}function xE(e){return ym(e).replace(W2,"%23").replace(pE,"%3F")}function LE(e){return e==null?"":xE(e).replace(fE,"%2F")}function Hf(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const SE=/\/$/,CE=e=>e.replace(SE,"");function F0(e,n,t="/"){let r,i={},o="",l="";const h=n.indexOf("#");let g=n.indexOf("?");return h<g&&h>=0&&(g=-1),g>-1&&(r=n.slice(0,g),o=n.slice(g+1,h>-1?h:n.length),i=e(o)),h>-1&&(r=r||n.slice(0,h),l=n.slice(h,n.length)),r=ME(r??n,t),{fullPath:r+(o&&"?")+o+l,path:r,query:i,hash:Hf(l)}}function PE(e,n){const t=n.query?e(n.query):"";return n.path+(t&&"?")+t+(n.hash||"")}function jv(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function EE(e,n,t){const r=n.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&Gh(n.matched[r],t.matched[i])&&X2(n.params,t.params)&&e(n.query)===e(t.query)&&n.hash===t.hash}function Gh(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function X2(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(!AE(e[t],n[t]))return!1;return!0}function AE(e,n){return Ql(e)?Uv(e,n):Ql(n)?Uv(n,e):e===n}function Uv(e,n){return Ql(n)?e.length===n.length&&e.every((t,r)=>t===n[r]):e.length===1&&e[0]===n}function ME(e,n){if(e.startsWith("/"))return e;if(!e)return n;const t=n.split("/"),r=e.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let o=t.length-1,l,h;for(l=0;l<r.length;l++)if(h=r[l],h!==".")if(h==="..")o>1&&o--;else break;return t.slice(0,o).join("/")+"/"+r.slice(l).join("/")}const lc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Wf;(function(e){e.pop="pop",e.push="push"})(Wf||(Wf={}));var Nf;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Nf||(Nf={}));function kE(e){if(!e)if(Bh){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),CE(e)}const TE=/^[^#]+#/;function BE(e,n){return e.replace(TE,"#")+n}function NE(e,n){const t=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:n.behavior,left:r.left-t.left-(n.left||0),top:r.top-t.top-(n.top||0)}}const Up=()=>({left:window.scrollX,top:window.scrollY});function RE(e){let n;if("el"in e){const t=e.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;n=NE(i,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function $v(e,n){return(history.state?history.state.position-n:-1)+e}const Cg=new Map;function DE(e,n){Cg.set(e,n)}function OE(e){const n=Cg.get(e);return Cg.delete(e),n}let IE=()=>location.protocol+"//"+location.host;function Q2(e,n){const{pathname:t,search:r,hash:i}=n,o=e.indexOf("#");if(o>-1){let h=i.includes(e.slice(o))?e.slice(o).length:1,g=i.slice(h);return g[0]!=="/"&&(g="/"+g),jv(g,"")}return jv(t,e)+r+i}function FE(e,n,t,r){let i=[],o=[],l=null;const h=({state:E})=>{const b=Q2(e,location),R=t.value,$=n.value;let Q=0;if(E){if(t.value=b,n.value=E,l&&l===R){l=null;return}Q=$?E.position-$.position:0}else r(b);i.forEach(I=>{I(t.value,R,{delta:Q,type:Wf.pop,direction:Q?Q>0?Nf.forward:Nf.back:Nf.unknown})})};function g(){l=t.value}function v(E){i.push(E);const b=()=>{const R=i.indexOf(E);R>-1&&i.splice(R,1)};return o.push(b),b}function _(){const{history:E}=window;E.state&&E.replaceState(Ci({},E.state,{scroll:Up()}),"")}function x(){for(const E of o)E();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:g,listen:v,destroy:x}}function qv(e,n,t,r=!1,i=!1){return{back:e,current:n,forward:t,replaced:r,position:window.history.length,scroll:i?Up():null}}function zE(e){const{history:n,location:t}=window,r={value:Q2(e,t)},i={value:n.state};i.value||o(r.value,{back:null,current:r.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function o(g,v,_){const x=e.indexOf("#"),E=x>-1?(t.host&&document.querySelector("base")?e:e.slice(x))+g:IE()+e+g;try{n[_?"replaceState":"pushState"](v,"",E),i.value=v}catch(b){console.error(b),t[_?"replace":"assign"](E)}}function l(g,v){const _=Ci({},n.state,qv(i.value.back,g,i.value.forward,!0),v,{position:i.value.position});o(g,_,!0),r.value=g}function h(g,v){const _=Ci({},i.value,n.state,{forward:g,scroll:Up()});o(_.current,_,!0);const x=Ci({},qv(r.value,g,null),{position:_.position+1},v);o(g,x,!1),r.value=g}return{location:r,state:i,push:h,replace:l}}function jE(e){e=kE(e);const n=zE(e),t=FE(e,n.state,n.location,n.replace);function r(o,l=!0){l||t.pauseListeners(),history.go(o)}const i=Ci({location:"",base:e,go:r,createHref:BE.bind(null,e)},n,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>n.state.value}),i}function UE(e){return typeof e=="string"||e&&typeof e=="object"}function eb(e){return typeof e=="string"||typeof e=="symbol"}const tb=Symbol("");var Vv;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Vv||(Vv={}));function Hh(e,n){return Ci(new Error,{type:e,[tb]:!0},n)}function Vu(e,n){return e instanceof Error&&tb in e&&(n==null||!!(e.type&n))}const Gv="[^/]+?",$E={sensitive:!1,strict:!1,start:!0,end:!0},qE=/[.+*?^${}()[\]/\\]/g;function VE(e,n){const t=Ci({},$E,n),r=[];let i=t.start?"^":"";const o=[];for(const v of e){const _=v.length?[]:[90];t.strict&&!v.length&&(i+="/");for(let x=0;x<v.length;x++){const E=v[x];let b=40+(t.sensitive?.25:0);if(E.type===0)x||(i+="/"),i+=E.value.replace(qE,"\\$&"),b+=40;else if(E.type===1){const{value:R,repeatable:$,optional:Q,regexp:I}=E;o.push({name:R,repeatable:$,optional:Q});const W=I||Gv;if(W!==Gv){b+=10;try{new RegExp(`(${W})`)}catch(Se){throw new Error(`Invalid custom RegExp for param "${R}" (${W}): `+Se.message)}}let ge=$?`((?:${W})(?:/(?:${W}))*)`:`(${W})`;x||(ge=Q&&v.length<2?`(?:/${ge})`:"/"+ge),Q&&(ge+="?"),i+=ge,b+=20,Q&&(b+=-8),$&&(b+=-20),W===".*"&&(b+=-50)}_.push(b)}r.push(_)}if(t.strict&&t.end){const v=r.length-1;r[v][r[v].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const l=new RegExp(i,t.sensitive?"":"i");function h(v){const _=v.match(l),x={};if(!_)return null;for(let E=1;E<_.length;E++){const b=_[E]||"",R=o[E-1];x[R.name]=b&&R.repeatable?b.split("/"):b}return x}function g(v){let _="",x=!1;for(const E of e){(!x||!_.endsWith("/"))&&(_+="/"),x=!1;for(const b of E)if(b.type===0)_+=b.value;else if(b.type===1){const{value:R,repeatable:$,optional:Q}=b,I=R in v?v[R]:"";if(Ql(I)&&!$)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const W=Ql(I)?I.join("/"):I;if(!W)if(Q)E.length<2&&(_.endsWith("/")?_=_.slice(0,-1):x=!0);else throw new Error(`Missing required param "${R}"`);_+=W}}return _||"/"}return{re:l,score:r,keys:o,parse:h,stringify:g}}function GE(e,n){let t=0;for(;t<e.length&&t<n.length;){const r=n[t]-e[t];if(r)return r;t++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function nb(e,n){let t=0;const r=e.score,i=n.score;for(;t<r.length&&t<i.length;){const o=GE(r[t],i[t]);if(o)return o;t++}if(Math.abs(i.length-r.length)===1){if(Hv(r))return 1;if(Hv(i))return-1}return i.length-r.length}function Hv(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const HE={type:0,value:""},WE=/[a-zA-Z0-9_]/;function ZE(e){if(!e)return[[]];if(e==="/")return[[HE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(b){throw new Error(`ERR (${t})/"${v}": ${b}`)}let t=0,r=t;const i=[];let o;function l(){o&&i.push(o),o=[]}let h=0,g,v="",_="";function x(){v&&(t===0?o.push({type:0,value:v}):t===1||t===2||t===3?(o.length>1&&(g==="*"||g==="+")&&n(`A repeatable param (${v}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:v,regexp:_,repeatable:g==="*"||g==="+",optional:g==="*"||g==="?"})):n("Invalid state to consume buffer"),v="")}function E(){v+=g}for(;h<e.length;){if(g=e[h++],g==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:g==="/"?(v&&x(),l()):g===":"?(x(),t=1):E();break;case 4:E(),t=r;break;case 1:g==="("?t=2:WE.test(g)?E():(x(),t=0,g!=="*"&&g!=="?"&&g!=="+"&&h--);break;case 2:g===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+g:t=3:_+=g;break;case 3:x(),t=0,g!=="*"&&g!=="?"&&g!=="+"&&h--,_="";break;default:n("Unknown state");break}}return t===2&&n(`Unfinished custom RegExp for param "${v}"`),x(),l(),i}function KE(e,n,t){const r=VE(ZE(e.path),t),i=Ci(r,{record:e,parent:n,children:[],alias:[]});return n&&!i.record.aliasOf==!n.record.aliasOf&&n.children.push(i),i}function JE(e,n){const t=[],r=new Map;n=Jv({strict:!1,end:!0,sensitive:!1},n);function i(x){return r.get(x)}function o(x,E,b){const R=!b,$=Zv(x);$.aliasOf=b&&b.record;const Q=Jv(n,x),I=[$];if("alias"in x){const Se=typeof x.alias=="string"?[x.alias]:x.alias;for(const De of Se)I.push(Zv(Ci({},$,{components:b?b.record.components:$.components,path:De,aliasOf:b?b.record:$})))}let W,ge;for(const Se of I){const{path:De}=Se;if(E&&De[0]!=="/"){const Ye=E.record.path,Ve=Ye[Ye.length-1]==="/"?"":"/";Se.path=E.record.path+(De&&Ve+De)}if(W=KE(Se,E,Q),b?b.alias.push(W):(ge=ge||W,ge!==W&&ge.alias.push(W),R&&x.name&&!Kv(W)&&l(x.name)),rb(W)&&g(W),$.children){const Ye=$.children;for(let Ve=0;Ve<Ye.length;Ve++)o(Ye[Ve],W,b&&b.children[Ve])}b=b||W}return ge?()=>{l(ge)}:Bf}function l(x){if(eb(x)){const E=r.get(x);E&&(r.delete(x),t.splice(t.indexOf(E),1),E.children.forEach(l),E.alias.forEach(l))}else{const E=t.indexOf(x);E>-1&&(t.splice(E,1),x.record.name&&r.delete(x.record.name),x.children.forEach(l),x.alias.forEach(l))}}function h(){return t}function g(x){const E=QE(x,t);t.splice(E,0,x),x.record.name&&!Kv(x)&&r.set(x.record.name,x)}function v(x,E){let b,R={},$,Q;if("name"in x&&x.name){if(b=r.get(x.name),!b)throw Hh(1,{location:x});Q=b.record.name,R=Ci(Wv(E.params,b.keys.filter(ge=>!ge.optional).concat(b.parent?b.parent.keys.filter(ge=>ge.optional):[]).map(ge=>ge.name)),x.params&&Wv(x.params,b.keys.map(ge=>ge.name))),$=b.stringify(R)}else if(x.path!=null)$=x.path,b=t.find(ge=>ge.re.test($)),b&&(R=b.parse($),Q=b.record.name);else{if(b=E.name?r.get(E.name):t.find(ge=>ge.re.test(E.path)),!b)throw Hh(1,{location:x,currentLocation:E});Q=b.record.name,R=Ci({},E.params,x.params),$=b.stringify(R)}const I=[];let W=b;for(;W;)I.unshift(W.record),W=W.parent;return{name:Q,path:$,params:R,matched:I,meta:XE(I)}}e.forEach(x=>o(x));function _(){t.length=0,r.clear()}return{addRoute:o,resolve:v,removeRoute:l,clearRoutes:_,getRoutes:h,getRecordMatcher:i}}function Wv(e,n){const t={};for(const r of n)r in e&&(t[r]=e[r]);return t}function Zv(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:YE(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function YE(e){const n={},t=e.props||!1;if("component"in e)n.default=t;else for(const r in e.components)n[r]=typeof t=="object"?t[r]:t;return n}function Kv(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function XE(e){return e.reduce((n,t)=>Ci(n,t.meta),{})}function Jv(e,n){const t={};for(const r in e)t[r]=r in n?n[r]:e[r];return t}function QE(e,n){let t=0,r=n.length;for(;t!==r;){const o=t+r>>1;nb(e,n[o])<0?r=o:t=o+1}const i=eA(e);return i&&(r=n.lastIndexOf(i,r-1)),r}function eA(e){let n=e;for(;n=n.parent;)if(rb(n)&&nb(e,n)===0)return n}function rb({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function tA(e){const n={};if(e===""||e==="?")return n;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<r.length;++i){const o=r[i].replace(Z2," "),l=o.indexOf("="),h=Hf(l<0?o:o.slice(0,l)),g=l<0?null:Hf(o.slice(l+1));if(h in n){let v=n[h];Ql(v)||(v=n[h]=[v]),v.push(g)}else n[h]=g}return n}function Yv(e){let n="";for(let t in e){const r=e[t];if(t=wE(t),r==null){r!==void 0&&(n+=(n.length?"&":"")+t);continue}(Ql(r)?r.map(o=>o&&Sg(o)):[r&&Sg(r)]).forEach(o=>{o!==void 0&&(n+=(n.length?"&":"")+t,o!=null&&(n+="="+o))})}return n}function nA(e){const n={};for(const t in e){const r=e[t];r!==void 0&&(n[t]=Ql(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return n}const rA=Symbol(""),Xv=Symbol(""),$p=Symbol(""),_m=Symbol(""),Pg=Symbol("");function ff(){let e=[];function n(r){return e.push(r),()=>{const i=e.indexOf(r);i>-1&&e.splice(i,1)}}function t(){e=[]}return{add:n,list:()=>e.slice(),reset:t}}function mc(e,n,t,r,i,o=l=>l()){const l=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((h,g)=>{const v=E=>{E===!1?g(Hh(4,{from:t,to:n})):E instanceof Error?g(E):UE(E)?g(Hh(2,{from:n,to:E})):(l&&r.enterCallbacks[i]===l&&typeof E=="function"&&l.push(E),h())},_=o(()=>e.call(r&&r.instances[i],n,t,v));let x=Promise.resolve(_);e.length<3&&(x=x.then(v)),x.catch(E=>g(E))})}function z0(e,n,t,r,i=o=>o()){const o=[];for(const l of e)for(const h in l.components){let g=l.components[h];if(!(n!=="beforeRouteEnter"&&!l.instances[h]))if(H2(g)){const _=(g.__vccOpts||g)[n];_&&o.push(mc(_,t,r,l,h,i))}else{let v=g();o.push(()=>v.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${h}" at "${l.path}"`);const x=cE(_)?_.default:_;l.mods[h]=_,l.components[h]=x;const b=(x.__vccOpts||x)[n];return b&&mc(b,t,r,l,h,i)()}))}}return o}function Qv(e){const n=Ml($p),t=Ml(_m),r=Rr(()=>{const g=Kn(e.to);return n.resolve(g)}),i=Rr(()=>{const{matched:g}=r.value,{length:v}=g,_=g[v-1],x=t.matched;if(!_||!x.length)return-1;const E=x.findIndex(Gh.bind(null,_));if(E>-1)return E;const b=ey(g[v-2]);return v>1&&ey(_)===b&&x[x.length-1].path!==b?x.findIndex(Gh.bind(null,g[v-2])):E}),o=Rr(()=>i.value>-1&&aA(t.params,r.value.params)),l=Rr(()=>i.value>-1&&i.value===t.matched.length-1&&X2(t.params,r.value.params));function h(g={}){if(oA(g)){const v=n[Kn(e.replace)?"replace":"push"](Kn(e.to)).catch(Bf);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>v),v}return Promise.resolve()}return{route:r,href:Rr(()=>r.value.href),isActive:o,isExactActive:l,navigate:h}}function iA(e){return e.length===1?e[0]:e}const sA=Pa({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Qv,setup(e,{slots:n}){const t=Au(Qv(e)),{options:r}=Ml($p),i=Rr(()=>({[ty(e.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[ty(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const o=n.default&&iA(n.default(t));return e.custom?o:dm("a",{"aria-current":t.isExactActive?e.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},o)}}}),bf=sA;function oA(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function aA(e,n){for(const t in n){const r=n[t],i=e[t];if(typeof r=="string"){if(r!==i)return!1}else if(!Ql(i)||i.length!==r.length||r.some((o,l)=>o!==i[l]))return!1}return!0}function ey(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ty=(e,n,t)=>e??n??t,lA=Pa({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:t}){const r=Ml(Pg),i=Rr(()=>e.route||r.value),o=Ml(Xv,0),l=Rr(()=>{let v=Kn(o);const{matched:_}=i.value;let x;for(;(x=_[v])&&!x.components;)v++;return v}),h=Rr(()=>i.value.matched[l.value]);Od(Xv,Rr(()=>l.value+1)),Od(rA,h),Od(Pg,i);const g=un();return Co(()=>[g.value,h.value,e.name],([v,_,x],[E,b,R])=>{_&&(_.instances[x]=v,b&&b!==_&&v&&v===E&&(_.leaveGuards.size||(_.leaveGuards=b.leaveGuards),_.updateGuards.size||(_.updateGuards=b.updateGuards))),v&&_&&(!b||!Gh(_,b)||!E)&&(_.enterCallbacks[x]||[]).forEach($=>$(v))},{flush:"post"}),()=>{const v=i.value,_=e.name,x=h.value,E=x&&x.components[_];if(!E)return ny(t.default,{Component:E,route:v});const b=x.props[_],R=b?b===!0?v.params:typeof b=="function"?b(v):b:null,Q=dm(E,Ci({},R,n,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(x.instances[_]=null)},ref:g}));return ny(t.default,{Component:Q,route:v})||Q}}});function ny(e,n){if(!e)return null;const t=e(n);return t.length===1?t[0]:t}const ib=lA;function uA(e){const n=JE(e.routes,e),t=e.parseQuery||tA,r=e.stringifyQuery||Yv,i=e.history,o=ff(),l=ff(),h=ff(),g=mL(lc);let v=lc;Bh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=I0.bind(null,ne=>""+ne),x=I0.bind(null,LE),E=I0.bind(null,Hf);function b(ne,te){let ee,se;return eb(ne)?(ee=n.getRecordMatcher(ne),se=te):se=ne,n.addRoute(se,ee)}function R(ne){const te=n.getRecordMatcher(ne);te&&n.removeRoute(te)}function $(){return n.getRoutes().map(ne=>ne.record)}function Q(ne){return!!n.getRecordMatcher(ne)}function I(ne,te){if(te=Ci({},te||g.value),typeof ne=="string"){const xe=F0(t,ne,te.path),ye=n.resolve({path:xe.path},te),le=i.createHref(xe.fullPath);return Ci(xe,ye,{params:E(ye.params),hash:Hf(xe.hash),redirectedFrom:void 0,href:le})}let ee;if(ne.path!=null)ee=Ci({},ne,{path:F0(t,ne.path,te.path).path});else{const xe=Ci({},ne.params);for(const ye in xe)xe[ye]==null&&delete xe[ye];ee=Ci({},ne,{params:x(xe)}),te.params=x(te.params)}const se=n.resolve(ee,te),Pe=ne.hash||"";se.params=_(E(se.params));const oe=PE(r,Ci({},ne,{hash:bE(Pe),path:se.path})),re=i.createHref(oe);return Ci({fullPath:oe,hash:Pe,query:r===Yv?nA(ne.query):ne.query||{}},se,{redirectedFrom:void 0,href:re})}function W(ne){return typeof ne=="string"?F0(t,ne,g.value.path):Ci({},ne)}function ge(ne,te){if(v!==ne)return Hh(8,{from:te,to:ne})}function Se(ne){return Ve(ne)}function De(ne){return Se(Ci(W(ne),{replace:!0}))}function Ye(ne){const te=ne.matched[ne.matched.length-1];if(te&&te.redirect){const{redirect:ee}=te;let se=typeof ee=="function"?ee(ne):ee;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=W(se):{path:se},se.params={}),Ci({query:ne.query,hash:ne.hash,params:se.path!=null?{}:ne.params},se)}}function Ve(ne,te){const ee=v=I(ne),se=g.value,Pe=ne.state,oe=ne.force,re=ne.replace===!0,xe=Ye(ee);if(xe)return Ve(Ci(W(xe),{state:typeof xe=="object"?Ci({},Pe,xe.state):Pe,force:oe,replace:re}),te||ee);const ye=ee;ye.redirectedFrom=te;let le;return!oe&&EE(r,se,ee)&&(le=Hh(16,{to:ye,from:se}),st(se,se,!0,!1)),(le?Promise.resolve(le):ce(ye,se)).catch(Ue=>Vu(Ue)?Vu(Ue,2)?Ue:Me(Ue):ie(Ue,ye,se)).then(Ue=>{if(Ue){if(Vu(Ue,2))return Ve(Ci({replace:re},W(Ue.to),{state:typeof Ue.to=="object"?Ci({},Pe,Ue.to.state):Pe,force:oe}),te||ye)}else Ue=D(ye,se,!0,re,Pe);return H(ye,se,Ue),Ue})}function O(ne,te){const ee=ge(ne,te);return ee?Promise.reject(ee):Promise.resolve()}function K(ne){const te=N.values().next().value;return te&&typeof te.runWithContext=="function"?te.runWithContext(ne):ne()}function ce(ne,te){let ee;const[se,Pe,oe]=cA(ne,te);ee=z0(se.reverse(),"beforeRouteLeave",ne,te);for(const xe of se)xe.leaveGuards.forEach(ye=>{ee.push(mc(ye,ne,te))});const re=O.bind(null,ne,te);return ee.push(re),he(ee).then(()=>{ee=[];for(const xe of o.list())ee.push(mc(xe,ne,te));return ee.push(re),he(ee)}).then(()=>{ee=z0(Pe,"beforeRouteUpdate",ne,te);for(const xe of Pe)xe.updateGuards.forEach(ye=>{ee.push(mc(ye,ne,te))});return ee.push(re),he(ee)}).then(()=>{ee=[];for(const xe of oe)if(xe.beforeEnter)if(Ql(xe.beforeEnter))for(const ye of xe.beforeEnter)ee.push(mc(ye,ne,te));else ee.push(mc(xe.beforeEnter,ne,te));return ee.push(re),he(ee)}).then(()=>(ne.matched.forEach(xe=>xe.enterCallbacks={}),ee=z0(oe,"beforeRouteEnter",ne,te,K),ee.push(re),he(ee))).then(()=>{ee=[];for(const xe of l.list())ee.push(mc(xe,ne,te));return ee.push(re),he(ee)}).catch(xe=>Vu(xe,8)?xe:Promise.reject(xe))}function H(ne,te,ee){h.list().forEach(se=>K(()=>se(ne,te,ee)))}function D(ne,te,ee,se,Pe){const oe=ge(ne,te);if(oe)return oe;const re=te===lc,xe=Bh?history.state:{};ee&&(se||re?i.replace(ne.fullPath,Ci({scroll:re&&xe&&xe.scroll},Pe)):i.push(ne.fullPath,Pe)),g.value=ne,st(ne,te,ee,re),Me()}let V;function z(){V||(V=i.listen((ne,te,ee)=>{if(!Z.listening)return;const se=I(ne),Pe=Ye(se);if(Pe){Ve(Ci(Pe,{replace:!0,force:!0}),se).catch(Bf);return}v=se;const oe=g.value;Bh&&DE($v(oe.fullPath,ee.delta),Up()),ce(se,oe).catch(re=>Vu(re,12)?re:Vu(re,2)?(Ve(Ci(W(re.to),{force:!0}),se).then(xe=>{Vu(xe,20)&&!ee.delta&&ee.type===Wf.pop&&i.go(-1,!1)}).catch(Bf),Promise.reject()):(ee.delta&&i.go(-ee.delta,!1),ie(re,se,oe))).then(re=>{re=re||D(se,oe,!1),re&&(ee.delta&&!Vu(re,8)?i.go(-ee.delta,!1):ee.type===Wf.pop&&Vu(re,20)&&i.go(-1,!1)),H(se,oe,re)}).catch(Bf)}))}let U=ff(),G=ff(),ue;function ie(ne,te,ee){Me(ne);const se=G.list();return se.length?se.forEach(Pe=>Pe(ne,te,ee)):console.error(ne),Promise.reject(ne)}function Ae(){return ue&&g.value!==lc?Promise.resolve():new Promise((ne,te)=>{U.add([ne,te])})}function Me(ne){return ue||(ue=!ne,z(),U.list().forEach(([te,ee])=>ne?ee(ne):te()),U.reset()),ne}function st(ne,te,ee,se){const{scrollBehavior:Pe}=e;if(!Bh||!Pe)return Promise.resolve();const oe=!ee&&OE($v(ne.fullPath,0))||(se||!ee)&&history.state&&history.state.scroll||null;return Ds().then(()=>Pe(ne,te,oe)).then(re=>re&&RE(re)).catch(re=>ie(re,ne,te))}const X=ne=>i.go(ne);let Ee;const N=new Set,Z={currentRoute:g,listening:!0,addRoute:b,removeRoute:R,clearRoutes:n.clearRoutes,hasRoute:Q,getRoutes:$,resolve:I,options:e,push:Se,replace:De,go:X,back:()=>X(-1),forward:()=>X(1),beforeEach:o.add,beforeResolve:l.add,afterEach:h.add,onError:G.add,isReady:Ae,install(ne){const te=this;ne.component("RouterLink",bf),ne.component("RouterView",ib),ne.config.globalProperties.$router=te,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>Kn(g)}),Bh&&!Ee&&g.value===lc&&(Ee=!0,Se(i.location).catch(Pe=>{}));const ee={};for(const Pe in lc)Object.defineProperty(ee,Pe,{get:()=>g.value[Pe],enumerable:!0});ne.provide($p,te),ne.provide(_m,w_(ee)),ne.provide(Pg,g);const se=ne.unmount;N.add(ne),ne.unmount=function(){N.delete(ne),N.size<1&&(v=lc,V&&V(),V=null,g.value=lc,Ee=!1,ue=!1),se()}}};function he(ne){return ne.reduce((te,ee)=>te.then(()=>K(ee)),Promise.resolve())}return Z}function cA(e,n){const t=[],r=[],i=[],o=Math.max(n.matched.length,e.matched.length);for(let l=0;l<o;l++){const h=n.matched[l];h&&(e.matched.find(v=>Gh(v,h))?r.push(h):t.push(h));const g=e.matched[l];g&&(n.matched.find(v=>Gh(v,g))||i.push(g))}return[t,r,i]}function qp(){return Ml($p)}function aF(e){return Ml(_m)}const Rf=Np("notification",()=>{const e=un([]),n=un(0),t=un(null),r=Rr(()=>[...e.value].sort((x,E)=>E.timestamp-x.timestamp));function i({type:x,message:E,duration:b=5e3}){const R=++n.value,$=Date.now(),Q={id:R,type:x,message:E,duration:b,timestamp:$};return e.value.push(Q),t.value=R,b>0&&setTimeout(()=>{v(R)},b),R}const o=(x,E=5e3)=>i({type:"success",message:x,duration:E}),l=(x,E=5e3)=>i({type:"error",message:x,duration:E}),h=(x,E=5e3)=>i({type:"info",message:x,duration:E}),g=(x,E=5e3)=>i({type:"warning",message:x,duration:E});function v(x){const E=e.value.findIndex(b=>b.id===x);E!==-1&&e.value.splice(E,1),t.value===x&&(t.value=null)}function _(){e.value=[],t.value=null}return{notifications:r,lastAddedId:t,addNotification:i,removeNotification:v,clearAll:_,success:o,error:l,info:h,warning:g}});var qo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function hA(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var ob=hA,fA=typeof qo=="object"&&qo&&qo.Object===Object&&qo,dA=fA,pA=dA,gA=typeof self=="object"&&self&&self.Object===Object&&self,mA=pA||gA||Function("return this")(),ab=mA,vA=ab,yA=function(){return vA.Date.now()},_A=yA,bA=/\s/;function wA(e){for(var n=e.length;n--&&bA.test(e.charAt(n)););return n}var xA=wA,LA=xA,SA=/^\s+/;function CA(e){return e&&e.slice(0,LA(e)+1).replace(SA,"")}var PA=CA,EA=ab,AA=EA.Symbol,lb=AA,ry=lb,ub=Object.prototype,MA=ub.hasOwnProperty,kA=ub.toString,df=ry?ry.toStringTag:void 0;function TA(e){var n=MA.call(e,df),t=e[df];try{e[df]=void 0;var r=!0}catch{}var i=kA.call(e);return r&&(n?e[df]=t:delete e[df]),i}var BA=TA,NA=Object.prototype,RA=NA.toString;function DA(e){return RA.call(e)}var OA=DA,iy=lb,IA=BA,FA=OA,zA="[object Null]",jA="[object Undefined]",sy=iy?iy.toStringTag:void 0;function UA(e){return e==null?e===void 0?jA:zA:sy&&sy in Object(e)?IA(e):FA(e)}var $A=UA;function qA(e){return e!=null&&typeof e=="object"}var VA=qA,GA=$A,HA=VA,WA="[object Symbol]";function ZA(e){return typeof e=="symbol"||HA(e)&&GA(e)==WA}var KA=ZA,JA=PA,oy=ob,YA=KA,ay=NaN,XA=/^[-+]0x[0-9a-f]+$/i,QA=/^0b[01]+$/i,eM=/^0o[0-7]+$/i,tM=parseInt;function nM(e){if(typeof e=="number")return e;if(YA(e))return ay;if(oy(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=oy(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=JA(e);var t=QA.test(e);return t||eM.test(e)?tM(e.slice(2),t?2:8):XA.test(e)?ay:+e}var rM=nM,iM=ob,j0=_A,ly=rM,sM="Expected a function",oM=Math.max,aM=Math.min;function lM(e,n,t){var r,i,o,l,h,g,v=0,_=!1,x=!1,E=!0;if(typeof e!="function")throw new TypeError(sM);n=ly(n)||0,iM(t)&&(_=!!t.leading,x="maxWait"in t,o=x?oM(ly(t.maxWait)||0,n):o,E="trailing"in t?!!t.trailing:E);function b(Ye){var Ve=r,O=i;return r=i=void 0,v=Ye,l=e.apply(O,Ve),l}function R(Ye){return v=Ye,h=setTimeout(I,n),_?b(Ye):l}function $(Ye){var Ve=Ye-g,O=Ye-v,K=n-Ve;return x?aM(K,o-O):K}function Q(Ye){var Ve=Ye-g,O=Ye-v;return g===void 0||Ve>=n||Ve<0||x&&O>=o}function I(){var Ye=j0();if(Q(Ye))return W(Ye);h=setTimeout(I,$(Ye))}function W(Ye){return h=void 0,E&&r?b(Ye):(r=i=void 0,l)}function ge(){h!==void 0&&clearTimeout(h),v=0,r=g=i=h=void 0}function Se(){return h===void 0?l:W(j0())}function De(){var Ye=j0(),Ve=Q(Ye);if(r=arguments,i=this,g=Ye,Ve){if(h===void 0)return R(g);if(x)return clearTimeout(h),h=setTimeout(I,n),b(g)}return h===void 0&&(h=setTimeout(I,n)),l}return De.cancel=ge,De.flush=Se,De}var uM=lM;const cM=sb(uM),hM={class:"relative w-full"},fM={key:0,class:"search-results w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},dM=["onClick"],uy=Pa({__name:"SearchBar",emits:["select-location"],setup(e,{emit:n}){const t=un(""),r=un([]),i=n,o=cM(async g=>{if(g.length<3){r.value=[];return}try{const _=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(g)}`)).json();r.value=_}catch(v){console.error("Erreur lors de la recherche d'adresse:",v),r.value=[]}},300);function l(){o(t.value)}function h(g){t.value=g.display_name,r.value=[],i("select-location",{lat:parseFloat(g.lat),lng:parseFloat(g.lon)})}return(g,v)=>(Xe(),tt("div",hM,[Dn(M("input",{"onUpdate:modelValue":v[0]||(v[0]=_=>t.value=_),onInput:l,type:"text",placeholder:"Rechercher une adresse...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},null,544),[[Mr,t.value]]),r.value.length>0?(Xe(),tt("div",fM,[(Xe(!0),tt(Un,null,kr(r.value,_=>(Xe(),tt("div",{key:_.place_id,onClick:x=>h(_),class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},Ht(_.display_name),9,dM))),128))])):yn("",!0)]))}}),pM={class:"perf-title"},gM={class:"perf-basic-stats"},mM={class:"perf-stat"},vM={class:"perf-stat"},yM={class:"perf-expand-btn"},_M={key:0,class:"perf-content"},bM={class:"perf-section"},wM={class:"perf-metrics"},xM={class:"perf-metric"},LM={class:"perf-metric-value"},SM={class:"perf-metric"},CM={class:"perf-metric-value"},PM={class:"perf-metric"},EM={class:"perf-metric-value"},AM={class:"perf-metric"},MM={class:"perf-metric-value"},kM={class:"perf-section"},TM={class:"perf-metrics"},BM={key:0,class:"perf-metric"},NM={class:"perf-metric-value"},RM={key:1,class:"perf-metric"},DM={class:"perf-metric-value"},OM={key:2,class:"perf-metric"},IM={class:"perf-metric-value"},FM={class:"perf-section"},zM={class:"perf-table"},jM={class:"perf-table-cell"},UM={class:"perf-table-cell"},$M={class:"perf-table-cell"},qM={class:"perf-table-cell"},VM=["onClick"],GM={key:0,class:"perf-empty"},HM=Pa({__name:"PerformancePanel",props:{position:{}},setup(e){const t=e.position||"bottom-left",r=un(!1),{isQueryParamEnabled:i,isRecording:o,measures:l,longTasks:h,memorySnapshots:g,framesPerSecond:v,operationHistory:_,startRecording:x,stopRecording:E,clearRecording:b,captureMemorySnapshot:R,getSlowOperations:$,getPerformanceReport:Q,getOperationDetails:I}=Xh(),W=Rr(()=>{const D=Q()??{totalMeasures:0,totalLongTasks:0,slowestOperations:[],averageFps:0,memoryUsage:null};return{totalMeasures:D.totalMeasures,totalLongTasks:D.totalLongTasks,averageDuration:D.slowestOperations.length>0?D.slowestOperations.reduce((V,z)=>V+z.duration,0)/D.slowestOperations.length:0,fps:D.averageFps,slowestOperations:D.slowestOperations,memoryUsage:D.memoryUsage}}),ge=Rr(()=>(Q()??{slowestOperations:[]}).slowestOperations.slice(0,5).map(V=>({operation:V.name,component:V.component||"unknown",durationMs:V.duration,timestamp:V.startTime}))),Se=un(null);Bl(()=>{i.value&&(Se.value=window.setInterval(()=>{R()},1e3))}),Kh(()=>{Se.value!==null&&clearInterval(Se.value)});function De(D){return D===void 0?"N/A":D<1024?D+" B":D<1024*1024?(D/1024).toFixed(2)+" KB":D<1024*1024*1024?(D/(1024*1024)).toFixed(2)+" MB":(D/(1024*1024*1024)).toFixed(2)+" GB"}function Ye(D){return D.toFixed(2)}const Ve=()=>{R()};function O(){const D=Q(),V="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(D,null,2)),z=document.createElement("a");z.setAttribute("href",V),z.setAttribute("download","performance_report.json"),document.body.appendChild(z),z.click(),z.remove()}function K(){b(),Ve()}function ce(){const D=Q();navigator.clipboard.writeText(JSON.stringify(D,null,2)).then(()=>{alert("Données de performance copiées dans le presse-papiers")}).catch(V=>{console.error("Erreur lors de la copie des données",V),alert("Erreur lors de la copie des données")})}async function H(D){const V=I(D.operation,D.timestamp);if(!V){alert("Impossible de trouver les détails de cette opération");return}const z={operation:{...V.operation,startTimeRelative:"0ms",startTimeAbsolute:new Date(V.operation.startTime).toISOString()},context:{...V.context,relatedOperations:V.context.relatedOperations.map(U=>({...U,startTime:`+${U.startTime.toFixed(2)}ms`})),longTasks:V.context.longTasks.map(U=>({...U,startTime:`+${U.startTime.toFixed(2)}ms`})),memorySnapshots:V.context.memorySnapshots.map(U=>({...U,timestamp:`+${U.timestamp.toFixed(2)}ms`,usedJSHeapSize:U.usedJSHeapSize?De(U.usedJSHeapSize):"N/A",totalJSHeapSize:U.totalJSHeapSize?De(U.totalJSHeapSize):"N/A"}))},summary:{...V.summary,memoryDelta:De(V.summary.memoryDelta),maxLongTaskDuration:`${V.summary.maxLongTaskDuration.toFixed(2)}ms`}};try{await navigator.clipboard.writeText(JSON.stringify(z,null,2)),alert("Détails de l'opération copiés dans le presse-papiers")}catch(U){console.error("Erreur lors de la copie des détails",U),alert("Erreur lors de la copie des détails")}}return(D,V)=>{var z,U,G,ue,ie,Ae;return Kn(i)?(Xe(),tt("div",{key:0,class:Yi(["performance-panel",`position-${Kn(t)}`,{expanded:r.value}])},[M("div",{class:"perf-header",onClick:V[0]||(V[0]=Me=>r.value=!r.value)},[M("div",pM,[M("div",{class:Yi(["perf-indicator",{active:Kn(o)}])},null,2),V[1]||(V[1]=M("span",null,"Performance",-1))]),M("div",gM,[M("span",mM,Ht(W.value.fps)+" FPS",1),M("span",vM,Ht(Ye(W.value.averageDuration))+"ms",1)]),M("button",yM,Ht(r.value?"▼":"▲"),1)]),r.value?(Xe(),tt("div",_M,[M("div",bM,[V[6]||(V[6]=M("h3",null,"Métriques générales",-1)),M("div",wM,[M("div",xM,[V[2]||(V[2]=M("span",{class:"perf-metric-label"},"Mesures",-1)),M("span",LM,Ht(W.value.totalMeasures),1)]),M("div",SM,[V[3]||(V[3]=M("span",{class:"perf-metric-label"},"Tâches longues",-1)),M("span",CM,Ht(W.value.totalLongTasks),1)]),M("div",PM,[V[4]||(V[4]=M("span",{class:"perf-metric-label"},"Durée moyenne",-1)),M("span",EM,Ht(Ye(W.value.averageDuration))+"ms",1)]),M("div",AM,[V[5]||(V[5]=M("span",{class:"perf-metric-label"},"FPS",-1)),M("span",MM,Ht(W.value.fps),1)])])]),M("div",kM,[V[10]||(V[10]=M("h3",null,"Mémoire",-1)),M("div",TM,[((z=W.value.memoryUsage)==null?void 0:z.usedJSHeapSize)!==void 0?(Xe(),tt("div",BM,[V[7]||(V[7]=M("span",{class:"perf-metric-label"},"Utilisée",-1)),M("span",NM,Ht(De((U=W.value.memoryUsage)==null?void 0:U.usedJSHeapSize)),1)])):yn("",!0),((G=W.value.memoryUsage)==null?void 0:G.totalJSHeapSize)!==void 0?(Xe(),tt("div",RM,[V[8]||(V[8]=M("span",{class:"perf-metric-label"},"Totale",-1)),M("span",DM,Ht(De((ue=W.value.memoryUsage)==null?void 0:ue.totalJSHeapSize)),1)])):yn("",!0),((ie=W.value.memoryUsage)==null?void 0:ie.jsHeapSizeLimit)!==void 0?(Xe(),tt("div",OM,[V[9]||(V[9]=M("span",{class:"perf-metric-label"},"Limite",-1)),M("span",IM,Ht(De((Ae=W.value.memoryUsage)==null?void 0:Ae.jsHeapSizeLimit)),1)])):yn("",!0)])]),M("div",FM,[V[13]||(V[13]=M("h3",null,"Opérations les plus lentes",-1)),M("div",zM,[V[12]||(V[12]=wc('<div class="perf-table-header" data-v-fefe39b0><div class="perf-table-cell" data-v-fefe39b0>Opération</div><div class="perf-table-cell" data-v-fefe39b0>Composant</div><div class="perf-table-cell" data-v-fefe39b0>Durée</div><div class="perf-table-cell" data-v-fefe39b0>Actions</div></div>',1)),(Xe(!0),tt(Un,null,kr(ge.value,Me=>(Xe(),tt("div",{class:"perf-table-row",key:Me.timestamp},[M("div",jM,Ht(Me.operation),1),M("div",UM,Ht(Me.component),1),M("div",$M,Ht(Ye(Me.durationMs))+"ms",1),M("div",qM,[M("button",{onClick:st=>H(Me),class:"perf-action-button",title:"Copier les détails"},V[11]||(V[11]=[M("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,VM)])]))),128)),ge.value.length===0?(Xe(),tt("div",GM," Aucune opération enregistrée ")):yn("",!0)])]),M("div",{class:"perf-actions"},[M("button",{onClick:K,class:"perf-button"}," Réinitialiser "),M("button",{onClick:O,class:"perf-button"}," Télécharger "),M("button",{onClick:ce,class:"perf-button"}," Copier ")])])):yn("",!0)],2)):yn("",!0)}}}),bm=(e,n)=>{const t=e.__vccOpts||e;for(const[r,i]of n)t[r]=i;return t},WM=bm(HM,[["__scopeId","data-v-fefe39b0"]]),ZM={class:"h-screen flex flex-col"},KM={key:0,class:"bg-white shadow-sm z-[2000] flex-shrink-0"},JM={class:"mx-auto px-4 sm:px-6 lg:px-8"},YM={class:"flex h-16 items-center justify-between"},XM={class:"flex items-center"},QM={class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e6={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},t6={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},n6={class:"hidden md:flex md:ml-6 space-x-8"},r6={key:0,class:"hidden md:block flex-1 mx-8"},i6={key:1,class:"flex-1"},s6={class:"flex items-center space-x-2 md:space-x-4"},o6={key:0,class:"hidden md:flex items-center justify-center p-2 text-amber-500 hover:text-amber-600 rounded-full hover:bg-amber-50 focus:outline-none focus:ring-2 focus:ring-amber-400",title:"Performance activée"},a6={class:"relative"},l6={key:0,class:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},u6={class:"px-4 py-2 border-b border-gray-100 flex justify-between items-center"},c6={class:"max-h-72 overflow-y-auto"},h6={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},f6={class:"flex items-start"},d6={class:"flex-shrink-0 mr-3"},p6={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},g6={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},m6={key:2,class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},v6={key:3,class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},y6={class:"flex-1"},_6={class:"text-sm text-gray-800"},b6=["onClick"],w6={class:"relative"},x6={class:"hidden md:flex flex-col items-end"},L6={class:"text-sm font-medium text-gray-700"},S6={key:0,class:"text-xs text-gray-500"},C6=["src","alt"],P6={key:0,class:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-[3000]"},E6={class:"md:hidden px-4 py-2 border-b border-gray-100"},A6={class:"text-sm font-medium text-gray-700"},M6={class:"text-xs text-gray-500"},k6={key:0,class:"md:hidden bg-white border-t border-gray-200"},T6={class:"space-y-1 px-2 pb-3 pt-2"},B6={key:0,class:"px-4 py-3 border-t border-gray-200"},N6=Pa({__name:"App",setup(e){const n=qp(),t=Ga(),r=Rf(),{isQueryParamEnabled:i}=Xh(),o=un(!1),l=un(!1),h=un(!1),g=un(!1),v=un(null),_=un(!1),x=un(!1),E=un(null),b=un("13px"),R=un("65px");function $(){x.value=window.innerWidth<768}Bl(()=>{$(),window.addEventListener("resize",$),window.addEventListener("resize",Q)}),Ep(()=>{window.removeEventListener("resize",$),window.removeEventListener("resize",Q)});function Q(){if(!E.value)return;const V=E.value.getBoundingClientRect();b.value=`${V.top+window.scrollY+5}px`;const z=V.left+V.width/2;R.value=`${window.innerWidth-z-22}px`}const I=Rr(()=>{const V=t.user;if(!V)return"";const z=`${V.first_name} ${V.last_name.toUpperCase()}`;return V.company_name?`${z} (${V.company_name})`:z}),W=Rr(()=>{var z;switch((z=t.user)==null?void 0:z.user_type){case"admin":return"Accès administrateur";case"entreprise":return"Accès entreprise";case"salarie":return"Accès salarie";case"visiteur":return"Accès visiteur";default:return""}}),ge=Rr(()=>{var V;return((V=t.user)==null?void 0:V.user_type)==="admin"}),Se=Rr(()=>t.isAuthenticated),De=[{name:"Carte",to:"/"},{name:"Notes",to:"/notes"}],Ye=Rr(()=>{var z;if(!Se.value)return[];const V=[...De];return(ge.value||((z=t.user)==null?void 0:z.user_type)==="entreprise")&&V.push({name:"Utilisateurs",to:"/users"}),V}),Ve=Rr(()=>Se.value?[{name:"Mon profil",to:"/profile"}]:[]);async function O(){try{await t.logout(),n.push("/login")}catch(V){console.error("Erreur lors de la déconnexion:",V)}}function K(V){window.dispatchEvent(new CustomEvent("map-set-location",{detail:{lat:V.lat,lng:V.lng,zoom:16}}))}Bl(async()=>{console.log("App mounted, checking auth...");try{if(localStorage.getItem("token")){console.log("Token found, checking auth..."),await t.checkAuth(),await t.fetchUserProfile();const z=localStorage.getItem("lastPlanId");z&&window.dispatchEvent(new CustomEvent("load-last-plan",{detail:{planId:z}}))}else console.log("No token found")}catch(V){console.error("Auth check error:",V),n.push("/login")}});const ce=Rr(()=>{const V="TagMap";if(!Se.value)return`${V} - Connexion`;const z=n.currentRoute.value,G={home:"Carte",notes:"Notes",users:"Utilisateurs",profile:"Mon profil",changePassword:"Changement de mot de passe",map:"Carte"}[z.name]||"";return G?`${V} - ${G}`:V});Co(ce,V=>{document.title=V},{immediate:!0});const H=Rr(()=>r.notifications.length);function D(){r.clearAll(),h.value=!1}return cg(()=>{if(r.lastAddedId!==null){const V=r.notifications.find(z=>z.id===r.lastAddedId);V&&Ds(()=>{Q(),g.value=!0,v.value={id:V.id,message:V.message,type:V.type},requestAnimationFrame(()=>{setTimeout(()=>{_.value=!0,setTimeout(()=>{_.value=!1,setTimeout(()=>{var z;((z=v.value)==null?void 0:z.id)===V.id&&(v.value=null,g.value=!1)},300)},4e3)},50)})})}}),(V,z)=>{var U;return Xe(),tt("div",ZM,[Se.value?(Xe(),tt("header",KM,[M("nav",JM,[M("div",YM,[M("div",XM,[M("button",{onClick:z[0]||(z[0]=G=>l.value=!l.value),class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500 md:hidden"},[z[5]||(z[5]=M("span",{class:"sr-only"},"Ouvrir le menu",-1)),(Xe(),tt("svg",QM,[l.value?(Xe(),tt("path",t6)):(Xe(),tt("path",e6))]))]),Xi(Kn(bf),{to:"/",class:"text-xl font-semibold text-primary-600 truncate ml-2 md:ml-0"},{default:vc(()=>z[6]||(z[6]=[M("span",{class:"md:inline hidden"},"TagMap",-1),M("span",{class:"md:hidden inline"},"TM",-1)])),_:1}),M("div",n6,[(Xe(!0),tt(Un,null,kr(Ye.value,G=>(Xe(),Cu(Kn(bf),{key:G.name,to:G.to,class:Yi(["text-sm font-medium transition-colors duration-200",[V.$route.path===G.to?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-900"]])},{default:vc(()=>[Ni(Ht(G.name),1)]),_:2},1032,["to","class"]))),128))])]),V.$route.path==="/"?(Xe(),tt("div",r6,[Xi(uy,{onSelectLocation:K})])):(Xe(),tt("div",i6)),M("div",s6,[Kn(i)?(Xe(),tt("button",o6,z[7]||(z[7]=[M("span",{class:"sr-only"},"Performance",-1),M("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]))):yn("",!0),M("div",a6,[M("button",{ref_key:"bellButtonRef",ref:E,onClick:z[1]||(z[1]=G=>h.value=!h.value),class:Yi(["relative flex items-center justify-center p-2 text-gray-400 hover:text-gray-500 rounded-full hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"animate-bell":g.value}])},z[8]||(z[8]=[M("span",{class:"sr-only"},"Voir les notifications",-1),M("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)]),2),h.value?(Xe(),tt("div",l6,[M("div",u6,[z[9]||(z[9]=M("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),H.value>0?(Xe(),tt("button",{key:0,onClick:D,class:"text-xs text-primary-600 hover:text-primary-800"}," Tout effacer ")):yn("",!0)]),M("div",c6,[H.value===0?(Xe(),tt("div",h6," Aucune notification ")):yn("",!0),(Xe(!0),tt(Un,null,kr(Kn(r).notifications,G=>(Xe(),tt("div",{key:G.id,class:"px-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50"},[M("div",f6,[M("div",d6,[G.type==="success"?(Xe(),tt("svg",p6,z[10]||(z[10]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):G.type==="error"?(Xe(),tt("svg",g6,z[11]||(z[11]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):G.type==="warning"?(Xe(),tt("svg",m6,z[12]||(z[12]=[M("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(Xe(),tt("svg",v6,z[13]||(z[13]=[M("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),M("div",y6,[M("p",_6,Ht(G.message),1),M("button",{onClick:ue=>Kn(r).removeNotification(G.id),class:"text-xs text-primary-600 hover:text-primary-800 mt-1"}," Fermer ",8,b6)])])]))),128))])])):yn("",!0)]),M("div",w6,[M("button",{onClick:z[2]||(z[2]=G=>o.value=!o.value),class:"flex items-center space-x-2 md:space-x-3 focus:outline-none"},[M("div",x6,[M("span",L6,Ht(I.value),1),W.value?(Xe(),tt("span",S6,Ht(W.value),1)):yn("",!0)]),M("img",{class:"h-8 w-8 rounded-full ring-2 ring-white",src:((U=Kn(t).user)==null?void 0:U.logo)||"https://ui-avatars.com/api/?name="+encodeURIComponent(I.value),alt:I.value},null,8,C6)]),o.value?(Xe(),tt("div",P6,[M("div",E6,[M("div",A6,Ht(I.value),1),M("div",M6,Ht(W.value),1)]),(Xe(!0),tt(Un,null,kr(Ve.value,G=>(Xe(),Cu(Kn(bf),{key:G.name,to:G.to,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:z[3]||(z[3]=ue=>o.value=!1)},{default:vc(()=>[Ni(Ht(G.name),1)]),_:2},1032,["to"]))),128)),M("button",{onClick:O,class:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50"}," Déconnexion ")])):yn("",!0)])])]),l.value?(Xe(),tt("div",k6,[M("div",T6,[(Xe(!0),tt(Un,null,kr(Ye.value,G=>(Xe(),Cu(Kn(bf),{key:G.name,to:G.to,class:Yi(["block px-3 py-2 rounded-md text-base font-medium",[V.$route.path===G.to?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"]]),onClick:z[4]||(z[4]=ue=>l.value=!1)},{default:vc(()=>[Ni(Ht(G.name),1)]),_:2},1032,["to","class"]))),128))]),V.$route.path==="/"?(Xe(),tt("div",B6,[Xi(uy,{onSelectLocation:K})])):yn("",!0)])):yn("",!0)])])):yn("",!0),M("main",{class:Yi([V.$route.path==="/"&&!x.value?"overflow-hidden":"overflow-auto","flex-1 flex flex-col","md:h-[calc(100vh-64px)]"])},[Xi(Kn(ib))],2),Xi(WM,{position:"bottom-left"})])}}}),R6="modulepreload",D6=function(e){return"/static/frontend/"+e},cy={},Qc=function(n,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(t.map(g=>{if(g=D6(g),g in cy)return;cy[g]=!0;const v=g.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${_}`))return;const x=document.createElement("link");if(x.rel=v?"stylesheet":R6,v||(x.as="script"),x.crossOrigin="",x.href=g,h&&x.setAttribute("nonce",h),document.head.appendChild(x),v)return new Promise((E,b)=>{x.addEventListener("load",E),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${g}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return i.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return n().catch(o)})},O6={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"},I6={class:"max-w-md w-full space-y-8"},F6={class:"space-y-4"},z6={class:"mt-1"},j6={class:"mt-1"},U6={class:"mt-1"},$6={key:0,class:"rounded-md bg-red-50 p-4"},q6={class:"flex"},V6={class:"ml-3"},G6={class:"text-sm font-medium text-red-800"},H6={key:1,class:"rounded-md bg-yellow-50 p-4"},W6={class:"flex"},Z6={class:"ml-3"},K6={class:"mt-2 text-sm text-yellow-700"},J6={class:"list-disc pl-5 space-y-1"},Y6=["disabled"],X6={class:"absolute left-0 inset-y-0 flex items-center pl-3"},Q6={key:0,class:"h-5 w-5 text-primary-500 group-hover:text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ek={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},tk=Pa({__name:"ChangePasswordForm",setup(e){const n=qp(),t=Ga(),r=Au({oldPassword:"",newPassword:"",confirmPassword:""}),i=un(!1),o=un("");Bl(()=>{var v,_;console.log("ChangePasswordForm mounted, auth state:",{isAuthenticated:t.isAuthenticated,userId:(v=t.user)==null?void 0:v.id,mustChangePassword:(_=t.user)==null?void 0:_.must_change_password})});const l=Rr(()=>{const v=[];return r.newPassword&&r.newPassword.length<8&&v.push("Le nouveau mot de passe doit contenir au moins 8 caractères"),r.newPassword&&r.confirmPassword&&r.newPassword!==r.confirmPassword&&v.push("Les mots de passe ne correspondent pas"),v}),h=Rr(()=>r.oldPassword.length>0&&r.newPassword.length>=8&&r.newPassword===r.confirmPassword);async function g(){var v,_,x,E,b,R,$,Q;if(!h.value){o.value="Veuillez corriger les erreurs avant de continuer";return}if(!((v=t.user)!=null&&v.id)){o.value="Erreur : utilisateur non identifié";return}i.value=!0,o.value="";try{console.log("Submitting password change..."),await t.changePassword(r.oldPassword,r.newPassword),console.log("Password changed successfully"),n.push("/")}catch(I){console.error("Password change failed:",I),(x=(_=I.response)==null?void 0:_.data)!=null&&x.detail?o.value=I.response.data.detail:(b=(E=I.response)==null?void 0:E.data)!=null&&b.old_password?o.value=I.response.data.old_password[0]:($=(R=I.response)==null?void 0:R.data)!=null&&$.password?o.value=I.response.data.password[0]:((Q=I.response)==null?void 0:Q.status)===401?(o.value="Session expirée, veuillez vous reconnecter",await t.logout(),n.push("/login")):o.value="Une erreur est survenue lors du changement de mot de passe"}finally{i.value=!1}}return(v,_)=>(Xe(),tt("div",O6,[M("div",I6,[_[12]||(_[12]=M("div",null,[M("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Changement de mot de passe "),M("p",{class:"mt-2 text-center text-sm text-gray-600"}," Pour des raisons de sécurité, vous devez changer votre mot de passe. ")],-1)),M("form",{class:"mt-8 space-y-6",onSubmit:Tp(g,["prevent"])},[M("div",F6,[M("div",null,[_[3]||(_[3]=M("label",{for:"old-password",class:"block text-sm font-medium text-gray-700"},"Ancien mot de passe",-1)),M("div",z6,[Dn(M("input",{id:"old-password","onUpdate:modelValue":_[0]||(_[0]=x=>r.oldPassword=x),name:"old-password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre mot de passe actuel"},null,512),[[Mr,r.oldPassword]])])]),M("div",null,[_[4]||(_[4]=M("label",{for:"new-password",class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),M("div",j6,[Dn(M("input",{id:"new-password","onUpdate:modelValue":_[1]||(_[1]=x=>r.newPassword=x),name:"new-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Entrez votre nouveau mot de passe"},null,512),[[Mr,r.newPassword]])]),_[5]||(_[5]=M("p",{class:"mt-1 text-sm text-gray-500"}," Le mot de passe doit contenir au moins 8 caractères ",-1))]),M("div",null,[_[6]||(_[6]=M("label",{for:"confirm-password",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),M("div",U6,[Dn(M("input",{id:"confirm-password","onUpdate:modelValue":_[2]||(_[2]=x=>r.confirmPassword=x),name:"confirm-password",type:"password",required:"",autocomplete:"new-password",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Confirmez votre nouveau mot de passe"},null,512),[[Mr,r.confirmPassword]])])])]),o.value?(Xe(),tt("div",$6,[M("div",q6,[_[7]||(_[7]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",V6,[M("h3",G6,Ht(o.value),1)])])])):yn("",!0),l.value.length>0?(Xe(),tt("div",H6,[M("div",W6,[_[9]||(_[9]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),M("div",Z6,[_[8]||(_[8]=M("h3",{class:"text-sm font-medium text-yellow-800"},"Attention",-1)),M("div",K6,[M("ul",J6,[(Xe(!0),tt(Un,null,kr(l.value,(x,E)=>(Xe(),tt("li",{key:E},Ht(x),1))),128))])])])])])):yn("",!0),M("div",null,[M("button",{type:"submit",disabled:i.value||!h.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50"},[M("span",X6,[i.value?(Xe(),tt("svg",ek,_[11]||(_[11]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(Xe(),tt("svg",Q6,_[10]||(_[10]=[M("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),Ni(" "+Ht(i.value?"Modification en cours...":"Changer le mot de passe"),1)],8,Y6)])],32)])]))}}),Eg="/static/frontend/assets/logo.svg",nk={class:"min-h-screen bg-white from-blue-50 to-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},rk={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},ik={class:"bg-white py-8 px-6 shadow-lg rounded-md sm:px-10"},sk={key:0,class:"rounded-md bg-red-50 p-4"},ok={class:"flex"},ak={class:"ml-3"},lk={class:"text-sm font-medium text-red-800"},uk={class:"mt-1"},ck={class:"mt-1 relative"},hk=["type"],fk={key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},dk={key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},pk={class:"flex items-center justify-between"},gk={class:"flex items-center"},mk={class:"text-sm"},vk=["disabled"],yk={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},_k=Pa({__name:"LoginView",setup(e){const n=qp(),t=Ga(),r=un(!1),i=un(null),o=un(!1),l=Au({username:"",password:"",rememberMe:!1});Bl(async()=>{var g;console.log("LoginView mounted"),console.log("INITIAL_STATE:",window.INITIAL_STATE);try{if((g=window.INITIAL_STATE)!=null&&g.isAuthenticated){console.log("User is authenticated, redirecting to home"),n.push("/");return}await t.restoreSession()&&(console.log("Session restored, redirecting to home"),n.push("/"))}catch(v){console.error("Error during initialization:",v),v.value=null}});async function h(){var g,v,_,x,E,b,R,$,Q;r.value=!0,i.value=null;try{if(!l.username||!l.password){i.value="Veuillez remplir tous les champs";return}await t.login(l.username,l.password),(g=t.user)!=null&&g.must_change_password?n.push("/change-password"):n.push("/")}catch(I){console.error("Login error:",I),((v=I==null?void 0:I.response)==null?void 0:v.status)===500?i.value="Le service est temporairement indisponible. Veuillez réessayer dans quelques instants.":((_=I==null?void 0:I.response)==null?void 0:_.status)===401||((x=I==null?void 0:I.response)==null?void 0:x.status)===403?i.value="Identifiants incorrects. Veuillez vérifier votre nom d'utilisateur et mot de passe.":(b=(E=I==null?void 0:I.response)==null?void 0:E.data)!=null&&b.detail?i.value=I.response.data.detail:(Q=($=(R=I==null?void 0:I.response)==null?void 0:R.data)==null?void 0:$.non_field_errors)!=null&&Q[0]?i.value=I.response.data.non_field_errors[0]:(I==null?void 0:I.message)==="Network Error"?i.value="Impossible de se connecter au serveur. Veuillez vérifier votre connexion internet.":i.value="Une erreur est survenue lors de la connexion. Veuillez réessayer."}finally{r.value=!1}}return(g,v)=>{const _=VL("router-link");return Xe(),tt("div",nk,[v[12]||(v[12]=M("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[M("img",{src:Eg,alt:"TagMap Logo",class:"mx-auto h-40 w-auto transition-transform duration-300 hover:scale-110"}),M("h2",{class:"mt-2 text-center text-3xl font-bold text-gray-800"}," TagMap "),M("p",{class:"mt-2 text-center text-sm text-gray-600"}," Connectez-vous pour accéder à votre espace ")],-1)),M("div",rk,[M("div",ik,[M("form",{class:"space-y-6",onSubmit:Tp(h,["prevent"])},[i.value?(Xe(),tt("div",sk,[M("div",ok,[v[4]||(v[4]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",ak,[M("h3",lk,Ht(i.value),1)])])])):yn("",!0),M("div",null,[v[5]||(v[5]=M("label",{for:"username",class:"block text-sm font-medium text-gray-700"}," Nom d'utilisateur ",-1)),M("div",uk,[Dn(M("input",{id:"username","onUpdate:modelValue":v[0]||(v[0]=x=>l.username=x),name:"username",type:"text",required:"",autocomplete:"username",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm","aria-label":"Nom d'utilisateur"},null,512),[[Mr,l.username]])])]),M("div",null,[v[8]||(v[8]=M("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," Mot de passe ",-1)),M("div",ck,[Dn(M("input",{id:"password","onUpdate:modelValue":v[1]||(v[1]=x=>l.password=x),type:o.value?"text":"password",name:"password",required:"",autocomplete:"current-password",class:"appearance-none block w-full h-11 px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm pr-10","aria-label":"Mot de passe"},null,8,hk),[[lC,l.password]]),M("button",{type:"button",onClick:v[2]||(v[2]=x=>o.value=!o.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center","aria-label":"Afficher/masquer le mot de passe"},[o.value?(Xe(),tt("svg",fk,v[6]||(v[6]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(Xe(),tt("svg",dk,v[7]||(v[7]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])))])])]),M("div",pk,[M("div",gk,[Dn(M("input",{id:"remember-me","onUpdate:modelValue":v[3]||(v[3]=x=>l.rememberMe=x),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","aria-label":"Se souvenir de moi"},null,512),[[u2,l.rememberMe]]),v[9]||(v[9]=M("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),M("div",mk,[Xi(_,{to:"/forgot-password",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors duration-200"},{default:vc(()=>v[10]||(v[10]=[Ni(" Mot de passe oublié ? ")])),_:1})])]),M("div",null,[M("button",{type:"submit",disabled:r.value,class:"w-full h-11 flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Se connecter"},[r.value?(Xe(),tt("svg",yk,v[11]||(v[11]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yn("",!0),Ni(" "+Ht(r.value?"Connexion en cours...":"Se connecter"),1)],8,vk)])],32)])])])}}});var Ag={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,n){(function(t,r){r(n)})(qo,function(t){var r="1.9.4";function i(s){var f,w,T,J;for(w=1,T=arguments.length;w<T;w++){J=arguments[w];for(f in J)s[f]=J[f]}return s}var o=Object.create||function(){function s(){}return function(f){return s.prototype=f,new s}}();function l(s,f){var w=Array.prototype.slice;if(s.bind)return s.bind.apply(s,w.call(arguments,1));var T=w.call(arguments,2);return function(){return s.apply(f,T.length?T.concat(w.call(arguments)):arguments)}}var h=0;function g(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function v(s,f,w){var T,J,_e,ot;return ot=function(){T=!1,J&&(_e.apply(w,J),J=!1)},_e=function(){T?J=arguments:(s.apply(w,arguments),setTimeout(ot,f),T=!0)},_e}function _(s,f,w){var T=f[1],J=f[0],_e=T-J;return s===T&&w?s:((s-J)%_e+_e)%_e+J}function x(){return!1}function E(s,f){if(f===!1)return s;var w=Math.pow(10,f===void 0?6:f);return Math.round(s*w)/w}function b(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function R(s){return b(s).split(/\s+/)}function $(s,f){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var w in f)s.options[w]=f[w];return s.options}function Q(s,f,w){var T=[];for(var J in s)T.push(encodeURIComponent(w?J.toUpperCase():J)+"="+encodeURIComponent(s[J]));return(!f||f.indexOf("?")===-1?"?":"&")+T.join("&")}var I=/\{ *([\w_ -]+) *\}/g;function W(s,f){return s.replace(I,function(w,T){var J=f[T];if(J===void 0)throw new Error("No value provided for variable "+w);return typeof J=="function"&&(J=J(f)),J})}var ge=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function Se(s,f){for(var w=0;w<s.length;w++)if(s[w]===f)return w;return-1}var De="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ye(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var Ve=0;function O(s){var f=+new Date,w=Math.max(0,16-(f-Ve));return Ve=f+w,window.setTimeout(s,w)}var K=window.requestAnimationFrame||Ye("RequestAnimationFrame")||O,ce=window.cancelAnimationFrame||Ye("CancelAnimationFrame")||Ye("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function H(s,f,w){if(w&&K===O)s.call(f);else return K.call(window,l(s,f))}function D(s){s&&ce.call(window,s)}var V={__proto__:null,extend:i,create:o,bind:l,get lastId(){return h},stamp:g,throttle:v,wrapNum:_,falseFn:x,formatNum:E,trim:b,splitWords:R,setOptions:$,getParamString:Q,template:W,isArray:ge,indexOf:Se,emptyImageUrl:De,requestFn:K,cancelFn:ce,requestAnimFrame:H,cancelAnimFrame:D};function z(){}z.extend=function(s){var f=function(){$(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},w=f.__super__=this.prototype,T=o(w);T.constructor=f,f.prototype=T;for(var J in this)Object.prototype.hasOwnProperty.call(this,J)&&J!=="prototype"&&J!=="__super__"&&(f[J]=this[J]);return s.statics&&i(f,s.statics),s.includes&&(U(s.includes),i.apply(null,[T].concat(s.includes))),i(T,s),delete T.statics,delete T.includes,T.options&&(T.options=w.options?o(w.options):{},i(T.options,s.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){w.callInitHooks&&w.callInitHooks.call(this),this._initHooksCalled=!0;for(var _e=0,ot=T._initHooks.length;_e<ot;_e++)T._initHooks[_e].call(this)}},f},z.include=function(s){var f=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=f,this.mergeOptions(s.options)),this},z.mergeOptions=function(s){return i(this.prototype.options,s),this},z.addInitHook=function(s){var f=Array.prototype.slice.call(arguments,1),w=typeof s=="function"?s:function(){this[s].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(w),this};function U(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=ge(s)?s:[s];for(var f=0;f<s.length;f++)s[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(s,f,w){if(typeof s=="object")for(var T in s)this._on(T,s[T],f);else{s=R(s);for(var J=0,_e=s.length;J<_e;J++)this._on(s[J],f,w)}return this},off:function(s,f,w){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var T in s)this._off(T,s[T],f);else{s=R(s);for(var J=arguments.length===1,_e=0,ot=s.length;_e<ot;_e++)J?this._off(s[_e]):this._off(s[_e],f,w)}return this},_on:function(s,f,w,T){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(s,f,w)===!1){w===this&&(w=void 0);var J={fn:f,ctx:w};T&&(J.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(J)}},_off:function(s,f,w){var T,J,_e;if(this._events&&(T=this._events[s],!!T)){if(arguments.length===1){if(this._firingCount)for(J=0,_e=T.length;J<_e;J++)T[J].fn=x;delete this._events[s];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var ot=this._listens(s,f,w);if(ot!==!1){var Tt=T[ot];this._firingCount&&(Tt.fn=x,this._events[s]=T=T.slice()),T.splice(ot,1)}}},fire:function(s,f,w){if(!this.listens(s,w))return this;var T=i({},f,{type:s,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var J=this._events[s];if(J){this._firingCount=this._firingCount+1||1;for(var _e=0,ot=J.length;_e<ot;_e++){var Tt=J[_e],jt=Tt.fn;Tt.once&&this.off(s,jt,Tt.ctx),jt.call(Tt.ctx||this,T)}this._firingCount--}}return w&&this._propagateEvent(T),this},listens:function(s,f,w,T){typeof s!="string"&&console.warn('"string" type argument expected');var J=f;typeof f!="function"&&(T=!!f,J=void 0,w=void 0);var _e=this._events&&this._events[s];if(_e&&_e.length&&this._listens(s,J,w)!==!1)return!0;if(T){for(var ot in this._eventParents)if(this._eventParents[ot].listens(s,f,w,T))return!0}return!1},_listens:function(s,f,w){if(!this._events)return!1;var T=this._events[s]||[];if(!f)return!!T.length;w===this&&(w=void 0);for(var J=0,_e=T.length;J<_e;J++)if(T[J].fn===f&&T[J].ctx===w)return J;return!1},once:function(s,f,w){if(typeof s=="object")for(var T in s)this._on(T,s[T],f,!0);else{s=R(s);for(var J=0,_e=s.length;J<_e;J++)this._on(s[J],f,w,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[g(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[g(s)],this},_propagateEvent:function(s){for(var f in this._eventParents)this._eventParents[f].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var ue=z.extend(G);function ie(s,f,w){this.x=w?Math.round(s):s,this.y=w?Math.round(f):f}var Ae=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(s){return this.clone()._add(Me(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(Me(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ie(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ie(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ae(this.x),this.y=Ae(this.y),this},distanceTo:function(s){s=Me(s);var f=s.x-this.x,w=s.y-this.y;return Math.sqrt(f*f+w*w)},equals:function(s){return s=Me(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=Me(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+E(this.x)+", "+E(this.y)+")"}};function Me(s,f,w){return s instanceof ie?s:ge(s)?new ie(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ie(s.x,s.y):new ie(s,f,w)}function st(s,f){if(s)for(var w=f?[s,f]:s,T=0,J=w.length;T<J;T++)this.extend(w[T])}st.prototype={extend:function(s){var f,w;if(!s)return this;if(s instanceof ie||typeof s[0]=="number"||"x"in s)f=w=Me(s);else if(s=X(s),f=s.min,w=s.max,!f||!w)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=w.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(w.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(w.y,this.max.y)),this},getCenter:function(s){return Me((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return Me(this.min.x,this.max.y)},getTopRight:function(){return Me(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var f,w;return typeof s[0]=="number"||s instanceof ie?s=Me(s):s=X(s),s instanceof st?(f=s.min,w=s.max):f=w=s,f.x>=this.min.x&&w.x<=this.max.x&&f.y>=this.min.y&&w.y<=this.max.y},intersects:function(s){s=X(s);var f=this.min,w=this.max,T=s.min,J=s.max,_e=J.x>=f.x&&T.x<=w.x,ot=J.y>=f.y&&T.y<=w.y;return _e&&ot},overlaps:function(s){s=X(s);var f=this.min,w=this.max,T=s.min,J=s.max,_e=J.x>f.x&&T.x<w.x,ot=J.y>f.y&&T.y<w.y;return _e&&ot},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var f=this.min,w=this.max,T=Math.abs(f.x-w.x)*s,J=Math.abs(f.y-w.y)*s;return X(Me(f.x-T,f.y-J),Me(w.x+T,w.y+J))},equals:function(s){return s?(s=X(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function X(s,f){return!s||s instanceof st?s:new st(s,f)}function Ee(s,f){if(s)for(var w=f?[s,f]:s,T=0,J=w.length;T<J;T++)this.extend(w[T])}Ee.prototype={extend:function(s){var f=this._southWest,w=this._northEast,T,J;if(s instanceof Z)T=s,J=s;else if(s instanceof Ee){if(T=s._southWest,J=s._northEast,!T||!J)return this}else return s?this.extend(he(s)||N(s)):this;return!f&&!w?(this._southWest=new Z(T.lat,T.lng),this._northEast=new Z(J.lat,J.lng)):(f.lat=Math.min(T.lat,f.lat),f.lng=Math.min(T.lng,f.lng),w.lat=Math.max(J.lat,w.lat),w.lng=Math.max(J.lng,w.lng)),this},pad:function(s){var f=this._southWest,w=this._northEast,T=Math.abs(f.lat-w.lat)*s,J=Math.abs(f.lng-w.lng)*s;return new Ee(new Z(f.lat-T,f.lng-J),new Z(w.lat+T,w.lng+J))},getCenter:function(){return new Z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Z(this.getNorth(),this.getWest())},getSouthEast:function(){return new Z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Z||"lat"in s?s=he(s):s=N(s);var f=this._southWest,w=this._northEast,T,J;return s instanceof Ee?(T=s.getSouthWest(),J=s.getNorthEast()):T=J=s,T.lat>=f.lat&&J.lat<=w.lat&&T.lng>=f.lng&&J.lng<=w.lng},intersects:function(s){s=N(s);var f=this._southWest,w=this._northEast,T=s.getSouthWest(),J=s.getNorthEast(),_e=J.lat>=f.lat&&T.lat<=w.lat,ot=J.lng>=f.lng&&T.lng<=w.lng;return _e&&ot},overlaps:function(s){s=N(s);var f=this._southWest,w=this._northEast,T=s.getSouthWest(),J=s.getNorthEast(),_e=J.lat>f.lat&&T.lat<w.lat,ot=J.lng>f.lng&&T.lng<w.lng;return _e&&ot},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,f){return s?(s=N(s),this._southWest.equals(s.getSouthWest(),f)&&this._northEast.equals(s.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function N(s,f){return s instanceof Ee?s:new Ee(s,f)}function Z(s,f,w){if(isNaN(s)||isNaN(f))throw new Error("Invalid LatLng object: ("+s+", "+f+")");this.lat=+s,this.lng=+f,w!==void 0&&(this.alt=+w)}Z.prototype={equals:function(s,f){if(!s)return!1;s=he(s);var w=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return w<=(f===void 0?1e-9:f)},toString:function(s){return"LatLng("+E(this.lat,s)+", "+E(this.lng,s)+")"},distanceTo:function(s){return te.distance(this,he(s))},wrap:function(){return te.wrapLatLng(this)},toBounds:function(s){var f=180*s/40075017,w=f/Math.cos(Math.PI/180*this.lat);return N([this.lat-f,this.lng-w],[this.lat+f,this.lng+w])},clone:function(){return new Z(this.lat,this.lng,this.alt)}};function he(s,f,w){return s instanceof Z?s:ge(s)&&typeof s[0]!="object"?s.length===3?new Z(s[0],s[1],s[2]):s.length===2?new Z(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Z(s.lat,"lng"in s?s.lng:s.lon,s.alt):f===void 0?null:new Z(s,f,w)}var ne={latLngToPoint:function(s,f){var w=this.projection.project(s),T=this.scale(f);return this.transformation._transform(w,T)},pointToLatLng:function(s,f){var w=this.scale(f),T=this.transformation.untransform(s,w);return this.projection.unproject(T)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var f=this.projection.bounds,w=this.scale(s),T=this.transformation.transform(f.min,w),J=this.transformation.transform(f.max,w);return new st(T,J)},infinite:!1,wrapLatLng:function(s){var f=this.wrapLng?_(s.lng,this.wrapLng,!0):s.lng,w=this.wrapLat?_(s.lat,this.wrapLat,!0):s.lat,T=s.alt;return new Z(w,f,T)},wrapLatLngBounds:function(s){var f=s.getCenter(),w=this.wrapLatLng(f),T=f.lat-w.lat,J=f.lng-w.lng;if(T===0&&J===0)return s;var _e=s.getSouthWest(),ot=s.getNorthEast(),Tt=new Z(_e.lat-T,_e.lng-J),jt=new Z(ot.lat-T,ot.lng-J);return new Ee(Tt,jt)}},te=i({},ne,{wrapLng:[-180,180],R:6371e3,distance:function(s,f){var w=Math.PI/180,T=s.lat*w,J=f.lat*w,_e=Math.sin((f.lat-s.lat)*w/2),ot=Math.sin((f.lng-s.lng)*w/2),Tt=_e*_e+Math.cos(T)*Math.cos(J)*ot*ot,jt=2*Math.atan2(Math.sqrt(Tt),Math.sqrt(1-Tt));return this.R*jt}}),ee=6378137,se={R:ee,MAX_LATITUDE:85.0511287798,project:function(s){var f=Math.PI/180,w=this.MAX_LATITUDE,T=Math.max(Math.min(w,s.lat),-w),J=Math.sin(T*f);return new ie(this.R*s.lng*f,this.R*Math.log((1+J)/(1-J))/2)},unproject:function(s){var f=180/Math.PI;return new Z((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*f,s.x*f/this.R)},bounds:function(){var s=ee*Math.PI;return new st([-s,-s],[s,s])}()};function Pe(s,f,w,T){if(ge(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=f,this._c=w,this._d=T}Pe.prototype={transform:function(s,f){return this._transform(s.clone(),f)},_transform:function(s,f){return f=f||1,s.x=f*(this._a*s.x+this._b),s.y=f*(this._c*s.y+this._d),s},untransform:function(s,f){return f=f||1,new ie((s.x/f-this._b)/this._a,(s.y/f-this._d)/this._c)}};function oe(s,f,w,T){return new Pe(s,f,w,T)}var re=i({},te,{code:"EPSG:3857",projection:se,transformation:function(){var s=.5/(Math.PI*se.R);return oe(s,.5,-s,.5)}()}),xe=i({},re,{code:"EPSG:900913"});function ye(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function le(s,f){var w="",T,J,_e,ot,Tt,jt;for(T=0,_e=s.length;T<_e;T++){for(Tt=s[T],J=0,ot=Tt.length;J<ot;J++)jt=Tt[J],w+=(J?"L":"M")+jt.x+" "+jt.y;w+=f?kt.svg?"z":"x":""}return w||"M0 0"}var Ue=document.documentElement.style,Ie="ActiveXObject"in window,Ce=Ie&&!document.addEventListener,qe="msLaunchUri"in navigator&&!("documentMode"in document),Re=Qn("webkit"),rt=Qn("android"),Ze=Qn("android 2")||Qn("android 3"),gt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_t=rt&&Qn("Google")&&gt<537&&!("AudioNode"in window),$t=!!window.opera,tn=!qe&&Qn("chrome"),Qe=Qn("gecko")&&!Re&&!$t&&!Ie,Yt=!tn&&Qn("safari"),Qt=Qn("phantom"),Zt="OTransition"in Ue,wt=navigator.platform.indexOf("Win")===0,He=Ie&&"transition"in Ue,Kt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ze,on="MozPerspective"in Ue,Bn=!window.L_DISABLE_3D&&(He||Kt||on)&&!Zt&&!Qt,kn=typeof orientation<"u"||Qn("mobile"),et=kn&&Re,On=kn&&Kt,Nn=!window.PointerEvent&&window.MSPointerEvent,mn=!!(window.PointerEvent||Nn),Pn="ontouchstart"in window||!!window.TouchEvent,zr=!window.L_NO_TOUCH&&(Pn||mn),Gn=kn&&$t,Dt=kn&&Qe,xr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,lr=function(){var s=!1;try{var f=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",x,f),window.removeEventListener("testPassiveEventSupport",x,f)}catch{}return s}(),hi=function(){return!!document.createElement("canvas").getContext}(),Ri=!!(document.createElementNS&&ye("svg").createSVGRect),Fn=!!Ri&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),xi=!Ri&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var f=s.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}(),Lr=navigator.platform.indexOf("Mac")===0,Gr=navigator.platform.indexOf("Linux")===0;function Qn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var kt={ie:Ie,ielt9:Ce,edge:qe,webkit:Re,android:rt,android23:Ze,androidStock:_t,opera:$t,chrome:tn,gecko:Qe,safari:Yt,phantom:Qt,opera12:Zt,win:wt,ie3d:He,webkit3d:Kt,gecko3d:on,any3d:Bn,mobile:kn,mobileWebkit:et,mobileWebkit3d:On,msPointer:Nn,pointer:mn,touch:zr,touchNative:Pn,mobileOpera:Gn,mobileGecko:Dt,retina:xr,passiveEvents:lr,canvas:hi,svg:Ri,vml:xi,inlineSvg:Fn,mac:Lr,linux:Gr},Ei=kt.msPointer?"MSPointerDown":"pointerdown",Ai=kt.msPointer?"MSPointerMove":"pointermove",fi=kt.msPointer?"MSPointerUp":"pointerup",ei=kt.msPointer?"MSPointerCancel":"pointercancel",Di={touchstart:Ei,touchmove:Ai,touchend:fi,touchcancel:ei},Qi={touchstart:mi,touchmove:si,touchend:si,touchcancel:si},Yn={},Mi=!1;function Xs(s,f,w){return f==="touchstart"&&Dr(),Qi[f]?(w=Qi[f].bind(this,w),s.addEventListener(Di[f],w,!1),w):(console.warn("wrong event specified:",f),x)}function Ps(s,f,w){if(!Di[f]){console.warn("wrong event specified:",f);return}s.removeEventListener(Di[f],w,!1)}function Tr(s){Yn[s.pointerId]=s}function Cn(s){Yn[s.pointerId]&&(Yn[s.pointerId]=s)}function di(s){delete Yn[s.pointerId]}function Dr(){Mi||(document.addEventListener(Ei,Tr,!0),document.addEventListener(Ai,Cn,!0),document.addEventListener(fi,di,!0),document.addEventListener(ei,di,!0),Mi=!0)}function si(s,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var w in Yn)f.touches.push(Yn[w]);f.changedTouches=[f],s(f)}}function mi(s,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&or(f),si(s,f)}function Es(s){var f={},w,T;for(T in s)w=s[T],f[T]=w&&w.bind?w.bind(s):w;return s=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var is=200;function pr(s,f){s.addEventListener("dblclick",f);var w=0,T;function J(_e){if(_e.detail!==1){T=_e.detail;return}if(!(_e.pointerType==="mouse"||_e.sourceCapabilities&&!_e.sourceCapabilities.firesTouchEvents)){var ot=fa(_e);if(!(ot.some(function(jt){return jt instanceof HTMLLabelElement&&jt.attributes.for})&&!ot.some(function(jt){return jt instanceof HTMLInputElement||jt instanceof HTMLSelectElement}))){var Tt=Date.now();Tt-w<=is?(T++,T===2&&f(Es(_e))):T=1,w=Tt}}}return s.addEventListener("click",J),{dblclick:f,simDblclick:J}}function fo(s,f){s.removeEventListener("dblclick",f.dblclick),s.removeEventListener("click",f.simDblclick)}var ti=Ao(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ki=Ao(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Br=ki==="webkitTransition"||ki==="OTransition"?ki+"End":"transitionend";function _n(s){return typeof s=="string"?document.getElementById(s):s}function Xt(s,f){var w=s.style[f]||s.currentStyle&&s.currentStyle[f];if((!w||w==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(s,null);w=T?T[f]:null}return w==="auto"?null:w}function Tn(s,f,w){var T=document.createElement(s);return T.className=f||"",w&&w.appendChild(T),T}function In(s){var f=s.parentNode;f&&f.removeChild(s)}function Oi(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function es(s){var f=s.parentNode;f&&f.lastChild!==s&&f.appendChild(s)}function ss(s){var f=s.parentNode;f&&f.firstChild!==s&&f.insertBefore(s,f.firstChild)}function ps(s,f){if(s.classList!==void 0)return s.classList.contains(f);var w=$r(s);return w.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(w)}function tr(s,f){if(s.classList!==void 0)for(var w=R(f),T=0,J=w.length;T<J;T++)s.classList.add(w[T]);else if(!ps(s,f)){var _e=$r(s);pi(s,(_e?_e+" ":"")+f)}}function pn(s,f){s.classList!==void 0?s.classList.remove(f):pi(s,b((" "+$r(s)+" ").replace(" "+f+" "," ")))}function pi(s,f){s.className.baseVal===void 0?s.className=f:s.className.baseVal=f}function $r(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function oi(s,f){"opacity"in s.style?s.style.opacity=f:"filter"in s.style&&Qs(s,f)}function Qs(s,f){var w=!1,T="DXImageTransform.Microsoft.Alpha";try{w=s.filters.item(T)}catch{if(f===1)return}f=Math.round(f*100),w?(w.Enabled=f!==100,w.Opacity=f):s.style.filter+=" progid:"+T+"(opacity="+f+")"}function Ao(s){for(var f=document.documentElement.style,w=0;w<s.length;w++)if(s[w]in f)return s[w];return!1}function oo(s,f,w){var T=f||new ie(0,0);s.style[ti]=(kt.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(w?" scale("+w+")":"")}function vi(s,f){s._leaflet_pos=f,kt.any3d?oo(s,f):(s.style.left=f.x+"px",s.style.top=f.y+"px")}function As(s){return s._leaflet_pos||new ie(0,0)}var ao,os,Ea;if("onselectstart"in document)ao=function(){ur(window,"selectstart",or)},os=function(){Or(window,"selectstart",or)};else{var jr=Ao(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ao=function(){if(jr){var s=document.documentElement.style;Ea=s[jr],s[jr]="none"}},os=function(){jr&&(document.documentElement.style[jr]=Ea,Ea=void 0)}}function lo(){ur(window,"dragstart",or)}function Li(){Or(window,"dragstart",or)}var Vo,ca;function Wa(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ts(),Vo=s,ca=s.style.outlineStyle,s.style.outlineStyle="none",ur(window,"keydown",ts))}function ts(){Vo&&(Vo.style.outlineStyle=ca,Vo=void 0,ca=void 0,Or(window,"keydown",ts))}function ru(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function hl(s){var f=s.getBoundingClientRect();return{x:f.width/s.offsetWidth||1,y:f.height/s.offsetHeight||1,boundingClientRect:f}}var ir={__proto__:null,TRANSFORM:ti,TRANSITION:ki,TRANSITION_END:Br,get:_n,getStyle:Xt,create:Tn,remove:In,empty:Oi,toFront:es,toBack:ss,hasClass:ps,addClass:tr,removeClass:pn,setClass:pi,getClass:$r,setOpacity:oi,testProp:Ao,setTransform:oo,setPosition:vi,getPosition:As,get disableTextSelection(){return ao},get enableTextSelection(){return os},disableImageDrag:lo,enableImageDrag:Li,preventOutline:Wa,restoreOutline:ts,getSizedParentNode:ru,getScale:hl};function ur(s,f,w,T){if(f&&typeof f=="object")for(var J in f)Ma(s,J,f[J],w);else{f=R(f);for(var _e=0,ot=f.length;_e<ot;_e++)Ma(s,f[_e],w,T)}return this}var po="_leaflet_events";function Or(s,f,w,T){if(arguments.length===1)Nl(s),delete s[po];else if(f&&typeof f=="object")for(var J in f)go(s,J,f[J],w);else if(f=R(f),arguments.length===2)Nl(s,function(Tt){return Se(f,Tt)!==-1});else for(var _e=0,ot=f.length;_e<ot;_e++)go(s,f[_e],w,T);return this}function Nl(s,f){for(var w in s[po]){var T=w.split(/\d/)[0];(!f||f(T))&&go(s,T,null,null,w)}}var Aa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ma(s,f,w,T){var J=f+g(w)+(T?"_"+g(T):"");if(s[po]&&s[po][J])return this;var _e=function(Tt){return w.call(T||s,Tt||window.event)},ot=_e;!kt.touchNative&&kt.pointer&&f.indexOf("touch")===0?_e=Xs(s,f,_e):kt.touch&&f==="dblclick"?_e=pr(s,_e):"addEventListener"in s?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?s.addEventListener(Aa[f]||f,_e,kt.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(_e=function(Tt){Tt=Tt||window.event,ka(s,Tt)&&ot(Tt)},s.addEventListener(Aa[f],_e,!1)):s.addEventListener(f,ot,!1):s.attachEvent("on"+f,_e),s[po]=s[po]||{},s[po][J]=_e}function go(s,f,w,T,J){J=J||f+g(w)+(T?"_"+g(T):"");var _e=s[po]&&s[po][J];if(!_e)return this;!kt.touchNative&&kt.pointer&&f.indexOf("touch")===0?Ps(s,f,_e):kt.touch&&f==="dblclick"?fo(s,_e):"removeEventListener"in s?s.removeEventListener(Aa[f]||f,_e,!1):s.detachEvent("on"+f,_e),s[po][J]=null}function ha(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Rl(s){return Ma(s,"wheel",ha),this}function Za(s){return ur(s,"mousedown touchstart dblclick contextmenu",ha),s._leaflet_disable_click=!0,this}function or(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function _r(s){return or(s),ha(s),this}function fa(s){if(s.composedPath)return s.composedPath();for(var f=[],w=s.target;w;)f.push(w),w=w.parentNode;return f}function iu(s,f){if(!f)return new ie(s.clientX,s.clientY);var w=hl(f),T=w.boundingClientRect;return new ie((s.clientX-T.left)/w.x-f.clientLeft,(s.clientY-T.top)/w.y-f.clientTop)}var Ka=kt.linux&&kt.chrome?window.devicePixelRatio:kt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fl(s){return kt.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Ka:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function ka(s,f){var w=f.relatedTarget;if(!w)return!0;try{for(;w&&w!==s;)w=w.parentNode}catch{return!1}return w!==s}var Ja={__proto__:null,on:ur,off:Or,stopPropagation:ha,disableScrollPropagation:Rl,disableClickPropagation:Za,preventDefault:or,stop:_r,getPropagationPath:fa,getMousePosition:iu,getWheelDelta:fl,isExternalTarget:ka,addListener:ur,removeListener:Or},dl=ue.extend({run:function(s,f,w,T){this.stop(),this._el=s,this._inProgress=!0,this._duration=w||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=As(s),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=H(this._animate,this),this._step()},_step:function(s){var f=+new Date-this._startTime,w=this._duration*1e3;f<w?this._runFrame(this._easeOut(f/w),s):(this._runFrame(1),this._complete())},_runFrame:function(s,f){var w=this._startPos.add(this._offset.multiplyBy(s));f&&w._round(),vi(this._el,w),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Sr=ue.extend({options:{crs:re,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,f){f=$(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(he(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ki&&kt.any3d&&!kt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ur(this._proxy,Br,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,f,w){if(f=f===void 0?this._zoom:this._limitZoom(f),s=this._limitCenter(he(s),f,this.options.maxBounds),w=w||{},this._stop(),this._loaded&&!w.reset&&w!==!0){w.animate!==void 0&&(w.zoom=i({animate:w.animate},w.zoom),w.pan=i({animate:w.animate,duration:w.duration},w.pan));var T=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,f,w.zoom):this._tryAnimatedPan(s,w.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(s,f,w.pan&&w.pan.noMoveStart),this},setZoom:function(s,f){return this._loaded?this.setView(this.getCenter(),s,{zoom:f}):(this._zoom=s,this)},zoomIn:function(s,f){return s=s||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,f)},zoomOut:function(s,f){return s=s||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,f)},setZoomAround:function(s,f,w){var T=this.getZoomScale(f),J=this.getSize().divideBy(2),_e=s instanceof ie?s:this.latLngToContainerPoint(s),ot=_e.subtract(J).multiplyBy(1-1/T),Tt=this.containerPointToLatLng(J.add(ot));return this.setView(Tt,f,{zoom:w})},_getBoundsCenterZoom:function(s,f){f=f||{},s=s.getBounds?s.getBounds():N(s);var w=Me(f.paddingTopLeft||f.padding||[0,0]),T=Me(f.paddingBottomRight||f.padding||[0,0]),J=this.getBoundsZoom(s,!1,w.add(T));if(J=typeof f.maxZoom=="number"?Math.min(f.maxZoom,J):J,J===1/0)return{center:s.getCenter(),zoom:J};var _e=T.subtract(w).divideBy(2),ot=this.project(s.getSouthWest(),J),Tt=this.project(s.getNorthEast(),J),jt=this.unproject(ot.add(Tt).divideBy(2).add(_e),J);return{center:jt,zoom:J}},fitBounds:function(s,f){if(s=N(s),!s.isValid())throw new Error("Bounds are not valid.");var w=this._getBoundsCenterZoom(s,f);return this.setView(w.center,w.zoom,f)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,f){return this.setView(s,this._zoom,{pan:f})},panBy:function(s,f){if(s=Me(s).round(),f=f||{},!s.x&&!s.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new dl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){tr(this._mapPane,"leaflet-pan-anim");var w=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,w,f.duration||.25,f.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,f,w){if(w=w||{},w.animate===!1||!kt.any3d)return this.setView(s,f,w);this._stop();var T=this.project(this.getCenter()),J=this.project(s),_e=this.getSize(),ot=this._zoom;s=he(s),f=f===void 0?ot:f;var Tt=Math.max(_e.x,_e.y),jt=Tt*this.getZoomScale(ot,f),rn=J.distanceTo(T)||1,Sn=1.42,$n=Sn*Sn;function gr(Hr){var xs=Hr?-1:1,Te=Hr?jt:Tt,$s=jt*jt-Tt*Tt+xs*$n*$n*rn*rn,Il=2*Te*$n*rn,ds=$s/Il,yr=Math.sqrt(ds*ds+1)-ds,ec=yr<1e-9?-18:Math.log(yr);return ec}function Ki(Hr){return(Math.exp(Hr)-Math.exp(-Hr))/2}function Ti(Hr){return(Math.exp(Hr)+Math.exp(-Hr))/2}function fs(Hr){return Ki(Hr)/Ti(Hr)}var wi=gr(0);function Us(Hr){return Tt*(Ti(wi)/Ti(wi+Sn*Hr))}function Tu(Hr){return Tt*(Ti(wi)*fs(wi+Sn*Hr)-Ki(wi))/$n}function Fo(Hr){return 1-Math.pow(1-Hr,1.5)}var wo=Date.now(),ho=(gr(1)-wi)/Sn,Mc=w.duration?1e3*w.duration:1e3*ho*.8;function ml(){var Hr=(Date.now()-wo)/Mc,xs=Fo(Hr)*ho;Hr<=1?(this._flyToFrame=H(ml,this),this._move(this.unproject(T.add(J.subtract(T).multiplyBy(Tu(xs)/rn)),ot),this.getScaleZoom(Tt/Us(xs),ot),{flyTo:!0})):this._move(s,f)._moveEnd(!0)}return this._moveStart(!0,w.noMoveStart),ml.call(this),this},flyToBounds:function(s,f){var w=this._getBoundsCenterZoom(s,f);return this.flyTo(w.center,w.zoom,f)},setMaxBounds:function(s){return s=N(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var f=this.options.minZoom;return this.options.minZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var f=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&f!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,f){this._enforcingBounds=!0;var w=this.getCenter(),T=this._limitCenter(w,this._zoom,N(s));return w.equals(T)||this.panTo(T,f),this._enforcingBounds=!1,this},panInside:function(s,f){f=f||{};var w=Me(f.paddingTopLeft||f.padding||[0,0]),T=Me(f.paddingBottomRight||f.padding||[0,0]),J=this.project(this.getCenter()),_e=this.project(s),ot=this.getPixelBounds(),Tt=X([ot.min.add(w),ot.max.subtract(T)]),jt=Tt.getSize();if(!Tt.contains(_e)){this._enforcingBounds=!0;var rn=_e.subtract(Tt.getCenter()),Sn=Tt.extend(_e).getSize().subtract(jt);J.x+=rn.x<0?-Sn.x:Sn.x,J.y+=rn.y<0?-Sn.y:Sn.y,this.panTo(this.unproject(J),f),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var w=this.getSize(),T=f.divideBy(2).round(),J=w.divideBy(2).round(),_e=T.subtract(J);return!_e.x&&!_e.y?this:(s.animate&&s.pan?this.panBy(_e):(s.pan&&this._rawPanBy(_e),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:w}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),w=l(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,w,s):navigator.geolocation.getCurrentPosition(f,w,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var f=s.code,w=s.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+w+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var f=s.coords.latitude,w=s.coords.longitude,T=new Z(f,w),J=T.toBounds(s.coords.accuracy*2),_e=this._locateOptions;if(_e.setView){var ot=this.getBoundsZoom(J);this.setView(T,_e.maxZoom?Math.min(ot,_e.maxZoom):ot)}var Tt={latlng:T,bounds:J,timestamp:s.timestamp};for(var jt in s.coords)typeof s.coords[jt]=="number"&&(Tt[jt]=s.coords[jt]);this.fire("locationfound",Tt)}},addHandler:function(s,f){if(!f)return this;var w=this[s]=new f(this);return this._handlers.push(w),this.options[s]&&w.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),In(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)In(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,f){var w="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),T=Tn("div",w,f||this._mapPane);return s&&(this._panes[s]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),f=this.unproject(s.getBottomLeft()),w=this.unproject(s.getTopRight());return new Ee(f,w)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,f,w){s=N(s),w=Me(w||[0,0]);var T=this.getZoom()||0,J=this.getMinZoom(),_e=this.getMaxZoom(),ot=s.getNorthWest(),Tt=s.getSouthEast(),jt=this.getSize().subtract(w),rn=X(this.project(Tt,T),this.project(ot,T)).getSize(),Sn=kt.any3d?this.options.zoomSnap:1,$n=jt.x/rn.x,gr=jt.y/rn.y,Ki=f?Math.max($n,gr):Math.min($n,gr);return T=this.getScaleZoom(Ki,T),Sn&&(T=Math.round(T/(Sn/100))*(Sn/100),T=f?Math.ceil(T/Sn)*Sn:Math.floor(T/Sn)*Sn),Math.max(J,Math.min(_e,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,f){var w=this._getTopLeftPoint(s,f);return new st(w,w.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,f){var w=this.options.crs;return f=f===void 0?this._zoom:f,w.scale(s)/w.scale(f)},getScaleZoom:function(s,f){var w=this.options.crs;f=f===void 0?this._zoom:f;var T=w.zoom(s*w.scale(f));return isNaN(T)?1/0:T},project:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(he(s),f)},unproject:function(s,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(Me(s),f)},layerPointToLatLng:function(s){var f=Me(s).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(s){var f=this.project(he(s))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(he(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(N(s))},distance:function(s,f){return this.options.crs.distance(he(s),he(f))},containerPointToLayerPoint:function(s){return Me(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return Me(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var f=this.containerPointToLayerPoint(Me(s));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(he(s)))},mouseEventToContainerPoint:function(s){return iu(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var f=this._container=_n(s);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ur(f,"scroll",this._onScroll,this),this._containerId=g(f)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&kt.any3d,tr(s,"leaflet-container"+(kt.touch?" leaflet-touch":"")+(kt.retina?" leaflet-retina":"")+(kt.ielt9?" leaflet-oldie":"")+(kt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=Xt(s,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vi(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(tr(s.markerPane,"leaflet-zoom-hide"),tr(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,f,w){vi(this._mapPane,new ie(0,0));var T=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var J=this._zoom!==f;this._moveStart(J,w)._move(s,f)._moveEnd(J),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(s,f){return s&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(s,f,w,T){f===void 0&&(f=this._zoom);var J=this._zoom!==f;return this._zoom=f,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),T?w&&w.pinch&&this.fire("zoom",w):((J||w&&w.pinch)&&this.fire("zoom",w),this.fire("move",w)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){vi(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[g(this._container)]=this;var f=s?Or:ur;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),kt.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=H(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,f){for(var w=[],T,J=f==="mouseout"||f==="mouseover",_e=s.target||s.srcElement,ot=!1;_e;){if(T=this._targets[g(_e)],T&&(f==="click"||f==="preclick")&&this._draggableMoved(T)){ot=!0;break}if(T&&T.listens(f,!0)&&(J&&!ka(_e,s)||(w.push(T),J))||_e===this._container)break;_e=_e.parentNode}return!w.length&&!ot&&!J&&this.listens(f,!0)&&(w=[this]),w},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var f=s.target||s.srcElement;if(!(!this._loaded||f._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(f))){var w=s.type;w==="mousedown"&&Wa(f),this._fireDOMEvent(s,w)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,f,w){if(s.type==="click"){var T=i({},s);T.type="preclick",this._fireDOMEvent(T,T.type,w)}var J=this._findEventTargets(s,f);if(w){for(var _e=[],ot=0;ot<w.length;ot++)w[ot].listens(f,!0)&&_e.push(w[ot]);J=_e.concat(J)}if(J.length){f==="contextmenu"&&or(s);var Tt=J[0],jt={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var rn=Tt.getLatLng&&(!Tt._radius||Tt._radius<=10);jt.containerPoint=rn?this.latLngToContainerPoint(Tt.getLatLng()):this.mouseEventToContainerPoint(s),jt.layerPoint=this.containerPointToLayerPoint(jt.containerPoint),jt.latlng=rn?Tt.getLatLng():this.layerPointToLatLng(jt.layerPoint)}for(ot=0;ot<J.length;ot++)if(J[ot].fire(f,jt,!0),jt.originalEvent._stopped||J[ot].options.bubblingMouseEvents===!1&&Se(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,f=this._handlers.length;s<f;s++)this._handlers[s].disable()},whenReady:function(s,f){return this._loaded?s.call(f||this,{target:this}):this.on("load",s,f),this},_getMapPanePos:function(){return As(this._mapPane)||new ie(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,f){var w=s&&f!==void 0?this._getNewPixelOrigin(s,f):this.getPixelOrigin();return w.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,f){var w=this.getSize()._divideBy(2);return this.project(s,f)._subtract(w)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,f,w){var T=this._getNewPixelOrigin(w,f);return this.project(s,f)._subtract(T)},_latLngBoundsToNewLayerBounds:function(s,f,w){var T=this._getNewPixelOrigin(w,f);return X([this.project(s.getSouthWest(),f)._subtract(T),this.project(s.getNorthWest(),f)._subtract(T),this.project(s.getSouthEast(),f)._subtract(T),this.project(s.getNorthEast(),f)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,f,w){if(!w)return s;var T=this.project(s,f),J=this.getSize().divideBy(2),_e=new st(T.subtract(J),T.add(J)),ot=this._getBoundsOffset(_e,w,f);return Math.abs(ot.x)<=1&&Math.abs(ot.y)<=1?s:this.unproject(T.add(ot),f)},_limitOffset:function(s,f){if(!f)return s;var w=this.getPixelBounds(),T=new st(w.min.add(s),w.max.add(s));return s.add(this._getBoundsOffset(T,f))},_getBoundsOffset:function(s,f,w){var T=X(this.project(f.getNorthEast(),w),this.project(f.getSouthWest(),w)),J=T.min.subtract(s.min),_e=T.max.subtract(s.max),ot=this._rebound(J.x,-_e.x),Tt=this._rebound(J.y,-_e.y);return new ie(ot,Tt)},_rebound:function(s,f){return s+f>0?Math.round(s-f)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(f))},_limitZoom:function(s){var f=this.getMinZoom(),w=this.getMaxZoom(),T=kt.any3d?this.options.zoomSnap:1;return T&&(s=Math.round(s/T)*T),Math.max(f,Math.min(w,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,f){var w=this._getCenterOffset(s)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(w)?!1:(this.panBy(w,f),!0)},_createAnimProxy:function(){var s=this._proxy=Tn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(f){var w=ti,T=this._proxy.style[w];oo(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),T===this._proxy.style[w]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){In(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),f=this.getZoom();oo(this._proxy,this.project(s,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,f,w){if(this._animatingZoom)return!0;if(w=w||{},!this._zoomAnimated||w.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(f),J=this._getCenterOffset(s)._divideBy(1-1/T);return w.animate!==!0&&!this.getSize().contains(J)?!1:(H(function(){this._moveStart(!0,w.noMoveStart||!1)._animateZoom(s,f,!0)},this),!0)},_animateZoom:function(s,f,w,T){this._mapPane&&(w&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=f,tr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:f,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ii(s,f){return new Sr(s,f)}var Wn=z.extend({options:{position:"topright"},initialize:function(s){$(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var f=this._map;return f&&f.removeControl(this),this.options.position=s,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var f=this._container=this.onAdd(s),w=this.getPosition(),T=s._controlCorners[w];return tr(f,"leaflet-control"),w.indexOf("bottom")!==-1?T.insertBefore(f,T.firstChild):T.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(In(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Fi=function(s){return new Wn(s)};Sr.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},f="leaflet-",w=this._controlContainer=Tn("div",f+"control-container",this._container);function T(J,_e){var ot=f+J+" "+f+_e;s[J+_e]=Tn("div",ot,w)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)In(this._controlCorners[s]);In(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ta=Wn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,f,w,T){return w<T?-1:T<w?1:0}},initialize:function(s,f,w){$(this,w),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in s)this._addLayer(s[T],T);for(T in f)this._addLayer(f[T],T,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Wn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,f){return this._addLayer(s,f),this._map?this._update():this},addOverlay:function(s,f){return this._addLayer(s,f,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var f=this._getLayer(g(s));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){tr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(tr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):pn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",f=this._container=Tn("div",s),w=this.options.collapsed;f.setAttribute("aria-haspopup",!0),Za(f),Rl(f);var T=this._section=Tn("section",s+"-list");w&&(this._map.on("click",this.collapse,this),ur(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var J=this._layersLink=Tn("a",s+"-toggle",f);J.href="#",J.title="Layers",J.setAttribute("role","button"),ur(J,{keydown:function(_e){_e.keyCode===13&&this._expandSafely()},click:function(_e){or(_e),this._expandSafely()}},this),w||this.expand(),this._baseLayersList=Tn("div",s+"-base",T),this._separator=Tn("div",s+"-separator",T),this._overlaysList=Tn("div",s+"-overlays",T),f.appendChild(T)},_getLayer:function(s){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&g(this._layers[f].layer)===s)return this._layers[f]},_addLayer:function(s,f,w){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:f,overlay:w}),this.options.sortLayers&&this._layers.sort(l(function(T,J){return this.options.sortFunction(T.layer,J.layer,T.name,J.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Oi(this._baseLayersList),Oi(this._overlaysList),this._layerControlInputs=[];var s,f,w,T,J=0;for(w=0;w<this._layers.length;w++)T=this._layers[w],this._addItem(T),f=f||T.overlay,s=s||!T.overlay,J+=T.overlay?0:1;return this.options.hideSingleBase&&(s=s&&J>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=f&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var f=this._getLayer(g(s.target)),w=f.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;w&&this._map.fire(w,f)},_createRadioElement:function(s,f){var w='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(f?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=w,T.firstChild},_addItem:function(s){var f=document.createElement("label"),w=this._map.hasLayer(s.layer),T;s.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=w):T=this._createRadioElement("leaflet-base-layers_"+g(this),w),this._layerControlInputs.push(T),T.layerId=g(s.layer),ur(T,"click",this._onInputClick,this);var J=document.createElement("span");J.innerHTML=" "+s.name;var _e=document.createElement("span");f.appendChild(_e),_e.appendChild(T),_e.appendChild(J);var ot=s.overlay?this._overlaysList:this._baseLayersList;return ot.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,f,w,T=[],J=[];this._handlingClick=!0;for(var _e=s.length-1;_e>=0;_e--)f=s[_e],w=this._getLayer(f.layerId).layer,f.checked?T.push(w):f.checked||J.push(w);for(_e=0;_e<J.length;_e++)this._map.hasLayer(J[_e])&&this._map.removeLayer(J[_e]);for(_e=0;_e<T.length;_e++)this._map.hasLayer(T[_e])||this._map.addLayer(T[_e]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,f,w,T=this._map.getZoom(),J=s.length-1;J>=0;J--)f=s[J],w=this._getLayer(f.layerId).layer,f.disabled=w.options.minZoom!==void 0&&T<w.options.minZoom||w.options.maxZoom!==void 0&&T>w.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,ur(s,"click",or),this.expand();var f=this;setTimeout(function(){Or(s,"click",or),f._preventClick=!1})}}),Go=function(s,f,w){return new Ta(s,f,w)},yi=Wn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var f="leaflet-control-zoom",w=Tn("div",f+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,f+"-in",w,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,f+"-out",w,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),w},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,f,w,T,J){var _e=Tn("a",w,T);return _e.innerHTML=s,_e.href="#",_e.title=f,_e.setAttribute("role","button"),_e.setAttribute("aria-label",f),Za(_e),ur(_e,"click",_r),ur(_e,"click",J,this),ur(_e,"click",this._refocusOnMap,this),_e},_updateDisabled:function(){var s=this._map,f="leaflet-disabled";pn(this._zoomInButton,f),pn(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(tr(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(tr(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Sr.mergeOptions({zoomControl:!0}),Sr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yi,this.addControl(this.zoomControl))});var pl=function(s){return new yi(s)},Mo=Wn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var f="leaflet-control-scale",w=Tn("div",f),T=this.options;return this._addScales(T,f+"-line",w),s.on(T.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),w},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,f,w){s.metric&&(this._mScale=Tn("div",f,w)),s.imperial&&(this._iScale=Tn("div",f,w))},_update:function(){var s=this._map,f=s.getSize().y/2,w=s.distance(s.containerPointToLatLng([0,f]),s.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(w)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var f=this._getRoundNum(s),w=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,w,f/s)},_updateImperial:function(s){var f=s*3.2808399,w,T,J;f>5280?(w=f/5280,T=this._getRoundNum(w),this._updateScale(this._iScale,T+" mi",T/w)):(J=this._getRoundNum(f),this._updateScale(this._iScale,J+" ft",J/f))},_updateScale:function(s,f,w){s.style.width=Math.round(this.options.maxWidth*w)+"px",s.innerHTML=f},_getRoundNum:function(s){var f=Math.pow(10,(Math.floor(s)+"").length-1),w=s/f;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:1,f*w}}),Ya=function(s){return new Mo(s)},Xa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',uo=Wn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(kt.inlineSvg?Xa+" ":"")+"Leaflet</a>"},initialize:function(s){$(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Tn("div","leaflet-control-attribution"),Za(this._container);for(var f in s._layers)s._layers[f].getAttribution&&this.addAttribution(s._layers[f].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var f in this._attributions)this._attributions[f]&&s.push(f);var w=[];this.options.prefix&&w.push(this.options.prefix),s.length&&w.push(s.join(", ")),this._container.innerHTML=w.join(' <span aria-hidden="true">|</span> ')}}});Sr.mergeOptions({attributionControl:!0}),Sr.addInitHook(function(){this.options.attributionControl&&new uo().addTo(this)});var Qa=function(s){return new uo(s)};Wn.Layers=Ta,Wn.Zoom=yi,Wn.Scale=Mo,Wn.Attribution=uo,Fi.layers=Go,Fi.zoom=pl,Fi.scale=Ya,Fi.attribution=Qa;var Zr=z.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Zr.addTo=function(s,f){return s.addHandler(f,this),this};var su={Events:G},as=kt.touch?"touchstart mousedown":"mousedown",mo=ue.extend({options:{clickTolerance:3},initialize:function(s,f,w,T){$(this,T),this._element=s,this._dragStartTarget=f||s,this._preventOutline=w},enable:function(){this._enabled||(ur(this._dragStartTarget,as,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(mo._dragging===this&&this.finishDrag(!0),Or(this._dragStartTarget,as,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ps(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){mo._dragging===this&&this.finishDrag();return}if(!(mo._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(mo._dragging=this,this._preventOutline&&Wa(this._element),lo(),ao(),!this._moving)){this.fire("down");var f=s.touches?s.touches[0]:s,w=ru(this._element);this._startPoint=new ie(f.clientX,f.clientY),this._startPos=As(this._element),this._parentScale=hl(w);var T=s.type==="mousedown";ur(document,T?"mousemove":"touchmove",this._onMove,this),ur(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var f=s.touches&&s.touches.length===1?s.touches[0]:s,w=new ie(f.clientX,f.clientY)._subtract(this._startPoint);!w.x&&!w.y||Math.abs(w.x)+Math.abs(w.y)<this.options.clickTolerance||(w.x/=this._parentScale.x,w.y/=this._parentScale.y,or(s),this._moved||(this.fire("dragstart"),this._moved=!0,tr(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),tr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(w),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),vi(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){pn(document.body,"leaflet-dragging"),this._lastTarget&&(pn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Or(document,"mousemove touchmove",this._onMove,this),Or(document,"mouseup touchend touchcancel",this._onUp,this),Li(),os();var f=this._moved&&this._moving;this._moving=!1,mo._dragging=!1,f&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function el(s,f,w){var T,J=[1,4,2,8],_e,ot,Tt,jt,rn,Sn,$n,gr;for(_e=0,Sn=s.length;_e<Sn;_e++)s[_e]._code=zt(s[_e],f);for(Tt=0;Tt<4;Tt++){for($n=J[Tt],T=[],_e=0,Sn=s.length,ot=Sn-1;_e<Sn;ot=_e++)jt=s[_e],rn=s[ot],jt._code&$n?rn._code&$n||(gr=Ct(rn,jt,$n,f,w),gr._code=zt(gr,f),T.push(gr)):(rn._code&$n&&(gr=Ct(rn,jt,$n,f,w),gr._code=zt(gr,f),T.push(gr)),T.push(jt));s=T}return s}function vo(s,f){var w,T,J,_e,ot,Tt,jt,rn,Sn;if(!s||s.length===0)throw new Error("latlngs not passed");En(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var $n=he([0,0]),gr=N(s),Ki=gr.getNorthWest().distanceTo(gr.getSouthWest())*gr.getNorthEast().distanceTo(gr.getNorthWest());Ki<1700&&($n=Ba(s));var Ti=s.length,fs=[];for(w=0;w<Ti;w++){var wi=he(s[w]);fs.push(f.project(he([wi.lat-$n.lat,wi.lng-$n.lng])))}for(Tt=jt=rn=0,w=0,T=Ti-1;w<Ti;T=w++)J=fs[w],_e=fs[T],ot=J.y*_e.x-_e.y*J.x,jt+=(J.x+_e.x)*ot,rn+=(J.y+_e.y)*ot,Tt+=ot*3;Tt===0?Sn=fs[0]:Sn=[jt/Tt,rn/Tt];var Us=f.unproject(Me(Sn));return he([Us.lat+$n.lat,Us.lng+$n.lng])}function Ba(s){for(var f=0,w=0,T=0,J=0;J<s.length;J++){var _e=he(s[J]);f+=_e.lat,w+=_e.lng,T++}return he([f/T,w/T])}var Na={__proto__:null,clipPolygon:el,polygonCenter:vo,centroid:Ba};function Kr(s,f){if(!f||!s.length)return s.slice();var w=f*f;return s=de(s,w),s=zi(s,w),s}function eo(s,f,w){return Math.sqrt(Ln(s,f,w,!0))}function Ho(s,f,w){return Ln(s,f,w)}function zi(s,f){var w=s.length,T=typeof Uint8Array<"u"?Uint8Array:Array,J=new T(w);J[0]=J[w-1]=1,A(s,J,f,0,w-1);var _e,ot=[];for(_e=0;_e<w;_e++)J[_e]&&ot.push(s[_e]);return ot}function A(s,f,w,T,J){var _e=0,ot,Tt,jt;for(Tt=T+1;Tt<=J-1;Tt++)jt=Ln(s[Tt],s[T],s[J],!0),jt>_e&&(ot=Tt,_e=jt);_e>w&&(f[ot]=1,A(s,f,w,T,ot),A(s,f,w,ot,J))}function de(s,f){for(var w=[s[0]],T=1,J=0,_e=s.length;T<_e;T++)ln(s[T],s[J])>f&&(w.push(s[T]),J=T);return J<_e-1&&w.push(s[_e-1]),w}var We;function ut(s,f,w,T,J){var _e=T?We:zt(s,w),ot=zt(f,w),Tt,jt,rn;for(We=ot;;){if(!(_e|ot))return[s,f];if(_e&ot)return!1;Tt=_e||ot,jt=Ct(s,f,Tt,w,J),rn=zt(jt,w),Tt===_e?(s=jt,_e=rn):(f=jt,ot=rn)}}function Ct(s,f,w,T,J){var _e=f.x-s.x,ot=f.y-s.y,Tt=T.min,jt=T.max,rn,Sn;return w&8?(rn=s.x+_e*(jt.y-s.y)/ot,Sn=jt.y):w&4?(rn=s.x+_e*(Tt.y-s.y)/ot,Sn=Tt.y):w&2?(rn=jt.x,Sn=s.y+ot*(jt.x-s.x)/_e):w&1&&(rn=Tt.x,Sn=s.y+ot*(Tt.x-s.x)/_e),new ie(rn,Sn,J)}function zt(s,f){var w=0;return s.x<f.min.x?w|=1:s.x>f.max.x&&(w|=2),s.y<f.min.y?w|=4:s.y>f.max.y&&(w|=8),w}function ln(s,f){var w=f.x-s.x,T=f.y-s.y;return w*w+T*T}function Ln(s,f,w,T){var J=f.x,_e=f.y,ot=w.x-J,Tt=w.y-_e,jt=ot*ot+Tt*Tt,rn;return jt>0&&(rn=((s.x-J)*ot+(s.y-_e)*Tt)/jt,rn>1?(J=w.x,_e=w.y):rn>0&&(J+=ot*rn,_e+=Tt*rn)),ot=s.x-J,Tt=s.y-_e,T?ot*ot+Tt*Tt:new ie(J,_e)}function En(s){return!ge(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Hn(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),En(s)}function nr(s,f){var w,T,J,_e,ot,Tt,jt,rn;if(!s||s.length===0)throw new Error("latlngs not passed");En(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Sn=he([0,0]),$n=N(s),gr=$n.getNorthWest().distanceTo($n.getSouthWest())*$n.getNorthEast().distanceTo($n.getNorthWest());gr<1700&&(Sn=Ba(s));var Ki=s.length,Ti=[];for(w=0;w<Ki;w++){var fs=he(s[w]);Ti.push(f.project(he([fs.lat-Sn.lat,fs.lng-Sn.lng])))}for(w=0,T=0;w<Ki-1;w++)T+=Ti[w].distanceTo(Ti[w+1])/2;if(T===0)rn=Ti[0];else for(w=0,_e=0;w<Ki-1;w++)if(ot=Ti[w],Tt=Ti[w+1],J=ot.distanceTo(Tt),_e+=J,_e>T){jt=(_e-T)/J,rn=[Tt.x-jt*(Tt.x-ot.x),Tt.y-jt*(Tt.y-ot.y)];break}var wi=f.unproject(Me(rn));return he([wi.lat+Sn.lat,wi.lng+Sn.lng])}var mr={__proto__:null,simplify:Kr,pointToSegmentDistance:eo,closestPointOnSegment:Ho,clipSegment:ut,_getEdgeIntersection:Ct,_getBitCode:zt,_sqClosestPointOnSegment:Ln,isFlat:En,_flat:Hn,polylineCenter:nr},gi={project:function(s){return new ie(s.lng,s.lat)},unproject:function(s){return new Z(s.y,s.x)},bounds:new st([-180,-90],[180,90])},qr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new st([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var f=Math.PI/180,w=this.R,T=s.lat*f,J=this.R_MINOR/w,_e=Math.sqrt(1-J*J),ot=_e*Math.sin(T),Tt=Math.tan(Math.PI/4-T/2)/Math.pow((1-ot)/(1+ot),_e/2);return T=-w*Math.log(Math.max(Tt,1e-10)),new ie(s.lng*f*w,T)},unproject:function(s){for(var f=180/Math.PI,w=this.R,T=this.R_MINOR/w,J=Math.sqrt(1-T*T),_e=Math.exp(-s.y/w),ot=Math.PI/2-2*Math.atan(_e),Tt=0,jt=.1,rn;Tt<15&&Math.abs(jt)>1e-7;Tt++)rn=J*Math.sin(ot),rn=Math.pow((1-rn)/(1+rn),J/2),jt=Math.PI/2-2*Math.atan(_e*rn)-ot,ot+=jt;return new Z(ot*f,s.x*f/w)}},Jr={__proto__:null,LonLat:gi,Mercator:qr,SphericalMercator:se},ji=i({},te,{code:"EPSG:3395",projection:qr,transformation:function(){var s=.5/(Math.PI*qr.R);return oe(s,.5,-s,.5)}()}),Hi=i({},te,{code:"EPSG:4326",projection:gi,transformation:oe(1/180,1,-1/180,.5)}),to=i({},ne,{projection:gi,transformation:oe(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,f){var w=f.lng-s.lng,T=f.lat-s.lat;return Math.sqrt(w*w+T*T)},infinite:!0});ne.Earth=te,ne.EPSG3395=ji,ne.EPSG3857=re,ne.EPSG900913=xe,ne.EPSG4326=Hi,ne.Simple=to;var vr=ue.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[g(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[g(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var f=s.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var w=this.getEvents();f.on(w,this),this.once("remove",function(){f.off(w,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Sr.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var f=g(s);return this._layers[f]?this:(this._layers[f]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var f=g(s);return this._layers[f]?(this._loaded&&s.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return g(s)in this._layers},eachLayer:function(s,f){for(var w in this._layers)s.call(f,this._layers[w]);return this},_addLayers:function(s){s=s?ge(s)?s:[s]:[];for(var f=0,w=s.length;f<w;f++)this.addLayer(s[f])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[g(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var f=g(s);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,f=-1/0,w=this._getZoomSpan();for(var T in this._zoomBoundLayers){var J=this._zoomBoundLayers[T].options;s=J.minZoom===void 0?s:Math.min(s,J.minZoom),f=J.maxZoom===void 0?f:Math.max(f,J.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=s===1/0?void 0:s,w!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gs=vr.extend({initialize:function(s,f){$(this,f),this._layers={};var w,T;if(s)for(w=0,T=s.length;w<T;w++)this.addLayer(s[w])},addLayer:function(s){var f=this.getLayerId(s);return this._layers[f]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var f=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(s){var f=typeof s=="number"?s:this.getLayerId(s);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var f=Array.prototype.slice.call(arguments,1),w,T;for(w in this._layers)T=this._layers[w],T[s]&&T[s].apply(T,f);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,f){for(var w in this._layers)s.call(f,this._layers[w]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return g(s)}}),Ra=function(s,f){return new gs(s,f)},Ms=gs.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),gs.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),gs.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ee;for(var f in this._layers){var w=this._layers[f];s.extend(w.getBounds?w.getBounds():w.getLatLng())}return s}}),gl=function(s,f){return new Ms(s,f)},ko=z.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){$(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,f){var w=this._getIconUrl(s);if(!w){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(w,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(T,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(s,f){var w=this.options,T=w[f+"Size"];typeof T=="number"&&(T=[T,T]);var J=Me(T),_e=Me(f==="shadow"&&w.shadowAnchor||w.iconAnchor||J&&J.divideBy(2,!0));s.className="leaflet-marker-"+f+" "+(w.className||""),_e&&(s.style.marginLeft=-_e.x+"px",s.style.marginTop=-_e.y+"px"),J&&(s.style.width=J.x+"px",s.style.height=J.y+"px")},_createImg:function(s,f){return f=f||document.createElement("img"),f.src=s,f},_getIconUrl:function(s){return kt.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Dl(s){return new ko(s)}var da=ko.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof da.imagePath!="string"&&(da.imagePath=this._detectIconPath()),(this.options.imagePath||da.imagePath)+ko.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var f=function(w,T,J){var _e=T.exec(w);return _e&&_e[J]};return s=f(s,/^url\((['"])?(.+)\1\)$/,2),s&&f(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Tn("div","leaflet-default-icon-path",document.body),f=Xt(s,"background-image")||Xt(s,"backgroundImage");if(document.body.removeChild(s),f=this._stripUrl(f),f)return f;var w=document.querySelector('link[href$="leaflet.css"]');return w?w.href.substring(0,w.href.length-11-1):""}}),pa=Zr.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new mo(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),tr(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var f=this._marker,w=f._map,T=this._marker.options.autoPanSpeed,J=this._marker.options.autoPanPadding,_e=As(f._icon),ot=w.getPixelBounds(),Tt=w.getPixelOrigin(),jt=X(ot.min._subtract(Tt).add(J),ot.max._subtract(Tt).subtract(J));if(!jt.contains(_e)){var rn=Me((Math.max(jt.max.x,_e.x)-jt.max.x)/(ot.max.x-jt.max.x)-(Math.min(jt.min.x,_e.x)-jt.min.x)/(ot.min.x-jt.min.x),(Math.max(jt.max.y,_e.y)-jt.max.y)/(ot.max.y-jt.max.y)-(Math.min(jt.min.y,_e.y)-jt.min.y)/(ot.min.y-jt.min.y)).multiplyBy(T);w.panBy(rn,{animate:!1}),this._draggable._newPos._add(rn),this._draggable._startPos._add(rn),vi(f._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=H(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=H(this._adjustPan.bind(this,s)))},_onDrag:function(s){var f=this._marker,w=f._shadow,T=As(f._icon),J=f._map.layerPointToLatLng(T);w&&vi(w,T),f._latlng=J,s.latlng=J,s.oldLatLng=this._oldLatLng,f.fire("move",s).fire("drag",s)},_onDragEnd:function(s){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Wi=vr.extend({options:{icon:new da,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,f){$(this,f),this._latlng=he(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),w=s.icon.createIcon(this._icon),T=!1;w!==this._icon&&(this._icon&&this._removeIcon(),T=!0,s.title&&(w.title=s.title),w.tagName==="IMG"&&(w.alt=s.alt||"")),tr(w,f),s.keyboard&&(w.tabIndex="0",w.setAttribute("role","button")),this._icon=w,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ur(w,"focus",this._panOnFocus,this);var J=s.icon.createShadow(this._shadow),_e=!1;J!==this._shadow&&(this._removeShadow(),_e=!0),J&&(tr(J,f),J.alt=""),this._shadow=J,s.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),J&&_e&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Or(this._icon,"focus",this._panOnFocus,this),In(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&In(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&vi(this._icon,s),this._shadow&&vi(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(tr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pa)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pa(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&oi(this._icon,s),this._shadow&&oi(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var f=this.options.icon.options,w=f.iconSize?Me(f.iconSize):Me(0,0),T=f.iconAnchor?Me(f.iconAnchor):Me(0,0);s.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:w.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function To(s,f){return new Wi(s,f)}var no=vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return $(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fs=no.extend({options:{fill:!0,radius:10},initialize:function(s,f){$(this,f),this._latlng=he(s),this._radius=this.options.radius},setLatLng:function(s){var f=this._latlng;return this._latlng=he(s),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var f=s&&s.radius||this._radius;return no.prototype.setStyle.call(this,s),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,f=this._radiusY||s,w=this._clickTolerance(),T=[s+w,f+w];this._pxBounds=new st(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Da(s,f){return new Fs(s,f)}var ms=Fs.extend({initialize:function(s,f,w){if(typeof f=="number"&&(f=i({},w,{radius:f})),$(this,f),this._latlng=he(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:no.prototype.setStyle,_project:function(){var s=this._latlng.lng,f=this._latlng.lat,w=this._map,T=w.options.crs;if(T.distance===te.distance){var J=Math.PI/180,_e=this._mRadius/te.R/J,ot=w.project([f+_e,s]),Tt=w.project([f-_e,s]),jt=ot.add(Tt).divideBy(2),rn=w.unproject(jt).lat,Sn=Math.acos((Math.cos(_e*J)-Math.sin(f*J)*Math.sin(rn*J))/(Math.cos(f*J)*Math.cos(rn*J)))/J;(isNaN(Sn)||Sn===0)&&(Sn=_e/Math.cos(Math.PI/180*f)),this._point=jt.subtract(w.getPixelOrigin()),this._radius=isNaN(Sn)?0:jt.x-w.project([rn,s-Sn]).x,this._radiusY=jt.y-ot.y}else{var $n=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=w.latLngToLayerPoint(this._latlng),this._radius=this._point.x-w.latLngToLayerPoint($n).x}this._updateBounds()}});function ks(s,f,w){return new ms(s,f,w)}var Ts=no.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,f){$(this,f),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var f=1/0,w=null,T=Ln,J,_e,ot=0,Tt=this._parts.length;ot<Tt;ot++)for(var jt=this._parts[ot],rn=1,Sn=jt.length;rn<Sn;rn++){J=jt[rn-1],_e=jt[rn];var $n=T(s,J,_e,!0);$n<f&&(f=$n,w=T(s,J,_e))}return w&&(w.distance=Math.sqrt(f)),w},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return nr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,f){return f=f||this._defaultShape(),s=he(s),f.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ee,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return En(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var f=[],w=En(s),T=0,J=s.length;T<J;T++)w?(f[T]=he(s[T]),this._bounds.extend(f[T])):f[T]=this._convertLatLngs(s[T]);return f},_project:function(){var s=new st;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),f=new ie(s,s);this._rawPxBounds&&(this._pxBounds=new st([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(s,f,w){var T=s[0]instanceof Z,J=s.length,_e,ot;if(T){for(ot=[],_e=0;_e<J;_e++)ot[_e]=this._map.latLngToLayerPoint(s[_e]),w.extend(ot[_e]);f.push(ot)}else for(_e=0;_e<J;_e++)this._projectLatlngs(s[_e],f,w)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,w,T,J,_e,ot,Tt,jt;for(w=0,J=0,_e=this._rings.length;w<_e;w++)for(jt=this._rings[w],T=0,ot=jt.length;T<ot-1;T++)Tt=ut(jt[T],jt[T+1],s,T,!0),Tt&&(f[J]=f[J]||[],f[J].push(Tt[0]),(Tt[1]!==jt[T+1]||T===ot-2)&&(f[J].push(Tt[1]),J++))}},_simplifyPoints:function(){for(var s=this._parts,f=this.options.smoothFactor,w=0,T=s.length;w<T;w++)s[w]=Kr(s[w],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,f){var w,T,J,_e,ot,Tt,jt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(w=0,_e=this._parts.length;w<_e;w++)for(Tt=this._parts[w],T=0,ot=Tt.length,J=ot-1;T<ot;J=T++)if(!(!f&&T===0)&&eo(s,Tt[J],Tt[T])<=jt)return!0;return!1}});function ou(s,f){return new Ts(s,f)}Ts._flat=Hn;var ns=Ts.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var f=Ts.prototype._convertLatLngs.call(this,s),w=f.length;return w>=2&&f[0]instanceof Z&&f[0].equals(f[w-1])&&f.pop(),f},_setLatLngs:function(s){Ts.prototype._setLatLngs.call(this,s),En(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return En(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,f=this.options.weight,w=new ie(f,f);if(s=new st(s.min.subtract(w),s.max.add(w)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,J=this._rings.length,_e;T<J;T++)_e=el(this._rings[T],s,!0),_e.length&&this._parts.push(_e)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var f=!1,w,T,J,_e,ot,Tt,jt,rn;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(_e=0,jt=this._parts.length;_e<jt;_e++)for(w=this._parts[_e],ot=0,rn=w.length,Tt=rn-1;ot<rn;Tt=ot++)T=w[ot],J=w[Tt],T.y>s.y!=J.y>s.y&&s.x<(J.x-T.x)*(s.y-T.y)/(J.y-T.y)+T.x&&(f=!f);return f||Ts.prototype._containsPoint.call(this,s,!0)}});function Wo(s,f){return new ns(s,f)}var vs=Ms.extend({initialize:function(s,f){$(this,f),this._layers={},s&&this.addData(s)},addData:function(s){var f=ge(s)?s:s.features,w,T,J;if(f){for(w=0,T=f.length;w<T;w++)J=f[w],(J.geometries||J.geometry||J.features||J.coordinates)&&this.addData(J);return this}var _e=this.options;if(_e.filter&&!_e.filter(s))return this;var ot=ys(s,_e);return ot?(ot.feature=bs(s),ot.defaultOptions=ot.options,this.resetStyle(ot),_e.onEachFeature&&_e.onEachFeature(s,ot),this.addLayer(ot)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(f){this._setLayerStyle(f,s)},this)},_setLayerStyle:function(s,f){s.setStyle&&(typeof f=="function"&&(f=f(s.feature)),s.setStyle(f))}});function ys(s,f){var w=s.type==="Feature"?s.geometry:s,T=w?w.coordinates:null,J=[],_e=f&&f.pointToLayer,ot=f&&f.coordsToLatLng||Ko,Tt,jt,rn,Sn;if(!T&&!w)return null;switch(w.type){case"Point":return Tt=ot(T),Zo(_e,s,Tt,f);case"MultiPoint":for(rn=0,Sn=T.length;rn<Sn;rn++)Tt=ot(T[rn]),J.push(Zo(_e,s,Tt,f));return new Ms(J);case"LineString":case"MultiLineString":return jt=_s(T,w.type==="LineString"?0:1,ot),new Ts(jt,f);case"Polygon":case"MultiPolygon":return jt=_s(T,w.type==="Polygon"?1:2,ot),new ns(jt,f);case"GeometryCollection":for(rn=0,Sn=w.geometries.length;rn<Sn;rn++){var $n=ys({geometry:w.geometries[rn],type:"Feature",properties:s.properties},f);$n&&J.push($n)}return new Ms(J);case"FeatureCollection":for(rn=0,Sn=w.features.length;rn<Sn;rn++){var gr=ys(w.features[rn],f);gr&&J.push(gr)}return new Ms(J);default:throw new Error("Invalid GeoJSON object.")}}function Zo(s,f,w,T){return s?s(f,w):new Wi(w,T&&T.markersInheritOptions&&T)}function Ko(s){return new Z(s[1],s[0],s[2])}function _s(s,f,w){for(var T=[],J=0,_e=s.length,ot;J<_e;J++)ot=f?_s(s[J],f-1,w):(w||Ko)(s[J]),T.push(ot);return T}function ls(s,f){return s=he(s),s.alt!==void 0?[E(s.lng,f),E(s.lat,f),E(s.alt,f)]:[E(s.lng,f),E(s.lat,f)]}function Bo(s,f,w,T){for(var J=[],_e=0,ot=s.length;_e<ot;_e++)J.push(f?Bo(s[_e],En(s[_e])?0:f-1,w,T):ls(s[_e],T));return!f&&w&&J.length>0&&J.push(J[0].slice()),J}function ro(s,f){return s.feature?i({},s.feature,{geometry:f}):bs(f)}function bs(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var bt={toGeoJSON:function(s){return ro(this,{type:"Point",coordinates:ls(this.getLatLng(),s)})}};Wi.include(bt),ms.include(bt),Fs.include(bt),Ts.include({toGeoJSON:function(s){var f=!En(this._latlngs),w=Bo(this._latlngs,f?1:0,!1,s);return ro(this,{type:(f?"Multi":"")+"LineString",coordinates:w})}}),ns.include({toGeoJSON:function(s){var f=!En(this._latlngs),w=f&&!En(this._latlngs[0]),T=Bo(this._latlngs,w?2:f?1:0,!0,s);return f||(T=[T]),ro(this,{type:(w?"Multi":"")+"Polygon",coordinates:T})}}),gs.include({toMultiPoint:function(s){var f=[];return this.eachLayer(function(w){f.push(w.toGeoJSON(s).geometry.coordinates)}),ro(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(s){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(s);var w=f==="GeometryCollection",T=[];return this.eachLayer(function(J){if(J.toGeoJSON){var _e=J.toGeoJSON(s);if(w)T.push(_e.geometry);else{var ot=bs(_e);ot.type==="FeatureCollection"?T.push.apply(T,ot.features):T.push(ot)}}}),w?ro(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function qt(s,f){return new vs(s,f)}var Bt=qt,wn=vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,f,w){this._url=s,this._bounds=N(f),$(this,w)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(tr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){In(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&es(this._image),this},bringToBack:function(){return this._map&&ss(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=N(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",f=this._image=s?this._url:Tn("img");if(tr(f,"leaflet-image-layer"),this._zoomAnimated&&tr(f,"leaflet-zoom-animated"),this.options.className&&tr(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(s){var f=this._map.getZoomScale(s.zoom),w=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;oo(this._image,w,f)},_reset:function(){var s=this._image,f=new st(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),w=f.getSize();vi(s,f.min),s.style.width=w.x+"px",s.style.height=w.y+"px"},_updateOpacity:function(){oi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),zn=function(s,f,w){return new wn(s,f,w)},sr=wn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",f=this._image=s?this._url:Tn("video");if(tr(f,"leaflet-image-layer"),this._zoomAnimated&&tr(f,"leaflet-zoom-animated"),this.options.className&&tr(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onloadeddata=l(this.fire,this,"load"),s){for(var w=f.getElementsByTagName("source"),T=[],J=0;J<w.length;J++)T.push(w[J].src);this._url=w.length>0?T:[f.src];return}ge(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var _e=0;_e<this._url.length;_e++){var ot=Tn("source");ot.src=this._url[_e],f.appendChild(ot)}}});function _i(s,f,w){return new sr(s,f,w)}var Yr=wn.extend({_initImage:function(){var s=this._image=this._url;tr(s,"leaflet-image-layer"),this._zoomAnimated&&tr(s,"leaflet-zoom-animated"),this.options.className&&tr(s,this.options.className),s.onselectstart=x,s.onmousemove=x}});function tl(s,f,w){return new Yr(s,f,w)}var Bs=vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,f){s&&(s instanceof Z||ge(s))?(this._latlng=he(s),$(this,f)):($(this,s),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&oi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&oi(this._container,1),this.bringToFront(),this.options.interactive&&(tr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(oi(this._container,0),this._removeTimeout=setTimeout(l(In,void 0,this._container),200)):In(this._container),this.options.interactive&&(pn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=he(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&es(this._container),this},bringToBack:function(){return this._map&&ss(this._container),this},_prepareOpen:function(s){var f=this._source;if(!f._map)return!1;if(f instanceof Ms){f=null;var w=this._source._layers;for(var T in w)if(w[T]._map){f=w[T];break}if(!f)return!1;this._source=f}if(!s)if(f.getCenter)s=f.getCenter();else if(f.getLatLng)s=f.getLatLng();else if(f.getBounds)s=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")s.innerHTML=f;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),f=Me(this.options.offset),w=this._getAnchor();this._zoomAnimated?vi(this._container,s.add(w)):f=f.add(s).add(w);var T=this._containerBottom=-f.y,J=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=T+"px",this._container.style.left=J+"px"}},_getAnchor:function(){return[0,0]}});Sr.include({_initOverlay:function(s,f,w,T){var J=f;return J instanceof s||(J=new s(T).setContent(f)),w&&J.setLatLng(w),J}}),vr.include({_initOverlay:function(s,f,w,T){var J=w;return J instanceof s?($(J,T),J._source=this):(J=f&&!T?f:new s(T,this),J.setContent(w)),J}});var bi=Bs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Bs.prototype.openOn.call(this,s)},onAdd:function(s){Bs.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof no||this._source.on("preclick",ha))},onRemove:function(s){Bs.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof no||this._source.off("preclick",ha))},getEvents:function(){var s=Bs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",f=this._container=Tn("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),w=this._wrapper=Tn("div",s+"-content-wrapper",f);if(this._contentNode=Tn("div",s+"-content",w),Za(f),Rl(this._contentNode),ur(f,"contextmenu",ha),this._tipContainer=Tn("div",s+"-tip-container",f),this._tip=Tn("div",s+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=Tn("a",s+"-close-button",f);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',ur(T,"click",function(J){or(J),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,f=s.style;f.width="",f.whiteSpace="nowrap";var w=s.offsetWidth;w=Math.min(w,this.options.maxWidth),w=Math.max(w,this.options.minWidth),f.width=w+1+"px",f.whiteSpace="",f.height="";var T=s.offsetHeight,J=this.options.maxHeight,_e="leaflet-popup-scrolled";J&&T>J?(f.height=J+"px",tr(s,_e)):pn(s,_e),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),w=this._getAnchor();vi(this._container,f.add(w))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,f=parseInt(Xt(this._container,"marginBottom"),10)||0,w=this._container.offsetHeight+f,T=this._containerWidth,J=new ie(this._containerLeft,-w-this._containerBottom);J._add(As(this._container));var _e=s.layerPointToContainerPoint(J),ot=Me(this.options.autoPanPadding),Tt=Me(this.options.autoPanPaddingTopLeft||ot),jt=Me(this.options.autoPanPaddingBottomRight||ot),rn=s.getSize(),Sn=0,$n=0;_e.x+T+jt.x>rn.x&&(Sn=_e.x+T-rn.x+jt.x),_e.x-Sn-Tt.x<0&&(Sn=_e.x-Tt.x),_e.y+w+jt.y>rn.y&&($n=_e.y+w-rn.y+jt.y),_e.y-$n-Tt.y<0&&($n=_e.y-Tt.y),(Sn||$n)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Sn,$n]))}},_getAnchor:function(){return Me(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),No=function(s,f){return new bi(s,f)};Sr.mergeOptions({closePopupOnClick:!0}),Sr.include({openPopup:function(s,f,w){return this._initOverlay(bi,s,f,w).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),vr.include({bindPopup:function(s,f){return this._popup=this._initOverlay(bi,this._popup,s,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ms||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){_r(s);var f=s.layer||s.target;if(this._popup._source===f&&!(f instanceof no)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=f,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Jo=Bs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Bs.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Bs.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Bs.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",f=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Tn("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+g(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var f,w,T=this._map,J=this._container,_e=T.latLngToContainerPoint(T.getCenter()),ot=T.layerPointToContainerPoint(s),Tt=this.options.direction,jt=J.offsetWidth,rn=J.offsetHeight,Sn=Me(this.options.offset),$n=this._getAnchor();Tt==="top"?(f=jt/2,w=rn):Tt==="bottom"?(f=jt/2,w=0):Tt==="center"?(f=jt/2,w=rn/2):Tt==="right"?(f=0,w=rn/2):Tt==="left"?(f=jt,w=rn/2):ot.x<_e.x?(Tt="right",f=0,w=rn/2):(Tt="left",f=jt+(Sn.x+$n.x)*2,w=rn/2),s=s.subtract(Me(f,w,!0)).add(Sn).add($n),pn(J,"leaflet-tooltip-right"),pn(J,"leaflet-tooltip-left"),pn(J,"leaflet-tooltip-top"),pn(J,"leaflet-tooltip-bottom"),tr(J,"leaflet-tooltip-"+Tt),vi(J,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&oi(this._container,s)},_animateZoom:function(s){var f=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(f)},_getAnchor:function(){return Me(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ro=function(s,f){return new Jo(s,f)};Sr.include({openTooltip:function(s,f,w){return this._initOverlay(Jo,s,f,w).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),vr.include({bindTooltip:function(s,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Jo,this._tooltip,s,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var f=s?"off":"on",w={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?w.add=this._openTooltip:(w.mouseover=this._openTooltip,w.mouseout=this.closeTooltip,w.click=this._openTooltip,this._map?this._addFocusListeners():w.add=this._addFocusListeners),this._tooltip.options.sticky&&(w.mousemove=this._moveTooltip),this[f](w),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ms||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&(ur(f,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),ur(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var f=typeof s.getElement=="function"&&s.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var f=s.latlng,w,T;this._tooltip.options.sticky&&s.originalEvent&&(w=this._map.mouseEventToContainerPoint(s.originalEvent),T=this._map.containerPointToLayerPoint(w),f=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(f)}});var Do=ko.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var f=s&&s.tagName==="DIV"?s:document.createElement("div"),w=this.options;if(w.html instanceof Element?(Oi(f),f.appendChild(w.html)):f.innerHTML=w.html!==!1?w.html:"",w.bgPos){var T=Me(w.bgPos);f.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Oo(s){return new Do(s)}ko.Default=da;var Cr=vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:kt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){$(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),In(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(es(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ss(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ie?s:new ie(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var f=this.getPane().children,w=-s(-1/0,1/0),T=0,J=f.length,_e;T<J;T++)_e=f[T].style.zIndex,f[T]!==this._container&&_e&&(w=s(w,+_e));isFinite(w)&&(this.options.zIndex=w+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!kt.ielt9){oi(this._container,this.options.opacity);var s=+new Date,f=!1,w=!1;for(var T in this._tiles){var J=this._tiles[T];if(!(!J.current||!J.loaded)){var _e=Math.min(1,(s-J.loaded)/200);oi(J.el,_e),_e<1?f=!0:(J.active?w=!0:this._onOpaqueTile(J),J.active=!0)}}w&&!this._noPrune&&this._pruneTiles(),f&&(D(this._fadeFrame),this._fadeFrame=H(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Tn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,f=this.options.maxZoom;if(s!==void 0){for(var w in this._levels)w=Number(w),this._levels[w].el.children.length||w===s?(this._levels[w].el.style.zIndex=f-Math.abs(s-w),this._onUpdateLevel(w)):(In(this._levels[w].el),this._removeTilesAtZoom(w),this._onRemoveLevel(w),delete this._levels[w]);var T=this._levels[s],J=this._map;return T||(T=this._levels[s]={},T.el=Tn("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=f,T.origin=J.project(J.unproject(J.getPixelOrigin()),s).round(),T.zoom=s,this._setZoomTransform(T,J.getCenter(),J.getZoom()),x(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var s,f,w=this._map.getZoom();if(w>this.options.maxZoom||w<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)f=this._tiles[s],f.retain=f.current;for(s in this._tiles)if(f=this._tiles[s],f.current&&!f.active){var T=f.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var f in this._tiles)this._tiles[f].coords.z===s&&this._removeTile(f)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)In(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,f,w,T){var J=Math.floor(s/2),_e=Math.floor(f/2),ot=w-1,Tt=new ie(+J,+_e);Tt.z=+ot;var jt=this._tileCoordsToKey(Tt),rn=this._tiles[jt];return rn&&rn.active?(rn.retain=!0,!0):(rn&&rn.loaded&&(rn.retain=!0),ot>T?this._retainParent(J,_e,ot,T):!1)},_retainChildren:function(s,f,w,T){for(var J=2*s;J<2*s+2;J++)for(var _e=2*f;_e<2*f+2;_e++){var ot=new ie(J,_e);ot.z=w+1;var Tt=this._tileCoordsToKey(ot),jt=this._tiles[Tt];if(jt&&jt.active){jt.retain=!0;continue}else jt&&jt.loaded&&(jt.retain=!0);w+1<T&&this._retainChildren(J,_e,w+1,T)}},_resetView:function(s){var f=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var f=this.options;return f.minNativeZoom!==void 0&&s<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<s?f.maxNativeZoom:s},_setView:function(s,f,w,T){var J=Math.round(f);this.options.maxZoom!==void 0&&J>this.options.maxZoom||this.options.minZoom!==void 0&&J<this.options.minZoom?J=void 0:J=this._clampZoom(J);var _e=this.options.updateWhenZooming&&J!==this._tileZoom;(!T||_e)&&(this._tileZoom=J,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),J!==void 0&&this._update(s),w||this._pruneTiles(),this._noPrune=!!w),this._setZoomTransforms(s,f)},_setZoomTransforms:function(s,f){for(var w in this._levels)this._setZoomTransform(this._levels[w],s,f)},_setZoomTransform:function(s,f,w){var T=this._map.getZoomScale(w,s.zoom),J=s.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(f,w)).round();kt.any3d?oo(s.el,J,T):vi(s.el,J)},_resetGrid:function(){var s=this._map,f=s.options.crs,w=this._tileSize=this.getTileSize(),T=this._tileZoom,J=this._map.getPixelWorldBounds(this._tileZoom);J&&(this._globalTileRange=this._pxBoundsToTileRange(J)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,f.wrapLng[0]],T).x/w.x),Math.ceil(s.project([0,f.wrapLng[1]],T).x/w.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([f.wrapLat[0],0],T).y/w.x),Math.ceil(s.project([f.wrapLat[1],0],T).y/w.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var f=this._map,w=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),T=f.getZoomScale(w,this._tileZoom),J=f.project(s,this._tileZoom).floor(),_e=f.getSize().divideBy(T*2);return new st(J.subtract(_e),J.add(_e))},_update:function(s){var f=this._map;if(f){var w=this._clampZoom(f.getZoom());if(s===void 0&&(s=f.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(s),J=this._pxBoundsToTileRange(T),_e=J.getCenter(),ot=[],Tt=this.options.keepBuffer,jt=new st(J.getBottomLeft().subtract([Tt,-Tt]),J.getTopRight().add([Tt,-Tt]));if(!(isFinite(J.min.x)&&isFinite(J.min.y)&&isFinite(J.max.x)&&isFinite(J.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var rn in this._tiles){var Sn=this._tiles[rn].coords;(Sn.z!==this._tileZoom||!jt.contains(new ie(Sn.x,Sn.y)))&&(this._tiles[rn].current=!1)}if(Math.abs(w-this._tileZoom)>1){this._setView(s,w);return}for(var $n=J.min.y;$n<=J.max.y;$n++)for(var gr=J.min.x;gr<=J.max.x;gr++){var Ki=new ie(gr,$n);if(Ki.z=this._tileZoom,!!this._isValidTile(Ki)){var Ti=this._tiles[this._tileCoordsToKey(Ki)];Ti?Ti.current=!0:ot.push(Ki)}}if(ot.sort(function(wi,Us){return wi.distanceTo(_e)-Us.distanceTo(_e)}),ot.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var fs=document.createDocumentFragment();for(gr=0;gr<ot.length;gr++)this._addTile(ot[gr],fs);this._level.el.appendChild(fs)}}}},_isValidTile:function(s){var f=this._map.options.crs;if(!f.infinite){var w=this._globalTileRange;if(!f.wrapLng&&(s.x<w.min.x||s.x>w.max.x)||!f.wrapLat&&(s.y<w.min.y||s.y>w.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(s);return N(this.options.bounds).overlaps(T)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var f=this._map,w=this.getTileSize(),T=s.scaleBy(w),J=T.add(w),_e=f.unproject(T,s.z),ot=f.unproject(J,s.z);return[_e,ot]},_tileCoordsToBounds:function(s){var f=this._tileCoordsToNwSe(s),w=new Ee(f[0],f[1]);return this.options.noWrap||(w=this._map.wrapLatLngBounds(w)),w},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var f=s.split(":"),w=new ie(+f[0],+f[1]);return w.z=+f[2],w},_removeTile:function(s){var f=this._tiles[s];f&&(In(f.el),delete this._tiles[s],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){tr(s,"leaflet-tile");var f=this.getTileSize();s.style.width=f.x+"px",s.style.height=f.y+"px",s.onselectstart=x,s.onmousemove=x,kt.ielt9&&this.options.opacity<1&&oi(s,this.options.opacity)},_addTile:function(s,f){var w=this._getTilePos(s),T=this._tileCoordsToKey(s),J=this.createTile(this._wrapCoords(s),l(this._tileReady,this,s));this._initTile(J),this.createTile.length<2&&H(l(this._tileReady,this,s,null,J)),vi(J,w),this._tiles[T]={el:J,coords:s,current:!0},f.appendChild(J),this.fire("tileloadstart",{tile:J,coords:s})},_tileReady:function(s,f,w){f&&this.fire("tileerror",{error:f,tile:w,coords:s});var T=this._tileCoordsToKey(s);w=this._tiles[T],w&&(w.loaded=+new Date,this._map._fadeAnimated?(oi(w.el,0),D(this._fadeFrame),this._fadeFrame=H(this._updateOpacity,this)):(w.active=!0,this._pruneTiles()),f||(tr(w.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:w.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),kt.ielt9||!this._map._fadeAnimated?H(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var f=new ie(this._wrapX?_(s.x,this._wrapX):s.x,this._wrapY?_(s.y,this._wrapY):s.y);return f.z=s.z,f},_pxBoundsToTileRange:function(s){var f=this.getTileSize();return new st(s.min.unscaleBy(f).floor(),s.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function yo(s){return new Cr(s)}var us=Cr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,f){this._url=s,f=$(this,f),f.detectRetina&&kt.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,f){return this._url===s&&f===void 0&&(f=!0),this._url=s,f||this.redraw(),this},createTile:function(s,f){var w=document.createElement("img");return ur(w,"load",l(this._tileOnLoad,this,f,w)),ur(w,"error",l(this._tileOnError,this,f,w)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(w.referrerPolicy=this.options.referrerPolicy),w.alt="",w.src=this.getTileUrl(s),w},getTileUrl:function(s){var f={r:kt.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var w=this._globalTileRange.max.y-s.y;this.options.tms&&(f.y=w),f["-y"]=w}return W(this._url,i(f,this.options))},_tileOnLoad:function(s,f){kt.ielt9?setTimeout(l(s,this,null,f),0):s(null,f)},_tileOnError:function(s,f,w){var T=this.options.errorTileUrl;T&&f.getAttribute("src")!==T&&(f.src=T),s(w,f)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,f=this.options.maxZoom,w=this.options.zoomReverse,T=this.options.zoomOffset;return w&&(s=f-s),s+T},_getSubdomain:function(s){var f=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var s,f;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(f=this._tiles[s].el,f.onload=x,f.onerror=x,!f.complete)){f.src=De;var w=this._tiles[s].coords;In(f),delete this._tiles[s],this.fire("tileabort",{tile:f,coords:w})}},_removeTile:function(s){var f=this._tiles[s];if(f)return f.el.setAttribute("src",De),Cr.prototype._removeTile.call(this,s)},_tileReady:function(s,f,w){if(!(!this._map||w&&w.getAttribute("src")===De))return Cr.prototype._tileReady.call(this,s,f,w)}});function Xr(s,f){return new us(s,f)}var ni=us.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,f){this._url=s;var w=i({},this.defaultWmsParams);for(var T in f)T in this.options||(w[T]=f[T]);f=$(this,f);var J=f.detectRetina&&kt.retina?2:1,_e=this.getTileSize();w.width=_e.x*J,w.height=_e.y*J,this.wmsParams=w},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,us.prototype.onAdd.call(this,s)},getTileUrl:function(s){var f=this._tileCoordsToNwSe(s),w=this._crs,T=X(w.project(f[0]),w.project(f[1])),J=T.min,_e=T.max,ot=(this._wmsVersion>=1.3&&this._crs===Hi?[J.y,J.x,_e.y,_e.x]:[J.x,J.y,_e.x,_e.y]).join(","),Tt=us.prototype.getTileUrl.call(this,s);return Tt+Q(this.wmsParams,Tt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ot},setParams:function(s,f){return i(this.wmsParams,s),f||this.redraw(),this}});function Ui(s,f){return new ni(s,f)}us.WMS=ni,Xr.wms=Ui;var li=vr.extend({options:{padding:.1},initialize:function(s){$(this,s),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),tr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,f){var w=this._map.getZoomScale(f,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),J=this._map.project(this._center,f),_e=T.multiplyBy(-w).add(J).subtract(this._map._getNewPixelOrigin(s,f));kt.any3d?oo(this._container,_e,w):vi(this._container,_e)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,f=this._map.getSize(),w=this._map.containerPointToLayerPoint(f.multiplyBy(-s)).round();this._bounds=new st(w,w.add(f.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),io=li.extend({options:{tolerance:0},getEvents:function(){var s=li.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){li.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");ur(s,"mousemove",this._onMouseMove,this),ur(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ur(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,In(this._container),Or(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var f in this._layers)s=this._layers[f],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){li.prototype._update.call(this);var s=this._bounds,f=this._container,w=s.getSize(),T=kt.retina?2:1;vi(f,s.min),f.width=T*w.x,f.height=T*w.y,f.style.width=w.x+"px",f.style.height=w.y+"px",kt.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){li.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[g(s)]=s;var f=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var f=s._order,w=f.next,T=f.prev;w?w.prev=T:this._drawLast=T,T?T.next=w:this._drawFirst=w,delete s._order,delete this._layers[g(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var f=s.options.dashArray.split(/[, ]+/),w=[],T,J;for(J=0;J<f.length;J++){if(T=Number(f[J]),isNaN(T))return;w.push(T)}s.options._dashArray=w}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||H(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var f=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new st,this._redrawBounds.extend(s._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(s._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var f=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,f=this._redrawBounds;if(this._ctx.save(),f){var w=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,w.x,w.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)s=T.layer,(!f||s._pxBounds&&s._pxBounds.intersects(f))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,f){if(this._drawing){var w,T,J,_e,ot=s._parts,Tt=ot.length,jt=this._ctx;if(Tt){for(jt.beginPath(),w=0;w<Tt;w++){for(T=0,J=ot[w].length;T<J;T++)_e=ot[w][T],jt[T?"lineTo":"moveTo"](_e.x,_e.y);f&&jt.closePath()}this._fillStroke(jt,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var f=s._point,w=this._ctx,T=Math.max(Math.round(s._radius),1),J=(Math.max(Math.round(s._radiusY),1)||T)/T;J!==1&&(w.save(),w.scale(1,J)),w.beginPath(),w.arc(f.x,f.y/J,T,0,Math.PI*2,!1),J!==1&&w.restore(),this._fillStroke(w,s)}},_fillStroke:function(s,f){var w=f.options;w.fill&&(s.globalAlpha=w.fillOpacity,s.fillStyle=w.fillColor||w.color,s.fill(w.fillRule||"evenodd")),w.stroke&&w.weight!==0&&(s.setLineDash&&s.setLineDash(f.options&&f.options._dashArray||[]),s.globalAlpha=w.opacity,s.lineWidth=w.weight,s.strokeStyle=w.color,s.lineCap=w.lineCap,s.lineJoin=w.lineJoin,s.stroke())},_onClick:function(s){for(var f=this._map.mouseEventToLayerPoint(s),w,T,J=this._drawFirst;J;J=J.next)w=J.layer,w.options.interactive&&w._containsPoint(f)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(w))&&(T=w);this._fireEvent(T?[T]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,f)}},_handleMouseOut:function(s){var f=this._hoveredLayer;f&&(pn(this._container,"leaflet-interactive"),this._fireEvent([f],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,f){if(!this._mouseHoverThrottled){for(var w,T,J=this._drawFirst;J;J=J.next)w=J.layer,w.options.interactive&&w._containsPoint(f)&&(T=w);T!==this._hoveredLayer&&(this._handleMouseOut(s),T&&(tr(this._container,"leaflet-interactive"),this._fireEvent([T],s,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,f,w){this._map._fireDOMEvent(f,w||f.type,s)},_bringToFront:function(s){var f=s._order;if(f){var w=f.next,T=f.prev;if(w)w.prev=T;else return;T?T.next=w:w&&(this._drawFirst=w),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(s)}},_bringToBack:function(s){var f=s._order;if(f){var w=f.next,T=f.prev;if(T)T.next=w;else return;w?w.prev=T:T&&(this._drawLast=T),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(s)}}});function zs(s){return kt.canvas?new io(s):null}var co=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ol={_initContainer:function(){this._container=Tn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(li.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var f=s._container=co("shape");tr(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",s._path=co("path"),f.appendChild(s._path),this._updateStyle(s),this._layers[g(s)]=s},_addPath:function(s){var f=s._container;this._container.appendChild(f),s.options.interactive&&s.addInteractiveTarget(f)},_removePath:function(s){var f=s._container;In(f),s.removeInteractiveTarget(f),delete this._layers[g(s)]},_updateStyle:function(s){var f=s._stroke,w=s._fill,T=s.options,J=s._container;J.stroked=!!T.stroke,J.filled=!!T.fill,T.stroke?(f||(f=s._stroke=co("stroke")),J.appendChild(f),f.weight=T.weight+"px",f.color=T.color,f.opacity=T.opacity,T.dashArray?f.dashStyle=ge(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=T.lineCap.replace("butt","flat"),f.joinstyle=T.lineJoin):f&&(J.removeChild(f),s._stroke=null),T.fill?(w||(w=s._fill=co("fill")),J.appendChild(w),w.color=T.fillColor||T.color,w.opacity=T.fillOpacity):w&&(J.removeChild(w),s._fill=null)},_updateCircle:function(s){var f=s._point.round(),w=Math.round(s._radius),T=Math.round(s._radiusY||w);this._setPath(s,s._empty()?"M0 0":"AL "+f.x+","+f.y+" "+w+","+T+" 0,"+65535*360)},_setPath:function(s,f){s._path.v=f},_bringToFront:function(s){es(s._container)},_bringToBack:function(s){ss(s._container)}},Io=kt.vml?co:ye,Zi=li.extend({_initContainer:function(){this._container=Io("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Io("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){In(this._container),Or(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){li.prototype._update.call(this);var s=this._bounds,f=s.getSize(),w=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,w.setAttribute("width",f.x),w.setAttribute("height",f.y)),vi(w,s.min),w.setAttribute("viewBox",[s.min.x,s.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(s){var f=s._path=Io("path");s.options.className&&tr(f,s.options.className),s.options.interactive&&tr(f,"leaflet-interactive"),this._updateStyle(s),this._layers[g(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){In(s._path),s.removeInteractiveTarget(s._path),delete this._layers[g(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var f=s._path,w=s.options;f&&(w.stroke?(f.setAttribute("stroke",w.color),f.setAttribute("stroke-opacity",w.opacity),f.setAttribute("stroke-width",w.weight),f.setAttribute("stroke-linecap",w.lineCap),f.setAttribute("stroke-linejoin",w.lineJoin),w.dashArray?f.setAttribute("stroke-dasharray",w.dashArray):f.removeAttribute("stroke-dasharray"),w.dashOffset?f.setAttribute("stroke-dashoffset",w.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),w.fill?(f.setAttribute("fill",w.fillColor||w.color),f.setAttribute("fill-opacity",w.fillOpacity),f.setAttribute("fill-rule",w.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(s,f){this._setPath(s,le(s._parts,f))},_updateCircle:function(s){var f=s._point,w=Math.max(Math.round(s._radius),1),T=Math.max(Math.round(s._radiusY),1)||w,J="a"+w+","+T+" 0 1,0 ",_e=s._empty()?"M0 0":"M"+(f.x-w)+","+f.y+J+w*2+",0 "+J+-w*2+",0 ";this._setPath(s,_e)},_setPath:function(s,f){s._path.setAttribute("d",f)},_bringToFront:function(s){es(s._path)},_bringToBack:function(s){ss(s._path)}});kt.vml&&Zi.include(Ol);function ai(s){return kt.svg||kt.vml?new Zi(s):null}Sr.include({getRenderer:function(s){var f=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var f=this._paneRenderers[s];return f===void 0&&(f=this._createRenderer({pane:s}),this._paneRenderers[s]=f),f},_createRenderer:function(s){return this.options.preferCanvas&&zs(s)||ai(s)}});var ws=ns.extend({initialize:function(s,f){ns.prototype.initialize.call(this,this._boundsToLatLngs(s),f)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=N(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function js(s,f){return new ws(s,f)}Zi.create=Io,Zi.pointsToPath=le,vs.geometryToLayer=ys,vs.coordsToLatLng=Ko,vs.coordsToLatLngs=_s,vs.latLngToCoords=ls,vs.latLngsToCoords=Bo,vs.getFeature=ro,vs.asFeature=bs,Sr.mergeOptions({boxZoom:!0});var er=Zr.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){ur(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Or(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){In(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ao(),lo(),this._startPoint=this._map.mouseEventToContainerPoint(s),ur(document,{contextmenu:_r,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Tn("div","leaflet-zoom-box",this._container),tr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var f=new st(this._point,this._startPoint),w=f.getSize();vi(this._box,f.min),this._box.style.width=w.x+"px",this._box.style.height=w.y+"px"},_finish:function(){this._moved&&(In(this._box),pn(this._container,"leaflet-crosshair")),os(),Li(),Or(document,{contextmenu:_r,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Sr.addInitHook("addHandler","boxZoom",er),Sr.mergeOptions({doubleClickZoom:!0});var Yo=Zr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var f=this._map,w=f.getZoom(),T=f.options.zoomDelta,J=s.originalEvent.shiftKey?w-T:w+T;f.options.doubleClickZoom==="center"?f.setZoom(J):f.setZoomAround(s.containerPoint,J)}});Sr.addInitHook("addHandler","doubleClickZoom",Yo),Sr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Xo=Zr.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new mo(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}tr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pn(this._map._container,"leaflet-grab"),pn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=N(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var f=this._lastTime=+new Date,w=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(w),this._times.push(f),this._prunePositions(f)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,f){return s-(s-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;s.x<f.min.x&&(s.x=this._viscousLimit(s.x,f.min.x)),s.y<f.min.y&&(s.y=this._viscousLimit(s.y,f.min.y)),s.x>f.max.x&&(s.x=this._viscousLimit(s.x,f.max.x)),s.y>f.max.y&&(s.y=this._viscousLimit(s.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,f=Math.round(s/2),w=this._initialWorldOffset,T=this._draggable._newPos.x,J=(T-f+w)%s+f-w,_e=(T+f+w)%s-f-w,ot=Math.abs(J+w)<Math.abs(_e+w)?J:_e;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ot},_onDragEnd:function(s){var f=this._map,w=f.options,T=!w.inertia||s.noInertia||this._times.length<2;if(f.fire("dragend",s),T)f.fire("moveend");else{this._prunePositions(+new Date);var J=this._lastPos.subtract(this._positions[0]),_e=(this._lastTime-this._times[0])/1e3,ot=w.easeLinearity,Tt=J.multiplyBy(ot/_e),jt=Tt.distanceTo([0,0]),rn=Math.min(w.inertiaMaxSpeed,jt),Sn=Tt.multiplyBy(rn/jt),$n=rn/(w.inertiaDeceleration*ot),gr=Sn.multiplyBy(-$n/2).round();!gr.x&&!gr.y?f.fire("moveend"):(gr=f._limitOffset(gr,f.options.maxBounds),H(function(){f.panBy(gr,{duration:$n,easeLinearity:ot,noMoveStart:!0,animate:!0})}))}}});Sr.addInitHook("addHandler","dragging",Xo),Sr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _o=Zr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),ur(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Or(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,f=document.documentElement,w=s.scrollTop||f.scrollTop,T=s.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(T,w)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var f=this._panKeys={},w=this.keyCodes,T,J;for(T=0,J=w.left.length;T<J;T++)f[w.left[T]]=[-1*s,0];for(T=0,J=w.right.length;T<J;T++)f[w.right[T]]=[s,0];for(T=0,J=w.down.length;T<J;T++)f[w.down[T]]=[0,s];for(T=0,J=w.up.length;T<J;T++)f[w.up[T]]=[0,-1*s]},_setZoomDelta:function(s){var f=this._zoomKeys={},w=this.keyCodes,T,J;for(T=0,J=w.zoomIn.length;T<J;T++)f[w.zoomIn[T]]=s;for(T=0,J=w.zoomOut.length;T<J;T++)f[w.zoomOut[T]]=-s},_addHooks:function(){ur(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Or(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var f=s.keyCode,w=this._map,T;if(f in this._panKeys){if(!w._panAnim||!w._panAnim._inProgress)if(T=this._panKeys[f],s.shiftKey&&(T=Me(T).multiplyBy(3)),w.options.maxBounds&&(T=w._limitOffset(Me(T),w.options.maxBounds)),w.options.worldCopyJump){var J=w.wrapLatLng(w.unproject(w.project(w.getCenter()).add(T)));w.panTo(J)}else w.panBy(T)}else if(f in this._zoomKeys)w.setZoom(w.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&w._popup&&w._popup.options.closeOnEscapeKey)w.closePopup();else return;_r(s)}}});Sr.addInitHook("addHandler","keyboard",_o),Sr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ns=Zr.extend({addHooks:function(){ur(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Or(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var f=fl(s),w=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var T=Math.max(w-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),T),_r(s)},_performZoom:function(){var s=this._map,f=s.getZoom(),w=this._map.options.zoomSnap||0;s._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),J=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,_e=w?Math.ceil(J/w)*w:J,ot=s._limitZoom(f+(this._delta>0?_e:-_e))-f;this._delta=0,this._startTime=null,ot&&(s.options.scrollWheelZoom==="center"?s.setZoom(f+ot):s.setZoomAround(this._lastMousePos,f+ot))}});Sr.addInitHook("addHandler","scrollWheelZoom",Ns);var ku=600;Sr.mergeOptions({tapHold:kt.touchNative&&kt.safari&&kt.mobile,tapTolerance:15});var cs=Zr.extend({addHooks:function(){ur(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Or(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var f=s.touches[0];this._startPos=this._newPos=new ie(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(ur(document,"touchend",or),ur(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),ku),ur(document,"touchend touchcancel contextmenu",this._cancel,this),ur(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Or(document,"touchend",or),Or(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Or(document,"touchend touchcancel contextmenu",this._cancel,this),Or(document,"touchmove",this._onMove,this)},_onMove:function(s){var f=s.touches[0];this._newPos=new ie(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,f){var w=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});w._simulated=!0,f.target.dispatchEvent(w)}});Sr.addInitHook("addHandler","tapHold",cs),Sr.mergeOptions({touchZoom:kt.touch,bounceAtZoomLimits:!0});var hs=Zr.extend({addHooks:function(){tr(this._map._container,"leaflet-touch-zoom"),ur(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pn(this._map._container,"leaflet-touch-zoom"),Or(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var f=this._map;if(!(!s.touches||s.touches.length!==2||f._animatingZoom||this._zooming)){var w=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(w.add(T)._divideBy(2))),this._startDist=w.distanceTo(T),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),ur(document,"touchmove",this._onTouchMove,this),ur(document,"touchend touchcancel",this._onTouchEnd,this),or(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var f=this._map,w=f.mouseEventToContainerPoint(s.touches[0]),T=f.mouseEventToContainerPoint(s.touches[1]),J=w.distanceTo(T)/this._startDist;if(this._zoom=f.getScaleZoom(J,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&J<1||this._zoom>f.getMaxZoom()&&J>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,J===1)return}else{var _e=w._add(T)._divideBy(2)._subtract(this._centerPoint);if(J===1&&_e.x===0&&_e.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(_e),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var ot=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=H(ot,this,!0),or(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),Or(document,"touchmove",this._onTouchMove,this),Or(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Sr.addInitHook("addHandler","touchZoom",hs),Sr.BoxZoom=er,Sr.DoubleClickZoom=Yo,Sr.Drag=Xo,Sr.Keyboard=_o,Sr.ScrollWheelZoom=Ns,Sr.TapHold=cs,Sr.TouchZoom=hs,t.Bounds=st,t.Browser=kt,t.CRS=ne,t.Canvas=io,t.Circle=ms,t.CircleMarker=Fs,t.Class=z,t.Control=Wn,t.DivIcon=Do,t.DivOverlay=Bs,t.DomEvent=Ja,t.DomUtil=ir,t.Draggable=mo,t.Evented=ue,t.FeatureGroup=Ms,t.GeoJSON=vs,t.GridLayer=Cr,t.Handler=Zr,t.Icon=ko,t.ImageOverlay=wn,t.LatLng=Z,t.LatLngBounds=Ee,t.Layer=vr,t.LayerGroup=gs,t.LineUtil=mr,t.Map=Sr,t.Marker=Wi,t.Mixin=su,t.Path=no,t.Point=ie,t.PolyUtil=Na,t.Polygon=ns,t.Polyline=Ts,t.Popup=bi,t.PosAnimation=dl,t.Projection=Jr,t.Rectangle=ws,t.Renderer=li,t.SVG=Zi,t.SVGOverlay=Yr,t.TileLayer=us,t.Tooltip=Jo,t.Transformation=Pe,t.Util=V,t.VideoOverlay=sr,t.bind=l,t.bounds=X,t.canvas=zs,t.circle=ks,t.circleMarker=Da,t.control=Fi,t.divIcon=Oo,t.extend=i,t.featureGroup=gl,t.geoJSON=qt,t.geoJson=Bt,t.gridLayer=yo,t.icon=Dl,t.imageOverlay=zn,t.latLng=he,t.latLngBounds=N,t.layerGroup=Ra,t.map=Ii,t.marker=To,t.point=Me,t.polygon=Wo,t.polyline=ou,t.popup=No,t.rectangle=js,t.setOptions=$,t.stamp=g,t.svg=ai,t.svgOverlay=tl,t.tileLayer=Xr,t.tooltip=Ro,t.transformation=oe,t.version=r,t.videoOverlay=_i;var bo=window.L;t.noConflict=function(){return window.L=bo,this},window.L=t})})(Ag,Ag.exports);var vt=Ag.exports;const fn=sb(vt);var hy={exports:{}};(function(e,n){(function(t,r){r(n)})(qo,function(t){var r=typeof window<"u"?window:typeof qo<"u"?qo:typeof self<"u"?self:{};function i(v,_){return v(_={exports:{}},_.exports),_.exports}var o=i(function(v,_){(function(x){const E={escape:function(U){return U.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:b,mimeType:function(U){return U=b(U).toLowerCase(),function(){var G="application/font-woff",ue="image/jpeg";return{woff:G,woff2:G,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:ue,jpeg:ue,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[U]||""},dataAsUrl:function(U,G){return`data:${G};base64,`+U},isDataUrl:function(U){return U.search(/^(data:)/)!==-1},canvasToBlob:function(U){return U.toBlob?new Promise(function(ue){U.toBlob(ue)}):(G=U,new Promise(function(ue){const ie=Ve(G.toDataURL().split(",")[1]);var Ae=ie.length;const Me=new Uint8Array(Ae);for(let st=0;st<Ae;st++)Me[st]=ie.charCodeAt(st);ue(new Blob([Me],{type:"image/png"}))}));var G},resolveUrl:function(U,G){const ue=document.implementation.createHTMLDocument(),ie=ue.createElement("base"),Ae=(ue.head.appendChild(ie),ue.createElement("a"));return ue.body.appendChild(Ae),ie.href=G,Ae.href=U,Ae.href},getAndEncode:function(U){let G=De.impl.urlCache.find(function(ue){return ue.url===U});return G||(G={url:U,promise:null},De.impl.urlCache.push(G)),G.promise===null&&(De.impl.options.cacheBust&&(U+=(/\?/.test(U)?"&":"?")+new Date().getTime()),G.promise=new Promise(function(ue){const ie=De.impl.options.httpTimeout,Ae=new XMLHttpRequest;let Me;var st;function X(Ee){console.error(Ee),ue("")}Ae.onreadystatechange=function(){if(Ae.readyState===4)if(Ae.status!==200)Me?ue(Me):X(`cannot fetch resource: ${U}, status: `+Ae.status);else{const Ee=new FileReader;Ee.onloadend=function(){var N=Ee.result.split(/,/)[1];ue(N)},Ee.readAsDataURL(Ae.response)}},Ae.ontimeout=function(){Me?ue(Me):X(`timeout of ${ie}ms occured while fetching resource: `+U)},Ae.responseType="blob",Ae.timeout=ie,De.impl.options.useCredentials&&(Ae.withCredentials=!0),Ae.open("GET",U,!0),Ae.send(),De.impl.options.imagePlaceholder&&(st=De.impl.options.imagePlaceholder.split(/,/))&&st[1]&&(Me=st[1])})),G.promise},uid:function(){let U=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+U++}}(),delay:function(U){return function(G){return new Promise(function(ue){setTimeout(function(){ue(G)},U)})}},asArray:function(U){const G=[],ue=U.length;for(let ie=0;ie<ue;ie++)G.push(U[ie]);return G},escapeXhtml:function(U){return U.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(U){return U!=="data:,"?new Promise(function(G,ue){const ie=new Image;De.impl.options.useCredentials&&(ie.crossOrigin="use-credentials"),ie.onload=function(){G(ie)},ie.onerror=ue,ie.src=U}):Promise.resolve()},width:function(U){var G=R(U,"border-left-width"),ue=R(U,"border-right-width");return U.scrollWidth+G+ue},height:function(U){var G=R(U,"border-top-width"),ue=R(U,"border-bottom-width");return U.scrollHeight+G+ue}};function b(U){return(U=/\.([^\.\/]*?)(\?|$)/g.exec(U))?U[1]:""}function R(U,G){const ue=Ye(U).getPropertyValue(G);return parseFloat(ue.replace("px",""))}const $=function(){const U=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(Ae,Me,st){return G(Ae)?Promise.resolve(Ae).then(ue).then(function(X){let Ee=Promise.resolve(Ae);return X.forEach(function(N){Ee=Ee.then(function(Z){return ie(Z,N,Me,st)})}),Ee}):Promise.resolve(Ae)},shouldProcess:G,impl:{readUrls:ue,inline:ie}};function G(Ae){return Ae.search(U)!==-1}function ue(Ae){const Me=[];for(var st;(st=U.exec(Ae))!==null;)Me.push(st[1]);return Me.filter(function(X){return!E.isDataUrl(X)})}function ie(Ae,Me,st,X){return Promise.resolve(Me).then(function(Ee){return st?E.resolveUrl(Ee,st):Ee}).then(X||E.getAndEncode).then(function(Ee){return E.dataAsUrl(Ee,E.mimeType(Me))}).then(function(Ee){return Ae.replace((N=Me,new RegExp(`(url\\(['"]?)(${E.escape(N)})(['"]?\\))`,"g")),`$1${Ee}$3`);var N})}}(),Q={resolveAll:function(){return I().then(function(U){return Promise.all(U.map(function(G){return G.resolve()}))}).then(function(U){return U.join(`
`)})},impl:{readAll:I}};function I(){return Promise.resolve(E.asArray(document.styleSheets)).then(function(G){const ue=[];return G.forEach(function(ie){if(Object.getPrototypeOf(ie).hasOwnProperty("cssRules"))try{E.asArray(ie.cssRules||[]).forEach(ue.push.bind(ue))}catch(Ae){console.log("Error while reading CSS rules from "+ie.href,Ae.toString())}}),ue}).then(function(G){return G.filter(function(ue){return ue.type===CSSRule.FONT_FACE_RULE}).filter(function(ue){return $.shouldProcess(ue.style.getPropertyValue("src"))})}).then(function(G){return G.map(U)});function U(G){return{resolve:function(){var ue=(G.parentStyleSheet||{}).href;return $.inlineAll(G.cssText,ue)},src:function(){return G.style.getPropertyValue("src")}}}}const W={inlineAll:function U(G){return G instanceof Element?function(ue){const ie=ue.style.getPropertyValue("background");return ie?$.inlineAll(ie).then(function(Ae){ue.style.setProperty("background",Ae,ie)}).then(function(){return ue}):Promise.resolve(ue)}(G).then(function(){return G instanceof HTMLImageElement?ge(G).inline():Promise.all(E.asArray(G.childNodes).map(function(ue){return U(ue)}))}):Promise.resolve(G)},impl:{newImage:ge}};function ge(U){return{inline:function(G){return E.isDataUrl(U.src)?Promise.resolve():Promise.resolve(U.src).then(G||E.getAndEncode).then(function(ue){return E.dataAsUrl(ue,E.mimeType(U.src))}).then(function(ue){return new Promise(function(ie){U.onload=ie,U.onerror=ie,U.src=ue})})}}}const Se={imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1},De={toSvg:O,toPng:function(U,G){return(G=G||{}).raster=!0,K(U,G).then(function(ue){return ue.toDataURL()})},toJpeg:function(U,G){return(G=G||{}).raster=!0,K(U,G).then(function(ue){return ue.toDataURL("image/jpeg",G.quality||1)})},toBlob:function(U,G){return(G=G||{}).raster=!0,K(U,G).then(E.canvasToBlob)},toPixelData:function(U,G){return(G=G||{}).raster=!0,K(U,G).then(function(ue){return ue.getContext("2d").getImageData(0,0,E.width(U),E.height(U)).data})},toCanvas:function(U,G){return(G=G||{}).raster=!0,K(U,G||{})},impl:{fontFaces:Q,images:W,util:E,inliner:$,urlCache:[],options:{}}},Ye=(v.exports=De,x.getComputedStyle||window.getComputedStyle),Ve=x.atob||window.atob;function O(U,G){var ue=G=G||{};return ue.imagePlaceholder===void 0?De.impl.options.imagePlaceholder=Se.imagePlaceholder:De.impl.options.imagePlaceholder=ue.imagePlaceholder,ue.cacheBust===void 0?De.impl.options.cacheBust=Se.cacheBust:De.impl.options.cacheBust=ue.cacheBust,ue.useCredentials===void 0?De.impl.options.useCredentials=Se.useCredentials:De.impl.options.useCredentials=ue.useCredentials,Promise.resolve(U).then(function(ie){return function Ae(Me,st,X,Ee,N=null){return X||!st||st(Me)?Promise.resolve(Me).then(function(Z){return Z instanceof HTMLCanvasElement?E.makeImage(Z.toDataURL()):Z.nodeName==="IFRAME"?html2canvas(Z.contentDocument.body).then(he=>he.toDataURL()).then(E.makeImage):Z.cloneNode(!1)}).then(function(Z){return function(he,ne){const te=he.childNodes;return te.length===0?Promise.resolve(ne):function(ee,se){const Pe=Ye(he);let oe=Promise.resolve();return se.forEach(function(re){oe=oe.then(function(){return Ae(re,st,!1,Ee,Pe)}).then(function(xe){xe&&ee.appendChild(xe)})}),oe}(ne,E.asArray(te)).then(function(){return ne})}(Me,Z)}).then(function(Z){return function(he,ne,te){return ne instanceof Element?Promise.resolve().then(function(){(function(ee,se){const Pe=Ye(ee);Pe.cssText?(se.style.cssText=Pe.cssText,function(oe,re){re.font=oe.font,re.fontFamily=oe.fontFamily,re.fontFeatureSettings=oe.fontFeatureSettings,re.fontKerning=oe.fontKerning,re.fontSize=oe.fontSize,re.fontStretch=oe.fontStretch,re.fontStyle=oe.fontStyle,re.fontVariant=oe.fontVariant,re.fontVariantCaps=oe.fontVariantCaps,re.fontVariantEastAsian=oe.fontVariantEastAsian,re.fontVariantLigatures=oe.fontVariantLigatures,re.fontVariantNumeric=oe.fontVariantNumeric,re.fontVariationSettings=oe.fontVariationSettings,re.fontWeight=oe.fontWeight}(Pe,se.style)):(te?function(oe,re,xe,ye){const le=xe.style,Ue=oe.style;for(var Ie of re){var Ce=re.getPropertyValue(Ie),qe=Ue.getPropertyValue(Ie),Re=(Ue.setProperty(Ie,ye?"initial":"unset"),re.getPropertyValue(Ie));Re!==Ce?le.setProperty(Ie,Ce):le.removeProperty(Ie),Ue.setProperty(Ie,qe)}}(ee,Pe,se,X):function(oe,re,xe){const ye=function(Ue){if(z[Ue])return z[Ue];V||((V=document.createElement("iframe")).style.visibility="hidden",V.style.position="fixed",document.body.appendChild(V),V.contentWindow.document.write('<!DOCTYPE html><meta charset="UTF-8"><title>sandbox</title><body>'));const Ie=document.createElement(Ue),Ce=(V.contentWindow.document.body.appendChild(Ie),Ie.textContent=".",V.contentWindow.getComputedStyle(Ie)),qe={};return E.asArray(Ce).forEach(function(Re){qe[Re]=Re==="width"||Re==="height"?"auto":Ce.getPropertyValue(Re)}),V.contentWindow.document.body.removeChild(Ie),z[Ue]=qe}(xe.tagName),le=xe.style;E.asArray(oe).forEach(function(Ue){var Ie=oe.getPropertyValue(Ue);(Ie!==ye[Ue]||re&&Ie!==re.getPropertyValue(Ue))&&le.setProperty(Ue,Ie,oe.getPropertyPriority(Ue))})}(Pe,N,se),X&&(["inset-block","inset-block-start","inset-block-end"].forEach(oe=>se.style.removeProperty(oe)),["left","right","top","bottom"].forEach(oe=>{se.style.getPropertyValue(oe)&&se.style.setProperty(oe,"0px")})))})(he,ne)}).then(function(){[":before",":after"].forEach(function(ee){(function(se){const Pe=Ye(he,se),oe=Pe.getPropertyValue("content");if(oe!==""&&oe!=="none"){const re=E.uid(),xe=ne.getAttribute("class"),ye=(xe&&ne.setAttribute("class",xe+" "+re),document.createElement("style"));ye.appendChild(function(){const le=`.${re}:`+se,Ue=(Pe.cssText?function(){return`${Pe.cssText} content: ${Pe.getPropertyValue("content")};`}:function(){return E.asArray(Pe).map(function(Ie){return Ie+": "+Pe.getPropertyValue(Ie)+(Pe.getPropertyPriority(Ie)?" !important":"")}).join("; ")+";"})();return document.createTextNode(le+`{${Ue}}`)}()),ne.appendChild(ye)}})(ee)})}).then(function(){he instanceof HTMLTextAreaElement&&(ne.innerHTML=he.value),he instanceof HTMLInputElement&&ne.setAttribute("value",he.value)}).then(function(){ne instanceof SVGElement&&(ne.setAttribute("xmlns","http://www.w3.org/2000/svg"),ne instanceof SVGRectElement&&["width","height"].forEach(function(ee){const se=ne.getAttribute(ee);se&&ne.style.setProperty(ee,se)}))}).then(function(){return ne}):ne}(Me,Z,Ee)}):Promise.resolve()}(ie,G.filter,!0,!G.raster)}).then(ce).then(H).then(function(ie){G.bgcolor&&(ie.style.backgroundColor=G.bgcolor),G.width&&(ie.style.width=G.width+"px"),G.height&&(ie.style.height=G.height+"px"),G.style&&Object.keys(G.style).forEach(function(Me){ie.style[Me]=G.style[Me]});let Ae=null;return typeof G.onclone=="function"&&(Ae=G.onclone(ie)),Promise.resolve(Ae).then(function(){return ie})}).then(function(ie){return ie=ie,Ae=G.width||E.width(U),Me=G.height||E.height(U),Promise.resolve(ie).then(function(st){return st.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(st)}).then(E.escapeXhtml).then(function(st){return`<foreignObject x="0" y="0" width="100%" height="100%">${st}</foreignObject>`}).then(function(st){return`<svg xmlns="http://www.w3.org/2000/svg" width="${Ae}" height="${Me}">${st}</svg>`}).then(function(st){return"data:image/svg+xml;charset=utf-8,"+st});var Ae,Me}).then(function(ie){return De.impl.urlCache=[],ie})}function K(U,G){return O(U,G).then(E.makeImage).then(E.delay(0)).then(function(ue){var ie=typeof G.scale!="number"?1:G.scale;const Ae=function(st,X){const Ee=document.createElement("canvas");if(Ee.width=(G.width||E.width(st))*X,Ee.height=(G.height||E.height(st))*X,G.bgcolor){const N=Ee.getContext("2d");N.fillStyle=G.bgcolor,N.fillRect(0,0,Ee.width,Ee.height)}return Ee}(U,ie),Me=Ae.getContext("2d");return Me.mozImageSmoothingEnabled=!1,Me.msImageSmoothingEnabled=!1,Me.imageSmoothingEnabled=!1,ue&&(Me.scale(ie,ie),Me.drawImage(ue,0,0)),V&&(document.body.removeChild(V),V=null,D&&clearTimeout(D),D=setTimeout(()=>{D=null,z={}},2e4)),Ae})}function ce(U){return Q.resolveAll().then(function(G){const ue=document.createElement("style");return U.appendChild(ue),ue.appendChild(document.createTextNode(G)),U})}function H(U){return W.inlineAll(U).then(function(){return U})}let D=null,V=null,z={}})(r)}),l=i(function(v,_){(function(){function x(Q,I,W){var ge=new XMLHttpRequest;ge.open("GET",Q),ge.responseType="blob",ge.onload=function(){$(ge.response,I,W)},ge.onerror=function(){console.error("could not download file")},ge.send()}function E(Q){var I=new XMLHttpRequest;I.open("HEAD",Q,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function b(Q){try{Q.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Q.dispatchEvent(I)}}var R=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof r=="object"&&r.global===r?r:void 0,$=R.saveAs||(typeof window!="object"||window!==R?function(){}:"download"in HTMLAnchorElement.prototype?function(Q,I,W){var ge=R.URL||R.webkitURL,Se=document.createElement("a");I=I||Q.name||"download",Se.download=I,Se.rel="noopener",typeof Q=="string"?(Se.href=Q,Se.origin===location.origin?b(Se):E(Se.href)?x(Q,I,W):b(Se,Se.target="_blank")):(Se.href=ge.createObjectURL(Q),setTimeout(function(){ge.revokeObjectURL(Se.href)},4e4),setTimeout(function(){b(Se)},0))}:"msSaveOrOpenBlob"in navigator?function(Q,I,W){if(I=I||Q.name||"download",typeof Q!="string")navigator.msSaveOrOpenBlob(function(Se,De){return De===void 0?De={autoBom:!1}:typeof De!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),De={autoBom:!De}),De.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Se.type)?new Blob(["\uFEFF",Se],{type:Se.type}):Se}(Q,W),I);else if(E(Q))x(Q,I,W);else{var ge=document.createElement("a");ge.href=Q,ge.target="_blank",setTimeout(function(){b(ge)})}}:function(Q,I,W,ge){if((ge=ge||open("","_blank"))&&(ge.document.title=ge.document.body.innerText="downloading..."),typeof Q=="string")return x(Q,I,W);var Se=Q.type==="application/octet-stream",De=/constructor/i.test(R.HTMLElement)||R.safari,Ye=/CriOS\/[\d]+/.test(navigator.userAgent);if((Ye||Se&&De)&&typeof FileReader=="object"){var Ve=new FileReader;Ve.onloadend=function(){var ce=Ve.result;ce=Ye?ce:ce.replace(/^data:[^;]*;/,"data:attachment/file;"),ge?ge.location.href=ce:location=ce,ge=null},Ve.readAsDataURL(Q)}else{var O=R.URL||R.webkitURL,K=O.createObjectURL(Q);ge?ge.location=K:location.href=K,ge=null,setTimeout(function(){O.revokeObjectURL(K)},4e4)}});R.saveAs=$.saveAs=$,v.exports=$})()}),h=L.Control.extend({options:{cropImageByInnerWH:!0,hidden:!1,domtoimageOptions:{},position:"topleft",screenName:"screen",iconUrl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDMyIDMyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMiAzMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxnIGlkPSJjYW1lcmEiPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsOS41MDFjLTQuNDE5LDAtOCwzLjU4MS04LDhjMCw0LjQxOCwzLjU4MSw4LDgsOGM0LjQxOCwwLDgtMy41ODIsOC04UzIwLjQxOCw5LjUwMSwxNiw5LjUwMXogTTIwLjU1NSwyMS40MDZjLTIuMTU2LDIuNTE2LTUuOTQzLDIuODA3LTguNDU5LDAuNjVjLTIuNTE3LTIuMTU2LTIuODA3LTUuOTQ0LTAuNjUtOC40NTljMi4xNTUtMi41MTcsNS45NDMtMi44MDcsOC40NTktMC42NUMyMi40MiwxNS4xMDIsMjIuNzExLDE4Ljg5MSwyMC41NTUsMjEuNDA2eiIvPjxwYXRoIHN0eWxlPSJmaWxsOiMwMTAwMDI7IiBkPSJNMTYsMTMuNTAxYy0yLjIwOSwwLTMuOTk5LDEuNzkxLTQsMy45OTl2MC4wMDJjMCwwLjI3NSwwLjIyNCwwLjUsMC41LDAuNXMwLjUtMC4yMjUsMC41LTAuNVYxNy41YzAuMDAxLTEuNjU2LDEuMzQzLTIuOTk5LDMtMi45OTljMC4yNzYsMCwwLjUtMC4yMjQsMC41LTAuNVMxNi4yNzYsMTMuNTAxLDE2LDEzLjUwMXoiLz48cGF0aCBzdHlsZT0iZmlsbDojMDEwMDAyOyIgZD0iTTI5LjQ5Miw4LjU0MmwtNC4zMzQtMC43MjNsLTEuMzczLTMuNDM0QzIzLjMyNiwzLjI0LDIyLjIzMiwyLjUsMjEsMi41SDExYy0xLjIzMiwwLTIuMzI2LDAuNzQtMi43ODYsMS44ODZMNi44NDIsNy44MTlMMi41MDksOC41NDJDMS4wNTUsOC43ODMsMCwxMC4wMjcsMCwxMS41djE1YzAsMS42NTQsMS4zNDYsMywzLDNoMjZjMS42NTQsMCwzLTEuMzQ2LDMtM3YtMTVDMzIsMTAuMDI3LDMwLjk0NSw4Ljc4MywyOS40OTIsOC41NDJ6IE0zMCwyNi41YzAsMC41NTMtMC40NDcsMS0xLDFIM2MtMC41NTMsMC0xLTAuNDQ3LTEtMXYtMTVjMC0wLjQ4OSwwLjM1NC0wLjkwNiwwLjgzNi0wLjk4Nkw4LjI4LDkuNjA3bDEuNzkxLTQuNDc4QzEwLjIyNCw0Ljc1LDEwLjU5MSw0LjUsMTEsNC41aDEwYzAuNDA4LDAsMC43NzUsMC4yNDksMC45MjgsMC42MjlsMS43OTEsNC40NzhsNS40NDUsMC45MDdDMjkuNjQ2LDEwLjU5NCwzMCwxMS4wMTEsMzAsMTEuNVYyNi41eiIvPjwvZz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PC9zdmc+",hideElementsWithSelectors:[".leaflet-control-container"],onCropBorderSize:2,caption:null,captionFontSize:15,captionFont:"Arial",captionColor:"black",captionBgColor:"white",captionOffset:5,mimeType:"image/png",debugMode:!1,preventDownload:!1,onPixelDataFail:function(v){var _=v.node,x=v.error;return console.warn("Map node is very big "+_.scrollWidth+"x"+_.scrollHeight),console.warn(`Add function: SimpleMapScreenshoter({
              onPixelDataFail: function({ node, plugin, error, mapPane, domtoimageOptions }) {
                 // Solutions:
                 // decrease size of map
                 // or decrease zoom level
                 // or remove elements with big distanses
                 // and after that return image in Promise - plugin._getPixelDataOfNormalMap
                 return plugin._getPixelDataOfNormalMap(domtoimageOptions)
              }
            })`),Promise.reject(x)}},onAdd:function(){return this._container=L.DomUtil.create("div","leaflet-control-simpleMapScreenshoter"),this._link=null,this._screenState={status:1,promise:null},this.options.hidden===!1&&this._addScreenBtn(),this._onUserStartInteractWithMap=this._onUserStartInteractWithMap.bind(this),this._onUserEndInteractWithMap=this._onUserEndInteractWithMap.bind(this),this._map.on("zoomstart",this._onUserStartInteractWithMap),this._map.on("move",this._onUserStartInteractWithMap),this._map.on("zoomend",this._onUserEndInteractWithMap),this._map.on("moveend",this._onUserEndInteractWithMap),this._container},takeScreen:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"blob",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={};for(var b in this.options)x.hasOwnProperty(b)?E[b]=x[b]:E[b]=this.options[b];return this._screenState.status===2?this._screenState.promise:(this._map.fire("simpleMapScreenshoter.takeScreen"),this._screenState.status=2,this._setElementsVisible(!1),this._screenState.promise=this._waitEndOfInteractions().then(function(){return v._getPixelData(E)}).then(function(R){return v._setElementsVisible(!0),v._toCanvas(R,E)}).then(function(R){return _==="image"?v._canvasToImage(R,E):_==="canvas"?R:v._canvasToBlob(R,E)}).then(function(R){return v._screenState.status=1,v._map.fire("simpleMapScreenshoter.done"),R}).catch(function(R){return v._setElementsVisible(!0),v._screenState.status=1,v._map.fire("simpleMapScreenshoter.error",{e:R}),Promise.reject(R)}),this._screenState.promise)},_setElementsVisible:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.hideElementsWithSelectors.forEach(function(x){var E=v._map._container.querySelectorAll(x),b=!0,R=!1,$=void 0;try{for(var Q,I=E[Symbol.iterator]();!(b=(Q=I.next()).done);b=!0)Q.value.style.opacity=_===!1?0:1}catch(W){R=!0,$=W}finally{try{!b&&I.return&&I.return()}finally{if(R)throw $}}})},_canvasToImage:function(v,_){var x=_.mimeType,E=v.toDataURL(x);return E.indexOf("base64")===-1?Promise.reject(new Error("Base64 image generation error")):Promise.resolve(E)},_canvasToBlob:function(v,_){var x=_.mimeType;return new Promise(function(E,b){v.toBlob(function(R){E(R)},x)})},_toCanvas:function(v,_){var x=_.captionOffset,E=_.caption,b=_.captionFontSize,R=_.captionFont,$=_.captionColor,Q=_.captionBgColor,I=this._node,W=I.screenHeight,ge=I.screenWidth,Se=document.createElement("canvas");Se.width=ge,Se.height=W;for(var De=Se.getContext("2d"),Ye=De.createImageData(ge,W),Ve=0;Ve<v.length;++Ve)Ye.data[Ve]=v[Ve];De.putImageData(Ye,0,0),Ye=null;var O=document.createElement("canvas"),K=O.getContext("2d"),ce=0,H=0,D=W,V=ge;if(this.options.cropImageByInnerWH===!0){for(var z=[],U=0,G=0;G<W;++G){U=0;for(var ue=0;ue<ge;++ue)v[4*G*ge+4*ue+4]===0&&U++;U===ge&&z.push(G)}var ie=this._getMinAndMaxOnValuesBreak(z);ce=ie.min;for(var Ae=ge,Me=ie.max,st=[],X=0,Ee=H;Ee<Ae;++Ee){X=0;for(var N=0;N<W;++N)v[4*N*ge+4*Ee+4]===0&&X++;X===W&&st.push(Ee)}var Z=this._getMinAndMaxOnValuesBreak(st);H=Z.min,Ae=Z.max,(H===0&&Ae===0||Ae===null)&&(Ae=ge),(ce===0&&Me===0||Me===null)&&(Me=W),this.options.debugMode===!0&&(console.log("emptyYLine",z),console.log("minMaxY",ie),console.log("emptyXLine",st),console.log("minMaxX",Z),console.log("debugX",{}),console.log("debugY",{})),ce===0&&Me===W&&H===0&&Ae===ge||(ce+=this.options.onCropBorderSize,Me-=this.options.onCropBorderSize,H+=this.options.onCropBorderSize,Ae-=this.options.onCropBorderSize),D=Me-ce,V=Ae-H,O.width=V,O.height=D}else O.width=V,O.height=D;var he=null;return E&&(he=typeof E=="function"?E.call(this):E),he!==null&&(O.height=O.height+(x+b+x),K.beginPath(),K.rect(0,0,O.width,O.height),K.fillStyle=Q,K.fill(),K.save()),K.drawImage(Se,H,ce,V,D,0,0,V,D),he!==null&&(K.font=b+"px "+R,K.fillStyle=$,K.fillText(he,x,D+x+b)),Promise.resolve(O)},_getMinAndMaxOnValuesBreak:function(v){for(var _=0,x=0,E=!1,b=1;b<v.length;b++){if(v[b]-1!==v[b-1]){x=v[b],E=!0;break}_=v[b]}return E===!1&&v[0]>1?(_=0,x=v[0]):E===!1&&(_=v[v.length-1]||0,x=null),{min:_,max:x}},_getPixelData:function(v){var _=this,x=v.domtoimageOptions,E=x===void 0?{}:x;return this._getPixelDataOfNormalMap(E).catch(function(b){return console.warn("May be map size very big on that zoom level, we have error:",b.toString()),console.warn("You can manually hide map elements with large distances between them for fix that warn"),_._getPixelDataOfBigMap(E)})},_getPixelDataOfNormalMap:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=this._map.getContainer();return this._node={node:_,screenHeight:_.scrollHeight,screenWidth:_.scrollWidth},o.toPixelData(_,v)},_getPixelDataOfBigMap:function(){var v=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=this._map.getContainer(),E=this._map.getPane("mapPane");E.style.width=2*x.clientWidth+"px",E.style.height=2*x.clientHeight+"px",E.style.overflow="hidden";var b=function(){E.style.width="initial",E.style.height="initial",E.style.overflow="initial"};return this._node={node:x,screenHeight:x.scrollHeight,screenWidth:x.scrollWidth},o.toPixelData(x,_).then(function(R){return b(),R}).catch(function(R){return b(),x.scrollHeight>=4e3||x.scrollWidth>=4e3?v.options.onPixelDataFail({plugin:v,node:x,mapPane:E,error:R,domtoimageOptions:_}):Promise.reject(R)})},_addScreenBtn:function(){this._link=L.DomUtil.create("a","leaflet-control-simpleMapScreenshoter-btn",this._container),this._addCss(),L.DomEvent.addListener(this._link,"click",this._onScreenBtn,this),L.DomEvent.disableClickPropagation(this._link)},_addCss:function(){var v=`
    .leaflet-control-simpleMapScreenshoter{
       border: 2px solid rgba(0,0,0,0.2);
       background-clip: padding-box;
    }
    .leaflet-control-simpleMapScreenshoter a{
       background-color: #fff;
       border-bottom: 1px solid #ccc;
       width: 30px;
       height: 30px;
       line-height: 30px;
       display: block;
       text-align: center;
       text-decoration: none;
       color: black;
       overflow: hidden;
       border-radius: 2px;
       background-image: url('`+this.options.iconUrl+`');
       background-position: 46% 41%;
       background-repeat: no-repeat;
       background-size: 63%;
    }
    .leaflet-control-simpleMapScreenshoter a:hover{
       cursor: pointer;
    }
    `,_=document.head||document.getElementsByTagName("head")[0],x=document.createElement("style");x.appendChild(document.createTextNode(v)),_.appendChild(x)},_onScreenBtn:function(){var v=this;this._map.fire("simpleMapScreenshoter.click"),this.options.preventDownload||this.takeScreen().then(function(_){var x=typeof v.options.screenName=="function"?v.options.screenName.call(v):v.options.screenName;l.saveAs(_,x+".png")}).catch(function(_){v._map.fire("simpleMapScreenshoter.error",{e:_})})},_onUserStartInteractWithMap:function(){this._interaction=!0},_onUserEndInteractWithMap:function(){this._interaction=!1},_waitEndOfInteractions:function(){var v=this;return new Promise(function(_){var x=setInterval(function(){v._interaction||(_(),clearInterval(x))},100)})}}),g=(L.Control.SimpleMapScreenshoter=h,L.simpleMapScreenshoter=function(v){return new L.Control.SimpleMapScreenshoter(v)},h);t.default=g,t.SimpleMapScreenshoter=h,Object.defineProperty(t,"__esModule",{value:!0})})})(hy,hy.exports);(()=>{var bn,qn;var e=Object.create,n=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,l=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),h=(a,c,p,y)=>{if(c&&typeof c=="object"||typeof c=="function")for(let S of r(c))!o.call(a,S)&&S!==p&&n(a,S,{get:()=>c[S],enumerable:!(y=t(c,S))||y.enumerable});return a},g=(a,c,p)=>(p=a!=null?e(i(a)):{},h(c||!a||!a.__esModule?n(p,"default",{value:a,enumerable:!0}):p,a)),v=l((a,c)=>{function p(){this.__data__=[],this.size=0}c.exports=p}),_=l((a,c)=>{function p(y,S){return y===S||y!==y&&S!==S}c.exports=p}),x=l((a,c)=>{var p=_();function y(S,k){for(var F=S.length;F--;)if(p(S[F][0],k))return F;return-1}c.exports=y}),E=l((a,c)=>{var p=x(),y=Array.prototype,S=y.splice;function k(F){var q=this.__data__,ae=p(q,F);if(ae<0)return!1;var ve=q.length-1;return ae==ve?q.pop():S.call(q,ae,1),--this.size,!0}c.exports=k}),b=l((a,c)=>{var p=x();function y(S){var k=this.__data__,F=p(k,S);return F<0?void 0:k[F][1]}c.exports=y}),R=l((a,c)=>{var p=x();function y(S){return p(this.__data__,S)>-1}c.exports=y}),$=l((a,c)=>{var p=x();function y(S,k){var F=this.__data__,q=p(F,S);return q<0?(++this.size,F.push([S,k])):F[q][1]=k,this}c.exports=y}),Q=l((a,c)=>{var p=v(),y=E(),S=b(),k=R(),F=$();function q(ae){var ve=-1,Je=ae==null?0:ae.length;for(this.clear();++ve<Je;){var $e=ae[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=S,q.prototype.has=k,q.prototype.set=F,c.exports=q}),I=l((a,c)=>{var p=Q();function y(){this.__data__=new p,this.size=0}c.exports=y}),W=l((a,c)=>{function p(y){var S=this.__data__,k=S.delete(y);return this.size=S.size,k}c.exports=p}),ge=l((a,c)=>{function p(y){return this.__data__.get(y)}c.exports=p}),Se=l((a,c)=>{function p(y){return this.__data__.has(y)}c.exports=p}),De=l((a,c)=>{var p=typeof qo=="object"&&qo&&qo.Object===Object&&qo;c.exports=p}),Ye=l((a,c)=>{var p=De(),y=typeof self=="object"&&self&&self.Object===Object&&self,S=p||y||Function("return this")();c.exports=S}),Ve=l((a,c)=>{var p=Ye(),y=p.Symbol;c.exports=y}),O=l((a,c)=>{var p=Ve(),y=Object.prototype,S=y.hasOwnProperty,k=y.toString,F=p?p.toStringTag:void 0;function q(ae){var ve=S.call(ae,F),Je=ae[F];try{ae[F]=void 0;var $e=!0}catch{}var mt=k.call(ae);return $e&&(ve?ae[F]=Je:delete ae[F]),mt}c.exports=q}),K=l((a,c)=>{var p=Object.prototype,y=p.toString;function S(k){return y.call(k)}c.exports=S}),ce=l((a,c)=>{var p=Ve(),y=O(),S=K(),k="[object Null]",F="[object Undefined]",q=p?p.toStringTag:void 0;function ae(ve){return ve==null?ve===void 0?F:k:q&&q in Object(ve)?y(ve):S(ve)}c.exports=ae}),H=l((a,c)=>{function p(y){var S=typeof y;return y!=null&&(S=="object"||S=="function")}c.exports=p}),D=l((a,c)=>{var p=ce(),y=H(),S="[object AsyncFunction]",k="[object Function]",F="[object GeneratorFunction]",q="[object Proxy]";function ae(ve){if(!y(ve))return!1;var Je=p(ve);return Je==k||Je==F||Je==S||Je==q}c.exports=ae}),V=l((a,c)=>{var p=Ye(),y=p["__core-js_shared__"];c.exports=y}),z=l((a,c)=>{var p=V(),y=function(){var k=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||"");return k?"Symbol(src)_1."+k:""}();function S(k){return!!y&&y in k}c.exports=S}),U=l((a,c)=>{var p=Function.prototype,y=p.toString;function S(k){if(k!=null){try{return y.call(k)}catch{}try{return k+""}catch{}}return""}c.exports=S}),G=l((a,c)=>{var p=D(),y=z(),S=H(),k=U(),F=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,ae=Function.prototype,ve=Object.prototype,Je=ae.toString,$e=ve.hasOwnProperty,mt=RegExp("^"+Je.call($e).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Nt(Wt){if(!S(Wt)||y(Wt))return!1;var gn=p(Wt)?mt:q;return gn.test(k(Wt))}c.exports=Nt}),ue=l((a,c)=>{function p(y,S){return y==null?void 0:y[S]}c.exports=p}),ie=l((a,c)=>{var p=G(),y=ue();function S(k,F){var q=y(k,F);return p(q)?q:void 0}c.exports=S}),Ae=l((a,c)=>{var p=ie(),y=Ye(),S=p(y,"Map");c.exports=S}),Me=l((a,c)=>{var p=ie(),y=p(Object,"create");c.exports=y}),st=l((a,c)=>{var p=Me();function y(){this.__data__=p?p(null):{},this.size=0}c.exports=y}),X=l((a,c)=>{function p(y){var S=this.has(y)&&delete this.__data__[y];return this.size-=S?1:0,S}c.exports=p}),Ee=l((a,c)=>{var p=Me(),y="__lodash_hash_undefined__",S=Object.prototype,k=S.hasOwnProperty;function F(q){var ae=this.__data__;if(p){var ve=ae[q];return ve===y?void 0:ve}return k.call(ae,q)?ae[q]:void 0}c.exports=F}),N=l((a,c)=>{var p=Me(),y=Object.prototype,S=y.hasOwnProperty;function k(F){var q=this.__data__;return p?q[F]!==void 0:S.call(q,F)}c.exports=k}),Z=l((a,c)=>{var p=Me(),y="__lodash_hash_undefined__";function S(k,F){var q=this.__data__;return this.size+=this.has(k)?0:1,q[k]=p&&F===void 0?y:F,this}c.exports=S}),he=l((a,c)=>{var p=st(),y=X(),S=Ee(),k=N(),F=Z();function q(ae){var ve=-1,Je=ae==null?0:ae.length;for(this.clear();++ve<Je;){var $e=ae[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=S,q.prototype.has=k,q.prototype.set=F,c.exports=q}),ne=l((a,c)=>{var p=he(),y=Q(),S=Ae();function k(){this.size=0,this.__data__={hash:new p,map:new(S||y),string:new p}}c.exports=k}),te=l((a,c)=>{function p(y){var S=typeof y;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?y!=="__proto__":y===null}c.exports=p}),ee=l((a,c)=>{var p=te();function y(S,k){var F=S.__data__;return p(k)?F[typeof k=="string"?"string":"hash"]:F.map}c.exports=y}),se=l((a,c)=>{var p=ee();function y(S){var k=p(this,S).delete(S);return this.size-=k?1:0,k}c.exports=y}),Pe=l((a,c)=>{var p=ee();function y(S){return p(this,S).get(S)}c.exports=y}),oe=l((a,c)=>{var p=ee();function y(S){return p(this,S).has(S)}c.exports=y}),re=l((a,c)=>{var p=ee();function y(S,k){var F=p(this,S),q=F.size;return F.set(S,k),this.size+=F.size==q?0:1,this}c.exports=y}),xe=l((a,c)=>{var p=ne(),y=se(),S=Pe(),k=oe(),F=re();function q(ae){var ve=-1,Je=ae==null?0:ae.length;for(this.clear();++ve<Je;){var $e=ae[ve];this.set($e[0],$e[1])}}q.prototype.clear=p,q.prototype.delete=y,q.prototype.get=S,q.prototype.has=k,q.prototype.set=F,c.exports=q}),ye=l((a,c)=>{var p=Q(),y=Ae(),S=xe(),k=200;function F(q,ae){var ve=this.__data__;if(ve instanceof p){var Je=ve.__data__;if(!y||Je.length<k-1)return Je.push([q,ae]),this.size=++ve.size,this;ve=this.__data__=new S(Je)}return ve.set(q,ae),this.size=ve.size,this}c.exports=F}),le=l((a,c)=>{var p=Q(),y=I(),S=W(),k=ge(),F=Se(),q=ye();function ae(ve){var Je=this.__data__=new p(ve);this.size=Je.size}ae.prototype.clear=y,ae.prototype.delete=S,ae.prototype.get=k,ae.prototype.has=F,ae.prototype.set=q,c.exports=ae}),Ue=l((a,c)=>{var p=ie(),y=function(){try{var S=p(Object,"defineProperty");return S({},"",{}),S}catch{}}();c.exports=y}),Ie=l((a,c)=>{var p=Ue();function y(S,k,F){k=="__proto__"&&p?p(S,k,{configurable:!0,enumerable:!0,value:F,writable:!0}):S[k]=F}c.exports=y}),Ce=l((a,c)=>{var p=Ie(),y=_();function S(k,F,q){(q!==void 0&&!y(k[F],q)||q===void 0&&!(F in k))&&p(k,F,q)}c.exports=S}),qe=l((a,c)=>{function p(y){return function(S,k,F){for(var q=-1,ae=Object(S),ve=F(S),Je=ve.length;Je--;){var $e=ve[y?Je:++q];if(k(ae[$e],$e,ae)===!1)break}return S}}c.exports=p}),Re=l((a,c)=>{var p=qe(),y=p();c.exports=y}),rt=l((a,c)=>{var p=Ye(),y=typeof a=="object"&&a&&!a.nodeType&&a,S=y&&typeof c=="object"&&c&&!c.nodeType&&c,k=S&&S.exports===y,F=k?p.Buffer:void 0,q=F?F.allocUnsafe:void 0;function ae(ve,Je){if(Je)return ve.slice();var $e=ve.length,mt=q?q($e):new ve.constructor($e);return ve.copy(mt),mt}c.exports=ae}),Ze=l((a,c)=>{var p=Ye(),y=p.Uint8Array;c.exports=y}),gt=l((a,c)=>{var p=Ze();function y(S){var k=new S.constructor(S.byteLength);return new p(k).set(new p(S)),k}c.exports=y}),_t=l((a,c)=>{var p=gt();function y(S,k){var F=k?p(S.buffer):S.buffer;return new S.constructor(F,S.byteOffset,S.length)}c.exports=y}),$t=l((a,c)=>{function p(y,S){var k=-1,F=y.length;for(S||(S=Array(F));++k<F;)S[k]=y[k];return S}c.exports=p}),tn=l((a,c)=>{var p=H(),y=Object.create,S=function(){function k(){}return function(F){if(!p(F))return{};if(y)return y(F);k.prototype=F;var q=new k;return k.prototype=void 0,q}}();c.exports=S}),Qe=l((a,c)=>{function p(y,S){return function(k){return y(S(k))}}c.exports=p}),Yt=l((a,c)=>{var p=Qe(),y=p(Object.getPrototypeOf,Object);c.exports=y}),Qt=l((a,c)=>{var p=Object.prototype;function y(S){var k=S&&S.constructor,F=typeof k=="function"&&k.prototype||p;return S===F}c.exports=y}),Zt=l((a,c)=>{var p=tn(),y=Yt(),S=Qt();function k(F){return typeof F.constructor=="function"&&!S(F)?p(y(F)):{}}c.exports=k}),wt=l((a,c)=>{function p(y){return y!=null&&typeof y=="object"}c.exports=p}),He=l((a,c)=>{var p=ce(),y=wt(),S="[object Arguments]";function k(F){return y(F)&&p(F)==S}c.exports=k}),Kt=l((a,c)=>{var p=He(),y=wt(),S=Object.prototype,k=S.hasOwnProperty,F=S.propertyIsEnumerable,q=p(function(){return arguments}())?p:function(ae){return y(ae)&&k.call(ae,"callee")&&!F.call(ae,"callee")};c.exports=q}),on=l((a,c)=>{var p=Array.isArray;c.exports=p}),Bn=l((a,c)=>{var p=9007199254740991;function y(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=p}c.exports=y}),kn=l((a,c)=>{var p=D(),y=Bn();function S(k){return k!=null&&y(k.length)&&!p(k)}c.exports=S}),et=l((a,c)=>{var p=kn(),y=wt();function S(k){return y(k)&&p(k)}c.exports=S}),On=l((a,c)=>{function p(){return!1}c.exports=p}),Nn=l((a,c)=>{var p=Ye(),y=On(),S=typeof a=="object"&&a&&!a.nodeType&&a,k=S&&typeof c=="object"&&c&&!c.nodeType&&c,F=k&&k.exports===S,q=F?p.Buffer:void 0,ae=q?q.isBuffer:void 0,ve=ae||y;c.exports=ve}),mn=l((a,c)=>{var p=ce(),y=Yt(),S=wt(),k="[object Object]",F=Function.prototype,q=Object.prototype,ae=F.toString,ve=q.hasOwnProperty,Je=ae.call(Object);function $e(mt){if(!S(mt)||p(mt)!=k)return!1;var Nt=y(mt);if(Nt===null)return!0;var Wt=ve.call(Nt,"constructor")&&Nt.constructor;return typeof Wt=="function"&&Wt instanceof Wt&&ae.call(Wt)==Je}c.exports=$e}),Pn=l((a,c)=>{var p=ce(),y=Bn(),S=wt(),k="[object Arguments]",F="[object Array]",q="[object Boolean]",ae="[object Date]",ve="[object Error]",Je="[object Function]",$e="[object Map]",mt="[object Number]",Nt="[object Object]",Wt="[object RegExp]",gn="[object Set]",vn="[object String]",Jn="[object WeakMap]",Ke="[object ArrayBuffer]",nt="[object DataView]",ct="[object Float32Array]",Ft="[object Float64Array]",xt="[object Int8Array]",Rt="[object Int16Array]",fe="[object Int32Array]",we="[object Uint8Array]",Oe="[object Uint8ClampedArray]",Ne="[object Uint16Array]",ze="[object Uint32Array]",je={};je[ct]=je[Ft]=je[xt]=je[Rt]=je[fe]=je[we]=je[Oe]=je[Ne]=je[ze]=!0,je[k]=je[F]=je[Ke]=je[q]=je[nt]=je[ae]=je[ve]=je[Je]=je[$e]=je[mt]=je[Nt]=je[Wt]=je[gn]=je[vn]=je[Jn]=!1;function at(lt){return S(lt)&&y(lt.length)&&!!je[p(lt)]}c.exports=at}),zr=l((a,c)=>{function p(y){return function(S){return y(S)}}c.exports=p}),Gn=l((a,c)=>{var p=De(),y=typeof a=="object"&&a&&!a.nodeType&&a,S=y&&typeof c=="object"&&c&&!c.nodeType&&c,k=S&&S.exports===y,F=k&&p.process,q=function(){try{var ae=S&&S.require&&S.require("util").types;return ae||F&&F.binding&&F.binding("util")}catch{}}();c.exports=q}),Dt=l((a,c)=>{var p=Pn(),y=zr(),S=Gn(),k=S&&S.isTypedArray,F=k?y(k):p;c.exports=F}),xr=l((a,c)=>{function p(y,S){if(!(S==="constructor"&&typeof y[S]=="function")&&S!="__proto__")return y[S]}c.exports=p}),lr=l((a,c)=>{var p=Ie(),y=_(),S=Object.prototype,k=S.hasOwnProperty;function F(q,ae,ve){var Je=q[ae];(!(k.call(q,ae)&&y(Je,ve))||ve===void 0&&!(ae in q))&&p(q,ae,ve)}c.exports=F}),hi=l((a,c)=>{var p=lr(),y=Ie();function S(k,F,q,ae){var ve=!q;q||(q={});for(var Je=-1,$e=F.length;++Je<$e;){var mt=F[Je],Nt=ae?ae(q[mt],k[mt],mt,q,k):void 0;Nt===void 0&&(Nt=k[mt]),ve?y(q,mt,Nt):p(q,mt,Nt)}return q}c.exports=S}),Ri=l((a,c)=>{function p(y,S){for(var k=-1,F=Array(y);++k<y;)F[k]=S(k);return F}c.exports=p}),Fn=l((a,c)=>{var p=9007199254740991,y=/^(?:0|[1-9]\d*)$/;function S(k,F){var q=typeof k;return F=F??p,!!F&&(q=="number"||q!="symbol"&&y.test(k))&&k>-1&&k%1==0&&k<F}c.exports=S}),xi=l((a,c)=>{var p=Ri(),y=Kt(),S=on(),k=Nn(),F=Fn(),q=Dt(),ae=Object.prototype,ve=ae.hasOwnProperty;function Je($e,mt){var Nt=S($e),Wt=!Nt&&y($e),gn=!Nt&&!Wt&&k($e),vn=!Nt&&!Wt&&!gn&&q($e),Jn=Nt||Wt||gn||vn,Ke=Jn?p($e.length,String):[],nt=Ke.length;for(var ct in $e)(mt||ve.call($e,ct))&&!(Jn&&(ct=="length"||gn&&(ct=="offset"||ct=="parent")||vn&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||F(ct,nt)))&&Ke.push(ct);return Ke}c.exports=Je}),Lr=l((a,c)=>{function p(y){var S=[];if(y!=null)for(var k in Object(y))S.push(k);return S}c.exports=p}),Gr=l((a,c)=>{var p=H(),y=Qt(),S=Lr(),k=Object.prototype,F=k.hasOwnProperty;function q(ae){if(!p(ae))return S(ae);var ve=y(ae),Je=[];for(var $e in ae)$e=="constructor"&&(ve||!F.call(ae,$e))||Je.push($e);return Je}c.exports=q}),Qn=l((a,c)=>{var p=xi(),y=Gr(),S=kn();function k(F){return S(F)?p(F,!0):y(F)}c.exports=k}),kt=l((a,c)=>{var p=hi(),y=Qn();function S(k){return p(k,y(k))}c.exports=S}),Ei=l((a,c)=>{var p=Ce(),y=rt(),S=_t(),k=$t(),F=Zt(),q=Kt(),ae=on(),ve=et(),Je=Nn(),$e=D(),mt=H(),Nt=mn(),Wt=Dt(),gn=xr(),vn=kt();function Jn(Ke,nt,ct,Ft,xt,Rt,fe){var we=gn(Ke,ct),Oe=gn(nt,ct),Ne=fe.get(Oe);if(Ne){p(Ke,ct,Ne);return}var ze=Rt?Rt(we,Oe,ct+"",Ke,nt,fe):void 0,je=ze===void 0;if(je){var at=ae(Oe),lt=!at&&Je(Oe),dt=!at&&!lt&&Wt(Oe);ze=Oe,at||lt||dt?ae(we)?ze=we:ve(we)?ze=k(we):lt?(je=!1,ze=y(Oe,!0)):dt?(je=!1,ze=S(Oe,!0)):ze=[]:Nt(Oe)||q(Oe)?(ze=we,q(we)?ze=vn(we):(!mt(we)||$e(we))&&(ze=F(Oe))):je=!1}je&&(fe.set(Oe,ze),xt(ze,Oe,Ft,Rt,fe),fe.delete(Oe)),p(Ke,ct,ze)}c.exports=Jn}),Ai=l((a,c)=>{var p=le(),y=Ce(),S=Re(),k=Ei(),F=H(),q=Qn(),ae=xr();function ve(Je,$e,mt,Nt,Wt){Je!==$e&&S($e,function(gn,vn){if(Wt||(Wt=new p),F(gn))k(Je,$e,vn,mt,ve,Nt,Wt);else{var Jn=Nt?Nt(ae(Je,vn),gn,vn+"",Je,$e,Wt):void 0;Jn===void 0&&(Jn=gn),y(Je,vn,Jn)}},q)}c.exports=ve}),fi=l((a,c)=>{function p(y){return y}c.exports=p}),ei=l((a,c)=>{function p(y,S,k){switch(k.length){case 0:return y.call(S);case 1:return y.call(S,k[0]);case 2:return y.call(S,k[0],k[1]);case 3:return y.call(S,k[0],k[1],k[2])}return y.apply(S,k)}c.exports=p}),Di=l((a,c)=>{var p=ei(),y=Math.max;function S(k,F,q){return F=y(F===void 0?k.length-1:F,0),function(){for(var ae=arguments,ve=-1,Je=y(ae.length-F,0),$e=Array(Je);++ve<Je;)$e[ve]=ae[F+ve];ve=-1;for(var mt=Array(F+1);++ve<F;)mt[ve]=ae[ve];return mt[F]=q($e),p(k,this,mt)}}c.exports=S}),Qi=l((a,c)=>{function p(y){return function(){return y}}c.exports=p}),Yn=l((a,c)=>{var p=Qi(),y=Ue(),S=fi(),k=y?function(F,q){return y(F,"toString",{configurable:!0,enumerable:!1,value:p(q),writable:!0})}:S;c.exports=k}),Mi=l((a,c)=>{var p=800,y=16,S=Date.now;function k(F){var q=0,ae=0;return function(){var ve=S(),Je=y-(ve-ae);if(ae=ve,Je>0){if(++q>=p)return arguments[0]}else q=0;return F.apply(void 0,arguments)}}c.exports=k}),Xs=l((a,c)=>{var p=Yn(),y=Mi(),S=y(p);c.exports=S}),Ps=l((a,c)=>{var p=fi(),y=Di(),S=Xs();function k(F,q){return S(y(F,q,p),F+"")}c.exports=k}),Tr=l((a,c)=>{var p=_(),y=kn(),S=Fn(),k=H();function F(q,ae,ve){if(!k(ve))return!1;var Je=typeof ae;return(Je=="number"?y(ve)&&S(ae,ve.length):Je=="string"&&ae in ve)?p(ve[ae],q):!1}c.exports=F}),Cn=l((a,c)=>{var p=Ps(),y=Tr();function S(k){return p(function(F,q){var ae=-1,ve=q.length,Je=ve>1?q[ve-1]:void 0,$e=ve>2?q[2]:void 0;for(Je=k.length>3&&typeof Je=="function"?(ve--,Je):void 0,$e&&y(q[0],q[1],$e)&&(Je=ve<3?void 0:Je,ve=1),F=Object(F);++ae<ve;){var mt=q[ae];mt&&k(F,mt,ae,Je)}return F})}c.exports=S}),di=l((a,c)=>{var p=Ai(),y=Cn(),S=y(function(k,F,q){p(k,F,q)});c.exports=S}),Dr=l((a,c)=>{var p=ce(),y=wt(),S="[object Symbol]";function k(F){return typeof F=="symbol"||y(F)&&p(F)==S}c.exports=k}),si=l((a,c)=>{var p=on(),y=Dr(),S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,k=/^\w*$/;function F(q,ae){if(p(q))return!1;var ve=typeof q;return ve=="number"||ve=="symbol"||ve=="boolean"||q==null||y(q)?!0:k.test(q)||!S.test(q)||ae!=null&&q in Object(ae)}c.exports=F}),mi=l((a,c)=>{var p=xe(),y="Expected a function";function S(k,F){if(typeof k!="function"||F!=null&&typeof F!="function")throw new TypeError(y);var q=function(){var ae=arguments,ve=F?F.apply(this,ae):ae[0],Je=q.cache;if(Je.has(ve))return Je.get(ve);var $e=k.apply(this,ae);return q.cache=Je.set(ve,$e)||Je,$e};return q.cache=new(S.Cache||p),q}S.Cache=p,c.exports=S}),Es=l((a,c)=>{var p=mi(),y=500;function S(k){var F=p(k,function(ae){return q.size===y&&q.clear(),ae}),q=F.cache;return F}c.exports=S}),is=l((a,c)=>{var p=Es(),y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,S=/\\(\\)?/g,k=p(function(F){var q=[];return F.charCodeAt(0)===46&&q.push(""),F.replace(y,function(ae,ve,Je,$e){q.push(Je?$e.replace(S,"$1"):ve||ae)}),q});c.exports=k}),pr=l((a,c)=>{function p(y,S){for(var k=-1,F=y==null?0:y.length,q=Array(F);++k<F;)q[k]=S(y[k],k,y);return q}c.exports=p}),fo=l((a,c)=>{var p=Ve(),y=pr(),S=on(),k=Dr(),F=p?p.prototype:void 0,q=F?F.toString:void 0;function ae(ve){if(typeof ve=="string")return ve;if(S(ve))return y(ve,ae)+"";if(k(ve))return q?q.call(ve):"";var Je=ve+"";return Je=="0"&&1/ve==-1/0?"-0":Je}c.exports=ae}),ti=l((a,c)=>{var p=fo();function y(S){return S==null?"":p(S)}c.exports=y}),ki=l((a,c)=>{var p=on(),y=si(),S=is(),k=ti();function F(q,ae){return p(q)?q:y(q,ae)?[q]:S(k(q))}c.exports=F}),Br=l((a,c)=>{var p=Dr();function y(S){if(typeof S=="string"||p(S))return S;var k=S+"";return k=="0"&&1/S==-1/0?"-0":k}c.exports=y}),_n=l((a,c)=>{var p=ki(),y=Br();function S(k,F){F=p(F,k);for(var q=0,ae=F.length;k!=null&&q<ae;)k=k[y(F[q++])];return q&&q==ae?k:void 0}c.exports=S}),Xt=l((a,c)=>{var p=_n();function y(S,k,F){var q=S==null?void 0:p(S,k);return q===void 0?F:q}c.exports=y}),Tn=l((a,c)=>{(function(p,y){typeof a=="object"&&typeof c<"u"?c.exports=y():(p=p||self).RBush=y()})(a,function(){function p(Ke,nt,ct,Ft,xt){(function Rt(fe,we,Oe,Ne,ze){for(;Ne>Oe;){if(Ne-Oe>600){var je=Ne-Oe+1,at=we-Oe+1,lt=Math.log(je),dt=.5*Math.exp(2*lt/3),Et=.5*Math.sqrt(lt*dt*(je-dt)/je)*(at-je/2<0?-1:1),At=Math.max(Oe,Math.floor(we-at*dt/je+Et)),nn=Math.min(Ne,Math.floor(we+(je-at)*dt/je+Et));Rt(fe,we,At,nn,ze)}var An=fe[we],Rn=Oe,Vn=Ne;for(y(fe,Oe,we),ze(fe[Ne],An)>0&&y(fe,Oe,Ne);Rn<Vn;){for(y(fe,Rn,Vn),Rn++,Vn--;ze(fe[Rn],An)<0;)Rn++;for(;ze(fe[Vn],An)>0;)Vn--}ze(fe[Oe],An)===0?y(fe,Oe,Vn):y(fe,++Vn,Ne),Vn<=we&&(Oe=Vn+1),we<=Vn&&(Ne=Vn-1)}})(Ke,nt,ct||0,Ft||Ke.length-1,xt||S)}function y(Ke,nt,ct){var Ft=Ke[nt];Ke[nt]=Ke[ct],Ke[ct]=Ft}function S(Ke,nt){return Ke<nt?-1:Ke>nt?1:0}var k=function(Ke){Ke===void 0&&(Ke=9),this._maxEntries=Math.max(4,Ke),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function F(Ke,nt,ct){if(!ct)return nt.indexOf(Ke);for(var Ft=0;Ft<nt.length;Ft++)if(ct(Ke,nt[Ft]))return Ft;return-1}function q(Ke,nt){ae(Ke,0,Ke.children.length,nt,Ke)}function ae(Ke,nt,ct,Ft,xt){xt||(xt=vn(null)),xt.minX=1/0,xt.minY=1/0,xt.maxX=-1/0,xt.maxY=-1/0;for(var Rt=nt;Rt<ct;Rt++){var fe=Ke.children[Rt];ve(xt,Ke.leaf?Ft(fe):fe)}return xt}function ve(Ke,nt){return Ke.minX=Math.min(Ke.minX,nt.minX),Ke.minY=Math.min(Ke.minY,nt.minY),Ke.maxX=Math.max(Ke.maxX,nt.maxX),Ke.maxY=Math.max(Ke.maxY,nt.maxY),Ke}function Je(Ke,nt){return Ke.minX-nt.minX}function $e(Ke,nt){return Ke.minY-nt.minY}function mt(Ke){return(Ke.maxX-Ke.minX)*(Ke.maxY-Ke.minY)}function Nt(Ke){return Ke.maxX-Ke.minX+(Ke.maxY-Ke.minY)}function Wt(Ke,nt){return Ke.minX<=nt.minX&&Ke.minY<=nt.minY&&nt.maxX<=Ke.maxX&&nt.maxY<=Ke.maxY}function gn(Ke,nt){return nt.minX<=Ke.maxX&&nt.minY<=Ke.maxY&&nt.maxX>=Ke.minX&&nt.maxY>=Ke.minY}function vn(Ke){return{children:Ke,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Jn(Ke,nt,ct,Ft,xt){for(var Rt=[nt,ct];Rt.length;)if(!((ct=Rt.pop())-(nt=Rt.pop())<=Ft)){var fe=nt+Math.ceil((ct-nt)/Ft/2)*Ft;p(Ke,fe,nt,ct,xt),Rt.push(nt,fe,fe,ct)}}return k.prototype.all=function(){return this._all(this.data,[])},k.prototype.search=function(Ke){var nt=this.data,ct=[];if(!gn(Ke,nt))return ct;for(var Ft=this.toBBox,xt=[];nt;){for(var Rt=0;Rt<nt.children.length;Rt++){var fe=nt.children[Rt],we=nt.leaf?Ft(fe):fe;gn(Ke,we)&&(nt.leaf?ct.push(fe):Wt(Ke,we)?this._all(fe,ct):xt.push(fe))}nt=xt.pop()}return ct},k.prototype.collides=function(Ke){var nt=this.data;if(!gn(Ke,nt))return!1;for(var ct=[];nt;){for(var Ft=0;Ft<nt.children.length;Ft++){var xt=nt.children[Ft],Rt=nt.leaf?this.toBBox(xt):xt;if(gn(Ke,Rt)){if(nt.leaf||Wt(Ke,Rt))return!0;ct.push(xt)}}nt=ct.pop()}return!1},k.prototype.load=function(Ke){if(!Ke||!Ke.length)return this;if(Ke.length<this._minEntries){for(var nt=0;nt<Ke.length;nt++)this.insert(Ke[nt]);return this}var ct=this._build(Ke.slice(),0,Ke.length-1,0);if(this.data.children.length)if(this.data.height===ct.height)this._splitRoot(this.data,ct);else{if(this.data.height<ct.height){var Ft=this.data;this.data=ct,ct=Ft}this._insert(ct,this.data.height-ct.height-1,!0)}else this.data=ct;return this},k.prototype.insert=function(Ke){return Ke&&this._insert(Ke,this.data.height-1),this},k.prototype.clear=function(){return this.data=vn([]),this},k.prototype.remove=function(Ke,nt){if(!Ke)return this;for(var ct,Ft,xt,Rt=this.data,fe=this.toBBox(Ke),we=[],Oe=[];Rt||we.length;){if(Rt||(Rt=we.pop(),Ft=we[we.length-1],ct=Oe.pop(),xt=!0),Rt.leaf){var Ne=F(Ke,Rt.children,nt);if(Ne!==-1)return Rt.children.splice(Ne,1),we.push(Rt),this._condense(we),this}xt||Rt.leaf||!Wt(Rt,fe)?Ft?(ct++,Rt=Ft.children[ct],xt=!1):Rt=null:(we.push(Rt),Oe.push(ct),ct=0,Ft=Rt,Rt=Rt.children[0])}return this},k.prototype.toBBox=function(Ke){return Ke},k.prototype.compareMinX=function(Ke,nt){return Ke.minX-nt.minX},k.prototype.compareMinY=function(Ke,nt){return Ke.minY-nt.minY},k.prototype.toJSON=function(){return this.data},k.prototype.fromJSON=function(Ke){return this.data=Ke,this},k.prototype._all=function(Ke,nt){for(var ct=[];Ke;)Ke.leaf?nt.push.apply(nt,Ke.children):ct.push.apply(ct,Ke.children),Ke=ct.pop();return nt},k.prototype._build=function(Ke,nt,ct,Ft){var xt,Rt=ct-nt+1,fe=this._maxEntries;if(Rt<=fe)return q(xt=vn(Ke.slice(nt,ct+1)),this.toBBox),xt;Ft||(Ft=Math.ceil(Math.log(Rt)/Math.log(fe)),fe=Math.ceil(Rt/Math.pow(fe,Ft-1))),(xt=vn([])).leaf=!1,xt.height=Ft;var we=Math.ceil(Rt/fe),Oe=we*Math.ceil(Math.sqrt(fe));Jn(Ke,nt,ct,Oe,this.compareMinX);for(var Ne=nt;Ne<=ct;Ne+=Oe){var ze=Math.min(Ne+Oe-1,ct);Jn(Ke,Ne,ze,we,this.compareMinY);for(var je=Ne;je<=ze;je+=we){var at=Math.min(je+we-1,ze);xt.children.push(this._build(Ke,je,at,Ft-1))}}return q(xt,this.toBBox),xt},k.prototype._chooseSubtree=function(Ke,nt,ct,Ft){for(;Ft.push(nt),!nt.leaf&&Ft.length-1!==ct;){for(var xt=1/0,Rt=1/0,fe=void 0,we=0;we<nt.children.length;we++){var Oe=nt.children[we],Ne=mt(Oe),ze=(je=Ke,at=Oe,(Math.max(at.maxX,je.maxX)-Math.min(at.minX,je.minX))*(Math.max(at.maxY,je.maxY)-Math.min(at.minY,je.minY))-Ne);ze<Rt?(Rt=ze,xt=Ne<xt?Ne:xt,fe=Oe):ze===Rt&&Ne<xt&&(xt=Ne,fe=Oe)}nt=fe||nt.children[0]}var je,at;return nt},k.prototype._insert=function(Ke,nt,ct){var Ft=ct?Ke:this.toBBox(Ke),xt=[],Rt=this._chooseSubtree(Ft,this.data,nt,xt);for(Rt.children.push(Ke),ve(Rt,Ft);nt>=0&&xt[nt].children.length>this._maxEntries;)this._split(xt,nt),nt--;this._adjustParentBBoxes(Ft,xt,nt)},k.prototype._split=function(Ke,nt){var ct=Ke[nt],Ft=ct.children.length,xt=this._minEntries;this._chooseSplitAxis(ct,xt,Ft);var Rt=this._chooseSplitIndex(ct,xt,Ft),fe=vn(ct.children.splice(Rt,ct.children.length-Rt));fe.height=ct.height,fe.leaf=ct.leaf,q(ct,this.toBBox),q(fe,this.toBBox),nt?Ke[nt-1].children.push(fe):this._splitRoot(ct,fe)},k.prototype._splitRoot=function(Ke,nt){this.data=vn([Ke,nt]),this.data.height=Ke.height+1,this.data.leaf=!1,q(this.data,this.toBBox)},k.prototype._chooseSplitIndex=function(Ke,nt,ct){for(var Ft,xt,Rt,fe,we,Oe,Ne,ze=1/0,je=1/0,at=nt;at<=ct-nt;at++){var lt=ae(Ke,0,at,this.toBBox),dt=ae(Ke,at,ct,this.toBBox),Et=(xt=lt,Rt=dt,fe=void 0,we=void 0,Oe=void 0,Ne=void 0,fe=Math.max(xt.minX,Rt.minX),we=Math.max(xt.minY,Rt.minY),Oe=Math.min(xt.maxX,Rt.maxX),Ne=Math.min(xt.maxY,Rt.maxY),Math.max(0,Oe-fe)*Math.max(0,Ne-we)),At=mt(lt)+mt(dt);Et<ze?(ze=Et,Ft=at,je=At<je?At:je):Et===ze&&At<je&&(je=At,Ft=at)}return Ft||ct-nt},k.prototype._chooseSplitAxis=function(Ke,nt,ct){var Ft=Ke.leaf?this.compareMinX:Je,xt=Ke.leaf?this.compareMinY:$e;this._allDistMargin(Ke,nt,ct,Ft)<this._allDistMargin(Ke,nt,ct,xt)&&Ke.children.sort(Ft)},k.prototype._allDistMargin=function(Ke,nt,ct,Ft){Ke.children.sort(Ft);for(var xt=this.toBBox,Rt=ae(Ke,0,nt,xt),fe=ae(Ke,ct-nt,ct,xt),we=Nt(Rt)+Nt(fe),Oe=nt;Oe<ct-nt;Oe++){var Ne=Ke.children[Oe];ve(Rt,Ke.leaf?xt(Ne):Ne),we+=Nt(Rt)}for(var ze=ct-nt-1;ze>=nt;ze--){var je=Ke.children[ze];ve(fe,Ke.leaf?xt(je):je),we+=Nt(fe)}return we},k.prototype._adjustParentBBoxes=function(Ke,nt,ct){for(var Ft=ct;Ft>=0;Ft--)ve(nt[Ft],Ke)},k.prototype._condense=function(Ke){for(var nt=Ke.length-1,ct=void 0;nt>=0;nt--)Ke[nt].children.length===0?nt>0?(ct=Ke[nt-1].children).splice(ct.indexOf(Ke[nt]),1):this.clear():q(Ke[nt],this.toBBox)},k})}),In=l(a=>{Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=63710088e-1,a.factors={centimeters:a.earthRadius*100,centimetres:a.earthRadius*100,degrees:a.earthRadius/111325,feet:a.earthRadius*3.28084,inches:a.earthRadius*39.37,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:a.earthRadius*1e3,millimetres:a.earthRadius*1e3,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius*1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1.0936133},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function c(Ne,ze,je){je===void 0&&(je={});var at={type:"Feature"};return(je.id===0||je.id)&&(at.id=je.id),je.bbox&&(at.bbox=je.bbox),at.properties=ze||{},at.geometry=Ne,at}a.feature=c;function p(Ne,ze,je){switch(Ne){case"Point":return y(ze).geometry;case"LineString":return q(ze).geometry;case"Polygon":return k(ze).geometry;case"MultiPoint":return $e(ze).geometry;case"MultiLineString":return Je(ze).geometry;case"MultiPolygon":return mt(ze).geometry;default:throw new Error(Ne+" is invalid")}}a.geometry=p;function y(Ne,ze,je){if(je===void 0&&(je={}),!Ne)throw new Error("coordinates is required");if(!Array.isArray(Ne))throw new Error("coordinates must be an Array");if(Ne.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Rt(Ne[0])||!Rt(Ne[1]))throw new Error("coordinates must contain numbers");var at={type:"Point",coordinates:Ne};return c(at,ze,je)}a.point=y;function S(Ne,ze,je){return je===void 0&&(je={}),ve(Ne.map(function(at){return y(at,ze)}),je)}a.points=S;function k(Ne,ze,je){je===void 0&&(je={});for(var at=0,lt=Ne;at<lt.length;at++){var dt=lt[at];if(dt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Et=0;Et<dt[dt.length-1].length;Et++)if(dt[dt.length-1][Et]!==dt[0][Et])throw new Error("First and last Position are not equivalent.")}var At={type:"Polygon",coordinates:Ne};return c(At,ze,je)}a.polygon=k;function F(Ne,ze,je){return je===void 0&&(je={}),ve(Ne.map(function(at){return k(at,ze)}),je)}a.polygons=F;function q(Ne,ze,je){if(je===void 0&&(je={}),Ne.length<2)throw new Error("coordinates must be an array of two or more positions");var at={type:"LineString",coordinates:Ne};return c(at,ze,je)}a.lineString=q;function ae(Ne,ze,je){return je===void 0&&(je={}),ve(Ne.map(function(at){return q(at,ze)}),je)}a.lineStrings=ae;function ve(Ne,ze){ze===void 0&&(ze={});var je={type:"FeatureCollection"};return ze.id&&(je.id=ze.id),ze.bbox&&(je.bbox=ze.bbox),je.features=Ne,je}a.featureCollection=ve;function Je(Ne,ze,je){je===void 0&&(je={});var at={type:"MultiLineString",coordinates:Ne};return c(at,ze,je)}a.multiLineString=Je;function $e(Ne,ze,je){je===void 0&&(je={});var at={type:"MultiPoint",coordinates:Ne};return c(at,ze,je)}a.multiPoint=$e;function mt(Ne,ze,je){je===void 0&&(je={});var at={type:"MultiPolygon",coordinates:Ne};return c(at,ze,je)}a.multiPolygon=mt;function Nt(Ne,ze,je){je===void 0&&(je={});var at={type:"GeometryCollection",geometries:Ne};return c(at,ze,je)}a.geometryCollection=Nt;function Wt(Ne,ze){if(ze===void 0&&(ze=0),ze&&!(ze>=0))throw new Error("precision must be a positive number");var je=Math.pow(10,ze||0);return Math.round(Ne*je)/je}a.round=Wt;function gn(Ne,ze){ze===void 0&&(ze="kilometers");var je=a.factors[ze];if(!je)throw new Error(ze+" units is invalid");return Ne*je}a.radiansToLength=gn;function vn(Ne,ze){ze===void 0&&(ze="kilometers");var je=a.factors[ze];if(!je)throw new Error(ze+" units is invalid");return Ne/je}a.lengthToRadians=vn;function Jn(Ne,ze){return nt(vn(Ne,ze))}a.lengthToDegrees=Jn;function Ke(Ne){var ze=Ne%360;return ze<0&&(ze+=360),ze}a.bearingToAzimuth=Ke;function nt(Ne){var ze=Ne%(2*Math.PI);return ze*180/Math.PI}a.radiansToDegrees=nt;function ct(Ne){var ze=Ne%360;return ze*Math.PI/180}a.degreesToRadians=ct;function Ft(Ne,ze,je){if(ze===void 0&&(ze="kilometers"),je===void 0&&(je="kilometers"),!(Ne>=0))throw new Error("length must be a positive number");return gn(vn(Ne,ze),je)}a.convertLength=Ft;function xt(Ne,ze,je){if(ze===void 0&&(ze="meters"),je===void 0&&(je="kilometers"),!(Ne>=0))throw new Error("area must be a positive number");var at=a.areaFactors[ze];if(!at)throw new Error("invalid original units");var lt=a.areaFactors[je];if(!lt)throw new Error("invalid final units");return Ne/at*lt}a.convertArea=xt;function Rt(Ne){return!isNaN(Ne)&&Ne!==null&&!Array.isArray(Ne)}a.isNumber=Rt;function fe(Ne){return!!Ne&&Ne.constructor===Object}a.isObject=fe;function we(Ne){if(!Ne)throw new Error("bbox is required");if(!Array.isArray(Ne))throw new Error("bbox must be an Array");if(Ne.length!==4&&Ne.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Ne.forEach(function(ze){if(!Rt(ze))throw new Error("bbox must only contain numbers")})}a.validateBBox=we;function Oe(Ne){if(!Ne)throw new Error("id is required");if(["string","number"].indexOf(typeof Ne)===-1)throw new Error("id must be a number or a string")}a.validateId=Oe}),Oi=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=In();function p(nt,ct,Ft){if(nt!==null)for(var xt,Rt,fe,we,Oe,Ne,ze,je=0,at=0,lt,dt=nt.type,Et=dt==="FeatureCollection",At=dt==="Feature",nn=Et?nt.features.length:1,An=0;An<nn;An++){ze=Et?nt.features[An].geometry:At?nt.geometry:nt,lt=ze?ze.type==="GeometryCollection":!1,Oe=lt?ze.geometries.length:1;for(var Rn=0;Rn<Oe;Rn++){var Vn=0,Wr=0;if(we=lt?ze.geometries[Rn]:ze,we!==null){Ne=we.coordinates;var ri=we.type;switch(je=Ft&&(ri==="Polygon"||ri==="MultiPolygon")?1:0,ri){case null:break;case"Point":if(ct(Ne,at,An,Vn,Wr)===!1)return!1;at++,Vn++;break;case"LineString":case"MultiPoint":for(xt=0;xt<Ne.length;xt++){if(ct(Ne[xt],at,An,Vn,Wr)===!1)return!1;at++,ri==="MultiPoint"&&Vn++}ri==="LineString"&&Vn++;break;case"Polygon":case"MultiLineString":for(xt=0;xt<Ne.length;xt++){for(Rt=0;Rt<Ne[xt].length-je;Rt++){if(ct(Ne[xt][Rt],at,An,Vn,Wr)===!1)return!1;at++}ri==="MultiLineString"&&Vn++,ri==="Polygon"&&Wr++}ri==="Polygon"&&Vn++;break;case"MultiPolygon":for(xt=0;xt<Ne.length;xt++){for(Wr=0,Rt=0;Rt<Ne[xt].length;Rt++){for(fe=0;fe<Ne[xt][Rt].length-je;fe++){if(ct(Ne[xt][Rt][fe],at,An,Vn,Wr)===!1)return!1;at++}Wr++}Vn++}break;case"GeometryCollection":for(xt=0;xt<we.geometries.length;xt++)if(p(we.geometries[xt],ct,Ft)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function y(nt,ct,Ft,xt){var Rt=Ft;return p(nt,function(fe,we,Oe,Ne,ze){we===0&&Ft===void 0?Rt=fe:Rt=ct(Rt,fe,we,Oe,Ne,ze)},xt),Rt}function S(nt,ct){var Ft;switch(nt.type){case"FeatureCollection":for(Ft=0;Ft<nt.features.length&&ct(nt.features[Ft].properties,Ft)!==!1;Ft++);break;case"Feature":ct(nt.properties,0);break}}function k(nt,ct,Ft){var xt=Ft;return S(nt,function(Rt,fe){fe===0&&Ft===void 0?xt=Rt:xt=ct(xt,Rt,fe)}),xt}function F(nt,ct){if(nt.type==="Feature")ct(nt,0);else if(nt.type==="FeatureCollection")for(var Ft=0;Ft<nt.features.length&&ct(nt.features[Ft],Ft)!==!1;Ft++);}function q(nt,ct,Ft){var xt=Ft;return F(nt,function(Rt,fe){fe===0&&Ft===void 0?xt=Rt:xt=ct(xt,Rt,fe)}),xt}function ae(nt){var ct=[];return p(nt,function(Ft){ct.push(Ft)}),ct}function ve(nt,ct){var Ft,xt,Rt,fe,we,Oe,Ne,ze,je,at,lt=0,dt=nt.type==="FeatureCollection",Et=nt.type==="Feature",At=dt?nt.features.length:1;for(Ft=0;Ft<At;Ft++){for(Oe=dt?nt.features[Ft].geometry:Et?nt.geometry:nt,ze=dt?nt.features[Ft].properties:Et?nt.properties:{},je=dt?nt.features[Ft].bbox:Et?nt.bbox:void 0,at=dt?nt.features[Ft].id:Et?nt.id:void 0,Ne=Oe?Oe.type==="GeometryCollection":!1,we=Ne?Oe.geometries.length:1,Rt=0;Rt<we;Rt++){if(fe=Ne?Oe.geometries[Rt]:Oe,fe===null){if(ct(null,lt,ze,je,at)===!1)return!1;continue}switch(fe.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(ct(fe,lt,ze,je,at)===!1)return!1;break}case"GeometryCollection":{for(xt=0;xt<fe.geometries.length;xt++)if(ct(fe.geometries[xt],lt,ze,je,at)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}lt++}}function Je(nt,ct,Ft){var xt=Ft;return ve(nt,function(Rt,fe,we,Oe,Ne){fe===0&&Ft===void 0?xt=Rt:xt=ct(xt,Rt,fe,we,Oe,Ne)}),xt}function $e(nt,ct){ve(nt,function(Ft,xt,Rt,fe,we){var Oe=Ft===null?null:Ft.type;switch(Oe){case null:case"Point":case"LineString":case"Polygon":return ct(c.feature(Ft,Rt,{bbox:fe,id:we}),xt,0)===!1?!1:void 0}var Ne;switch(Oe){case"MultiPoint":Ne="Point";break;case"MultiLineString":Ne="LineString";break;case"MultiPolygon":Ne="Polygon";break}for(var ze=0;ze<Ft.coordinates.length;ze++){var je=Ft.coordinates[ze],at={type:Ne,coordinates:je};if(ct(c.feature(at,Rt),xt,ze)===!1)return!1}})}function mt(nt,ct,Ft){var xt=Ft;return $e(nt,function(Rt,fe,we){fe===0&&we===0&&Ft===void 0?xt=Rt:xt=ct(xt,Rt,fe,we)}),xt}function Nt(nt,ct){$e(nt,function(Ft,xt,Rt){var fe=0;if(Ft.geometry){var we=Ft.geometry.type;if(!(we==="Point"||we==="MultiPoint")){var Oe,Ne=0,ze=0,je=0;if(p(Ft,function(at,lt,dt,Et,At){if(Oe===void 0||xt>Ne||Et>ze||At>je){Oe=at,Ne=xt,ze=Et,je=At,fe=0;return}var nn=c.lineString([Oe,at],Ft.properties);if(ct(nn,xt,Rt,At,fe)===!1)return!1;fe++,Oe=at})===!1)return!1}}})}function Wt(nt,ct,Ft){var xt=Ft,Rt=!1;return Nt(nt,function(fe,we,Oe,Ne,ze){Rt===!1&&Ft===void 0?xt=fe:xt=ct(xt,fe,we,Oe,Ne,ze),Rt=!0}),xt}function gn(nt,ct){if(!nt)throw new Error("geojson is required");$e(nt,function(Ft,xt,Rt){if(Ft.geometry!==null){var fe=Ft.geometry.type,we=Ft.geometry.coordinates;switch(fe){case"LineString":if(ct(Ft,xt,Rt,0,0)===!1)return!1;break;case"Polygon":for(var Oe=0;Oe<we.length;Oe++)if(ct(c.lineString(we[Oe],Ft.properties),xt,Rt,Oe)===!1)return!1;break}}})}function vn(nt,ct,Ft){var xt=Ft;return gn(nt,function(Rt,fe,we,Oe){fe===0&&Ft===void 0?xt=Rt:xt=ct(xt,Rt,fe,we,Oe)}),xt}function Jn(nt,ct){if(ct=ct||{},!c.isObject(ct))throw new Error("options is invalid");var Ft=ct.featureIndex||0,xt=ct.multiFeatureIndex||0,Rt=ct.geometryIndex||0,fe=ct.segmentIndex||0,we=ct.properties,Oe;switch(nt.type){case"FeatureCollection":Ft<0&&(Ft=nt.features.length+Ft),we=we||nt.features[Ft].properties,Oe=nt.features[Ft].geometry;break;case"Feature":we=we||nt.properties,Oe=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Oe=nt;break;default:throw new Error("geojson is invalid")}if(Oe===null)return null;var Ne=Oe.coordinates;switch(Oe.type){case"Point":case"MultiPoint":return null;case"LineString":return fe<0&&(fe=Ne.length+fe-1),c.lineString([Ne[fe],Ne[fe+1]],we,ct);case"Polygon":return Rt<0&&(Rt=Ne.length+Rt),fe<0&&(fe=Ne[Rt].length+fe-1),c.lineString([Ne[Rt][fe],Ne[Rt][fe+1]],we,ct);case"MultiLineString":return xt<0&&(xt=Ne.length+xt),fe<0&&(fe=Ne[xt].length+fe-1),c.lineString([Ne[xt][fe],Ne[xt][fe+1]],we,ct);case"MultiPolygon":return xt<0&&(xt=Ne.length+xt),Rt<0&&(Rt=Ne[xt].length+Rt),fe<0&&(fe=Ne[xt][Rt].length-fe-1),c.lineString([Ne[xt][Rt][fe],Ne[xt][Rt][fe+1]],we,ct)}throw new Error("geojson is invalid")}function Ke(nt,ct){if(ct=ct||{},!c.isObject(ct))throw new Error("options is invalid");var Ft=ct.featureIndex||0,xt=ct.multiFeatureIndex||0,Rt=ct.geometryIndex||0,fe=ct.coordIndex||0,we=ct.properties,Oe;switch(nt.type){case"FeatureCollection":Ft<0&&(Ft=nt.features.length+Ft),we=we||nt.features[Ft].properties,Oe=nt.features[Ft].geometry;break;case"Feature":we=we||nt.properties,Oe=nt.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Oe=nt;break;default:throw new Error("geojson is invalid")}if(Oe===null)return null;var Ne=Oe.coordinates;switch(Oe.type){case"Point":return c.point(Ne,we,ct);case"MultiPoint":return xt<0&&(xt=Ne.length+xt),c.point(Ne[xt],we,ct);case"LineString":return fe<0&&(fe=Ne.length+fe),c.point(Ne[fe],we,ct);case"Polygon":return Rt<0&&(Rt=Ne.length+Rt),fe<0&&(fe=Ne[Rt].length+fe),c.point(Ne[Rt][fe],we,ct);case"MultiLineString":return xt<0&&(xt=Ne.length+xt),fe<0&&(fe=Ne[xt].length+fe),c.point(Ne[xt][fe],we,ct);case"MultiPolygon":return xt<0&&(xt=Ne.length+xt),Rt<0&&(Rt=Ne[xt].length+Rt),fe<0&&(fe=Ne[xt][Rt].length-fe),c.point(Ne[xt][Rt][fe],we,ct)}throw new Error("geojson is invalid")}a.coordAll=ae,a.coordEach=p,a.coordReduce=y,a.featureEach=F,a.featureReduce=q,a.findPoint=Ke,a.findSegment=Jn,a.flattenEach=$e,a.flattenReduce=mt,a.geomEach=ve,a.geomReduce=Je,a.lineEach=gn,a.lineReduce=vn,a.propEach=S,a.propReduce=k,a.segmentEach=Nt,a.segmentReduce=Wt}),es=l(a=>{Object.defineProperty(a,"__esModule",{value:!0});var c=Oi();function p(y){var S=[1/0,1/0,-1/0,-1/0];return c.coordEach(y,function(k){S[0]>k[0]&&(S[0]=k[0]),S[1]>k[1]&&(S[1]=k[1]),S[2]<k[0]&&(S[2]=k[0]),S[3]<k[1]&&(S[3]=k[1])}),S}p.default=p,a.default=p}),ss=l((a,c)=>{var p=Tn(),y=In(),S=Oi(),k=es().default,F=S.featureEach;S.coordEach,y.polygon;var q=y.featureCollection;function ae(ve){var Je=new p(ve);return Je.insert=function($e){if($e.type!=="Feature")throw new Error("invalid feature");return $e.bbox=$e.bbox?$e.bbox:k($e),p.prototype.insert.call(this,$e)},Je.load=function($e){var mt=[];return Array.isArray($e)?$e.forEach(function(Nt){if(Nt.type!=="Feature")throw new Error("invalid features");Nt.bbox=Nt.bbox?Nt.bbox:k(Nt),mt.push(Nt)}):F($e,function(Nt){if(Nt.type!=="Feature")throw new Error("invalid features");Nt.bbox=Nt.bbox?Nt.bbox:k(Nt),mt.push(Nt)}),p.prototype.load.call(this,mt)},Je.remove=function($e,mt){if($e.type!=="Feature")throw new Error("invalid feature");return $e.bbox=$e.bbox?$e.bbox:k($e),p.prototype.remove.call(this,$e,mt)},Je.clear=function(){return p.prototype.clear.call(this)},Je.search=function($e){var mt=p.prototype.search.call(this,this.toBBox($e));return q(mt)},Je.collides=function($e){return p.prototype.collides.call(this,this.toBBox($e))},Je.all=function(){var $e=p.prototype.all.call(this);return q($e)},Je.toJSON=function(){return p.prototype.toJSON.call(this)},Je.fromJSON=function($e){return p.prototype.fromJSON.call(this,$e)},Je.toBBox=function($e){var mt;if($e.bbox)mt=$e.bbox;else if(Array.isArray($e)&&$e.length===4)mt=$e;else if(Array.isArray($e)&&$e.length===6)mt=[$e[0],$e[1],$e[3],$e[4]];else if($e.type==="Feature")mt=k($e);else if($e.type==="FeatureCollection")mt=k($e);else throw new Error("invalid geojson");return{minX:mt[0],minY:mt[1],maxX:mt[2],maxY:mt[3]}},Je}c.exports=ae,c.exports.default=ae});Array.prototype.findIndex=Array.prototype.findIndex||function(a){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),p=c.length>>>0,y=arguments[1],S=0;S<p;S++)if(a.call(y,c[S],S,c))return S;return-1},Array.prototype.find=Array.prototype.find||function(a){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof a!="function")throw new TypeError("callback must be a function");for(var c=Object(this),p=c.length>>>0,y=arguments[1],S=0;S<p;S++){var k=c[S];if(a.call(y,k,S,c))return k}},typeof Object.assign!="function"&&(Object.assign=function(a){if(a==null)throw new TypeError("Cannot convert undefined or null to object");a=Object(a);for(var c=1;c<arguments.length;c++){var p=arguments[c];if(p!=null)for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(a[y]=p[y])}return a}),function(a){a.forEach(function(c){c.hasOwnProperty("remove")||Object.defineProperty(c,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,c){if(this==null)throw new TypeError('"this" is null or not defined');var p=Object(this),y=p.length>>>0;if(y===0)return!1;var S=c|0,k=Math.max(S>=0?S:y-Math.abs(S),0);function F(q,ae){return q===ae||typeof q=="number"&&typeof ae=="number"&&isNaN(q)&&isNaN(ae)}for(;k<y;){if(F(p[k],a))return!0;k++}return!1}});var ps={version:"2.18.3"},tr=g(di()),pn={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},pi={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},$r={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},oi={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},Qs={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},Ao={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},oo={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},vi={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},As={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},ao={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},os={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},Ea={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para finalizar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},jr={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vértice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do círculo",finishCircle:"Clique para terminar o círculo",placeCircleMarker:"Clique para colocar marcador de círculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover Último Vértice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polígonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Círculo",drawRectButton:"Desenhar Retângulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Círculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vértices",pinningButton:"Unir vértices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traçado Automático de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"Área",radius:"Raio",perimeter:"Perímetro",height:"Altura",width:"Largura",coordinates:"Posição",coordinatesMarker:"Marcador de Posição"}},lo={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},Li={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Vo={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},ca={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},Wa={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},ts={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},ru={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},hl={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},ir={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},ur={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},po={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Or={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Nl={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},Aa={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},Ma=jr,go={en:pn,de:pi,it:$r,id:oi,ro:Qs,ru:Ao,es:oo,nl:vi,fr:As,pt:Ma,pt_br:Ea,pt_pt:jr,zh:ao,zh_tw:os,pl:lo,sv:Li,el:Vo,hu:ca,da:Wa,no:ts,fa:ru,ua:hl,tr:ir,cz:ur,ja:po,fi:Or,ko:Nl,ky:Aa},ha={_globalEditModeEnabled:!1,enableGlobalEditMode(a){let c={...a};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(p=>{this._isRelevantForEdit(p)&&p.pm.enable(c)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(a=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(a)},handleLayerAdditionInGlobalEditMode(){let a=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let c in a){let p=a[c];this._isRelevantForEdit(p)&&p.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:a}){this._addedLayersEdit[L.stamp(a)]=a},_isRelevantForEdit(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowEditing}},Rl=ha,Za={_globalDragModeEnabled:!1,enableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},a.forEach(c=>{this._isRelevantForDrag(c)&&c.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let a=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,a.forEach(c=>{c.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let a=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let c in a){let p=a[c];this._isRelevantForDrag(p)&&p.pm.enableLayerDrag()}},_layerAddedDrag({layer:a}){this._addedLayersDrag[L.stamp(a)]=a},_isRelevantForDrag(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.draggable}},or=Za,_r={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(a=>{this._isRelevantForRemoval(a)&&(a.pm.enabled()&&a.pm.disable(),a.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(a=>{a.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(a){let c=a.target;this._isRelevantForRemoval(c)&&!c.pm.dragging()&&(c.removeFrom(this.map.pm._getContainingLayer()),c.remove(),c instanceof L.LayerGroup?(this._fireRemoveLayerGroup(c),this._fireRemoveLayerGroup(this.map,c)):(c.pm._fireRemove(c),c.pm._fireRemove(this.map,c)))},_isRelevantForRemoval(a){return a.pm&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let a=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let c in a){let p=a[c];this._isRelevantForRemoval(p)&&(p.pm.enabled()&&p.pm.disable(),p.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:a}){this._addedLayersRemoval[L.stamp(a)]=a}},fa=_r,iu={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{this._isRelevantForRotate(a)&&a.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(a=>a instanceof L.Polyline).forEach(a=>{a.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(a){return a.pm&&a instanceof L.Polyline&&!(a instanceof L.LayerGroup)&&(!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)&&!a._pmTempLayer&&a.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let a=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let c in a){let p=a[c];this._isRelevantForRemoval(p)&&p.pm.enableRotate()}},_layerAddedRotate({layer:a}){this._addedLayersRotate[L.stamp(a)]=a}},Ka=iu,fl=g(di()),ka={_fireDrawStart(a="Draw",c={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},a,c)},_fireDrawEnd(a="Draw",c={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},a,c)},_fireCreate(a,c="Draw",p={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:a,layer:a},c,p)},_fireCenterPlaced(a="Draw",c={}){let p=a==="Draw"?this._layer:void 0,y=a!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:p,layer:y,latlng:this._layer.getLatLng()},a,c)},_fireCut(a,c,p,y="Draw",S={}){this.__fire(a,"pm:cut",{shape:this._shape,layer:c,originalLayer:p},y,S)},_fireEdit(a=this._layer,c="Edit",p={}){this.__fire(a,"pm:edit",{layer:this._layer,shape:this.getShape()},c,p)},_fireEnable(a="Edit",c={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDisable(a="Edit",c={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},a,c)},_fireUpdate(a="Edit",c={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},a,c)},_fireMarkerDragStart(a,c=void 0,p="Edit",y={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},p,y)},_fireMarkerDrag(a,c=void 0,p="Edit",y={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c},p,y)},_fireMarkerDragEnd(a,c=void 0,p=void 0,y="Edit",S={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:a,shape:this.getShape(),indexPath:c,intersectionReset:p},y,S)},_fireDragStart(a="Edit",c={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},a,c)},_fireDrag(a,c="Edit",p={}){this.__fire(this._layer,"pm:drag",{...a,shape:this.getShape()},c,p)},_fireDragEnd(a="Edit",c={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragEnable(a="Edit",c={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},a,c)},_fireDragDisable(a="Edit",c={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},a,c)},_fireRemove(a,c=a,p="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:this.getShape()},p,y)},_fireVertexAdded(a,c,p,y="Edit",S={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:a,indexPath:c,latlng:p,shape:this.getShape()},y,S)},_fireVertexRemoved(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:a,indexPath:c,shape:this.getShape()},p,y)},_fireVertexClick(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},p,y)},_fireIntersect(a,c=this._layer,p="Edit",y={}){this.__fire(c,"pm:intersect",{layer:this._layer,intersection:a,shape:this.getShape()},p,y)},_fireLayerReset(a,c,p="Edit",y={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:a,indexPath:c,shape:this.getShape()},p,y)},_fireChange(a,c="Edit",p={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:a,shape:this.getShape()},c,p)},_fireTextChange(a,c="Edit",p={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:a,shape:this.getShape()},c,p)},_fireTextFocus(a="Edit",c={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},a,c)},_fireTextBlur(a="Edit",c={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},a,c)},_fireSnapDrag(a,c,p="Snapping",y={}){this.__fire(a,"pm:snapdrag",c,p,y)},_fireSnap(a,c,p="Snapping",y={}){this.__fire(a,"pm:snap",c,p,y)},_fireUnsnap(a,c,p="Snapping",y={}){this.__fire(a,"pm:unsnap",c,p,y)},_fireRotationEnable(a,c,p="Rotation",y={}){this.__fire(a,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},p,y)},_fireRotationDisable(a,c="Rotation",p={}){this.__fire(a,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},c,p)},_fireRotationStart(a,c,p="Rotation",y={}){this.__fire(a,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:c},p,y)},_fireRotation(a,c,p,y=this._rotationLayer,S="Rotation",k={}){this.__fire(a,"pm:rotate",{layer:y,helpLayer:this._layer,startAngle:this._startAngle,angle:y.pm.getAngle(),angleDiff:c,oldLatLngs:p,newLatLngs:y.getLatLngs()},S,k)},_fireRotationEnd(a,c,p,y="Rotation",S={}){this.__fire(a,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:c,angle:this._rotationLayer.pm.getAngle(),originLatLngs:p,newLatLngs:this._rotationLayer.getLatLngs()},y,S)},_fireActionClick(a,c,p,y="Toolbar",S={}){this.__fire(this._map,"pm:actionclick",{text:a.text,action:a,btnName:c,button:p},y,S)},_fireButtonClick(a,c,p="Toolbar",y={}){this.__fire(this._map,"pm:buttonclick",{btnName:a,button:c},p,y)},_fireLangChange(a,c,p,y,S="Global",k={}){this.__fire(this.map,"pm:langchange",{oldLang:a,activeLang:c,fallback:p,translations:y},S,k)},_fireGlobalDragModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalEditModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalRemovalModeToggled(a,c="Global",p={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:a,map:this.map},c,p)},_fireGlobalCutModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},a,c)},_fireGlobalDrawModeToggled(a="Global",c={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},a,c)},_fireGlobalRotateModeToggled(a="Global",c={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},a,c)},_fireRemoveLayerGroup(a,c=a,p="Edit",y={}){this.__fire(a,"pm:remove",{layer:c,shape:void 0},p,y)},_fireKeyeventEvent(a,c,p,y="Global",S={}){this.__fire(this.map,"pm:keyevent",{event:a,eventType:c,focusOn:p},y,S)},__fire(a,c,p,y,S={}){p=(0,fl.default)(p,S,{source:y}),L.PM.Utils._fireEvent(a,c,p)}},Ja=ka,dl=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(a){this.map=a,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),a.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(a){let c="document";this.map.getContainer().contains(a.target)&&(c="map");let p={event:a,eventType:a.type,focusOn:c};this._lastEvents[a.type]=p,this._lastEvents.current=p,this.map.pm._fireKeyeventEvent(a,a.type,c)},_onBlur(a){a.altKey=!1;let c={event:a,eventType:a.type,focusOn:"document"};this._lastEvents[a.type]=c,this._lastEvents.current=c},getLastKeyEvent(a="current"){return this._lastEvents[a]},isShiftKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.shiftKey},isAltKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.altKey},isCtrlKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.ctrlKey},isMetaKeyPressed(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.metaKey},getPressedKey(){var a;return(a=this._lastEvents.current)==null?void 0:a.event.key}}),Sr=dl,Ii=g(Xt());function Wn(a){let c=L.PM.activeLang;return(0,Ii.default)(go[c],a)||(0,Ii.default)(go.en,a)||a}function Fi(a){for(let c=0;c<a.length;c+=1){let p=a[c];if(Array.isArray(p)){if(Fi(p))return!0}else if(p!=null&&p!=="")return!0}return!1}function Ta(a){return a.reduce((c,p)=>{if(p.length!==0){let y=Array.isArray(p)?Ta(p):p;Array.isArray(y)?y.length!==0&&c.push(y):c.push(y)}return c},[])}function Go(a,c,p){let y={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:S,b:k,f:F}=y,q=a.lng,ae=a.lat,ve=p,Je=Math.PI,$e=c*Je/180,mt=Math.sin($e),Nt=Math.cos($e),Wt=(1-F)*Math.tan(ae*Je/180),gn=1/Math.sqrt(1+Wt*Wt),vn=Wt*gn,Jn=Math.atan2(Wt,Nt),Ke=gn*mt,nt=1-Ke*Ke,ct=nt*(S*S-k*k)/(k*k),Ft=1+ct/16384*(4096+ct*(-768+ct*(320-175*ct))),xt=ct/1024*(256+ct*(-128+ct*(74-47*ct))),Rt=ve/(k*Ft),fe=2*Math.PI,we,Oe,Ne;for(;Math.abs(Rt-fe)>1e-12;){we=Math.cos(2*Jn+Rt),Oe=Math.sin(Rt),Ne=Math.cos(Rt);let nn=xt*Oe*(we+xt/4*(Ne*(-1+2*we*we)-xt/6*we*(-3+4*Oe*Oe)*(-3+4*we*we)));fe=Rt,Rt=ve/(k*Ft)+nn}let ze=vn*Oe-gn*Ne*Nt,je=Math.atan2(vn*Ne+gn*Oe*Nt,(1-F)*Math.sqrt(Ke*Ke+ze*ze)),at=Math.atan2(Oe*mt,gn*Ne-vn*Oe*Nt),lt=F/16*nt*(4+F*(4-3*nt)),dt=at-(1-lt)*F*Ke*(Rt+lt*Oe*(we+lt*Ne*(-1+2*we*we))),Et=q+dt*180/Je,At=je*180/Je;return L.latLng(Et,At)}function yi(a,c,p,y,S=!0){let k,F,q,ae=[];for(let ve=0;ve<p;ve+=1){if(S)k=ve*360/p+y,F=Go(a,k,c),q=L.latLng(F.lng,F.lat);else{let Je=a.lat+Math.cos(2*ve*Math.PI/p)*c,$e=a.lng+Math.sin(2*ve*Math.PI/p)*c;q=L.latLng(Je,$e)}ae.push(q)}return ae}function pl(a,c,p){c=(c+360)%360;let y=Math.PI/180,S=180/Math.PI,{R:k}=L.CRS.Earth,F=a.lng*y,q=a.lat*y,ae=c*y,ve=Math.sin(q),Je=Math.cos(q),$e=Math.cos(p/k),mt=Math.sin(p/k),Nt=Math.asin(ve*$e+Je*mt*Math.cos(ae)),Wt=F+Math.atan2(Math.sin(ae)*mt*Je,$e-ve*Math.sin(Nt));Wt*=S;let gn=Wt-360,vn=Wt<-180?Wt+360:Wt;return Wt=Wt>180?gn:vn,L.latLng([Nt*S,Wt])}function Mo(a,c,p){let y=a.latLngToContainerPoint(c),S=a.latLngToContainerPoint(p),k=Math.atan2(S.y-y.y,S.x-y.x)*180/Math.PI+90;return k+=k<0?360:0,k}function Ya(a,c,p,y){let S=Mo(a,c,p);return pl(c,S,y)}function Xa(a,c,p="asc"){if(!c||Object.keys(c).length===0)return(ae,ve)=>ae-ve;let y=Object.keys(c),S,k=y.length-1,F={};for(;k>=0;)S=y[k],F[S.toLowerCase()]=c[S],k-=1;function q(ae){if(ae instanceof L.Marker)return"Marker";if(ae instanceof L.Circle)return"Circle";if(ae instanceof L.CircleMarker)return"CircleMarker";if(ae instanceof L.Rectangle)return"Rectangle";if(ae instanceof L.Polygon)return"Polygon";if(ae instanceof L.Polyline)return"Line"}return(ae,ve)=>{let Je,$e;if(Je=q(ae.layer).toLowerCase(),$e=q(ve.layer).toLowerCase(),!Je||!$e)return 0;let mt=Je in F?F[Je]:Number.MAX_SAFE_INTEGER,Nt=$e in F?F[$e]:Number.MAX_SAFE_INTEGER,Wt=0;return mt<Nt?Wt=-1:mt>Nt&&(Wt=1),p==="desc"?Wt*-1:Wt}}function uo(a,c=a.getLatLngs()){return a instanceof L.Polygon?L.polygon(c).getLatLngs():L.polyline(c).getLatLngs()}function Qa(a,c){var p,y,S,k;if((y=(p=c.options.crs)==null?void 0:p.projection)!=null&&y.MAX_LATITUDE){let F=(k=(S=c.options.crs)==null?void 0:S.projection)==null?void 0:k.MAX_LATITUDE;a.lat=Math.max(Math.min(F,a.lat),-F)}return a}function Zr(a){return a.options.renderer||a._map&&(a._map._getPaneRenderer(a.options.pane)||a._map.options.renderer||a._map._renderer)||a._renderer}var su=L.Class.extend({includes:[Rl,or,fa,Ka,Ja],initialize(a){this.map=a,this.Draw=new L.PM.Draw(a),this.Toolbar=new L.PM.Toolbar(a),this.Keyboard=Sr(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(a)},setLang(a="en",c,p="en"){if(a=a.trim().toLowerCase(),!/^[a-z]{2}$/.test(a)){let S=a.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(S){let k=[`${S[1]}_${S[2]}`,`${S[1]}`];for(let F of k)if(go[F]){a=F;break}}}let y=L.PM.activeLang;c&&(go[a]=(0,tr.default)(go[p],c)),L.PM.activeLang=a,this.map.pm.Toolbar.reinit(),this._fireLangChange(y,a,p,go[a])},addControls(a){this.Toolbar.addControls(a)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(a="Polygon",c){a==="Poly"&&(a="Polygon"),this.Draw.enable(a,c)},disableDraw(a="Polygon"){a==="Poly"&&(a="Polygon"),this.Draw.disable(a)},setPathOptions(a,c={}){let p=c.ignoreShapes||[],y=c.merge||!1;this.map.pm.Draw.shapes.forEach(S=>{p.indexOf(S)===-1&&this.map.pm.Draw[S].setPathOptions(a,y)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(a){let c=(0,tr.default)(this.globalOptions,a);c.editable&&(c.resizeableCircleMarker=c.editable,delete c.editable);let p=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!c.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),p=!0);let y=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!c.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),y=!0),this.map.pm.Draw.shapes.forEach(S=>{this.map.pm.Draw[S].setOptions(c)}),p&&this.map.pm.Draw.CircleMarker.enable(),y&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(S=>{S.pm.setOptions(c)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=c,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.enabled()&&a.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(a){return this.Draw.Cut.enable(a)},toggleGlobalCutMode(a){return this.Draw.Cut.toggle(a)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(a=!1){let c=L.PM.Utils.findLayers(this.map);if(!a)return c;let p=L.featureGroup();return p._pmTempLayer=!0,c.forEach(y=>{p.addLayer(y)}),p},getGeomanDrawLayers(a=!1){let c=L.PM.Utils.findLayers(this.map).filter(y=>y._drawnByGeoman===!0);if(!a)return c;let p=L.featureGroup();return p._pmTempLayer=!0,c.forEach(y=>{p.addLayer(y)}),p},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(a){this._touchEventCounter===0&&(L.DomEvent.on(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(a){this._touchEventCounter===1&&(L.DomEvent.off(a,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(a,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(a){Zr(this.map)._onMouseMove(this._createMouseEvent("mousemove",a))},_canvasTouchClick(a){let c="";a.type==="touchstart"||a.type==="pointerdown"?c="mousedown":(a.type==="touchend"||a.type==="pointerup"||a.type==="touchcancel"||a.type==="pointercancel")&&(c="mouseup"),c&&Zr(this.map)._onClick(this._createMouseEvent(c,a))},_createMouseEvent(a,c){let p,y=c.touches[0]||c.changedTouches[0];try{p=new MouseEvent(a,{bubbles:c.bubbles,cancelable:c.cancelable,view:c.view,detail:y.detail,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY,ctrlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey,metaKey:c.metaKey,button:c.button,relatedTarget:c.relatedTarget})}catch{p=document.createEvent("MouseEvents"),p.initMouseEvent(a,c.bubbles,c.cancelable,c.view,y.detail,y.screenX,y.screenY,y.clientX,y.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}return p}}),as=su,mo=L.Control.extend({includes:[Ja],options:{position:"topleft",disableByOtherButtons:!0},initialize(a){this._button=L.Util.extend({},this.options,a)},onAdd(a){return this._map=a,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let a=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),a?a.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(a){return typeof a=="boolean"?this._button.toggleStatus=a:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(a){a&&a.preventDefault(),!this._button.disabled&&(this._button.onClick(a,{button:this,event:a}),this._clicked(a),this._button.afterClick(a,{button:this,event:a}))},_makeButton(a){let c=this.options.position.indexOf("right")>-1?"pos-right":"",p=L.DomUtil.create("div",`button-container  ${c}`,this._container);a.title&&p.setAttribute("title",a.title);let y=L.DomUtil.create("a","leaflet-buttons-control-button",p);y.setAttribute("role","button"),y.setAttribute("tabindex","0"),y.href="#";let S=L.DomUtil.create("div",`leaflet-pm-actions-container ${c}`,p),k=a.actions,F={cancel:{text:Wn("actions.cancel"),title:Wn("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:Wn("actions.finish"),title:Wn("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:Wn("actions.removeLastVertex"),title:Wn("actions.removeLastVertex"),onClick(){this._map.pm.Draw[a.jsClass]._removeLastVertex()}},finish:{text:Wn("actions.finish"),title:Wn("actions.finish"),onClick(ae){this._map.pm.Draw[a.jsClass]._finishShape(ae)}}};a._preparedActions=k.map(ae=>{let ve=typeof ae=="string"?ae:ae.name,Je;if(F[ve])Je=F[ve];else if(ae.text)Je=ae;else return Je;let $e=L.DomUtil.create("a",`leaflet-pm-action ${c} action-${ve}`,S);if($e.setAttribute("role","button"),$e.setAttribute("tabindex","0"),$e.href="#",Je.title&&($e.title=Je.title),$e.innerHTML=Je.text,L.DomEvent.disableClickPropagation($e),L.DomEvent.on($e,"click",L.DomEvent.stop),Je._node=$e,!a.disabled&&Je.onClick){let mt=Nt=>{Nt.preventDefault();let Wt="",{buttons:gn}=this._map.pm.Toolbar;for(let vn in gn)if(gn[vn]._button===a){Wt=vn;break}this._fireActionClick(Je,Wt,a)};L.DomEvent.addListener($e,"click",mt,this),L.DomEvent.addListener($e,"click",Je.onClick,this),L.DomEvent.addListener($e,"click",()=>this._updateActiveAction(a))}return Je}),this._updateActiveAction(a),a.toggleStatus&&L.DomUtil.addClass(p,"active");let q=L.DomUtil.create("div","control-icon",y);return a.iconUrl&&q.setAttribute("src",a.iconUrl),a.className&&L.DomUtil.addClass(q,a.className),L.DomEvent.disableClickPropagation(y),L.DomEvent.on(y,"click",L.DomEvent.stop),a.disabled||(L.DomEvent.addListener(y,"click",this._onBtnClick,this),L.DomEvent.addListener(y,"click",this._triggerClick,this)),a.disabled&&(L.DomUtil.addClass(y,"pm-disabled"),y.setAttribute("aria-disabled","true")),p},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let a="",{buttons:c}=this._map.pm.Toolbar;for(let p in c)if(c[p]._button===this._button){a=p;break}this._fireButtonClick(a,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let a="pm-disabled",c=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(c,a),c.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(c,a),c.setAttribute("aria-disabled","false"))},_updateActiveAction(a){var c;(c=a._preparedActions)==null||c.forEach(p=>{p!=null&&p._node&&(p.isActive&&p.isActive.call(this)?L.DomUtil.addClass(p._node,"active-action"):L.DomUtil.removeClass(p._node,"active-action"))})}}),el=mo;L.Control.PMButton=el;var vo=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(a){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(a)},reinit(){let a=this.isVisible;this.removeControls(),this._defineButtons(),a&&this.addControls()},init(a){this.map=a,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(a){let c=`${a}Container`;return this[c]||(this[c]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${a} leaflet-bar leaflet-control`)),this[c]},getButtons(){return this.buttons},addControls(a=this.options){typeof a.editPolygon<"u"&&(a.editMode=a.editPolygon),typeof a.deleteLayer<"u"&&(a.removalMode=a.deleteLayer),L.Util.setOptions(this,a),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let a=this.getButtons(),c={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let p in a){let y=a[p];L.Util.setOptions(y,{className:c.geomanIcons[p]})}},removeControls(){let a=this.getButtons();for(let c in a)a[c].remove();this.isVisible=!1},toggleControls(a=this.options){this.isVisible?this.removeControls():this.addControls(a)},_addButton(a,c){return this.buttons[a]=c,this.options[a]=!!this.options[a]||!1,this.buttons[a]},triggerClickOnToggledButtons(a){for(let c in this.buttons){let p=this.buttons[c];p._button.disableByOtherButtons&&p!==a&&p.toggled()&&p._triggerClick()}},toggleButton(a,c,p=!0){a==="editPolygon"&&(a="editMode"),a==="deleteLayer"&&(a="removalMode");let y=a;return p&&this.triggerClickOnToggledButtons(this.buttons[y]),this.buttons[y]?this.buttons[y].toggle(c):!1},_defineButtons(){let a={className:"control-icon leaflet-pm-icon-marker",title:Wn("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},c={title:Wn("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},p={className:"control-icon leaflet-pm-icon-polyline",title:Wn("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},y={title:Wn("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},S={title:Wn("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},k={title:Wn("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},F={title:Wn("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},q={title:Wn("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},ae={title:Wn("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},ve={title:Wn("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Je={title:Wn("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},$e={className:"control-icon leaflet-pm-icon-text",title:Wn("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(mt,Nt)=>{this.map.pm.Draw[Nt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(a)),this._addButton("drawPolyline",new L.Control.PMButton(p)),this._addButton("drawRectangle",new L.Control.PMButton(k)),this._addButton("drawPolygon",new L.Control.PMButton(c)),this._addButton("drawCircle",new L.Control.PMButton(y)),this._addButton("drawCircleMarker",new L.Control.PMButton(S)),this._addButton("drawText",new L.Control.PMButton($e)),this._addButton("editMode",new L.Control.PMButton(F)),this._addButton("dragMode",new L.Control.PMButton(q)),this._addButton("cutPolygon",new L.Control.PMButton(ae)),this._addButton("removalMode",new L.Control.PMButton(ve)),this._addButton("rotateMode",new L.Control.PMButton(Je))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let a=this.getButtons(),c=[];this.options.drawControls===!1&&(c=c.concat(Object.keys(a).filter(p=>!a[p]._button.tool))),this.options.editControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="edit"))),this.options.optionsControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="options"))),this.options.customControls===!1&&(c=c.concat(Object.keys(a).filter(p=>a[p]._button.tool==="custom")));for(let p in a)if(this.options[p]&&c.indexOf(p)===-1){let y=a[p]._button.tool;y||(y="draw"),a[p].setPosition(this._getBtnPosition(y)),a[p].addTo(this.map)}},_getBtnPosition(a){return this.options.positions&&this.options.positions[a]?this.options.positions[a]:this.options.position},setBlockPosition(a,c){this.options.positions[a]=c,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(a,c){if(c)typeof c!="object"&&(c={name:c});else throw new TypeError("Button has no name");let p=this._btnNameMapping(a);if(!c.name)throw new TypeError("Button has no name");if(this.buttons[c.name])throw new TypeError("Button with this name already exists");let y=this.map.pm.Draw.createNewDrawInstance(c.name,p);c={...this.buttons[p]._button,...c};let S=this.createCustomControl(c);return{drawInstance:y,control:S}},createCustomControl(a){if(!a.name)throw new TypeError("Button has no name");if(this.buttons[a.name])throw new TypeError("Button with this name already exists");a.onClick||(a.onClick=()=>{}),a.afterClick||(a.afterClick=()=>{}),a.toggle!==!1&&(a.toggle=!0),a.block&&(a.block=a.block.toLowerCase()),(!a.block||a.block==="draw")&&(a.block=""),a.className?a.className.indexOf("control-icon")===-1&&(a.className=`control-icon ${a.className}`):a.className="control-icon";let c={tool:a.block,className:a.className,title:a.title||"",jsClass:a.name,onClick:a.onClick,afterClick:a.afterClick,doToggle:a.toggle,toggleStatus:!1,disableOtherButtons:a.disableOtherButtons??!0,disableByOtherButtons:a.disableByOtherButtons??!0,cssToggle:a.toggle,position:this.options.position,actions:a.actions||[],disabled:!!a.disabled};this.options[a.name]!==!1&&(this.options[a.name]=!0);let p=this._addButton(a.name,new L.Control.PMButton(c));return this.changeControlOrder(),p},controlExists(a){return!!this.getButton(a)},getButton(a){return this.getButtons()[a]},getButtonsInBlock(a){let c={};if(a)for(let p in this.getButtons()){let y=this.getButtons()[p];(y._button.tool===a||a==="draw"&&!y._button.tool)&&(c[p]=y)}return c},changeControlOrder(a=[]){let c=this._shapeMapping(),p=[];a.forEach(k=>{c[k]?p.push(c[k]):p.push(k)});let y=this.getButtons(),S={};p.forEach(k=>{y[k]&&(S[k]=y[k])}),Object.keys(y).filter(k=>!y[k]._button.tool||y[k]._button.tool==="draw").forEach(k=>{p.indexOf(k)===-1&&(S[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="edit").forEach(k=>{p.indexOf(k)===-1&&(S[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="options").forEach(k=>{p.indexOf(k)===-1&&(S[k]=y[k])}),Object.keys(y).filter(k=>y[k]._button.tool==="custom").forEach(k=>{p.indexOf(k)===-1&&(S[k]=y[k])}),Object.keys(y).forEach(k=>{p.indexOf(k)===-1&&(S[k]=y[k])}),this.map.pm.Toolbar.buttons=S,this._showHideButtons()},getControlOrder(){let a=this.getButtons(),c=[];for(let p in a)c.push(p);return c},changeActionsOfControl(a,c){let p=this._btnNameMapping(a);if(!p)throw new TypeError("No name passed");if(!c)throw new TypeError("No actions passed");if(!this.buttons[p])throw new TypeError("Button with this name not exists");this.buttons[p]._button.actions=c,this.changeControlOrder()},setButtonDisabled(a,c){let p=this._btnNameMapping(a);c?this.buttons[p].disable():this.buttons[p].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(a){let c=this._shapeMapping();return c[a]?c[a]:a}}),Ba=vo,Na=g(di()),Kr={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(a){a.forEach(c=>{if(Array.isArray(c)){this._assignEvents(c);return}c.off("drag",this._handleSnapping,this),c.on("drag",this._handleSnapping,this),c.off("dragend",this._cleanupSnapping,this),c.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(a){if(a){let c=a.target;c._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(c=>{c.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(a){var q,ae,ve;let c=a.target;if(c._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((q=a==null?void 0:a.originalEvent)==null?void 0:q.altKey)||((ve=(ae=this._map)==null?void 0:ae.pm)==null?void 0:ve.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let p=this._calcClosestLayer(c.getLatLng(),this._snapList);if(Object.keys(p).length===0)return!1;let y=p.layer instanceof L.Marker||p.layer instanceof L.CircleMarker||!this.options.snapSegment,S;y?S=p.latlng:S=this._checkPrioritiySnapping(p);let k=this.options.snapDistance,F={marker:c,shape:this._shape,snapLatLng:S,segment:p.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:p.layer,distance:p.distance};if(this._fireSnapDrag(F.marker,F),this._fireSnapDrag(this._layer,F),p.distance<k){c._orgLatLng=c.getLatLng(),c.setLatLng(S),c._snapped=!0,c._snapInfo=F;let Je=()=>{this._snapLatLng=S,this._fireSnap(c,F),this._fireSnap(this._layer,F)},$e=this._snapLatLng||{},mt=S||{};($e.lat!==mt.lat||$e.lng!==mt.lng)&&Je()}else this._snapLatLng&&(this._unsnap(F),c._snapped=!1,c._snapInfo=void 0,this._fireUnsnap(F.marker,F),this._fireUnsnap(this._layer,F));return!0},_createSnapList(){let a=[],c=[],p=this._map;p.off("layerremove",this._handleSnapLayerRemoval,this),p.on("layerremove",this._handleSnapLayerRemoval,this),p.eachLayer(y=>{if((y instanceof L.Polyline||y instanceof L.Marker||y instanceof L.CircleMarker||y instanceof L.ImageOverlay)&&y.options.snapIgnore!==!0){if(y.options.snapIgnore===void 0&&(!L.PM.optIn&&y.options.pmIgnore===!0||L.PM.optIn&&y.options.pmIgnore!==!1))return;(y instanceof L.Circle||y instanceof L.CircleMarker)&&y.pm&&y.pm._hiddenPolyCircle?a.push(y.pm._hiddenPolyCircle):y instanceof L.ImageOverlay&&(y=L.rectangle(y.getBounds())),a.push(y);let S=L.polyline([],{color:"red",pmIgnore:!0});S._pmTempLayer=!0,c.push(S),(y instanceof L.Circle||y instanceof L.CircleMarker)&&c.push(S)}}),a=a.filter(y=>this._layer!==y),a=a.filter(y=>y._latlng||y._latlngs&&Fi(y._latlngs)),a=a.filter(y=>!y._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let y=L.polyline([],{color:"red",pmIgnore:!0});y._pmTempLayer=!0,c.push(y)}),this._snapList=a.concat(this._otherSnapLayers)):this._snapList=a,this.debugIndicatorLines=c},_handleSnapLayerRemoval({layer:a}){if(!a._leaflet_id)return;let c=this._snapList.findIndex(p=>p._leaflet_id===a._leaflet_id);c>-1&&this._snapList.splice(c,1)},_calcClosestLayer(a,c){return this._calcClosestLayers(a,c,1)[0]},_calcClosestLayers(a,c,p=1){let y=[],S={};c.forEach((F,q)=>{var ve;if(F._parentCopy&&F._parentCopy===this._layer||((ve=F.getLatLngs)==null?void 0:ve.call(F).flat(5).length)<2)return;let ae=this._calcLayerDistances(a,F);if(ae.distance=Math.floor(ae.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[q]){let Je=L.polyline([],{color:"red",pmIgnore:!0});Je._pmTempLayer=!0,this.debugIndicatorLines[q]=Je}this.debugIndicatorLines[q].setLatLngs([a,ae.latlng])}p===1&&(S.distance===void 0||ae.distance-5<=S.distance)?(ae.distance+5<S.distance&&(y=[]),S=ae,S.layer=F,y.push(S)):p!==1&&(S={},S=ae,S.layer=F,y.push(S))}),p!==1&&(y=y.sort((F,q)=>F.distance-q.distance)),p===-1&&(p=y.length);let k=this._getClosestLayerByPriority(y,p);return L.Util.isArray(k)?k:[k]},_calcLayerDistances(a,c){let p=this._map,y=c instanceof L.Marker||c instanceof L.CircleMarker,S=c instanceof L.Polygon,k=a;if(y){let F=c.getLatLng();return{latlng:{...F},distance:this._getDistance(p,F,k)}}return this._calcLatLngDistances(k,c.getLatLngs(),p,S)},_calcLatLngDistances(a,c,p,y=!1){let S,k,F,q=ae=>{ae.forEach((ve,Je)=>{if(Array.isArray(ve)){q(ve);return}if(this.options.snapSegment){let $e=ve,mt;y?mt=Je+1===ae.length?0:Je+1:mt=Je+1===ae.length?void 0:Je+1;let Nt=ae[mt];if(Nt){let Wt=this._getDistanceToSegment(p,a,$e,Nt);(k===void 0||Wt<k)&&(k=Wt,F=[$e,Nt])}}else{let $e=this._getDistance(p,a,ve);(k===void 0||$e<k)&&(k=$e,S=ve)}})};return q(c),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(p,a,F[0],F[1])},segment:F,distance:k}:{latlng:S,distance:k}},_getClosestLayerByPriority(a,c=1){a=a.sort((F,q)=>F._leaflet_id-q._leaflet_id);let p=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],y=this._map.pm.globalOptions.snappingOrder||[],S=0,k={};return y.concat(p).forEach(F=>{k[F]||(S+=1,k[F]=S)}),a.sort(Xa("instanceofShape",k)),c===1?a[0]||{}:a.slice(0,c)},_checkPrioritiySnapping(a){let c=this._map,p=a.segment[0],y=a.segment[1],S=a.latlng,k=S;if(this.options.snapVertex){let F=this._getDistance(c,p,S),q=this._getDistance(c,y,S),ae=F<q?p:y,ve=F<q?F:q;if(this.options.snapMiddle){let $e=L.PM.Utils.calcMiddleLatLng(c,p,y),mt=this._getDistance(c,$e,S);mt<F&&mt<q&&(ae=$e,ve=mt)}let Je=this.options.snapDistance;ve<Je&&(k=ae)}return{...k}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(a,c,p,y){let S=a.getMaxZoom();S===1/0&&(S=a.getZoom());let k=a.project(c,S),F=a.project(p,S),q=a.project(y,S),ae=L.LineUtil.closestPointOnSegment(k,F,q);return a.unproject(ae,S)},_getDistanceToSegment(a,c,p,y){let S=a.latLngToContainerPoint(c),k=a.latLngToContainerPoint(p),F=a.latLngToContainerPoint(y);return L.LineUtil.pointToSegmentDistance(S,k,F)},_getDistance(a,c,p){return a.latLngToContainerPoint(c).distanceTo(a.latLngToContainerPoint(p))}},eo=Kr,Ho=L.Class.extend({includes:[eo,Ja],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(a){L.Util.setOptions(this,a),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(a){let c=new L.Icon.Default;c.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=c,this._map=a,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(p=>{this[p]=new L.PM.Draw[p](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(a,c=!1){c?this.options.pathOptions=(0,Na.default)(this.options.pathOptions,a):this.options.pathOptions=a},getShapes(){return this.shapes},getShape(){return this._shape},enable(a,c){if(!a)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[a].enable(c)},disable(){this.shapes.forEach(a=>{this[a].disable()})},addControls(){this.shapes.forEach(a=>{this[a].addButton()})},getActiveShape(){let a;return this.shapes.forEach(c=>{this[c]._enabled&&(a=c)}),a},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let a=[];this._map.eachLayer(c=>{(c instanceof L.Polyline||c instanceof L.Marker||c instanceof L.Circle||c instanceof L.CircleMarker||c instanceof L.ImageOverlay)&&(c._pmTempLayer||a.push(c))}),this._enabled?a.forEach(c=>{L.PM.Utils.disablePopup(c)}):a.forEach(c=>{L.PM.Utils.enablePopup(c)})},createNewDrawInstance(a,c){let p=this._getShapeFromBtnName(c);if(this[a])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[p])throw new TypeError(`There is no class L.PM.Draw.${p}`);return this[a]=new L.PM.Draw[p](this._map),this[a].toolbarButtonName=a,this[a]._shape=a,this.shapes.push(a),this[c]&&this[a].setOptions(this[c].options),this[a].setOptions(this[a].options),this[a]},_getShapeFromBtnName(a){let c={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return c[a]?c[a]:this[a]?this[a]._shape:a},_finishLayer(a){a.pm&&(a.pm.setOptions(this.options),a.pm._shape=this._shape,a.pm._map=this._map),this._addDrawnLayerProp(a)},_addDrawnLayerProp(a){a._drawnByGeoman=!0},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),zi=Ho;zi.Marker=zi.extend({initialize(a){this._map=a,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(c=>{this.isRelevantMarker(c)&&c.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},isRelevantMarker(a){return a instanceof L.Marker&&a.pm&&!a._pmTempLayer&&!a.pm._initTextMarker},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(a){if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=new L.Marker(c,this.options.markerStyle);this._setPane(p,"markerPane"),this._finishLayer(p),p.pm||(p.options.draggable=!1),p.addTo(this._map.pm._getContainingLayer()),p.pm&&this.options.markerEditable?p.pm.enable():p.dragging&&p.dragging.disable(),this._fireCreate(p),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var a,c;(a=this.options.markerStyle)!=null&&a.icon&&((c=this._hintMarker)==null||c.setIcon(this.options.markerStyle.icon))}});var A=63710088e-1,de={centimeters:A*100,centimetres:A*100,degrees:A/111325,feet:A*3.28084,inches:A*39.37,kilometers:A/1e3,kilometres:A/1e3,meters:A,metres:A,miles:A/1609.344,millimeters:A*1e3,millimetres:A*1e3,nauticalmiles:A/1852,radians:1,yards:A*1.0936};function We(a,c,p){p===void 0&&(p={});var y={type:"Feature"};return(p.id===0||p.id)&&(y.id=p.id),p.bbox&&(y.bbox=p.bbox),y.properties=c||{},y.geometry=a,y}function ut(a,c,p){if(p===void 0&&(p={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!nr(a[0])||!nr(a[1]))throw new Error("coordinates must contain numbers");var y={type:"Point",coordinates:a};return We(y,c,p)}function Ct(a,c,p){if(p===void 0&&(p={}),a.length<2)throw new Error("coordinates must be an array of two or more positions");var y={type:"LineString",coordinates:a};return We(y,c,p)}function zt(a,c){c===void 0&&(c={});var p={type:"FeatureCollection"};return c.id&&(p.id=c.id),c.bbox&&(p.bbox=c.bbox),p.features=a,p}function ln(a,c){c===void 0&&(c="kilometers");var p=de[c];if(!p)throw new Error(c+" units is invalid");return a*p}function Ln(a,c){c===void 0&&(c="kilometers");var p=de[c];if(!p)throw new Error(c+" units is invalid");return a/p}function En(a){var c=a%(2*Math.PI);return c*180/Math.PI}function Hn(a){var c=a%360;return c*Math.PI/180}function nr(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)}function mr(a){var c,p,y={type:"FeatureCollection",features:[]};if(a.type==="Feature"?p=a.geometry:p=a,p.type==="LineString")c=[p.coordinates];else if(p.type==="MultiLineString")c=p.coordinates;else if(p.type==="MultiPolygon")c=[].concat.apply([],p.coordinates);else if(p.type==="Polygon")c=p.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return c.forEach(function(S){c.forEach(function(k){for(var F=0;F<S.length-1;F++)for(var q=F;q<k.length-1;q++)if(!(S===k&&(Math.abs(F-q)===1||F===0&&q===S.length-2&&S[F][0]===S[S.length-1][0]&&S[F][1]===S[S.length-1][1]))){var ae=gi(S[F][0],S[F][1],S[F+1][0],S[F+1][1],k[q][0],k[q][1],k[q+1][0],k[q+1][1]);ae&&y.features.push(ut([ae[0],ae[1]]))}})}),y}function gi(a,c,p,y,S,k,F,q){var ae,ve,Je,$e,mt,Nt={x:null,y:null,onLine1:!1,onLine2:!1};return ae=(q-k)*(p-a)-(F-S)*(y-c),ae===0?Nt.x!==null&&Nt.y!==null?Nt:!1:(ve=c-k,Je=a-S,$e=(F-S)*ve-(q-k)*Je,mt=(p-a)*ve-(y-c)*Je,ve=$e/ae,Je=mt/ae,Nt.x=a+ve*(p-a),Nt.y=c+ve*(y-c),ve>=0&&ve<=1&&(Nt.onLine1=!0),Je>=0&&Je<=1&&(Nt.onLine2=!0),Nt.onLine1&&Nt.onLine2?[Nt.x,Nt.y]:!1)}zi.Line=zi.extend({initialize(a){this._map=a,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintLine(){let a=this._layer.getLatLngs();if(a.length>0){let c=a[a.length-1];this._hintline.setLatLngs([c,this._hintMarker.getLatLng()])}},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let c=this._layer._defaultShape().slice();c.push(this._hintMarker.getLatLng()),this._change(c)},hasSelfIntersection(){return mr(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(a,c){let p=L.polyline(this._layer.getLatLngs());a&&(c||(c=this._hintMarker.getLatLng()),p.addLatLng(c));let y=mr(p.toGeoJSON(15));this._doesSelfIntersect=y.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(y,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(a){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,a.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=this._layer.getLatLngs(),y=p[p.length-1];if(c.equals(p[0])||p.length>0&&c.equals(y)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:c,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(c);let S=this._createMarker(c);this._setTooltipText(),this._setHintLineAfterNewVertex(c),this._fireVertexAdded(S,void 0,c,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(a)},_setHintLineAfterNewVertex(a){this._hintline.setLatLngs([a,a])},_removeLastVertex(){let a=this._markers;if(a.length<=1){this.disable();return}let c=this._layer.getLatLngs(),p=a[a.length-1],{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(a,p);a.pop(),this._layerGroup.removeLayer(p);let S=a[a.length-1],k=c.indexOf(S.getLatLng());c=c.slice(0,k+1),this._layer.setLatLngs(c),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(p,y,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=1)return;let c=L.polyline(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this.options.snappable&&this._cleanupSnapping();let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),c.on("click",this._finishShape,this),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=1?c=Wn("tooltips.continueLine"):c=Wn("tooltips.finishLine"),this._hintMarker.setTooltipContent(c)},_change(a){this._fireChange(a,"Draw")},setStyle(){var a,c;(a=this._layer)==null||a.setStyle(this.options.templineStyle),(c=this._hintline)==null||c.setStyle(this.options.hintlineStyle)}}),zi.Polygon=zi.Line.extend({initialize(a){this._map=a,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(a){L.PM.Draw.Line.prototype.enable.call(this,a),this._layer.pm._shape="Polygon"},_createMarker(a){let c=new L.Marker(a,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this._layerGroup.addLayer(c),this._markers.push(c),this._layer.getLatLngs().flat().length===1?(c.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(c)-1,this.options.snappable&&this._cleanupSnapping()):c.on("click",()=>1),c},_setTooltipText(){let{length:a}=this._layer.getLatLngs().flat(),c="";a<=2?c=Wn("tooltips.continueLine"):c=Wn("tooltips.finishPoly"),this._hintMarker.setTooltipContent(c)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);this._setPane(c,"layerPane"),this._finishLayer(c),c.addTo(this._map.pm._getContainingLayer()),this._fireCreate(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))}}),zi.Rectangle=zi.extend({initialize(a){this._map=a,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(a){if(L.Util.setOptions(this,a),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let c=0;c<2;c+=1){let p=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(p,"vertexPane"),p._pmTempLayer=!0,this._layerGroup.addLayer(p),this._styleMarkers.push(p)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeStartingMarkers(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(c),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(p=>{L.DomUtil.addClass(p._icon,"visible"),p.setLatLng(c)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(Wn("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let a=this._startMarker.getLatLng();a&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([a,a]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}let c=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(c,"Draw")},_syncRectangleSize(){let a=Qa(this._startMarker.getLatLng(),this._map),c=Qa(this._hintMarker.getLatLng(),this._map),p=L.PM.Utils._getRotatedRectangle(a,c,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(p),this.options.cursorMarker&&this._styleMarkers){let y=[];p.forEach(S=>{!S.equals(a,1e-8)&&!S.equals(c,1e-8)&&y.push(S)}),y.forEach((S,k)=>{try{this._styleMarkers[k].setLatLng(S)}catch{}})}},_findCorners(){let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.options.rectangleAngle||0,this._map)},_finishShape(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||p.equals(c))return;let y=L.rectangle([p,c],this.options.pathOptions);if(this.options.rectangleAngle){let k=L.PM.Utils._getRotatedRectangle(p,c,this.options.rectangleAngle||0,this._map);y.setLatLngs(k),y.pm&&y.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(y,"layerPane"),this._finishLayer(y),y.addTo(this._map.pm._getContainingLayer()),this._fireCreate(y);let S=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(S))},setStyle(){var a;(a=this._layer)==null||a.setStyle(this.options.pathOptions)}}),zi.CircleMarker=zi.extend({initialize(a){this._map=a,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(a){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let c={};L.extend(c,this.options.templineStyle),c.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),c),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(a=>{this.isRelevantMarker(a)&&a.pm.disable()})},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_placeCenterMarker(a){this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let c=this._hintMarker.getLatLng();this._centerMarker.setLatLng(c),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let a=this._centerMarker.getLatLng();a&&(this._layer.setLatLng(a),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(Wn("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([a,c])},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(p)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let p=a;p.target=this._hintMarker,this._handleSnapping(p)}this._handleHintMarkerSnapping();let c=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(c,"Draw")},isRelevantMarker(a){return a instanceof L.CircleMarker&&!(a instanceof L.Circle)&&a.pm&&!a._pmTempLayer},_createMarker(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!a.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng(),p=new this._BaseCircleClass(c,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(p,"layerPane"),this._finishLayer(p),p.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(p),this._fireCreate(p),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(a){a.pm&&this.options.markerEditable&&a.pm.enable()},_finishShape(a){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._centerMarker.getLatLng(),p=this._defaultRadius;if(this.options[this._editableOption]){let F=this._hintMarker.getLatLng();p=this._distanceCalculation(c,F),this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?p=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(p=this.options[this._maxRadiusOption])}let y={...this.options.pathOptions,radius:p},S=new this._BaseCircleClass(c,y);this._setPane(S,"layerPane"),this._finishLayer(S),S.addTo(this._map.pm._getContainingLayer()),S.pm&&S.pm._updateHiddenPolyCircle(),this._fireCreate(S);let k=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(k))},_getNewDestinationOfHintMarker(){let a=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return a;let c=this._centerMarker.getLatLng(),p=this._distanceCalculation(c,a);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?a=Ya(this._map,c,a,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(a=Ya(this._map,c,a,this._getMaxDistanceInMeter()))}return a},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._hintMarker.getLatLng(),p=this._distanceCalculation(a,c);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var c,p;let a={};L.extend(a,this.options.templineStyle),this.options[this._editableOption]&&(a.radius=0),(c=this._layer)==null||c.setStyle(a),(p=this._hintline)==null||p.setStyle(this.options.hintlineStyle)},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))}}),zi.Circle=zi.CircleMarker.extend({initialize(a){this._map=a,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(a,c){return this._map.distance(a,c)}});function qr(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Jr(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ji(a){return a.type==="Feature"?a.geometry:a}function Hi(a,c){return a.type==="FeatureCollection"?"FeatureCollection":a.type==="GeometryCollection"?"GeometryCollection":a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}function to(a,c,p){if(a!==null)for(var y,S,k,F,q,ae,ve,Je=0,$e=0,mt,Nt=a.type,Wt=Nt==="FeatureCollection",gn=Nt==="Feature",vn=Wt?a.features.length:1,Jn=0;Jn<vn;Jn++){ve=Wt?a.features[Jn].geometry:gn?a.geometry:a,mt=ve?ve.type==="GeometryCollection":!1,q=mt?ve.geometries.length:1;for(var Ke=0;Ke<q;Ke++){var nt=0,ct=0;if(F=mt?ve.geometries[Ke]:ve,F!==null){ae=F.coordinates;var Ft=F.type;switch(Je=0,Ft){case null:break;case"Point":if(c(ae,$e,Jn,nt,ct)===!1)return!1;$e++,nt++;break;case"LineString":case"MultiPoint":for(y=0;y<ae.length;y++){if(c(ae[y],$e,Jn,nt,ct)===!1)return!1;$e++,Ft==="MultiPoint"&&nt++}Ft==="LineString"&&nt++;break;case"Polygon":case"MultiLineString":for(y=0;y<ae.length;y++){for(S=0;S<ae[y].length-Je;S++){if(c(ae[y][S],$e,Jn,nt,ct)===!1)return!1;$e++}Ft==="MultiLineString"&&nt++,Ft==="Polygon"&&ct++}Ft==="Polygon"&&nt++;break;case"MultiPolygon":for(y=0;y<ae.length;y++){for(ct=0,S=0;S<ae[y].length;S++){for(k=0;k<ae[y][S].length-Je;k++){if(c(ae[y][S][k],$e,Jn,nt,ct)===!1)return!1;$e++}ct++}nt++}break;case"GeometryCollection":for(y=0;y<F.geometries.length;y++)if(to(F.geometries[y],c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function vr(a,c){if(a.type==="Feature")c(a,0);else if(a.type==="FeatureCollection")for(var p=0;p<a.features.length&&c(a.features[p],p)!==!1;p++);}function gs(a,c,p){var y=p;return vr(a,function(S,k){k===0&&p===void 0?y=S:y=c(y,S,k)}),y}function Ra(a,c){var p,y,S,k,F,q,ae,ve,Je,$e,mt=0,Nt=a.type==="FeatureCollection",Wt=a.type==="Feature",gn=Nt?a.features.length:1;for(p=0;p<gn;p++){for(q=Nt?a.features[p].geometry:Wt?a.geometry:a,ve=Nt?a.features[p].properties:Wt?a.properties:{},Je=Nt?a.features[p].bbox:Wt?a.bbox:void 0,$e=Nt?a.features[p].id:Wt?a.id:void 0,ae=q?q.type==="GeometryCollection":!1,F=ae?q.geometries.length:1,S=0;S<F;S++){if(k=ae?q.geometries[S]:q,k===null){if(c(null,mt,ve,Je,$e)===!1)return!1;continue}switch(k.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(c(k,mt,ve,Je,$e)===!1)return!1;break}case"GeometryCollection":{for(y=0;y<k.geometries.length;y++)if(c(k.geometries[y],mt,ve,Je,$e)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}mt++}}function Ms(a,c){Ra(a,function(p,y,S,k,F){var q=p===null?null:p.type;switch(q){case null:case"Point":case"LineString":case"Polygon":return c(We(p,S,{bbox:k,id:F}),y,0)===!1?!1:void 0}var ae;switch(q){case"MultiPoint":ae="Point";break;case"MultiLineString":ae="LineString";break;case"MultiPolygon":ae="Polygon";break}for(var ve=0;ve<p.coordinates.length;ve++){var Je=p.coordinates[ve],$e={type:ae,coordinates:Je};if(c(We($e,S),y,ve)===!1)return!1}})}function gl(a){if(!a)throw new Error("geojson is required");var c=[];return Ms(a,function(p){ko(p,c)}),zt(c)}function ko(a,c){var p=[],y=a.geometry;if(y!==null){switch(y.type){case"Polygon":p=Jr(y);break;case"LineString":p=[Jr(y)]}p.forEach(function(S){var k=Dl(S,a.properties);k.forEach(function(F){F.id=c.length,c.push(F)})})}}function Dl(a,c){var p=[];return a.reduce(function(y,S){var k=Ct([y,S],c);return k.bbox=da(y,S),p.push(k),S}),p}function da(a,c){var p=a[0],y=a[1],S=c[0],k=c[1],F=p<S?p:S,q=y<k?y:k,ae=p>S?p:S,ve=y>k?y:k;return[F,q,ae,ve]}var pa=gl,Wi=g(ss(),1);function To(a,c){var p={},y=[];if(a.type==="LineString"&&(a=We(a)),c.type==="LineString"&&(c=We(c)),a.type==="Feature"&&c.type==="Feature"&&a.geometry!==null&&c.geometry!==null&&a.geometry.type==="LineString"&&c.geometry.type==="LineString"&&a.geometry.coordinates.length===2&&c.geometry.coordinates.length===2){var S=no(a,c);return S&&y.push(S),zt(y)}var k=(0,Wi.default)();return k.load(pa(c)),vr(pa(a),function(F){vr(k.search(F),function(q){var ae=no(F,q);if(ae){var ve=Jr(ae).join(",");p[ve]||(p[ve]=!0,y.push(ae))}})}),zt(y)}function no(a,c){var p=Jr(a),y=Jr(c);if(p.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(y.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var S=p[0][0],k=p[0][1],F=p[1][0],q=p[1][1],ae=y[0][0],ve=y[0][1],Je=y[1][0],$e=y[1][1],mt=($e-ve)*(F-S)-(Je-ae)*(q-k),Nt=(Je-ae)*(k-ve)-($e-ve)*(S-ae),Wt=(F-S)*(k-ve)-(q-k)*(S-ae);if(mt===0)return null;var gn=Nt/mt,vn=Wt/mt;if(gn>=0&&gn<=1&&vn>=0&&vn<=1){var Jn=S+gn*(F-S),Ke=k+gn*(q-k);return ut([Jn,Ke])}return null}var Fs=To,Da=g(ss(),1);function ms(a,c,p){p===void 0&&(p={});var y=qr(a),S=qr(c),k=Hn(S[1]-y[1]),F=Hn(S[0]-y[0]),q=Hn(y[1]),ae=Hn(S[1]),ve=Math.pow(Math.sin(k/2),2)+Math.pow(Math.sin(F/2),2)*Math.cos(q)*Math.cos(ae);return ln(2*Math.atan2(Math.sqrt(ve),Math.sqrt(1-ve)),p.units)}var ks=ms;function Ts(a){var c=a[0],p=a[1],y=a[2],S=a[3],k=ks(a.slice(0,2),[y,p]),F=ks(a.slice(0,2),[c,S]);if(k>=F){var q=(p+S)/2;return[c,q-(y-c)/2,y,q+(y-c)/2]}else{var ae=(c+y)/2;return[ae-(S-p)/2,p,ae+(S-p)/2,S]}}var ou=Ts;function ns(a){var c=[1/0,1/0,-1/0,-1/0];return to(a,function(p){c[0]>p[0]&&(c[0]=p[0]),c[1]>p[1]&&(c[1]=p[1]),c[2]<p[0]&&(c[2]=p[0]),c[3]<p[1]&&(c[3]=p[1])}),c}ns.default=ns;var Wo=ns;function vs(a,c){c===void 0&&(c={});var p=c.precision,y=c.coordinates,S=c.mutate;if(p=p==null||isNaN(p)?6:p,y=y==null||isNaN(y)?3:y,!a)throw new Error("<geojson> is required");if(typeof p!="number")throw new Error("<precision> must be a number");if(typeof y!="number")throw new Error("<coordinates> must be a number");(S===!1||S===void 0)&&(a=JSON.parse(JSON.stringify(a)));var k=Math.pow(10,p);return to(a,function(F){ys(F,k,y)}),a}function ys(a,c,p){a.length>p&&a.splice(p,a.length);for(var y=0;y<a.length;y++)a[y]=Math.round(a[y]*c)/c;return a}var Zo=vs;function Ko(a,c,p){if(p===void 0&&(p={}),p.final===!0)return _s(a,c);var y=qr(a),S=qr(c),k=Hn(y[0]),F=Hn(S[0]),q=Hn(y[1]),ae=Hn(S[1]),ve=Math.sin(F-k)*Math.cos(ae),Je=Math.cos(q)*Math.sin(ae)-Math.sin(q)*Math.cos(ae)*Math.cos(F-k);return En(Math.atan2(ve,Je))}function _s(a,c){var p=Ko(c,a);return p=(p+180)%360,p}function ls(a,c,p,y){y===void 0&&(y={});var S=qr(a),k=Hn(S[0]),F=Hn(S[1]),q=Hn(p),ae=Ln(c,y.units),ve=Math.asin(Math.sin(F)*Math.cos(ae)+Math.cos(F)*Math.sin(ae)*Math.cos(q)),Je=k+Math.atan2(Math.sin(q)*Math.sin(ae)*Math.cos(F),Math.cos(ae)-Math.sin(F)*Math.sin(ve)),$e=En(Je),mt=En(ve);return ut([$e,mt],y.properties)}function Bo(a,c,p){p===void 0&&(p={});var y=ut([1/0,1/0],{dist:1/0}),S=0;return Ms(a,function(k){for(var F=Jr(k),q=0;q<F.length-1;q++){var ae=ut(F[q]);ae.properties.dist=ks(c,ae,p);var ve=ut(F[q+1]);ve.properties.dist=ks(c,ve,p);var Je=ks(ae,ve,p),$e=Math.max(ae.properties.dist,ve.properties.dist),mt=Ko(ae,ve),Nt=ls(c,$e,mt+90,p),Wt=ls(c,$e,mt-90,p),gn=Fs(Ct([Nt.geometry.coordinates,Wt.geometry.coordinates]),Ct([ae.geometry.coordinates,ve.geometry.coordinates])),vn=null;gn.features.length>0&&(vn=gn.features[0],vn.properties.dist=ks(c,vn,p),vn.properties.location=S+ks(ae,vn,p)),ae.properties.dist<y.properties.dist&&(y=ae,y.properties.index=q,y.properties.location=S),ve.properties.dist<y.properties.dist&&(y=ve,y.properties.index=q+1,y.properties.location=S+Je),vn&&vn.properties.dist<y.properties.dist&&(y=vn,y.properties.index=q),S+=Je}}),y}var ro=Bo;function bs(a,c){if(!a)throw new Error("line is required");if(!c)throw new Error("splitter is required");var p=Hi(a),y=Hi(c);if(p!=="LineString")throw new Error("line must be LineString");if(y==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(y==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var S=Zo(c,{precision:7});switch(y){case"Point":return qt(a,S);case"MultiPoint":return bt(a,S);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return bt(a,Fs(a,S))}}function bt(a,c){var p=[],y=(0,Da.default)();return Ms(c,function(S){if(p.forEach(function(q,ae){q.id=ae}),!p.length)p=qt(a,S).features,p.forEach(function(q){q.bbox||(q.bbox=ou(Wo(q)))}),y.load(zt(p));else{var k=y.search(S);if(k.features.length){var F=Bt(S,k);p=p.filter(function(q){return q.id!==F.id}),y.remove(F),vr(qt(F,S),function(q){p.push(q),y.insert(q)})}}}),zt(p)}function qt(a,c){var p=[],y=Jr(a)[0],S=Jr(a)[a.geometry.coordinates.length-1];if(wn(y,qr(c))||wn(S,qr(c)))return zt([a]);var k=(0,Da.default)(),F=pa(a);k.load(F);var q=k.search(c);if(!q.features.length)return zt([a]);var ae=Bt(c,q),ve=[y],Je=gs(F,function($e,mt,Nt){var Wt=Jr(mt)[1],gn=qr(c);return Nt===ae.id?($e.push(gn),p.push(Ct($e)),wn(gn,Wt)?[gn]:[gn,Wt]):($e.push(Wt),$e)},ve);return Je.length>1&&p.push(Ct(Je)),zt(p)}function Bt(a,c){if(!c.features.length)throw new Error("lines must contain features");if(c.features.length===1)return c.features[0];var p,y=1/0;return vr(c,function(S){var k=ro(S,a),F=k.properties.dist;F<y&&(p=S,y=F)}),p}function wn(a,c){return a[0]===c[0]&&a[1]===c[1]}var zn=bs;function sr(a,c,p){if(p===void 0&&(p={}),!a)throw new Error("point is required");if(!c)throw new Error("polygon is required");var y=qr(a),S=ji(c),k=S.type,F=c.bbox,q=S.coordinates;if(F&&Yr(y,F)===!1)return!1;k==="Polygon"&&(q=[q]);for(var ae=!1,ve=0;ve<q.length&&!ae;ve++)if(_i(y,q[ve][0],p.ignoreBoundary)){for(var Je=!1,$e=1;$e<q[ve].length&&!Je;)_i(y,q[ve][$e],!p.ignoreBoundary)&&(Je=!0),$e++;Je||(ae=!0)}return ae}function _i(a,c,p){var y=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var S=0,k=c.length-1;S<c.length;k=S++){var F=c[S][0],q=c[S][1],ae=c[k][0],ve=c[k][1],Je=a[1]*(F-ae)+q*(ae-a[0])+ve*(a[0]-F)===0&&(F-a[0])*(ae-a[0])<=0&&(q-a[1])*(ve-a[1])<=0;if(Je)return!p;var $e=q>a[1]!=ve>a[1]&&a[0]<(ae-F)*(a[1]-q)/(ve-q)+F;$e&&(y=!y)}return y}function Yr(a,c){return c[0]<=a[0]&&c[1]<=a[1]&&c[2]>=a[0]&&c[3]>=a[1]}function tl(a,c,p){p===void 0&&(p={});for(var y=qr(a),S=Jr(c),k=0;k<S.length-1;k++){var F=!1;if(p.ignoreEndVertices&&(k===0&&(F="start"),k===S.length-2&&(F="end"),k===0&&k+1===S.length-1&&(F="both")),Bs(S[k],S[k+1],y,F,typeof p.epsilon>"u"?null:p.epsilon))return!0}return!1}function Bs(a,c,p,y,S){var k=p[0],F=p[1],q=a[0],ae=a[1],ve=c[0],Je=c[1],$e=p[0]-q,mt=p[1]-ae,Nt=ve-q,Wt=Je-ae,gn=$e*Wt-mt*Nt;if(S!==null){if(Math.abs(gn)>S)return!1}else if(gn!==0)return!1;if(y){if(y==="start")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<k&&k<=ve:ve<=k&&k<q:Wt>0?ae<F&&F<=Je:Je<=F&&F<ae;if(y==="end")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<=k&&k<ve:ve<k&&k<=q:Wt>0?ae<=F&&F<Je:Je<F&&F<=ae;if(y==="both")return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<k&&k<ve:ve<k&&k<q:Wt>0?ae<F&&F<Je:Je<F&&F<ae}else return Math.abs(Nt)>=Math.abs(Wt)?Nt>0?q<=k&&k<=ve:ve<=k&&k<=q:Wt>0?ae<=F&&F<=Je:Je<=F&&F<=ae;return!1}var bi=tl;function No(a,c){var p=ji(a),y=ji(c),S=p.type,k=y.type,F=p.coordinates,q=y.coordinates;switch(S){case"Point":switch(k){case"Point":return ni(F,q);default:throw new Error("feature2 "+k+" geometry not supported")}case"MultiPoint":switch(k){case"Point":return Jo(p,y);case"MultiPoint":return Ro(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}case"LineString":switch(k){case"Point":return bi(y,p,{ignoreEndVertices:!0});case"LineString":return Cr(p,y);case"MultiPoint":return Do(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}case"Polygon":switch(k){case"Point":return sr(y,p,{ignoreBoundary:!0});case"LineString":return yo(p,y);case"Polygon":return us(p,y);case"MultiPoint":return Oo(p,y);default:throw new Error("feature2 "+k+" geometry not supported")}default:throw new Error("feature1 "+S+" geometry not supported")}}function Jo(a,c){var p,y=!1;for(p=0;p<a.coordinates.length;p++)if(ni(a.coordinates[p],c.coordinates)){y=!0;break}return y}function Ro(a,c){for(var p=0,y=c.coordinates;p<y.length;p++){for(var S=y[p],k=!1,F=0,q=a.coordinates;F<q.length;F++){var ae=q[F];if(ni(S,ae)){k=!0;break}}if(!k)return!1}return!0}function Do(a,c){for(var p=!1,y=0,S=c.coordinates;y<S.length;y++){var k=S[y];if(bi(k,a,{ignoreEndVertices:!0})&&(p=!0),!bi(k,a))return!1}return!!p}function Oo(a,c){for(var p=0,y=c.coordinates;p<y.length;p++){var S=y[p];if(!sr(S,a,{ignoreBoundary:!0}))return!1}return!0}function Cr(a,c){for(var p=!1,y=0,S=c.coordinates;y<S.length;y++){var k=S[y];if(bi({type:"Point",coordinates:k},a,{ignoreEndVertices:!0})&&(p=!0),!bi({type:"Point",coordinates:k},a,{ignoreEndVertices:!1}))return!1}return p}function yo(a,c){var p=!1,y=0,S=Wo(a),k=Wo(c);if(!Xr(S,k))return!1;for(y;y<c.coordinates.length-1;y++){var F=Ui(c.coordinates[y],c.coordinates[y+1]);if(sr({type:"Point",coordinates:F},a,{ignoreBoundary:!0})){p=!0;break}}return p}function us(a,c){if(a.type==="Feature"&&a.geometry===null||c.type==="Feature"&&c.geometry===null)return!1;var p=Wo(a),y=Wo(c);if(!Xr(p,y))return!1;for(var S=ji(c).coordinates,k=0,F=S;k<F.length;k++)for(var q=F[k],ae=0,ve=q;ae<ve.length;ae++){var Je=ve[ae];if(!sr(Je,a))return!1}return!0}function Xr(a,c){return!(a[0]>c[0]||a[2]<c[2]||a[1]>c[1]||a[3]<c[3])}function ni(a,c){return a[0]===c[0]&&a[1]===c[1]}function Ui(a,c){return[(a[0]+c[0])/2,(a[1]+c[1])/2]}var li=g(Xt()),io=a=>()=>a,zs=a=>{let c=a?(p,y)=>y.minus(p).abs().isLessThanOrEqualTo(a):io(!1);return(p,y)=>c(p,y)?0:p.comparedTo(y)};function co(a){let c=a?(p,y,S,k,F)=>p.exponentiatedBy(2).isLessThanOrEqualTo(k.minus(y).exponentiatedBy(2).plus(F.minus(S).exponentiatedBy(2)).times(a)):io(!1);return(p,y,S)=>{let k=p.x,F=p.y,q=S.x,ae=S.y,ve=F.minus(ae).times(y.x.minus(q)).minus(k.minus(q).times(y.y.minus(ae)));return c(ve,k,F,q,ae)?0:ve.comparedTo(0)}}var Ol=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Io=Math.ceil,Zi=Math.floor,ai="[BigNumber Error] ",ws=ai+"Number primitive has more than 15 significant digits: ",js=1e14,er=14,Yo=9007199254740991,Xo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],_o=1e7,Ns=1e9;function ku(a){var c,p,y,S=Ke.prototype={constructor:Ke,toString:null,valueOf:null},k=new Ke(1),F=20,q=4,ae=-7,ve=21,Je=-1e7,$e=1e7,mt=!1,Nt=1,Wt=0,gn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},vn="0123456789abcdefghijklmnopqrstuvwxyz",Jn=!0;function Ke(fe,we){var Oe,Ne,ze,je,at,lt,dt,Et,At=this;if(!(At instanceof Ke))return new Ke(fe,we);if(we==null){if(fe&&fe._isBigNumber===!0){At.s=fe.s,!fe.c||fe.e>$e?At.c=At.e=null:fe.e<Je?At.c=[At.e=0]:(At.e=fe.e,At.c=fe.c.slice());return}if((lt=typeof fe=="number")&&fe*0==0){if(At.s=1/fe<0?(fe=-fe,-1):1,fe===~~fe){for(je=0,at=fe;at>=10;at/=10,je++);je>$e?At.c=At.e=null:(At.e=je,At.c=[fe]);return}Et=String(fe)}else{if(!Ol.test(Et=String(fe)))return y(At,Et,lt);At.s=Et.charCodeAt(0)==45?(Et=Et.slice(1),-1):1}(je=Et.indexOf("."))>-1&&(Et=Et.replace(".","")),(at=Et.search(/e/i))>0?(je<0&&(je=at),je+=+Et.slice(at+1),Et=Et.substring(0,at)):je<0&&(je=Et.length)}else{if(s(we,2,vn.length,"Base"),we==10&&Jn)return At=new Ke(fe),xt(At,F+At.e+1,q);if(Et=String(fe),lt=typeof fe=="number"){if(fe*0!=0)return y(At,Et,lt,we);if(At.s=1/fe<0?(Et=Et.slice(1),-1):1,Ke.DEBUG&&Et.replace(/^0\.0*|\./,"").length>15)throw Error(ws+fe)}else At.s=Et.charCodeAt(0)===45?(Et=Et.slice(1),-1):1;for(Oe=vn.slice(0,we),je=at=0,dt=Et.length;at<dt;at++)if(Oe.indexOf(Ne=Et.charAt(at))<0){if(Ne=="."){if(at>je){je=dt;continue}}else if(!ze&&(Et==Et.toUpperCase()&&(Et=Et.toLowerCase())||Et==Et.toLowerCase()&&(Et=Et.toUpperCase()))){ze=!0,at=-1,je=0;continue}return y(At,String(fe),lt,we)}lt=!1,Et=p(Et,we,10,At.s),(je=Et.indexOf("."))>-1?Et=Et.replace(".",""):je=Et.length}for(at=0;Et.charCodeAt(at)===48;at++);for(dt=Et.length;Et.charCodeAt(--dt)===48;);if(Et=Et.slice(at,++dt)){if(dt-=at,lt&&Ke.DEBUG&&dt>15&&(fe>Yo||fe!==Zi(fe)))throw Error(ws+At.s*fe);if((je=je-at-1)>$e)At.c=At.e=null;else if(je<Je)At.c=[At.e=0];else{if(At.e=je,At.c=[],at=(je+1)%er,je<0&&(at+=er),at<dt){for(at&&At.c.push(+Et.slice(0,at)),dt-=er;at<dt;)At.c.push(+Et.slice(at,at+=er));at=er-(Et=Et.slice(at)).length}else at-=dt;for(;at--;Et+="0");At.c.push(+Et)}}else At.c=[At.e=0]}Ke.clone=ku,Ke.ROUND_UP=0,Ke.ROUND_DOWN=1,Ke.ROUND_CEIL=2,Ke.ROUND_FLOOR=3,Ke.ROUND_HALF_UP=4,Ke.ROUND_HALF_DOWN=5,Ke.ROUND_HALF_EVEN=6,Ke.ROUND_HALF_CEIL=7,Ke.ROUND_HALF_FLOOR=8,Ke.EUCLID=9,Ke.config=Ke.set=function(fe){var we,Oe;if(fe!=null)if(typeof fe=="object"){if(fe.hasOwnProperty(we="DECIMAL_PLACES")&&(Oe=fe[we],s(Oe,0,Ns,we),F=Oe),fe.hasOwnProperty(we="ROUNDING_MODE")&&(Oe=fe[we],s(Oe,0,8,we),q=Oe),fe.hasOwnProperty(we="EXPONENTIAL_AT")&&(Oe=fe[we],Oe&&Oe.pop?(s(Oe[0],-1e9,0,we),s(Oe[1],0,Ns,we),ae=Oe[0],ve=Oe[1]):(s(Oe,-1e9,Ns,we),ae=-(ve=Oe<0?-Oe:Oe))),fe.hasOwnProperty(we="RANGE"))if(Oe=fe[we],Oe&&Oe.pop)s(Oe[0],-1e9,-1,we),s(Oe[1],1,Ns,we),Je=Oe[0],$e=Oe[1];else if(s(Oe,-1e9,Ns,we),Oe)Je=-($e=Oe<0?-Oe:Oe);else throw Error(ai+we+" cannot be zero: "+Oe);if(fe.hasOwnProperty(we="CRYPTO"))if(Oe=fe[we],Oe===!!Oe)if(Oe)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))mt=Oe;else throw mt=!Oe,Error(ai+"crypto unavailable");else mt=Oe;else throw Error(ai+we+" not true or false: "+Oe);if(fe.hasOwnProperty(we="MODULO_MODE")&&(Oe=fe[we],s(Oe,0,9,we),Nt=Oe),fe.hasOwnProperty(we="POW_PRECISION")&&(Oe=fe[we],s(Oe,0,Ns,we),Wt=Oe),fe.hasOwnProperty(we="FORMAT"))if(Oe=fe[we],typeof Oe=="object")gn=Oe;else throw Error(ai+we+" not an object: "+Oe);if(fe.hasOwnProperty(we="ALPHABET"))if(Oe=fe[we],typeof Oe=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Oe))Jn=Oe.slice(0,10)=="0123456789",vn=Oe;else throw Error(ai+we+" invalid: "+Oe)}else throw Error(ai+"Object expected: "+fe);return{DECIMAL_PLACES:F,ROUNDING_MODE:q,EXPONENTIAL_AT:[ae,ve],RANGE:[Je,$e],CRYPTO:mt,MODULO_MODE:Nt,POW_PRECISION:Wt,FORMAT:gn,ALPHABET:vn}},Ke.isBigNumber=function(fe){if(!fe||fe._isBigNumber!==!0)return!1;if(!Ke.DEBUG)return!0;var we,Oe,Ne=fe.c,ze=fe.e,je=fe.s;e:if({}.toString.call(Ne)=="[object Array]"){if((je===1||je===-1)&&ze>=-1e9&&ze<=Ns&&ze===Zi(ze)){if(Ne[0]===0){if(ze===0&&Ne.length===1)return!0;break e}if(we=(ze+1)%er,we<1&&(we+=er),String(Ne[0]).length==we){for(we=0;we<Ne.length;we++)if(Oe=Ne[we],Oe<0||Oe>=js||Oe!==Zi(Oe))break e;if(Oe!==0)return!0}}}else if(Ne===null&&ze===null&&(je===null||je===1||je===-1))return!0;throw Error(ai+"Invalid BigNumber: "+fe)},Ke.maximum=Ke.max=function(){return ct(arguments,-1)},Ke.minimum=Ke.min=function(){return ct(arguments,1)},Ke.random=function(){var fe=9007199254740992,we=Math.random()*fe&2097151?function(){return Zi(Math.random()*fe)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Oe){var Ne,ze,je,at,lt,dt=0,Et=[],At=new Ke(k);if(Oe==null?Oe=F:s(Oe,0,Ns),at=Io(Oe/er),mt)if(crypto.getRandomValues){for(Ne=crypto.getRandomValues(new Uint32Array(at*=2));dt<at;)lt=Ne[dt]*131072+(Ne[dt+1]>>>11),lt>=9e15?(ze=crypto.getRandomValues(new Uint32Array(2)),Ne[dt]=ze[0],Ne[dt+1]=ze[1]):(Et.push(lt%1e14),dt+=2);dt=at/2}else if(crypto.randomBytes){for(Ne=crypto.randomBytes(at*=7);dt<at;)lt=(Ne[dt]&31)*281474976710656+Ne[dt+1]*1099511627776+Ne[dt+2]*4294967296+Ne[dt+3]*16777216+(Ne[dt+4]<<16)+(Ne[dt+5]<<8)+Ne[dt+6],lt>=9e15?crypto.randomBytes(7).copy(Ne,dt):(Et.push(lt%1e14),dt+=7);dt=at/7}else throw mt=!1,Error(ai+"crypto unavailable");if(!mt)for(;dt<at;)lt=we(),lt<9e15&&(Et[dt++]=lt%1e14);for(at=Et[--dt],Oe%=er,at&&Oe&&(lt=Xo[er-Oe],Et[dt]=Zi(at/lt)*lt);Et[dt]===0;Et.pop(),dt--);if(dt<0)Et=[je=0];else{for(je=-1;Et[0]===0;Et.splice(0,1),je-=er);for(dt=1,lt=Et[0];lt>=10;lt/=10,dt++);dt<er&&(je-=er-dt)}return At.e=je,At.c=Et,At}}(),Ke.sum=function(){for(var fe=1,we=arguments,Oe=new Ke(we[0]);fe<we.length;)Oe=Oe.plus(we[fe++]);return Oe},p=function(){var fe="0123456789";function we(Oe,Ne,ze,je){for(var at,lt=[0],dt,Et=0,At=Oe.length;Et<At;){for(dt=lt.length;dt--;lt[dt]*=Ne);for(lt[0]+=je.indexOf(Oe.charAt(Et++)),at=0;at<lt.length;at++)lt[at]>ze-1&&(lt[at+1]==null&&(lt[at+1]=0),lt[at+1]+=lt[at]/ze|0,lt[at]%=ze)}return lt.reverse()}return function(Oe,Ne,ze,je,at){var lt,dt,Et,At,nn,An,Rn,Vn,Wr=Oe.indexOf("."),ri=F,Pr=q;for(Wr>=0&&(At=Wt,Wt=0,Oe=Oe.replace(".",""),Vn=new Ke(Ne),An=Vn.pow(Oe.length-Wr),Wt=At,Vn.c=we(T(hs(An.c),An.e,"0"),10,ze,fe),Vn.e=Vn.c.length),Rn=we(Oe,Ne,ze,at?(lt=vn,fe):(lt=fe,vn)),Et=At=Rn.length;Rn[--At]==0;Rn.pop());if(!Rn[0])return lt.charAt(0);if(Wr<0?--Et:(An.c=Rn,An.e=Et,An.s=je,An=c(An,Vn,ri,Pr,ze),Rn=An.c,nn=An.r,Et=An.e),dt=Et+ri+1,Wr=Rn[dt],At=ze/2,nn=nn||dt<0||Rn[dt+1]!=null,nn=Pr<4?(Wr!=null||nn)&&(Pr==0||Pr==(An.s<0?3:2)):Wr>At||Wr==At&&(Pr==4||nn||Pr==6&&Rn[dt-1]&1||Pr==(An.s<0?8:7)),dt<1||!Rn[0])Oe=nn?T(lt.charAt(1),-ri,lt.charAt(0)):lt.charAt(0);else{if(Rn.length=dt,nn)for(--ze;++Rn[--dt]>ze;)Rn[dt]=0,dt||(++Et,Rn=[1].concat(Rn));for(At=Rn.length;!Rn[--At];);for(Wr=0,Oe="";Wr<=At;Oe+=lt.charAt(Rn[Wr++]));Oe=T(Oe,Et,lt.charAt(0))}return Oe}}(),c=function(){function fe(Ne,ze,je){var at,lt,dt,Et,At=0,nn=Ne.length,An=ze%_o,Rn=ze/_o|0;for(Ne=Ne.slice();nn--;)dt=Ne[nn]%_o,Et=Ne[nn]/_o|0,at=Rn*dt+Et*An,lt=An*dt+at%_o*_o+At,At=(lt/je|0)+(at/_o|0)+Rn*Et,Ne[nn]=lt%je;return At&&(Ne=[At].concat(Ne)),Ne}function we(Ne,ze,je,at){var lt,dt;if(je!=at)dt=je>at?1:-1;else for(lt=dt=0;lt<je;lt++)if(Ne[lt]!=ze[lt]){dt=Ne[lt]>ze[lt]?1:-1;break}return dt}function Oe(Ne,ze,je,at){for(var lt=0;je--;)Ne[je]-=lt,lt=Ne[je]<ze[je]?1:0,Ne[je]=lt*at+Ne[je]-ze[je];for(;!Ne[0]&&Ne.length>1;Ne.splice(0,1));}return function(Ne,ze,je,at,lt){var dt,Et,At,nn,An,Rn,Vn,Wr,ri,Pr,ui,qs,Fl,zo,Tc,ma,lu,jo=Ne.s==ze.s?1:-1,Ls=Ne.c,$i=ze.c;if(!Ls||!Ls[0]||!$i||!$i[0])return new Ke(!Ne.s||!ze.s||(Ls?$i&&Ls[0]==$i[0]:!$i)?NaN:Ls&&Ls[0]==0||!$i?jo*0:jo/0);for(Wr=new Ke(jo),ri=Wr.c=[],Et=Ne.e-ze.e,jo=je+Et+1,lt||(lt=js,Et=cs(Ne.e/er)-cs(ze.e/er),jo=jo/er|0),At=0;$i[At]==(Ls[At]||0);At++);if($i[At]>(Ls[At]||0)&&Et--,jo<0)ri.push(1),nn=!0;else{for(zo=Ls.length,ma=$i.length,At=0,jo+=2,An=Zi(lt/($i[0]+1)),An>1&&($i=fe($i,An,lt),Ls=fe(Ls,An,lt),ma=$i.length,zo=Ls.length),Fl=ma,Pr=Ls.slice(0,ma),ui=Pr.length;ui<ma;Pr[ui++]=0);lu=$i.slice(),lu=[0].concat(lu),Tc=$i[0],$i[1]>=lt/2&&Tc++;do{if(An=0,dt=we($i,Pr,ma,ui),dt<0){if(qs=Pr[0],ma!=ui&&(qs=qs*lt+(Pr[1]||0)),An=Zi(qs/Tc),An>1)for(An>=lt&&(An=lt-1),Rn=fe($i,An,lt),Vn=Rn.length,ui=Pr.length;we(Rn,Pr,Vn,ui)==1;)An--,Oe(Rn,ma<Vn?lu:$i,Vn,lt),Vn=Rn.length,dt=1;else An==0&&(dt=An=1),Rn=$i.slice(),Vn=Rn.length;if(Vn<ui&&(Rn=[0].concat(Rn)),Oe(Pr,Rn,ui,lt),ui=Pr.length,dt==-1)for(;we($i,Pr,ma,ui)<1;)An++,Oe(Pr,ma<ui?lu:$i,ui,lt),ui=Pr.length}else dt===0&&(An++,Pr=[0]);ri[At++]=An,Pr[0]?Pr[ui++]=Ls[Fl]||0:(Pr=[Ls[Fl]],ui=1)}while((Fl++<zo||Pr[0]!=null)&&jo--);nn=Pr[0]!=null,ri[0]||ri.splice(0,1)}if(lt==js){for(At=1,jo=ri[0];jo>=10;jo/=10,At++);xt(Wr,je+(Wr.e=At+Et*er-1)+1,at,nn)}else Wr.e=Et,Wr.r=+nn;return Wr}}();function nt(fe,we,Oe,Ne){var ze,je,at,lt,dt;if(Oe==null?Oe=q:s(Oe,0,8),!fe.c)return fe.toString();if(ze=fe.c[0],at=fe.e,we==null)dt=hs(fe.c),dt=Ne==1||Ne==2&&(at<=ae||at>=ve)?w(dt,at):T(dt,at,"0");else if(fe=xt(new Ke(fe),we,Oe),je=fe.e,dt=hs(fe.c),lt=dt.length,Ne==1||Ne==2&&(we<=je||je<=ae)){for(;lt<we;dt+="0",lt++);dt=w(dt,je)}else if(we-=at,dt=T(dt,je,"0"),je+1>lt){if(--we>0)for(dt+=".";we--;dt+="0");}else if(we+=je-lt,we>0)for(je+1==lt&&(dt+=".");we--;dt+="0");return fe.s<0&&ze?"-"+dt:dt}function ct(fe,we){for(var Oe,Ne,ze=1,je=new Ke(fe[0]);ze<fe.length;ze++)Ne=new Ke(fe[ze]),(!Ne.s||(Oe=bo(je,Ne))===we||Oe===0&&je.s===we)&&(je=Ne);return je}function Ft(fe,we,Oe){for(var Ne=1,ze=we.length;!we[--ze];we.pop());for(ze=we[0];ze>=10;ze/=10,Ne++);return(Oe=Ne+Oe*er-1)>$e?fe.c=fe.e=null:Oe<Je?fe.c=[fe.e=0]:(fe.e=Oe,fe.c=we),fe}y=function(){var fe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,Oe=/^\.([^.]+)$/,Ne=/^-?(Infinity|NaN)$/,ze=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(je,at,lt,dt){var Et,At=lt?at:at.replace(ze,"");if(Ne.test(At))je.s=isNaN(At)?null:At<0?-1:1;else{if(!lt&&(At=At.replace(fe,function(nn,An,Rn){return Et=(Rn=Rn.toLowerCase())=="x"?16:Rn=="b"?2:8,!dt||dt==Et?An:nn}),dt&&(Et=dt,At=At.replace(we,"$1").replace(Oe,"0.$1")),at!=At))return new Ke(At,Et);if(Ke.DEBUG)throw Error(ai+"Not a"+(dt?" base "+dt:"")+" number: "+at);je.s=null}je.c=je.e=null}}();function xt(fe,we,Oe,Ne){var ze,je,at,lt,dt,Et,At,nn=fe.c,An=Xo;if(nn){e:{for(ze=1,lt=nn[0];lt>=10;lt/=10,ze++);if(je=we-ze,je<0)je+=er,at=we,dt=nn[Et=0],At=Zi(dt/An[ze-at-1]%10);else if(Et=Io((je+1)/er),Et>=nn.length)if(Ne){for(;nn.length<=Et;nn.push(0));dt=At=0,ze=1,je%=er,at=je-er+1}else break e;else{for(dt=lt=nn[Et],ze=1;lt>=10;lt/=10,ze++);je%=er,at=je-er+ze,At=at<0?0:Zi(dt/An[ze-at-1]%10)}if(Ne=Ne||we<0||nn[Et+1]!=null||(at<0?dt:dt%An[ze-at-1]),Ne=Oe<4?(At||Ne)&&(Oe==0||Oe==(fe.s<0?3:2)):At>5||At==5&&(Oe==4||Ne||Oe==6&&(je>0?at>0?dt/An[ze-at]:0:nn[Et-1])%10&1||Oe==(fe.s<0?8:7)),we<1||!nn[0])return nn.length=0,Ne?(we-=fe.e+1,nn[0]=An[(er-we%er)%er],fe.e=-we||0):nn[0]=fe.e=0,fe;if(je==0?(nn.length=Et,lt=1,Et--):(nn.length=Et+1,lt=An[er-je],nn[Et]=at>0?Zi(dt/An[ze-at]%An[at])*lt:0),Ne)for(;;)if(Et==0){for(je=1,at=nn[0];at>=10;at/=10,je++);for(at=nn[0]+=lt,lt=1;at>=10;at/=10,lt++);je!=lt&&(fe.e++,nn[0]==js&&(nn[0]=1));break}else{if(nn[Et]+=lt,nn[Et]!=js)break;nn[Et--]=0,lt=1}for(je=nn.length;nn[--je]===0;nn.pop());}fe.e>$e?fe.c=fe.e=null:fe.e<Je&&(fe.c=[fe.e=0])}return fe}function Rt(fe){var we,Oe=fe.e;return Oe===null?fe.toString():(we=hs(fe.c),we=Oe<=ae||Oe>=ve?w(we,Oe):T(we,Oe,"0"),fe.s<0?"-"+we:we)}return S.absoluteValue=S.abs=function(){var fe=new Ke(this);return fe.s<0&&(fe.s=1),fe},S.comparedTo=function(fe,we){return bo(this,new Ke(fe,we))},S.decimalPlaces=S.dp=function(fe,we){var Oe,Ne,ze,je=this;if(fe!=null)return s(fe,0,Ns),we==null?we=q:s(we,0,8),xt(new Ke(je),fe+je.e+1,we);if(!(Oe=je.c))return null;if(Ne=((ze=Oe.length-1)-cs(this.e/er))*er,ze=Oe[ze])for(;ze%10==0;ze/=10,Ne--);return Ne<0&&(Ne=0),Ne},S.dividedBy=S.div=function(fe,we){return c(this,new Ke(fe,we),F,q)},S.dividedToIntegerBy=S.idiv=function(fe,we){return c(this,new Ke(fe,we),0,1)},S.exponentiatedBy=S.pow=function(fe,we){var Oe,Ne,ze,je,at,lt,dt,Et,At,nn=this;if(fe=new Ke(fe),fe.c&&!fe.isInteger())throw Error(ai+"Exponent not an integer: "+Rt(fe));if(we!=null&&(we=new Ke(we)),lt=fe.e>14,!nn.c||!nn.c[0]||nn.c[0]==1&&!nn.e&&nn.c.length==1||!fe.c||!fe.c[0])return At=new Ke(Math.pow(+Rt(nn),lt?fe.s*(2-f(fe)):+Rt(fe))),we?At.mod(we):At;if(dt=fe.s<0,we){if(we.c?!we.c[0]:!we.s)return new Ke(NaN);Ne=!dt&&nn.isInteger()&&we.isInteger(),Ne&&(nn=nn.mod(we))}else{if(fe.e>9&&(nn.e>0||nn.e<-1||(nn.e==0?nn.c[0]>1||lt&&nn.c[1]>=24e7:nn.c[0]<8e13||lt&&nn.c[0]<=9999975e7)))return je=nn.s<0&&f(fe)?-0:0,nn.e>-1&&(je=1/je),new Ke(dt?1/je:je);Wt&&(je=Io(Wt/er+2))}for(lt?(Oe=new Ke(.5),dt&&(fe.s=1),Et=f(fe)):(ze=Math.abs(+Rt(fe)),Et=ze%2),At=new Ke(k);;){if(Et){if(At=At.times(nn),!At.c)break;je?At.c.length>je&&(At.c.length=je):Ne&&(At=At.mod(we))}if(ze){if(ze=Zi(ze/2),ze===0)break;Et=ze%2}else if(fe=fe.times(Oe),xt(fe,fe.e+1,1),fe.e>14)Et=f(fe);else{if(ze=+Rt(fe),ze===0)break;Et=ze%2}nn=nn.times(nn),je?nn.c&&nn.c.length>je&&(nn.c.length=je):Ne&&(nn=nn.mod(we))}return Ne?At:(dt&&(At=k.div(At)),we?At.mod(we):je?xt(At,Wt,q,at):At)},S.integerValue=function(fe){var we=new Ke(this);return fe==null?fe=q:s(fe,0,8),xt(we,we.e+1,fe)},S.isEqualTo=S.eq=function(fe,we){return bo(this,new Ke(fe,we))===0},S.isFinite=function(){return!!this.c},S.isGreaterThan=S.gt=function(fe,we){return bo(this,new Ke(fe,we))>0},S.isGreaterThanOrEqualTo=S.gte=function(fe,we){return(we=bo(this,new Ke(fe,we)))===1||we===0},S.isInteger=function(){return!!this.c&&cs(this.e/er)>this.c.length-2},S.isLessThan=S.lt=function(fe,we){return bo(this,new Ke(fe,we))<0},S.isLessThanOrEqualTo=S.lte=function(fe,we){return(we=bo(this,new Ke(fe,we)))===-1||we===0},S.isNaN=function(){return!this.s},S.isNegative=function(){return this.s<0},S.isPositive=function(){return this.s>0},S.isZero=function(){return!!this.c&&this.c[0]==0},S.minus=function(fe,we){var Oe,Ne,ze,je,at=this,lt=at.s;if(fe=new Ke(fe,we),we=fe.s,!lt||!we)return new Ke(NaN);if(lt!=we)return fe.s=-we,at.plus(fe);var dt=at.e/er,Et=fe.e/er,At=at.c,nn=fe.c;if(!dt||!Et){if(!At||!nn)return At?(fe.s=-we,fe):new Ke(nn?at:NaN);if(!At[0]||!nn[0])return nn[0]?(fe.s=-we,fe):new Ke(At[0]?at:q==3?-0:0)}if(dt=cs(dt),Et=cs(Et),At=At.slice(),lt=dt-Et){for((je=lt<0)?(lt=-lt,ze=At):(Et=dt,ze=nn),ze.reverse(),we=lt;we--;ze.push(0));ze.reverse()}else for(Ne=(je=(lt=At.length)<(we=nn.length))?lt:we,lt=we=0;we<Ne;we++)if(At[we]!=nn[we]){je=At[we]<nn[we];break}if(je&&(ze=At,At=nn,nn=ze,fe.s=-fe.s),we=(Ne=nn.length)-(Oe=At.length),we>0)for(;we--;At[Oe++]=0);for(we=js-1;Ne>lt;){if(At[--Ne]<nn[Ne]){for(Oe=Ne;Oe&&!At[--Oe];At[Oe]=we);--At[Oe],At[Ne]+=js}At[Ne]-=nn[Ne]}for(;At[0]==0;At.splice(0,1),--Et);return At[0]?Ft(fe,At,Et):(fe.s=q==3?-1:1,fe.c=[fe.e=0],fe)},S.modulo=S.mod=function(fe,we){var Oe,Ne,ze=this;return fe=new Ke(fe,we),!ze.c||!fe.s||fe.c&&!fe.c[0]?new Ke(NaN):!fe.c||ze.c&&!ze.c[0]?new Ke(ze):(Nt==9?(Ne=fe.s,fe.s=1,Oe=c(ze,fe,0,3),fe.s=Ne,Oe.s*=Ne):Oe=c(ze,fe,0,Nt),fe=ze.minus(Oe.times(fe)),!fe.c[0]&&Nt==1&&(fe.s=ze.s),fe)},S.multipliedBy=S.times=function(fe,we){var Oe,Ne,ze,je,at,lt,dt,Et,At,nn,An,Rn,Vn,Wr,ri,Pr=this,ui=Pr.c,qs=(fe=new Ke(fe,we)).c;if(!ui||!qs||!ui[0]||!qs[0])return!Pr.s||!fe.s||ui&&!ui[0]&&!qs||qs&&!qs[0]&&!ui?fe.c=fe.e=fe.s=null:(fe.s*=Pr.s,!ui||!qs?fe.c=fe.e=null:(fe.c=[0],fe.e=0)),fe;for(Ne=cs(Pr.e/er)+cs(fe.e/er),fe.s*=Pr.s,dt=ui.length,nn=qs.length,dt<nn&&(Vn=ui,ui=qs,qs=Vn,ze=dt,dt=nn,nn=ze),ze=dt+nn,Vn=[];ze--;Vn.push(0));for(Wr=js,ri=_o,ze=nn;--ze>=0;){for(Oe=0,An=qs[ze]%ri,Rn=qs[ze]/ri|0,at=dt,je=ze+at;je>ze;)Et=ui[--at]%ri,At=ui[at]/ri|0,lt=Rn*Et+At*An,Et=An*Et+lt%ri*ri+Vn[je]+Oe,Oe=(Et/Wr|0)+(lt/ri|0)+Rn*At,Vn[je--]=Et%Wr;Vn[je]=Oe}return Oe?++Ne:Vn.splice(0,1),Ft(fe,Vn,Ne)},S.negated=function(){var fe=new Ke(this);return fe.s=-fe.s||null,fe},S.plus=function(fe,we){var Oe,Ne=this,ze=Ne.s;if(fe=new Ke(fe,we),we=fe.s,!ze||!we)return new Ke(NaN);if(ze!=we)return fe.s=-we,Ne.minus(fe);var je=Ne.e/er,at=fe.e/er,lt=Ne.c,dt=fe.c;if(!je||!at){if(!lt||!dt)return new Ke(ze/0);if(!lt[0]||!dt[0])return dt[0]?fe:new Ke(lt[0]?Ne:ze*0)}if(je=cs(je),at=cs(at),lt=lt.slice(),ze=je-at){for(ze>0?(at=je,Oe=dt):(ze=-ze,Oe=lt),Oe.reverse();ze--;Oe.push(0));Oe.reverse()}for(ze=lt.length,we=dt.length,ze-we<0&&(Oe=dt,dt=lt,lt=Oe,we=ze),ze=0;we;)ze=(lt[--we]=lt[we]+dt[we]+ze)/js|0,lt[we]=js===lt[we]?0:lt[we]%js;return ze&&(lt=[ze].concat(lt),++at),Ft(fe,lt,at)},S.precision=S.sd=function(fe,we){var Oe,Ne,ze,je=this;if(fe!=null&&fe!==!!fe)return s(fe,1,Ns),we==null?we=q:s(we,0,8),xt(new Ke(je),fe,we);if(!(Oe=je.c))return null;if(ze=Oe.length-1,Ne=ze*er+1,ze=Oe[ze]){for(;ze%10==0;ze/=10,Ne--);for(ze=Oe[0];ze>=10;ze/=10,Ne++);}return fe&&je.e+1>Ne&&(Ne=je.e+1),Ne},S.shiftedBy=function(fe){return s(fe,-9007199254740991,Yo),this.times("1e"+fe)},S.squareRoot=S.sqrt=function(){var fe,we,Oe,Ne,ze,je=this,at=je.c,lt=je.s,dt=je.e,Et=F+4,At=new Ke("0.5");if(lt!==1||!at||!at[0])return new Ke(!lt||lt<0&&(!at||at[0])?NaN:at?je:1/0);if(lt=Math.sqrt(+Rt(je)),lt==0||lt==1/0?(we=hs(at),(we.length+dt)%2==0&&(we+="0"),lt=Math.sqrt(+we),dt=cs((dt+1)/2)-(dt<0||dt%2),lt==1/0?we="5e"+dt:(we=lt.toExponential(),we=we.slice(0,we.indexOf("e")+1)+dt),Oe=new Ke(we)):Oe=new Ke(lt+""),Oe.c[0]){for(dt=Oe.e,lt=dt+Et,lt<3&&(lt=0);;)if(ze=Oe,Oe=At.times(ze.plus(c(je,ze,Et,1))),hs(ze.c).slice(0,lt)===(we=hs(Oe.c)).slice(0,lt))if(Oe.e<dt&&--lt,we=we.slice(lt-3,lt+1),we=="9999"||!Ne&&we=="4999"){if(!Ne&&(xt(ze,ze.e+F+2,0),ze.times(ze).eq(je))){Oe=ze;break}Et+=4,lt+=4,Ne=1}else{(!+we||!+we.slice(1)&&we.charAt(0)=="5")&&(xt(Oe,Oe.e+F+2,1),fe=!Oe.times(Oe).eq(je));break}}return xt(Oe,Oe.e+F+1,q,fe)},S.toExponential=function(fe,we){return fe!=null&&(s(fe,0,Ns),fe++),nt(this,fe,we,1)},S.toFixed=function(fe,we){return fe!=null&&(s(fe,0,Ns),fe=fe+this.e+1),nt(this,fe,we)},S.toFormat=function(fe,we,Oe){var Ne,ze=this;if(Oe==null)fe!=null&&we&&typeof we=="object"?(Oe=we,we=null):fe&&typeof fe=="object"?(Oe=fe,fe=we=null):Oe=gn;else if(typeof Oe!="object")throw Error(ai+"Argument not an object: "+Oe);if(Ne=ze.toFixed(fe,we),ze.c){var je,at=Ne.split("."),lt=+Oe.groupSize,dt=+Oe.secondaryGroupSize,Et=Oe.groupSeparator||"",At=at[0],nn=at[1],An=ze.s<0,Rn=An?At.slice(1):At,Vn=Rn.length;if(dt&&(je=lt,lt=dt,dt=je,Vn-=je),lt>0&&Vn>0){for(je=Vn%lt||lt,At=Rn.substr(0,je);je<Vn;je+=lt)At+=Et+Rn.substr(je,lt);dt>0&&(At+=Et+Rn.slice(je)),An&&(At="-"+At)}Ne=nn?At+(Oe.decimalSeparator||"")+((dt=+Oe.fractionGroupSize)?nn.replace(new RegExp("\\d{"+dt+"}\\B","g"),"$&"+(Oe.fractionGroupSeparator||"")):nn):At}return(Oe.prefix||"")+Ne+(Oe.suffix||"")},S.toFraction=function(fe){var we,Oe,Ne,ze,je,at,lt,dt,Et,At,nn,An,Rn=this,Vn=Rn.c;if(fe!=null&&(lt=new Ke(fe),!lt.isInteger()&&(lt.c||lt.s!==1)||lt.lt(k)))throw Error(ai+"Argument "+(lt.isInteger()?"out of range: ":"not an integer: ")+Rt(lt));if(!Vn)return new Ke(Rn);for(we=new Ke(k),Et=Oe=new Ke(k),Ne=dt=new Ke(k),An=hs(Vn),je=we.e=An.length-Rn.e-1,we.c[0]=Xo[(at=je%er)<0?er+at:at],fe=!fe||lt.comparedTo(we)>0?je>0?we:Et:lt,at=$e,$e=1/0,lt=new Ke(An),dt.c[0]=0;At=c(lt,we,0,1),ze=Oe.plus(At.times(Ne)),ze.comparedTo(fe)!=1;)Oe=Ne,Ne=ze,Et=dt.plus(At.times(ze=Et)),dt=ze,we=lt.minus(At.times(ze=we)),lt=ze;return ze=c(fe.minus(Oe),Ne,0,1),dt=dt.plus(ze.times(Et)),Oe=Oe.plus(ze.times(Ne)),dt.s=Et.s=Rn.s,je=je*2,nn=c(Et,Ne,je,q).minus(Rn).abs().comparedTo(c(dt,Oe,je,q).minus(Rn).abs())<1?[Et,Ne]:[dt,Oe],$e=at,nn},S.toNumber=function(){return+Rt(this)},S.toPrecision=function(fe,we){return fe!=null&&s(fe,1,Ns),nt(this,fe,we,2)},S.toString=function(fe){var we,Oe=this,Ne=Oe.s,ze=Oe.e;return ze===null?Ne?(we="Infinity",Ne<0&&(we="-"+we)):we="NaN":(fe==null?we=ze<=ae||ze>=ve?w(hs(Oe.c),ze):T(hs(Oe.c),ze,"0"):fe===10&&Jn?(Oe=xt(new Ke(Oe),F+ze+1,q),we=T(hs(Oe.c),Oe.e,"0")):(s(fe,2,vn.length,"Base"),we=p(T(hs(Oe.c),ze,"0"),10,fe,Ne,!0)),Ne<0&&Oe.c[0]&&(we="-"+we)),we},S.valueOf=S.toJSON=function(){return Rt(this)},S._isBigNumber=!0,S[Symbol.toStringTag]="BigNumber",S[Symbol.for("nodejs.util.inspect.custom")]=S.valueOf,a!=null&&Ke.set(a),Ke}function cs(a){var c=a|0;return a>0||a===c?c:c-1}function hs(a){for(var c,p,y=1,S=a.length,k=a[0]+"";y<S;){for(c=a[y++]+"",p=er-c.length;p--;c="0"+c);k+=c}for(S=k.length;k.charCodeAt(--S)===48;);return k.slice(0,S+1||1)}function bo(a,c){var p,y,S=a.c,k=c.c,F=a.s,q=c.s,ae=a.e,ve=c.e;if(!F||!q)return null;if(p=S&&!S[0],y=k&&!k[0],p||y)return p?y?0:-q:F;if(F!=q)return F;if(p=F<0,y=ae==ve,!S||!k)return y?0:!S^p?1:-1;if(!y)return ae>ve^p?1:-1;for(q=(ae=S.length)<(ve=k.length)?ae:ve,F=0;F<q;F++)if(S[F]!=k[F])return S[F]>k[F]^p?1:-1;return ae==ve?0:ae>ve^p?1:-1}function s(a,c,p,y){if(a<c||a>p||a!==Zi(a))throw Error(ai+(y||"Argument")+(typeof a=="number"?a<c||a>p?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function f(a){var c=a.c.length-1;return cs(a.e/er)==c&&a.c[c]%2!=0}function w(a,c){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(c<0?"e":"e+")+c}function T(a,c,p){var y,S;if(c<0){for(S=p+".";++c;S+=p);a=S+a}else if(y=a.length,++c>y){for(S=p,c-=y;--c;S+=p);a+=S}else c<y&&(a=a.slice(0,c)+"."+a.slice(c));return a}var J=ku(),_e=J,ot=class{constructor(a){Pt(this,"key");Pt(this,"left",null);Pt(this,"right",null);this.key=a}},Tt=class extends ot{constructor(a){super(a)}},jt=class{constructor(){Pt(this,"size",0);Pt(this,"modificationCount",0);Pt(this,"splayCount",0)}splay(a){let c=this.root;if(c==null)return this.compare(a,a),-1;let p=null,y=null,S=null,k=null,F=c,q=this.compare,ae;for(;;)if(ae=q(F.key,a),ae>0){let ve=F.left;if(ve==null||(ae=q(ve.key,a),ae>0&&(F.left=ve.right,ve.right=F,F=ve,ve=F.left,ve==null)))break;p==null?y=F:p.left=F,p=F,F=ve}else if(ae<0){let ve=F.right;if(ve==null||(ae=q(ve.key,a),ae<0&&(F.right=ve.left,ve.left=F,F=ve,ve=F.right,ve==null)))break;S==null?k=F:S.right=F,S=F,F=ve}else break;return S!=null&&(S.right=F.left,F.left=k),p!=null&&(p.left=F.right,F.right=y),this.root!==F&&(this.root=F,this.splayCount++),ae}splayMin(a){let c=a,p=c.left;for(;p!=null;){let y=p;c.left=y.right,y.right=c,c=y,p=c.left}return c}splayMax(a){let c=a,p=c.right;for(;p!=null;){let y=p;c.right=y.left,y.left=c,c=y,p=c.right}return c}_delete(a){if(this.root==null||this.splay(a)!=0)return null;let c=this.root,p=c,y=c.left;if(this.size--,y==null)this.root=c.right;else{let S=c.right;c=this.splayMax(y),c.right=S,this.root=c}return this.modificationCount++,p}addNewRoot(a,c){this.size++,this.modificationCount++;let p=this.root;if(p==null){this.root=a;return}c<0?(a.left=p,a.right=p.right,p.right=null):(a.right=p,a.left=p.left,p.left=null),this.root=a}_first(){let a=this.root;return a==null?null:(this.root=this.splayMin(a),this.root)}_last(){let a=this.root;return a==null?null:(this.root=this.splayMax(a),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(a){return this.validKey(a)&&this.splay(a)==0}defaultCompare(){return(a,c)=>a<c?-1:a>c?1:0}wrap(){return{getRoot:()=>this.root,setRoot:a=>{this.root=a},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:a=>{this.splayCount=a},splay:a=>this.splay(a),has:a=>this.has(a)}}},rn=class wf extends jt{constructor(p,y){super();Pt(this,"root",null);Pt(this,"compare");Pt(this,"validKey");Pt(this,bn,"[object Set]");this.compare=p??this.defaultCompare(),this.validKey=y??(S=>S!=null&&S!=null)}delete(p){return this.validKey(p)?this._delete(p)!=null:!1}deleteAll(p){for(let y of p)this.delete(y)}forEach(p){let y=this[Symbol.iterator](),S;for(;S=y.next(),!S.done;)p(S.value,S.value,this)}add(p){let y=this.splay(p);return y!=0&&this.addNewRoot(new Tt(p),y),this}addAndReturn(p){let y=this.splay(p);return y!=0&&this.addNewRoot(new Tt(p),y),this.root.key}addAll(p){for(let y of p)this.add(y)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(p){if(p==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(p)<0)return this.root.key;let y=this.root.left;if(y==null)return null;let S=y.right;for(;S!=null;)y=S,S=y.right;return y.key}firstAfter(p){if(p==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(p)>0)return this.root.key;let y=this.root.right;if(y==null)return null;let S=y.left;for(;S!=null;)y=S,S=y.left;return y.key}retainAll(p){let y=new wf(this.compare,this.validKey),S=this.modificationCount;for(let k of p){if(S!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(k)&&this.splay(k)==0&&y.add(this.root.key)}y.size!=this.size&&(this.root=y.root,this.size=y.size,this.modificationCount++)}lookup(p){return!this.validKey(p)||this.splay(p)!=0?null:this.root.key}intersection(p){let y=new wf(this.compare,this.validKey);for(let S of this)p.has(S)&&y.add(S);return y}difference(p){let y=new wf(this.compare,this.validKey);for(let S of this)p.has(S)||y.add(S);return y}union(p){let y=this.clone();return y.addAll(p),y}clone(){let p=new wf(this.compare,this.validKey);return p.size=this.size,p.root=this.copyNode(this.root),p}copyNode(p){if(p==null)return null;function y(k,F){let q,ae;do{if(q=k.left,ae=k.right,q!=null){let ve=new Tt(q.key);F.left=ve,y(q,ve)}if(ae!=null){let ve=new Tt(ae.key);F.right=ve,k=ae,F=ve}}while(ae!=null)}let S=new Tt(p.key);return y(p,S),S}toSet(){return this.clone()}entries(){return new gr(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(qn=Symbol.iterator,bn=Symbol.toStringTag,qn)](){return new $n(this.wrap())}},Sn=class{constructor(a){Pt(this,"tree");Pt(this,"path",new Array);Pt(this,"modificationCount",null);Pt(this,"splayCount");this.tree=a,this.splayCount=a.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let a=this.path[this.path.length-1];return this.getValue(a)}rebuildPath(a){this.path.splice(0,this.path.length),this.tree.splay(a),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(a){for(;a!=null;)this.path.push(a),a=a.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let p=this.tree.getRoot();for(;p!=null;)this.path.push(p),p=p.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let a=this.path[this.path.length-1],c=a.right;if(c!=null){for(;c!=null;)this.path.push(c),c=c.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===a;)a=this.path.pop();return this.path.length>0}},$n=class extends Sn{getValue(a){return a.key}},gr=class extends Sn{getValue(a){return[a.key,a.key]}},Ki=a=>a,Ti=a=>{if(a){let c=new rn(zs(a)),p=new rn(zs(a)),y=(k,F)=>F.addAndReturn(k),S=k=>({x:y(k.x,c),y:y(k.y,p)});return S({x:new _e(0),y:new _e(0)}),S}return Ki},fs=a=>({set:c=>{wi=fs(c)},reset:()=>fs(a),compare:zs(a),snap:Ti(a),orient:co(a)}),wi=fs(),Us=(a,c)=>a.ll.x.isLessThanOrEqualTo(c.x)&&c.x.isLessThanOrEqualTo(a.ur.x)&&a.ll.y.isLessThanOrEqualTo(c.y)&&c.y.isLessThanOrEqualTo(a.ur.y),Tu=(a,c)=>{if(c.ur.x.isLessThan(a.ll.x)||a.ur.x.isLessThan(c.ll.x)||c.ur.y.isLessThan(a.ll.y)||a.ur.y.isLessThan(c.ll.y))return null;let p=a.ll.x.isLessThan(c.ll.x)?c.ll.x:a.ll.x,y=a.ur.x.isLessThan(c.ur.x)?a.ur.x:c.ur.x,S=a.ll.y.isLessThan(c.ll.y)?c.ll.y:a.ll.y,k=a.ur.y.isLessThan(c.ur.y)?a.ur.y:c.ur.y;return{ll:{x:p,y:S},ur:{x:y,y:k}}},Fo=(a,c)=>a.x.times(c.y).minus(a.y.times(c.x)),wo=(a,c)=>a.x.times(c.x).plus(a.y.times(c.y)),ho=a=>wo(a,a).sqrt(),Mc=(a,c,p)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},S={x:p.x.minus(a.x),y:p.y.minus(a.y)};return Fo(S,y).div(ho(S)).div(ho(y))},ml=(a,c,p)=>{let y={x:c.x.minus(a.x),y:c.y.minus(a.y)},S={x:p.x.minus(a.x),y:p.y.minus(a.y)};return wo(S,y).div(ho(S)).div(ho(y))},Hr=(a,c,p)=>c.y.isZero()?null:{x:a.x.plus(c.x.div(c.y).times(p.minus(a.y))),y:p},xs=(a,c,p)=>c.x.isZero()?null:{x:p,y:a.y.plus(c.y.div(c.x).times(p.minus(a.x)))},Te=(a,c,p,y)=>{if(c.x.isZero())return xs(p,y,a.x);if(y.x.isZero())return xs(a,c,p.x);if(c.y.isZero())return Hr(p,y,a.y);if(y.y.isZero())return Hr(a,c,p.y);let S=Fo(c,y);if(S.isZero())return null;let k={x:p.x.minus(a.x),y:p.y.minus(a.y)},F=Fo(k,c).div(S),q=Fo(k,y).div(S),ae=a.x.plus(q.times(c.x)),ve=p.x.plus(F.times(y.x)),Je=a.y.plus(q.times(c.y)),$e=p.y.plus(F.times(y.y)),mt=ae.plus(ve).div(2),Nt=Je.plus($e).div(2);return{x:mt,y:Nt}},$s=class cb{constructor(c,p){Pt(this,"point");Pt(this,"isLeft");Pt(this,"segment");Pt(this,"otherSE");Pt(this,"consumedBy");c.events===void 0?c.events=[this]:c.events.push(this),this.point=c,this.isLeft=p}static compare(c,p){let y=cb.comparePoints(c.point,p.point);return y!==0?y:(c.point!==p.point&&c.link(p),c.isLeft!==p.isLeft?c.isLeft?1:-1:ds.compare(c.segment,p.segment))}static comparePoints(c,p){return c.x.isLessThan(p.x)?-1:c.x.isGreaterThan(p.x)?1:c.y.isLessThan(p.y)?-1:c.y.isGreaterThan(p.y)?1:0}link(c){if(c.point===this.point)throw new Error("Tried to link already linked events");let p=c.point.events;for(let y=0,S=p.length;y<S;y++){let k=p[y];this.point.events.push(k),k.point=this.point}this.checkForConsuming()}checkForConsuming(){let c=this.point.events.length;for(let p=0;p<c;p++){let y=this.point.events[p];if(y.segment.consumedBy===void 0)for(let S=p+1;S<c;S++){let k=this.point.events[S];k.consumedBy===void 0&&y.otherSE.point.events===k.otherSE.point.events&&y.segment.consume(k.segment)}}}getAvailableLinkedEvents(){let c=[];for(let p=0,y=this.point.events.length;p<y;p++){let S=this.point.events[p];S!==this&&!S.segment.ringOut&&S.segment.isInResult()&&c.push(S)}return c}getLeftmostComparator(c){let p=new Map,y=S=>{let k=S.otherSE;p.set(S,{sine:Mc(this.point,c.point,k.point),cosine:ml(this.point,c.point,k.point)})};return(S,k)=>{p.has(S)||y(S),p.has(k)||y(k);let{sine:F,cosine:q}=p.get(S),{sine:ae,cosine:ve}=p.get(k);return F.isGreaterThanOrEqualTo(0)&&ae.isGreaterThanOrEqualTo(0)?q.isLessThan(ve)?1:q.isGreaterThan(ve)?-1:0:F.isLessThan(0)&&ae.isLessThan(0)?q.isLessThan(ve)?-1:q.isGreaterThan(ve)?1:0:ae.isLessThan(F)?-1:ae.isGreaterThan(F)?1:0}}},Il=0,ds=class Vd{constructor(c,p,y,S){Pt(this,"id");Pt(this,"leftSE");Pt(this,"rightSE");Pt(this,"rings");Pt(this,"windings");Pt(this,"ringOut");Pt(this,"consumedBy");Pt(this,"prev");Pt(this,"_prevInResult");Pt(this,"_beforeState");Pt(this,"_afterState");Pt(this,"_isInResult");this.id=++Il,this.leftSE=c,c.segment=this,c.otherSE=p,this.rightSE=p,p.segment=this,p.otherSE=c,this.rings=y,this.windings=S}static compare(c,p){let y=c.leftSE.point.x,S=p.leftSE.point.x,k=c.rightSE.point.x,F=p.rightSE.point.x;if(F.isLessThan(y))return 1;if(k.isLessThan(S))return-1;let q=c.leftSE.point.y,ae=p.leftSE.point.y,ve=c.rightSE.point.y,Je=p.rightSE.point.y;if(y.isLessThan(S)){if(ae.isLessThan(q)&&ae.isLessThan(ve))return 1;if(ae.isGreaterThan(q)&&ae.isGreaterThan(ve))return-1;let $e=c.comparePoint(p.leftSE.point);if($e<0)return 1;if($e>0)return-1;let mt=p.comparePoint(c.rightSE.point);return mt!==0?mt:-1}if(y.isGreaterThan(S)){if(q.isLessThan(ae)&&q.isLessThan(Je))return-1;if(q.isGreaterThan(ae)&&q.isGreaterThan(Je))return 1;let $e=p.comparePoint(c.leftSE.point);if($e!==0)return $e;let mt=c.comparePoint(p.rightSE.point);return mt<0?1:mt>0?-1:1}if(q.isLessThan(ae))return-1;if(q.isGreaterThan(ae))return 1;if(k.isLessThan(F)){let $e=p.comparePoint(c.rightSE.point);if($e!==0)return $e}if(k.isGreaterThan(F)){let $e=c.comparePoint(p.rightSE.point);if($e<0)return 1;if($e>0)return-1}if(!k.eq(F)){let $e=ve.minus(q),mt=k.minus(y),Nt=Je.minus(ae),Wt=F.minus(S);if($e.isGreaterThan(mt)&&Nt.isLessThan(Wt))return 1;if($e.isLessThan(mt)&&Nt.isGreaterThan(Wt))return-1}return k.isGreaterThan(F)?1:k.isLessThan(F)||ve.isLessThan(Je)?-1:ve.isGreaterThan(Je)?1:c.id<p.id?-1:c.id>p.id?1:0}static fromRing(c,p,y){let S,k,F,q=$s.comparePoints(c,p);if(q<0)S=c,k=p,F=1;else if(q>0)S=p,k=c,F=-1;else throw new Error(`Tried to create degenerate segment at [${c.x}, ${c.y}]`);let ae=new $s(S,!0),ve=new $s(k,!1);return new Vd(ae,ve,[y],[F])}replaceRightSE(c){this.rightSE=c,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let c=this.leftSE.point.y,p=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:c.isLessThan(p)?c:p},ur:{x:this.rightSE.point.x,y:c.isGreaterThan(p)?c:p}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(c){return c.x.eq(this.leftSE.point.x)&&c.y.eq(this.leftSE.point.y)||c.x.eq(this.rightSE.point.x)&&c.y.eq(this.rightSE.point.y)}comparePoint(c){return wi.orient(this.leftSE.point,c,this.rightSE.point)}getIntersection(c){let p=this.bbox(),y=c.bbox(),S=Tu(p,y);if(S===null)return null;let k=this.leftSE.point,F=this.rightSE.point,q=c.leftSE.point,ae=c.rightSE.point,ve=Us(p,q)&&this.comparePoint(q)===0,Je=Us(y,k)&&c.comparePoint(k)===0,$e=Us(p,ae)&&this.comparePoint(ae)===0,mt=Us(y,F)&&c.comparePoint(F)===0;if(Je&&ve)return mt&&!$e?F:!mt&&$e?ae:null;if(Je)return $e&&k.x.eq(ae.x)&&k.y.eq(ae.y)?null:k;if(ve)return mt&&F.x.eq(q.x)&&F.y.eq(q.y)?null:q;if(mt&&$e)return null;if(mt)return F;if($e)return ae;let Nt=Te(k,this.vector(),q,c.vector());return Nt===null||!Us(S,Nt)?null:wi.snap(Nt)}split(c){let p=[],y=c.events!==void 0,S=new $s(c,!0),k=new $s(c,!1),F=this.rightSE;this.replaceRightSE(k),p.push(k),p.push(S);let q=new Vd(S,F,this.rings.slice(),this.windings.slice());return $s.comparePoints(q.leftSE.point,q.rightSE.point)>0&&q.swapEvents(),$s.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),y&&(S.checkForConsuming(),k.checkForConsuming()),p}swapEvents(){let c=this.rightSE;this.rightSE=this.leftSE,this.leftSE=c,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let p=0,y=this.windings.length;p<y;p++)this.windings[p]*=-1}consume(c){let p=this,y=c;for(;p.consumedBy;)p=p.consumedBy;for(;y.consumedBy;)y=y.consumedBy;let S=Vd.compare(p,y);if(S!==0){if(S>0){let k=p;p=y,y=k}if(p.prev===y){let k=p;p=y,y=k}for(let k=0,F=y.rings.length;k<F;k++){let q=y.rings[k],ae=y.windings[k],ve=p.rings.indexOf(q);ve===-1?(p.rings.push(q),p.windings.push(ae)):p.windings[ve]+=ae}y.rings=null,y.windings=null,y.consumedBy=p,y.leftSE.consumedBy=p.leftSE,y.rightSE.consumedBy=p.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let c=this.prev.consumedBy||this.prev;this._beforeState=c.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let c=this.beforeState();this._afterState={rings:c.rings.slice(0),windings:c.windings.slice(0),multiPolys:[]};let p=this._afterState.rings,y=this._afterState.windings,S=this._afterState.multiPolys;for(let q=0,ae=this.rings.length;q<ae;q++){let ve=this.rings[q],Je=this.windings[q],$e=p.indexOf(ve);$e===-1?(p.push(ve),y.push(Je)):y[$e]+=Je}let k=[],F=[];for(let q=0,ae=p.length;q<ae;q++){if(y[q]===0)continue;let ve=p[q],Je=ve.poly;if(F.indexOf(Je)===-1)if(ve.isExterior)k.push(Je);else{F.indexOf(Je)===-1&&F.push(Je);let $e=k.indexOf(ve.poly);$e!==-1&&k.splice($e,1)}}for(let q=0,ae=k.length;q<ae;q++){let ve=k[q].multiPoly;S.indexOf(ve)===-1&&S.push(ve)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let c=this.beforeState().multiPolys,p=this.afterState().multiPolys;switch(nc.type){case"union":{let y=c.length===0,S=p.length===0;this._isInResult=y!==S;break}case"intersection":{let y,S;c.length<p.length?(y=c.length,S=p.length):(y=p.length,S=c.length),this._isInResult=S===nc.numMultiPolys&&y<S;break}case"xor":{let y=Math.abs(c.length-p.length);this._isInResult=y%2===1;break}case"difference":{let y=S=>S.length===1&&S[0].isSubject;this._isInResult=y(c)!==y(p);break}}return this._isInResult}},yr=class{constructor(a,c,p){Pt(this,"poly");Pt(this,"isExterior");Pt(this,"segments");Pt(this,"bbox");if(!Array.isArray(a)||a.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=c,this.isExterior=p,this.segments=[],typeof a[0][0]!="number"||typeof a[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let y=wi.snap({x:new _e(a[0][0]),y:new _e(a[0][1])});this.bbox={ll:{x:y.x,y:y.y},ur:{x:y.x,y:y.y}};let S=y;for(let k=1,F=a.length;k<F;k++){if(typeof a[k][0]!="number"||typeof a[k][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let q=wi.snap({x:new _e(a[k][0]),y:new _e(a[k][1])});q.x.eq(S.x)&&q.y.eq(S.y)||(this.segments.push(ds.fromRing(S,q,this)),q.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=q.x),q.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=q.y),q.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=q.x),q.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=q.y),S=q)}(!y.x.eq(S.x)||!y.y.eq(S.y))&&this.segments.push(ds.fromRing(S,y,this))}getSweepEvents(){let a=[];for(let c=0,p=this.segments.length;c<p;c++){let y=this.segments[c];a.push(y.leftSE),a.push(y.rightSE)}return a}},ec=class{constructor(a,c){Pt(this,"multiPoly");Pt(this,"exteriorRing");Pt(this,"interiorRings");Pt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new yr(a[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let p=1,y=a.length;p<y;p++){let S=new yr(a[p],this,!1);S.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=S.bbox.ll.x),S.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=S.bbox.ll.y),S.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=S.bbox.ur.x),S.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=S.bbox.ur.y),this.interiorRings.push(S)}this.multiPoly=c}getSweepEvents(){let a=this.exteriorRing.getSweepEvents();for(let c=0,p=this.interiorRings.length;c<p;c++){let y=this.interiorRings[c].getSweepEvents();for(let S=0,k=y.length;S<k;S++)a.push(y[S])}return a}},hh=class{constructor(a,c){Pt(this,"isSubject");Pt(this,"polys");Pt(this,"bbox");if(!Array.isArray(a))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof a[0][0][0]=="number"&&(a=[a])}catch{}this.polys=[],this.bbox={ll:{x:new _e(Number.POSITIVE_INFINITY),y:new _e(Number.POSITIVE_INFINITY)},ur:{x:new _e(Number.NEGATIVE_INFINITY),y:new _e(Number.NEGATIVE_INFINITY)}};for(let p=0,y=a.length;p<y;p++){let S=new ec(a[p],this);S.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=S.bbox.ll.x),S.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=S.bbox.ll.y),S.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=S.bbox.ur.x),S.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=S.bbox.ur.y),this.polys.push(S)}this.isSubject=c}getSweepEvents(){let a=[];for(let c=0,p=this.polys.length;c<p;c++){let y=this.polys[c].getSweepEvents();for(let S=0,k=y.length;S<k;S++)a.push(y[S])}return a}},tc=class Mg{constructor(c){Pt(this,"events");Pt(this,"poly");Pt(this,"_isExteriorRing");Pt(this,"_enclosingRing");this.events=c;for(let p=0,y=c.length;p<y;p++)c[p].segment.ringOut=this;this.poly=null}static factory(c){let p=[];for(let y=0,S=c.length;y<S;y++){let k=c[y];if(!k.isInResult()||k.ringOut)continue;let F=null,q=k.leftSE,ae=k.rightSE,ve=[q],Je=q.point,$e=[];for(;F=q,q=ae,ve.push(q),q.point!==Je;)for(;;){let mt=q.getAvailableLinkedEvents();if(mt.length===0){let gn=ve[0].point,vn=ve[ve.length-1].point;throw new Error(`Unable to complete output ring starting at [${gn.x}, ${gn.y}]. Last matching segment found ends at [${vn.x}, ${vn.y}].`)}if(mt.length===1){ae=mt[0].otherSE;break}let Nt=null;for(let gn=0,vn=$e.length;gn<vn;gn++)if($e[gn].point===q.point){Nt=gn;break}if(Nt!==null){let gn=$e.splice(Nt)[0],vn=ve.splice(gn.index);vn.unshift(vn[0].otherSE),p.push(new Mg(vn.reverse()));continue}$e.push({index:ve.length,point:q.point});let Wt=q.getLeftmostComparator(F);ae=mt.sort(Wt)[0].otherSE;break}p.push(new Mg(ve))}return p}getGeom(){let c=this.events[0].point,p=[c];for(let ve=1,Je=this.events.length-1;ve<Je;ve++){let $e=this.events[ve].point,mt=this.events[ve+1].point;wi.orient($e,c,mt)!==0&&(p.push($e),c=$e)}if(p.length===1)return null;let y=p[0],S=p[1];wi.orient(y,c,S)===0&&p.shift(),p.push(p[0]);let k=this.isExteriorRing()?1:-1,F=this.isExteriorRing()?0:p.length-1,q=this.isExteriorRing()?p.length:-1,ae=[];for(let ve=F;ve!=q;ve+=k)ae.push([p[ve].x.toNumber(),p[ve].y.toNumber()]);return ae}isExteriorRing(){if(this._isExteriorRing===void 0){let c=this.enclosingRing();this._isExteriorRing=c?!c.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var S,k;let c=this.events[0];for(let F=1,q=this.events.length;F<q;F++){let ae=this.events[F];$s.compare(c,ae)>0&&(c=ae)}let p=c.segment.prevInResult(),y=p?p.prevInResult():null;for(;;){if(!p)return null;if(!y)return p.ringOut;if(y.ringOut!==p.ringOut)return((S=y.ringOut)==null?void 0:S.enclosingRing())!==p.ringOut?p.ringOut:(k=p.ringOut)==null?void 0:k.enclosingRing();p=y.prevInResult(),y=p?p.prevInResult():null}}},ga=class{constructor(a){Pt(this,"exteriorRing");Pt(this,"interiorRings");this.exteriorRing=a,a.poly=this,this.interiorRings=[]}addInterior(a){this.interiorRings.push(a),a.poly=this}getGeom(){let a=this.exteriorRing.getGeom();if(a===null)return null;let c=[a];for(let p=0,y=this.interiorRings.length;p<y;p++){let S=this.interiorRings[p].getGeom();S!==null&&c.push(S)}return c}},Bu=class{constructor(a){Pt(this,"rings");Pt(this,"polys");this.rings=a,this.polys=this._composePolys(a)}getGeom(){let a=[];for(let c=0,p=this.polys.length;c<p;c++){let y=this.polys[c].getGeom();y!==null&&a.push(y)}return a}_composePolys(a){var p;let c=[];for(let y=0,S=a.length;y<S;y++){let k=a[y];if(!k.poly)if(k.isExteriorRing())c.push(new ga(k));else{let F=k.enclosingRing();F!=null&&F.poly||c.push(new ga(F)),(p=F==null?void 0:F.poly)==null||p.addInterior(k)}}return c}},kc=class{constructor(a,c=ds.compare){Pt(this,"queue");Pt(this,"tree");Pt(this,"segments");this.queue=a,this.tree=new rn(c),this.segments=[]}process(a){let c=a.segment,p=[];if(a.consumedBy)return a.isLeft?this.queue.delete(a.otherSE):this.tree.delete(c),p;a.isLeft&&this.tree.add(c);let y=c,S=c;do y=this.tree.lastBefore(y);while(y!=null&&y.consumedBy!=null);do S=this.tree.firstAfter(S);while(S!=null&&S.consumedBy!=null);if(a.isLeft){let k=null;if(y){let q=y.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(k=q),!y.isAnEndpoint(q))){let ae=this._splitSafely(y,q);for(let ve=0,Je=ae.length;ve<Je;ve++)p.push(ae[ve])}}let F=null;if(S){let q=S.getIntersection(c);if(q!==null&&(c.isAnEndpoint(q)||(F=q),!S.isAnEndpoint(q))){let ae=this._splitSafely(S,q);for(let ve=0,Je=ae.length;ve<Je;ve++)p.push(ae[ve])}}if(k!==null||F!==null){let q=null;k===null?q=F:F===null?q=k:q=$s.comparePoints(k,F)<=0?k:F,this.queue.delete(c.rightSE),p.push(c.rightSE);let ae=c.split(q);for(let ve=0,Je=ae.length;ve<Je;ve++)p.push(ae[ve])}p.length>0?(this.tree.delete(c),p.push(a)):(this.segments.push(c),c.prev=y)}else{if(y&&S){let k=y.getIntersection(S);if(k!==null){if(!y.isAnEndpoint(k)){let F=this._splitSafely(y,k);for(let q=0,ae=F.length;q<ae;q++)p.push(F[q])}if(!S.isAnEndpoint(k)){let F=this._splitSafely(S,k);for(let q=0,ae=F.length;q<ae;q++)p.push(F[q])}}}this.tree.delete(c)}return p}_splitSafely(a,c){this.tree.delete(a);let p=a.rightSE;this.queue.delete(p);let y=a.split(c);return y.push(p),a.consumedBy===void 0&&this.tree.add(a),y}},Qh=class{constructor(){Pt(this,"type");Pt(this,"numMultiPolys")}run(a,c,p){au.type=a;let y=[new hh(c,!0)];for(let ae=0,ve=p.length;ae<ve;ae++)y.push(new hh(p[ae],!1));if(au.numMultiPolys=y.length,au.type==="difference"){let ae=y[0],ve=1;for(;ve<y.length;)Tu(y[ve].bbox,ae.bbox)!==null?ve++:y.splice(ve,1)}if(au.type==="intersection")for(let ae=0,ve=y.length;ae<ve;ae++){let Je=y[ae];for(let $e=ae+1,mt=y.length;$e<mt;$e++)if(Tu(Je.bbox,y[$e].bbox)===null)return[]}let S=new rn($s.compare);for(let ae=0,ve=y.length;ae<ve;ae++){let Je=y[ae].getSweepEvents();for(let $e=0,mt=Je.length;$e<mt;$e++)S.add(Je[$e])}let k=new kc(S),F=null;for(S.size!=0&&(F=S.first(),S.delete(F));F;){let ae=k.process(F);for(let ve=0,Je=ae.length;ve<Je;ve++){let $e=ae[ve];$e.consumedBy===void 0&&S.add($e)}S.size!=0?(F=S.first(),S.delete(F)):F=null}wi.reset();let q=tc.factory(k.segments);return new Bu(q).getGeom()}},au=new Qh,nc=au,nl=(a,...c)=>nc.run("intersection",a,c),ef=(a,...c)=>nc.run("difference",a,c);wi.set;function rc(a){let c={type:"Feature"};return c.geometry=a,c}function ic(a){return a.type==="Feature"?a.geometry:a}function fh(a){return a&&a.geometry&&a.geometry.coordinates?a.geometry.coordinates:a}function dh(a){return rc({type:"LineString",coordinates:a})}function Qo(a){return rc({type:"MultiLineString",coordinates:a})}function ph(a){return rc({type:"Polygon",coordinates:a})}function gh(a){return rc({type:"MultiPolygon",coordinates:a})}function mh(a,c){let p=ic(a),y=ic(c),S=nl(p.coordinates,y.coordinates);return S.length===0?null:S.length===1?ph(S[0]):gh(S)}function m(a,c){let p=ic(a),y=ic(c),S=ef(p.coordinates,y.coordinates);return S.length===0?null:S.length===1?ph(S[0]):gh(S)}function C(a){return Array.isArray(a)?1+C(a[0]):-1}function B(a){a instanceof L.Polyline&&(a=a.toGeoJSON(15));let c=fh(a),p=C(c),y=[];return p>1?c.forEach(S=>{y.push(dh(S))}):y.push(a),y}function Y(a){let c=[];return a.eachLayer(p=>{c.push(fh(p.toGeoJSON(15)))}),Qo(c)}zi.Cut=zi.Polygon.extend({initialize(a){this._map=a,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let a=this._layer.getLatLngs();if(a.length<=2)return;let c=L.polygon(a,this.options.pathOptions);c._latlngInfos=this._layer._latlngInfo,this.cut(c),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:y,originalLayer:S})=>{this._fireCut(S,y,S),this._fireCut(this._map,y,S),S.pm._fireEdit()}),this._editedLayers=[];let p=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(p))},cut(a){let c=this._map._layers,p=a._latlngInfos||[];Object.keys(c).map(y=>c[y]).filter(y=>y.pm).filter(y=>!y._pmTempLayer).filter(y=>!L.PM.optIn&&!y.options.pmIgnore||L.PM.optIn&&y.options.pmIgnore===!1).filter(y=>y instanceof L.Polyline).filter(y=>y!==a).filter(y=>y.pm.options.allowCutting).filter(y=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(y)>-1:!0).filter(y=>!this._layerGroup.hasLayer(y)).filter(y=>{try{let S=!!Fs(a.toGeoJSON(15),y.toGeoJSON(15)).features.length>0;return S||y instanceof L.Polyline&&!(y instanceof L.Polygon)?S:!!mh(a.toGeoJSON(15),y.toGeoJSON(15))}catch{return y instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(y=>{let S;if(y instanceof L.Polygon){S=L.polygon(y.getLatLngs());let ae=S.getLatLngs();p.forEach(ve=>{if(ve&&ve.snapInfo){let{latlng:Je}=ve,$e=this._calcClosestLayer(Je,[S]);if($e&&$e.segment&&$e.distance<this.options.snapDistance){let{segment:mt}=$e;if(mt&&mt.length===2){let{indexPath:Nt,parentPath:Wt,newIndex:gn}=L.PM.Utils._getIndexFromSegment(ae,mt);(Nt.length>1?(0,li.default)(ae,Wt):ae).splice(gn,0,Je)}}}})}else S=y;let k=this._cutLayer(a,S),F=L.geoJSON(k,y.options);F.getLayers().length===1&&([F]=F.getLayers()),this._setPane(F,"layerPane");let q=F.addTo(this._map.pm._getContainingLayer());if(q.pm.enable(y.pm.options),q.pm.disable(),y._pmTempLayer=!0,a._pmTempLayer=!0,y.remove(),y.removeFrom(this._map.pm._getContainingLayer()),a.remove(),a.removeFrom(this._map.pm._getContainingLayer()),q.getLayers&&q.getLayers().length===0&&this._map.pm.removeLayer({target:q}),q instanceof L.LayerGroup?(q.eachLayer(ae=>{this._addDrawnLayerProp(ae)}),this._addDrawnLayerProp(q)):this._addDrawnLayerProp(q),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let ae=this.options.layersToCut.indexOf(y);ae>-1&&this.options.layersToCut.splice(ae,1)}this._editedLayers.push({layer:q,originalLayer:y})})},_cutLayer(a,c){let p=L.geoJSON(),y;if(c instanceof L.Polygon)y=m(c.toGeoJSON(15),a.toGeoJSON(15));else{let S=B(c);S.forEach(k=>{let F=zn(k,a.toGeoJSON(15)),q;F&&F.features.length>0?q=L.geoJSON(F):q=L.geoJSON(k),q.getLayers().forEach(ae=>{No(a.toGeoJSON(15),ae.toGeoJSON(15))||ae.addTo(p)})}),S.length>1?y=Y(p):y=p.toGeoJSON(15)}return y},_change:L.Util.falseFn}),zi.Text=zi.extend({initialize(a){this._map=a,this._shape="Text",this.toolbarButtonName="drawText"},enable(a){L.Util.setOptions(this,a),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Wn("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var a;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(a=this._hintMarker)==null||a.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(a){this.enabled()?this.disable():this.enable(a)},_syncHintMarker(a){if(this._hintMarker.setLatLng(a.latlng),this.options.snappable){let c=a;c.target=this._hintMarker,this._handleSnapping(c)}},_createMarker(a){var S,k,F,q;if(!a.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(a.latlng);let c=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(S=this.options.textOptions)==null?void 0:S.className){let ae=this.options.textOptions.className.split(" ");this.textArea.classList.add(...ae)}let p=this._createTextIcon(this.textArea),y=new L.Marker(c,{textMarker:!0,_textMarkerOverPM:!0,icon:p});if(this._setPane(y,"markerPane"),this._finishLayer(y),y.pm||(y.options.draggable=!1),y.addTo(this._map.pm._getContainingLayer()),y.pm){y.pm.textArea=this.textArea,L.setOptions(y.pm,{removeIfEmpty:((k=this.options.textOptions)==null?void 0:k.removeIfEmpty)??!0});let ae=((F=this.options.textOptions)==null?void 0:F.focusAfterDraw)??!0;y.pm._createTextMarker(ae),(q=this.options.textOptions)!=null&&q.text&&y.pm.setText(this.options.textOptions.text)}this._fireCreate(y),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(a){this.enable(),this._hintMarker.setLatLng(a.latlng)},_createTextArea(){let a=document.createElement("textarea");return a.readOnly=!0,a.classList.add("pm-textarea","pm-disabled"),a},_createTextIcon(a){return L.divIcon({className:"pm-text-marker",html:a})}});var pe={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,Zr(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let a=this._getDOMElem();a&&(Zr(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(a)):L.DomEvent.on(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,Zr(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let a=this._getDOMElem();a&&(Zr(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(a)):L.DomEvent.off(a,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(a){let c=a.touches?a.touches[0]:a,p={originalEvent:c,target:this._layer};return p.containerPoint=this._map.mouseEventToContainerPoint(c),p.latlng=this._map.containerPointToLatLng(p.containerPoint),this._dragMixinOnMouseDown(p),!1},_simulateMouseMoveEvent(a){let c=a.touches?a.touches[0]:a,p={originalEvent:c,target:this._layer};return p.containerPoint=this._map.mouseEventToContainerPoint(c),p.latlng=this._map.containerPointToLatLng(p.containerPoint),this._dragMixinOnMouseMove(p),!1},_simulateMouseUpEvent(a){let c={originalEvent:a.touches?a.touches[0]:a,target:this._layer};return a.type.indexOf("touch")===-1&&(c.containerPoint=this._map.mouseEventToContainerPoint(a),c.latlng=this._map.containerPointToLatLng(c.containerPoint)),this._dragMixinOnMouseUp(c),!1},_dragMixinOnMouseDown(a){if(a.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(a);let c=a._fromLayerSync,p=this._syncLayers("_dragMixinOnMouseDown",a);if(this._layer instanceof L.Marker&&(this.options.snappable&&!c&&!p?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let y="resizeableCircleMarker";this._layer instanceof L.Circle&&(y="resizeableCircle"),this.options.snappable&&!c&&!p?this._layer.pm.options[y]||this._initSnappableMarkersDrag():this._layer.pm.options[y]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=a.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(a){this._overwriteEventIfItComesFromMarker(a);let c=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",a),this._dragging||(this._dragging=!0,L.DomUtil.addClass(c,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=a.latlng),this._onLayerDrag(a),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(a){let c=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",a),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,c&&L.DomUtil.removeClass(c,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(a){let{latlng:c}=a,p={lat:c.lat-this._tempDragCoord.lat,lng:c.lng-this._tempDragCoord.lng},y=S=>S.map(k=>{if(Array.isArray(k))return y(k);let F={lat:k.lat+p.lat,lng:k.lng+p.lng};return(k.alt||k.alt===0)&&(F.alt=k.alt),F});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let S=y([this._layer.getLatLng()]);this._layer.setLatLng(S[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let S=this._layer.getLatLng();this._layer._snapped&&(S=this._layer._orgLatLng);let k=y([S]);this._layer.setLatLng(k[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let S=y([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(S),this._fireChange(this._layer.getBounds(),"Edit")}else{let S=y(this._layer.getLatLngs());this._layer.setLatLngs(S),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=c,a.layer=this._layer,this._fireDrag(a)},addDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.addClass(a,"leaflet-pm-draggable")},removeDraggingClass(){let a=this._getDOMElem();a&&L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_getDOMElem(){let a=null;return this._layer._path?a=this._layer._path:this._layer._renderer&&this._layer._renderer._container?a=this._layer._renderer._container:this._layer._image?a=this._layer._image:this._layer._icon&&(a=this._layer._icon),a},_overwriteEventIfItComesFromMarker(a){a.target.getLatLng&&(!a.target._radius||a.target._radius<=10)&&(a.containerPoint=this._map.mouseEventToContainerPoint(a.originalEvent),a.latlng=this._map.containerPointToLatLng(a.containerPoint))},_syncLayers(a,c){if(this.enabled())return!1;if(!c._fromLayerSync&&this._layer===c.target&&this.options.syncLayersOnDrag){c._fromLayerSync=!0;let p=[];if(L.Util.isArray(this.options.syncLayersOnDrag))p=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(y=>{y instanceof L.LayerGroup&&(p=p.concat(y.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let y in this._parentLayerGroup){let S=this._parentLayerGroup[y];S.pm&&(p=S.pm.getLayers(!0))}return L.Util.isArray(p)&&p.length>0&&(p=p.filter(y=>!!y.pm).filter(y=>!!y.pm.options.draggable),p.forEach(y=>{y!==this._layer&&y.pm[a]&&(y._snapped=!1,y.pm[a](c))})),p.length>0}return!1},_stopDOMImageDrag(a){return a.preventDefault(),!1}},be=pe,Le=g(Xt());function ke(a,c,p,y){return p.unproject(c.transform(p.project(a,y)),y)}function Be(a,c,p){let y=p.getMaxZoom();if(y===1/0&&(y=p.getZoom()),L.Util.isArray(a)){let S=[];return a.forEach(k=>{S.push(Be(k,c,p))}),S}return a instanceof L.LatLng?ke(a,c,p,y):null}function Ge(a,c){c instanceof L.Layer&&(c=c.getLatLng());let p=a.getMaxZoom();return p===1/0&&(p=a.getZoom()),a.project(c,p)}function ht(a,c){let p=a.getMaxZoom();return p===1/0&&(p=a.getZoom()),a.unproject(c,p)}var Ot={_onRotateStart(a){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Ge(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Ge(this._map,a.target.getLatLng()),this._initialRotateLatLng=uo(this._layer),this._startAngle=this.getAngle();let c=uo(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,c),this._fireRotationStart(this._map,c)},_onRotate(a){let c=Ge(this._map,a.target.getLatLng()),p=this._rotationStartPoint,y=this._rotationOriginPoint,S=Math.atan2(c.y-y.y,c.x-y.x)-Math.atan2(p.y-y.y,p.x-y.x);this._layer.setLatLngs(this._rotateLayer(S,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let k=this;function F(Je,$e=[],mt=-1){if(mt>-1&&$e.push(mt),L.Util.isArray(Je[0]))Je.forEach((Nt,Wt)=>F(Nt,$e.slice(),Wt));else{let Nt=$e.length>0?(0,Le.default)(k._markers,$e):k._markers[0];Je.forEach((Wt,gn)=>{Nt[gn].setLatLng(Wt)})}}F(this._layer.getLatLngs());let q=uo(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(S,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let ae=S*180/Math.PI;ae=ae<0?ae+360:ae;let ve=ae+this._startAngle;this._setAngle(ve),this._rotationLayer.pm._setAngle(ve),this._fireRotation(this._rotationLayer,ae,q),this._fireRotation(this._map,ae,q),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let a=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let c=uo(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=uo(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,a,c),this._fireRotationEnd(this._map,a,c),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(a,c,p,y,S){let k=Ge(S,p);return this._matrix=y.clone().rotate(a,k).flip(),Be(c,this._matrix,S)},_setAngle(a){a=a<0?a+360:a,this._angle=a%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let a=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),c=a.getCenter();return a.removeFrom(this._layer._map),c},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Mo(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),a),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=uo(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(a){let c=this.getAngle(),p=this._layer.getLatLngs(),y=a*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(y,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+a),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(y,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let S=this.getAngle()-c;S=S<0?S+360:S,this._startAngle=c,this._fireRotation(this._layer,S,p,this._layer),this._fireRotation(this._map||this._layer._map,S,p,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(a){let c=a-this.getAngle();this.rotateLayer(c)},getAngle(){return this._angle||0},setInitAngle(a){this._setAngle(a)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(a){this._rotationCenter=a,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(a)}},It=Ot,Lt=L.Class.extend({includes:[be,eo,It,Ja],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(a){L.Util.setOptions(this,a)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(a,c){c==="layerPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":c==="vertexPane"?a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":c==="markerPane"&&(a.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(a,c){let p=c.target,y={layer:this._layer,marker:p,event:c},S="";return a==="move"?S="moveVertexValidation":a==="add"?S="addVertexValidation":a==="remove"&&(S="removeVertexValidation"),this.options[S]&&typeof this.options[S]=="function"&&!this.options[S](y)?(a==="move"&&(p._cancelDragEventChain=p.getLatLng()),!1):(p._cancelDragEventChain=null,!0)},_vertexValidationDrag(a){return a._cancelDragEventChain?(a._latlng=a._cancelDragEventChain,a.update(),!1):!0},_vertexValidationDragEnd(a){return a._cancelDragEventChain?(a._cancelDragEventChain=null,!1):!0}}),Vt=Lt;Vt.LayerGroup=L.Class.extend({initialize(a){this._layerGroup=a,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(y=>this._initLayer(y));let c=y=>{if(y.layer._pmTempLayer)return;this._layers=this.getLayers();let S=this._layers.filter(k=>!k.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in k.pm._parentLayerGroup));S.forEach(k=>{this._initLayer(k)}),S.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(c,100,this),this),this._layerGroup.on("layerremove",y=>{this._removeLayerFromGroup(y.target)},this);let p=y=>{y.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(p,100,this),this)},enable(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(p=>{p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.enable(a,c)):p.pm.enable(a)})},disable(a=[]){a.length===0&&(this._layers=this.getLayers()),this._layers.forEach(c=>{c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1&&(a.push(c._leaflet_id),c.pm.disable(a)):c.pm.disable()})},enabled(a=[]){return a.length===0&&(this._layers=this.getLayers()),!!this._layers.find(c=>c instanceof L.LayerGroup?a.indexOf(c._leaflet_id)===-1?(a.push(c._leaflet_id),c.pm.enabled(a)):!1:c.pm.enabled())},toggleEdit(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this._options=a,this._layers.forEach(p=>{p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.toggleEdit(a,c)):p.pm.toggleEdit(a)})},_initLayer(a){let c=L.Util.stamp(this._layerGroup);a.pm._parentLayerGroup||(a.pm._parentLayerGroup={}),a.pm._parentLayerGroup[c]=this._layerGroup},_removeLayerFromGroup(a){if(a.pm&&a.pm._layerGroup){let c=L.Util.stamp(this._layerGroup);delete a.pm._layerGroup[c]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(a=>a.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var a;return this._map||((a=this._layers.find(c=>!!c._map))==null?void 0:a._map)||null},getLayers(a=!1,c=!0,p=!0,y=[]){let S=[];return a?this._layerGroup.getLayers().forEach(k=>{S.push(k),k instanceof L.LayerGroup&&y.indexOf(k._leaflet_id)===-1&&(y.push(k._leaflet_id),S=S.concat(k.pm.getLayers(!0,!0,!0,y)))}):S=this._layerGroup.getLayers(),p&&(S=S.filter(k=>!(k instanceof L.LayerGroup))),c&&(S=S.filter(k=>!!k.pm),S=S.filter(k=>!k._pmTempLayer),S=S.filter(k=>!L.PM.optIn&&!k.options.pmIgnore||L.PM.optIn&&k.options.pmIgnore===!1)),S},setOptions(a,c=[]){c.length===0&&(this._layers=this.getLayers()),this.options=a,this._layers.forEach(p=>{p.pm&&(p instanceof L.LayerGroup?c.indexOf(p._leaflet_id)===-1&&(c.push(p._leaflet_id),p.pm.setOptions(a,c)):p.pm.setOptions(a))})}}),Vt.Marker=Vt.extend({_shape:"Marker",initialize(a){this._layer=a,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(a={draggable:!0}){if(L.Util.setOptions(this,a),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(a){let c=a.target;c.remove(),this._fireRemove(c),this._fireRemove(this._map,c)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)}});var Ut=g(Xt()),ft={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let a=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=a.filter((c,p,y)=>y.indexOf(c)===p)},_removeFromCache(a){let c=this.markerCache.indexOf(a);c>-1&&this.markerCache.splice(c,1)},renderLimits(a){this.markerCache.forEach(c=>{a.includes(c)?this._markerGroup.addLayer(c):this._markerGroup.removeLayer(c)})},applyLimitFilters({latlng:a={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let c=[...this._filterClosestMarkers(a)];this.renderLimits(c)},_filterClosestMarkers(a){let c=[...this.markerCache],p=this.options.limitMarkersToCount;return p===-1?c:(c.sort((y,S)=>{let k=y._latlng.distanceTo(a),F=S._latlng.distanceTo(a);return k-F}),c.filter((y,S)=>p>-1?S<p:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(a){this._preventRenderMarkers=!!a}},yt=ft;Vt.Line=Vt.extend({includes:[yt],_shape:"Line",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(a){return this.enabled()?this.disable():this.enable(a),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let a=this._map,c=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(a),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let p=y=>{if(Array.isArray(y[0]))return y.map(p,this);let S=y.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&y.map((k,F)=>{let q=this.isPolygon()?(F+1)%y.length:F+1;return this._createMiddleMarker(S[F],S[q])}),S};this._markers=p(c),this.filterMarkerGroup(),a.addLayer(this._markerGroup)},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._pmTempLayer=!0,this.options.rotate?(c.on("dragstart",this._onRotateStart,this),c.on("drag",this._onRotate,this),c.on("dragend",this._onRotateEnd,this)):(c.on("click",this._onVertexClick,this),c.on("dragstart",this._onMarkerDragStart,this),c.on("move",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||c.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(c),c},_createMiddleMarker(a,c){if(!a||!c)return!1;let p=L.PM.Utils.calcMiddleLatLng(this._map,a.getLatLng(),c.getLatLng()),y=this._createMarker(p),S=L.divIcon({className:"marker-icon marker-icon-middle"});return y.setIcon(S),y.leftM=a,y.rightM=c,a._middleMarkerNext=y,c._middleMarkerPrev=y,y.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),y.on("movestart",this._onMiddleMarkerMoveStart,this),y},_onMiddleMarkerClick(a){let c=a.target;if(!this._vertexValidation("add",a))return;let p=L.divIcon({className:"marker-icon"});c.setIcon(p),this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMoveStart(a){let c=a.target;if(c.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",a)){c.on("move",this._onMiddleMarkerMovePrevent,this);return}c._dragging=!0,this._addMarker(c,c.leftM,c.rightM)},_onMiddleMarkerMovePrevent(a){let c=a.target;this._vertexValidationDrag(c)},_onMiddleMarkerMoveEnd(a){let c=a.target;if(c.off("move",this._onMiddleMarkerMovePrevent,this),c.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(c))return;let p=L.divIcon({className:"marker-icon"});c.setIcon(p),setTimeout(()=>{delete c._dragging},100)},_addMarker(a,c,p){a.off("movestart",this._onMiddleMarkerMoveStart,this),a.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let y=a.getLatLng(),S=this._layer._latlngs;delete a.leftM,delete a.rightM;let{indexPath:k,index:F,parentPath:q}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),ae=k.length>1?(0,Ut.default)(S,q):S,ve=k.length>1?(0,Ut.default)(this._markers,q):this._markers;ae.splice(F+1,0,y),ve.splice(F+1,0,a),this._layer.setLatLngs(S),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(c,a),this._createMiddleMarker(a,p)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(a,L.PM.Utils.findDeepMarkerIndex(this._markers,a).indexPath,y),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return mr(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(a){let c=this._layer,p,y;if(this.options.allowSelfIntersection?p=!1:(y=mr(this._layer.toGeoJSON(15)),p=y.features.length>0),p){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return p;a?this._flashLayer():(c.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(y)}else c.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return p},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(a,c){a.forEach(p=>{Array.isArray(p)?this._updateDisabledMarkerStyle(p,c):p._icon&&(c&&!this._checkMarkerAllowedToDrag(p)?L.DomUtil.addClass(p._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(p._icon,"vertexmarker-disabled"))})},_removeMarker(a){let c=a.target;if(!this._vertexValidation("remove",a))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=uo(this._layer,this._layer.getLatLngs()));let p=this._layer.getLatLngs(),{indexPath:y,index:S,parentPath:k}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!y)return;let F=y.length>1?(0,Ut.default)(p,k):p,q=y.length>1?(0,Ut.default)(this._markers,k):this._markers,ae=k[k.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!ae&&(F.length<=2||this.isPolygon()&&F.length<=3)){this._flashLayer();return}F.splice(S,1),this._layer.setLatLngs(p),this.isPolygon()&&F.length<=2&&F.splice(0,F.length);let ve=!1;if(F.length<=1&&(F.splice(0,F.length),k.length>1&&y.length>1&&(p=Ta(p)),this._layer.setLatLngs(p),this._initMarkers(),ve=!0),Fi(p)||this._layer.remove(),p=Ta(p),this._layer.setLatLngs(p),this._markers=Ta(this._markers),!ve&&(q=y.length>1?(0,Ut.default)(this._markers,k):this._markers,c._middleMarkerPrev&&(this._markerGroup.removeLayer(c._middleMarkerPrev),this._removeFromCache(c._middleMarkerPrev)),c._middleMarkerNext&&(this._markerGroup.removeLayer(c._middleMarkerNext),this._removeFromCache(c._middleMarkerNext)),this._markerGroup.removeLayer(c),this._removeFromCache(c),q)){let Je,$e;if(this.isPolygon()?(Je=(S+1)%q.length,$e=(S+(q.length-1))%q.length):($e=S-1<0?void 0:S-1,Je=S+1>=q.length?void 0:S+1),Je!==$e){let mt=q[$e],Nt=q[Je];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(mt,Nt)}q.splice(S,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(c,y),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(a){let c=this._layer.getLatLngs(),p=a.getLatLng(),{indexPath:y,index:S,parentPath:k}=L.PM.Utils.findDeepMarkerIndex(this._markers,a);(y.length>1?(0,Ut.default)(c,k):c).splice(S,1,p),this._layer.setLatLngs(c)},_getNeighborMarkers(a){let{indexPath:c,index:p,parentPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,a),S=c.length>1?(0,Ut.default)(this._markers,y):this._markers,k=(p+1)%S.length,F=(p+(S.length-1))%S.length,q=S[F],ae=S[k];return{prevMarker:q,nextMarker:ae}},_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:p}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),S=L.polyline([a.getLatLng(),p.getLatLng()]),k=Fs(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,F=Fs(this._layer.toGeoJSON(15),S.toGeoJSON(15)).features.length;return a.getLatLng()===this._markers[0][0].getLatLng()?F+=1:a.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(k+=1),!(k<=2&&F<=2)},_onMarkerDragStart(a){let c=a.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",a))return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,p),this.options.allowSelfIntersection||(this._coordsBeforeEdit=uo(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(c):this._markerAllowedToDrag=null},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c))return;let{indexPath:p,index:y,parentPath:S}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);if(!p)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(c);let k=p.length>1?(0,Ut.default)(this._markers,S):this._markers,F=(y+1)%k.length,q=(y+(k.length-1))%k.length,ae=c.getLatLng(),ve=k[q].getLatLng(),Je=k[F].getLatLng();if(c._middleMarkerNext){let $e=L.PM.Utils.calcMiddleLatLng(this._map,ae,Je);c._middleMarkerNext.setLatLng($e)}if(c._middleMarkerPrev){let $e=L.PM.Utils.calcMiddleLatLng(this._map,ae,ve);c._middleMarkerPrev.setLatLng($e)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(a,p),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c),y=!this.options.allowSelfIntersection&&this.hasSelfIntersection();y&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(y=!1);let S=!this.options.allowSelfIntersection&&y;if(this._fireMarkerDragEnd(a,p,S),S){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(a,p);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(a){let c=a.target;if(c._dragging)return;let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireVertexClick(a,p)}}),Vt.Polygon=Vt.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(a){let{prevMarker:c,nextMarker:p}=this._getNeighborMarkers(a),y=L.polyline([c.getLatLng(),a.getLatLng()]),S=L.polyline([a.getLatLng(),p.getLatLng()]),k=Fs(this._layer.toGeoJSON(15),y.toGeoJSON(15)).features.length,F=Fs(this._layer.toGeoJSON(15),S.toGeoJSON(15)).features.length;return!(k<=2&&F<=2)}}),Vt.Rectangle=Vt.Polygon.extend({_shape:"Rectangle",_initMarkers(){let a=this._map,c=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,a.addLayer(this._markerGroup),this._markers=[],this._markers[0]=c.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((p,y)=>{let S=this._cornerMarkers.find(k=>k._index===y);S&&S.setLatLng(p)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(a,c){let p=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(p,"vertexPane"),p._origLatLng=a,p._index=c,p._pmTempLayer=!0,p.on("click",this._onVertexClick,this),this._markerGroup.addLayer(p),p},_addMarkerEvents(){this._markers[0].forEach(a=>{a.on("dragstart",this._onMarkerDragStart,this),a.on("drag",this._onMarkerDrag,this),a.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||a.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(a){if(!this._vertexValidation("move",a))return;let c=a.target,p=this._cornerMarkers;c._oppositeCornerLatLng=p.find(S=>S._index===(c._index+2)%4).getLatLng(),c._snapped=!1;let{indexPath:y}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragStart(a,y)},_onMarkerDrag(a){let c=a.target;if(!this._vertexValidationDrag(c)||c._index===void 0)return;this._adjustRectangleForMarkerMove(c);let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDrag(a,p),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(a){let c=a.target;if(!this._vertexValidationDragEnd(c))return;this._cornerMarkers.forEach(y=>{delete y._oppositeCornerLatLng});let{indexPath:p}=L.PM.Utils.findDeepMarkerIndex(this._markers,c);this._fireMarkerDragEnd(a,p),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(a){L.extend(a._origLatLng,a._latlng);let c=L.PM.Utils._getRotatedRectangle(a.getLatLng(),a._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(c),this._adjustAllMarkers(a),this._layer.redraw()},_adjustAllMarkers(a){let c=this._layer.getLatLngs()[0];if(c&&c.length!==4&&c.length>0)c.forEach((p,y)=>{this._cornerMarkers[y].setLatLng(p)}),this._cornerMarkers.slice(c.length).forEach(p=>{p.setLatLng(c[0])});else if(!c||!c.length)console.error("The layer has no LatLngs");else{let p=c.findIndex(y=>a.getLatLng().equals(y));p>-1?(this._cornerMarkers[(a._index+1)%4].setLatLng(c[(p+1)%4]),this._cornerMarkers[(a._index+2)%4].setLatLng(c[(p+2)%4]),this._cornerMarkers[(a._index+3)%4].setLatLng(c[(p+3)%4])):this._cornerMarkers.forEach(y=>{y.setLatLng(c[y._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(Mo(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let a=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(a[0],a[2],this.getAngle(),this._map||this)}}),Vt.CircleMarker=Vt.extend({_shape:"CircleMarker",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let a=this._map;this._helperLayers&&(this._helperLayers.removeFrom(a),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(a);let c=this._layer.getLatLng(),p=this._layer._radius,y=this._getLatLngOnCircle(c,p);this._centerMarker=this._createCenterMarker(c),this._outerMarker=this._createOuterMarker(y),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(a,c){let p=this._map.project(a),y=L.point(p.x+c,p.y);return this._map.unproject(y)},_createHintLine(a,c){let p=a.getLatLng(),y=c.getLatLng();this._hintline=L.polyline([p,y],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(a){let c=this._createMarker(a);return this.options.draggable?(L.DomUtil.addClass(c._icon,"leaflet-pm-draggable"),c.on("move",this._moveCircle,this)):c.dragging.disable(),c},_createOuterMarker(a){let c=this._createMarker(a);return c.on("drag",this._resizeCircle,this),c},_createMarker(a){let c=new L.Marker(a,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(c,"vertexPane"),c._origLatLng=a,c._pmTempLayer=!0,c.on("dragstart",this._onMarkerDragStart,this),c.on("drag",this._onMarkerDrag,this),c.on("dragend",this._onMarkerDragEnd,this),c.on("click",this._onVertexClick,this),this._helperLayers.addLayer(c),c},_moveCircle(a){if(a.target._cancelDragEventChain)return;let c=this._centerMarker.getLatLng();this._layer.setLatLng(c);let p=this._layer._radius,y=this._getLatLngOnCircle(c,p);this._outerMarker._latlng=y,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let a=this._layer.getLatLng(),c=this._layer._radius,p=this._getLatLngOnCircle(a,c);this._outerMarker.setLatLng(p),this._centerMarker.setLatLng(a),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(p),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng();this._hintline.setLatLngs([a,c])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(a){this._vertexValidation("move",a)&&this._fireMarkerDragStart(a)},_onMarkerDrag(a){let c=a.target;c instanceof L.Marker&&!this._vertexValidationDrag(c)||this._fireMarkerDrag(a)},_onMarkerDragEnd(a){this._extedingMarkerDragEnd();let c=a.target;this._vertexValidationDragEnd(c)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(a))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let a=this._layer._map||this._map;if(a){let c=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),a,this._layer.getLatLng()),p=L.circle(this._layer.getLatLng(),this._layer.options);p.setRadius(c);let y=a&&a.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(p,200,!y).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(p,200,!y),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);return this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?c=Ya(this._map,a,c,this._getMinDistanceInMeter(a)):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&(c=Ya(this._map,a,c,this._getMaxDistanceInMeter(a))),c},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let a=this._centerMarker.getLatLng(),c=this._outerMarker.getLatLng(),p=this._distanceCalculation(a,c);this.options[this._minRadiusOption]&&p<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&p>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(a,c){return this._map.project(a).distanceTo(this._map.project(c))},_getMinDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,a)},_getMaxDistanceInMeter(a){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,a)},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Vt.Circle=Vt.CircleMarker.extend({_shape:"Circle",initialize(a){this._layer=a,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(a){L.PM.Edit.CircleMarker.prototype.enable.call(this,a||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let a=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(a,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let a=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!a).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!a),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(a,c){return this._map.distance(a,c)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(a){a.target._dragging||this._fireVertexClick(a,void 0)}}),Vt.ImageOverlay=Vt.extend({_shape:"ImageOverlay",initialize(a){this._layer=a,this._enabled=!1},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},enabled(){return this._enabled},enable(a={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,a),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let a=this._layer.getBounds(),c=a.getNorthWest(),p=a.getNorthEast(),y=a.getSouthEast(),S=a.getSouthWest();return[c,p,y,S]}}),Vt.Text=Vt.extend({_shape:"Text",initialize(a){this._layer=a,this._enabled=!1},enable(a){if(L.Util.setOptions(this,a),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let a=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),a.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(a){this.enabled()?this.disable():this.enable(a)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let a=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,a.off("pm:drag",this._handleSnapping,this),a.on("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.on("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this),a.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let a=this._layer;a.off("pm:drag",this._handleSnapping,this),a.off("pm:dragend",this._cleanupSnapping,this),a.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let a=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,c=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${a}px`,this.textArea.style.width=`${c}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(a){a.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(a={}){let c=this._hasFocus;this._hasFocus=a.type==="focus",!c!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(a){a&&(this.textArea.value=a),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let c=this.options.className.split(" ");this.textArea.classList.add(...c)}let a=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(a),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(a=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),a===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(a){a.preventDefault()}});var Jt=function(a,c,p,y,S,k){this._matrix=[a,c,p,y,S,k]};Jt.init=()=>new L.PM.Matrix(1,0,0,1,0,0),Jt.prototype={transform(a){return this._transform(a.clone())},_transform(a){let c=this._matrix,{x:p,y}=a;return a.x=c[0]*p+c[1]*y+c[4],a.y=c[2]*p+c[3]*y+c[5],a},untransform(a){let c=this._matrix;return new L.Point((a.x/c[0]-c[4])/c[0],(a.y/c[2]-c[5])/c[2])},clone(){let a=this._matrix;return new L.PM.Matrix(a[0],a[1],a[2],a[3],a[4],a[5])},translate(a){if(a===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let c,p;return typeof a=="number"?(c=a,p=a):(c=a.x,p=a.y),this._add(1,0,0,1,c,p)},scale(a,c){if(a===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let p,y;return c=c||L.point(0,0),typeof a=="number"?(p=a,y=a):(p=a.x,y=a.y),this._add(p,0,0,y,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},rotate(a,c){let p=Math.cos(a),y=Math.sin(a);return c=c||new L.Point(0,0),this._add(p,y,-y,p,c.x,c.y)._add(1,0,0,1,-c.x,-c.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(a,c,p,y,S,k){let F=[[],[],[]],q=this._matrix,ae=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]],ve=[[a,p,S],[c,y,k],[0,0,1]],Je;a&&a instanceof L.PM.Matrix&&(q=a._matrix,ve=[[q[0],q[2],q[4]],[q[1],q[3],q[5]],[0,0,1]]);for(let $e=0;$e<3;$e+=1)for(let mt=0;mt<3;mt+=1){Je=0;for(let Nt=0;Nt<3;Nt+=1)Je+=ae[$e][Nt]*ve[Nt][mt];F[$e][mt]=Je}return this._matrix=[F[0][0],F[1][0],F[0][1],F[1][1],F[0][2],F[1][2]],this}};var cn=Jt,en={calcMiddleLatLng(a,c,p){let y=a.project(c),S=a.project(p);return a.unproject(y._add(S)._divideBy(2))},findLayers(a){let c=[];return a.eachLayer(p=>{(p instanceof L.Polyline||p instanceof L.Marker||p instanceof L.Circle||p instanceof L.CircleMarker||p instanceof L.ImageOverlay)&&c.push(p)}),c=c.filter(p=>!!p.pm),c=c.filter(p=>!p._pmTempLayer),c=c.filter(p=>!L.PM.optIn&&!p.options.pmIgnore||L.PM.optIn&&p.options.pmIgnore===!1),c},circleToPolygon(a,c=60,p=!0){let y=a.getLatLng(),S=a.getRadius(),k=yi(y,S,c,0,p),F=[];for(let q=0;q<k.length;q+=1){let ae=[k[q].lat,k[q].lng];F.push(ae)}return L.polygon(F,a.options)},disablePopup(a){a.getPopup()&&(a._tempPopupCopy=a.getPopup(),a.unbindPopup())},enablePopup(a){a._tempPopupCopy&&(a.bindPopup(a._tempPopupCopy),delete a._tempPopupCopy)},_fireEvent(a,c,p,y=!1){a.fire(c,p,y);let{groups:S}=this.getAllParentGroups(a);S.forEach(k=>{k.fire(c,p,y)})},getAllParentGroups(a){let c=[],p=[],y=S=>{for(let k in S._eventParents)if(c.indexOf(k)===-1){c.push(k);let F=S._eventParents[k];p.push(F),y(F)}};return!a._pmLastGroupFetch||!a._pmLastGroupFetch.time||new Date().getTime()-a._pmLastGroupFetch.time>1e3?(y(a),a._pmLastGroupFetch={time:new Date().getTime(),groups:p,groupIds:c},{groupIds:c,groups:p}):{groups:a._pmLastGroupFetch.groups,groupIds:a._pmLastGroupFetch.groupIds}},createGeodesicPolygon:yi,getTranslation:Wn,findDeepCoordIndex(a,c,p=!0){let y,S=F=>(q,ae)=>{let ve=F.concat(ae);if(p){if(q.lat&&q.lat===c.lat&&q.lng===c.lng)return y=ve,!0}else if(q.lat&&L.latLng(q).equals(c))return y=ve,!0;return Array.isArray(q)&&q.some(S(ve))};a.some(S([]));let k={};return y&&(k={indexPath:y,index:y[y.length-1],parentPath:y.slice(0,y.length-1)}),k},findDeepMarkerIndex(a,c){let p,y=k=>(F,q)=>{let ae=k.concat(q);return F._leaflet_id===c._leaflet_id?(p=ae,!0):Array.isArray(F)&&F.some(y(ae))};a.some(y([]));let S={};return p&&(S={indexPath:p,index:p[p.length-1],parentPath:p.slice(0,p.length-1)}),S},_getIndexFromSegment(a,c){if(c&&c.length===2){let p=this.findDeepCoordIndex(a,c[0]),y=this.findDeepCoordIndex(a,c[1]),S=Math.max(p.index,y.index);return(p.index===0||y.index===0)&&S!==1&&(S+=1),{indexA:p,indexB:y,newIndex:S,indexPath:p.indexPath,parentPath:p.parentPath}}return null},_getRotatedRectangle(a,c,p,y){let S=Ge(y,a),k=Ge(y,c),F=p*Math.PI/180,q=Math.cos(F),ae=Math.sin(F),ve=(k.x-S.x)*q+(k.y-S.y)*ae,Je=(k.y-S.y)*q-(k.x-S.x)*ae,$e=ve*q+S.x,mt=ve*ae+S.y,Nt=-Je*ae+S.x,Wt=Je*q+S.y,gn=ht(y,S),vn=ht(y,{x:$e,y:mt}),Jn=ht(y,k),Ke=ht(y,{x:Nt,y:Wt});return[gn,vn,Jn,Ke]},pxRadiusToMeterRadius(a,c,p){let y=c.project(p),S=L.point(y.x+a,y.y);return c.distance(c.unproject(S),p)}},xn=en;L.PM=L.PM||{version:ps.version,Map:as,Toolbar:Ba,Draw:zi,Edit:Vt,Utils:xn,Matrix:cn,activeLang:"en",optIn:!1,initialize(a){this.addInitHooks(a)},setOptIn(a){this.optIn=!!a},addInitHooks(){function a(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(a);function c(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(c);function p(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(p);function y(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(y);function S(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(S);function k(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(k);function F(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(F);function q(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(q);function ae(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(ae)},reInitLayer(a){a instanceof L.LayerGroup&&a.eachLayer(c=>{this.reInitLayer(c)}),a.pm||L.PM.optIn&&a.options.pmIgnore!==!1||a.options.pmIgnore||(a instanceof L.Map?a.pm=new L.PM.Map(a):a instanceof L.Marker?a.options.textMarker?(a.pm=new L.PM.Edit.Text(a),a.pm._initTextMarker(),a.pm._createTextMarker(!1)):a.pm=new L.PM.Edit.Marker(a):a instanceof L.Circle?a.pm=new L.PM.Edit.Circle(a):a instanceof L.CircleMarker?a.pm=new L.PM.Edit.CircleMarker(a):a instanceof L.Rectangle?a.pm=new L.PM.Edit.Rectangle(a):a instanceof L.Polygon?a.pm=new L.PM.Edit.Polygon(a):a instanceof L.Polyline?a.pm=new L.PM.Edit.Line(a):a instanceof L.LayerGroup?a.pm=new L.PM.Edit.LayerGroup(a):a instanceof L.ImageOverlay&&(a.pm=new L.PM.Edit.ImageOverlay(a)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(a){let c=this._map.mouseEventToLayerPoint(a),p,y;for(let S=this._drawFirst;S;S=S.next)p=S.layer,p.options.interactive&&p._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(p))&&(y=p);y&&(L.DomEvent.fakeStop(a),this._fireEvent([y],a))}}),L.PM.initialize()})();class yu extends fn.Rectangle{constructor(t,r="Double-cliquez pour éditer",i={}){var g,v,_,x,E,b,R,$;const o=t instanceof fn.LatLngBounds?t:fn.latLngBounds(t);if(!o.isValid()){console.warn("[TextRectangle] Limites invalides, utilisation de limites par défaut");const Q=fn.latLng(0,0);o.extend(fn.latLng(Q.lat+.001,Q.lng+.001)),o.extend(fn.latLng(Q.lat-.001,Q.lng-.001))}const l={...i.textStyle,color:i.textColor||((g=i.textStyle)==null?void 0:g.color)||"#000000",fontFamily:i.fontFamily||((v=i.textStyle)==null?void 0:v.fontFamily)||"Arial, sans-serif",textAlign:i.textAlign||((_=i.textStyle)==null?void 0:_.textAlign)||"center",backgroundColor:i.backgroundColor||((x=i.textStyle)==null?void 0:x.backgroundColor)||"#FFFFFF",backgroundOpacity:i.backgroundOpacity??((E=i.textStyle)==null?void 0:E.backgroundOpacity)??1,bold:i.bold||((b=i.textStyle)==null?void 0:b.bold)||!1,italic:i.italic||((R=i.textStyle)==null?void 0:R.italic)||!1,fontSize:(($=i.textStyle)==null?void 0:$.fontSize)||"14px"},h={pmIgnore:!1,interactive:!0,fill:!0,stroke:!0,className:"leaflet-text-rectangle",...i,textStyle:l};super(o,h);Pt(this,"properties",{type:"TextRectangle",text:"",width:0,height:0,area:0,rotation:0,style:{textStyle:{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1}}});Pt(this,"_textNode",null);Pt(this,"_isEditing",!1);Pt(this,"_editableDiv",null);Pt(this,"_text");Pt(this,"_rotation",0);Pt(this,"_textStyle",{color:"#000000",fontSize:"14px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#FFFFFF",backgroundOpacity:1,bold:!1,italic:!1});Pt(this,"_initialBounds",null);Pt(this,"_isResizing",!1);Pt(this,"_resizePreview",null);Pt(this,"_minWidth",50);Pt(this,"_minHeight",30);Pt(this,"_maxWidth",2e3);Pt(this,"_maxHeight",1e3);Pt(this,"_onKeyDown",t=>{St.measure("TextRectangle._onKeyDown",()=>{t.key==="Enter"&&t.ctrlKey?(t.preventDefault(),this._finishEditing()):t.key==="Escape"&&(t.preventDefault(),this._cancelEditing())})});Pt(this,"_finishEditing",()=>{St.measure("TextRectangle._finishEditing",()=>{if(this._editableDiv)try{const t=this._editableDiv.innerText.trim()||"Double-cliquez pour éditer";this._cleanupEditableDiv(),this.setText(t),this._textRedraw(),this.fire("edit:end"),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()}catch(t){console.error("[TextRectangle] Erreur lors de la finalisation de l'édition :",t),this._cleanupEditableDiv()}})});Pt(this,"_cancelEditing",()=>{this._textRedraw(),this._cleanupEditableDiv(),this.map&&!this.map.dragging.enabled()&&this.map.dragging.enable()});Pt(this,"_updateTextPosition",()=>{St.measure("TextRectangle._updateTextPosition",()=>{this.updateProperties(),this._textRedraw()})});Pt(this,"_onZoomEnd",()=>{St.measure("TextRectangle._onZoomEnd",()=>{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display=""),this._textRedraw()})});Pt(this,"_onAdd",()=>{St.measure("TextRectangle._onAdd",()=>{this._textRedraw(),this.map&&(this.map.on("zoomend",this._onZoomEnd.bind(this)),this.map.on("zoomanim",this._animateZoom.bind(this)))})});Pt(this,"_onRemove",()=>{St.measure("TextRectangle._onRemove",()=>{this._removeTextNode(),this.map&&(this.map.off("zoomend",this._onZoomEnd),this.map.off("zoomanim",this._animateZoom))})});this._text=r,this._textStyle={...l},this.properties={type:"TextRectangle",text:this._text,width:0,height:0,area:0,rotation:this._rotation,style:{...h,textStyle:{...this._textStyle},name:i.name||""}},this.on({add:this._onAdd,remove:this._onRemove,dblclick:this._onDoubleClick,dragend:this._updateTextPosition,"pm:edit":this._updateTextPosition,"pm:dragend":this._updateTextPosition,"pm:markerdragend":this._updateTextPosition,"pm:vertexadded":this._updateTextPosition,"pm:vertexremoved":this._updateTextPosition}),this.pm&&this.pm.enableLayerDrag()}get map(){return this._map}set map(t){this._map=t}setText(t,r){St.measure("TextRectangle.setText",()=>{const i=this.properties.text;this._text=t,r&&(this._textStyle={...this._textStyle,...r}),this.properties.text=t||"Double-cliquez pour éditer",console.log("[TextRectangle] Mise à jour du texte",{oldText:i,newText:this.properties.text,hasTextNode:!!this._textNode}),this._textRedraw(),this.fire("text:updated",{text:this.properties.text,oldText:i,bounds:this.getBounds(),style:this.properties.style}),this.fire("properties:updated",{shape:this,properties:this.properties,source:"setText"})})}setTextStyle(t){St.measure("TextRectangle.setTextStyle",()=>{var r,i;console.log("[TextRectangle] Setting text style",{currentStyle:{...this._textStyle},newStyle:t,currentProps:(i=(r=this.properties)==null?void 0:r.style)==null?void 0:i.textStyle}),this._textStyle={...this._textStyle,...t},this.properties.style.textStyle?this.properties.style.textStyle={...this.properties.style.textStyle,...t}:this.properties.style.textStyle={...this._textStyle},t.fontSize&&(this._textStyle.fontSize=t.fontSize,this.properties.style.textStyle.fontSize=t.fontSize),console.log("[TextRectangle] After style update",{textStyle:{...this._textStyle},propsTextStyle:{...this.properties.style.textStyle}}),this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}setRotation(t){St.measure("TextRectangle.setRotation",()=>{this.properties.rotation=t%360,this._textRedraw(),this.fire("properties:updated",{shape:this,properties:this.properties})})}getTextElement(){return this._textNode}updateProperties(){St.measure("TextRectangle.updateProperties",()=>{var l,h;const t=this.getBounds(),r=t.getCenter(),i=this.getDimensions().width,o=this.getDimensions().height;this.properties={type:"TextRectangle",text:this._text,width:i,height:o,area:i*o,rotation:this._rotation,center:{lat:r.lat,lng:r.lng},bounds:{northEast:{lat:t.getNorthEast().lat,lng:t.getNorthEast().lng},southWest:{lat:t.getSouthWest().lat,lng:t.getSouthWest().lng}},style:{...this.options,textStyle:{...this._textStyle},name:((h=(l=this.properties)==null?void 0:l.style)==null?void 0:h.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}setBounds(t){return St.measure("TextRectangle.setBounds",()=>{const r=t instanceof fn.LatLngBounds?t:fn.latLngBounds(t);return fn.Rectangle.prototype.setBounds.call(this,r),this._textRedraw(),this.updateProperties(),this})}startResize(){St.measure("TextRectangle.startResize",()=>{if(!this._isResizing&&(this._isResizing=!0,this._initialBounds=this.getBounds(),this.map&&!this._resizePreview))try{if(this._resizePreview=fn.rectangle(this._initialBounds,{color:this.options.color||"#3388ff",weight:this.options.weight||2,opacity:.8,fillColor:this.options.fillColor||"#3388ff",fillOpacity:.2,dashArray:this.options.dashArray||"5,5",className:"resize-preview"}).addTo(this.map),this._rotation!==0){const t=this._resizePreview._path;t&&(t.style.transformOrigin="center",t.style.transform=`rotate(${this._rotation}deg)`)}this._textNode&&(this._textNode.style.opacity="0.5")}catch(t){console.error("[TextRectangle] Erreur lors de la création du rectangle fantôme:",t),this._cleanupResizePreview()}})}updateResizePreview(t){St.measure("TextRectangle.updateResizePreview",()=>{if(!(!this._isResizing||!this._resizePreview||!this.map))try{const r=this.map.latLngToContainerPoint(t.getNorthWest()),i=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(i.x-r.x),l=Math.abs(i.y-r.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight)return;if(this._resizePreview.setBounds(t),this._rotation!==0){const h=this._resizePreview._path;h&&(h.style.transformOrigin="center",h.style.transform=`rotate(${this._rotation}deg)`)}if(this._textNode){const h=Math.min(o,l)*.1,g=Math.max(10,Math.min(48,h)),v=g*1.2,x=this.properties.text.split(`
`).length*v,E=r.y+(l-x)/2,b=this._calculateTextX(r.x,i.x,5);if(this._textNode.setAttribute("x",b.toString()),this._textNode.setAttribute("y",E.toString()),this._textNode.querySelectorAll("tspan").forEach((R,$)=>{R.setAttribute("x",b.toString()),R.setAttribute("dy",$===0?"0":`${v}px`),R.style.fontSize=`${g}px`}),this._rotation!==0){const R=this.map.latLngToLayerPoint(t.getCenter());this._textNode.setAttribute("transform",`rotate(${this._rotation}, ${R.x}, ${R.y})`)}}this.fire("resize:update",{bounds:t})}catch(r){console.error("[TextRectangle] Erreur lors de la mise à jour du rectangle fantôme:",r),this._cleanupResizePreview()}})}endResize(t){St.measure("TextRectangle.endResize",()=>{if(this._isResizing)try{if(this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.map){const r=this.map.latLngToContainerPoint(t.getNorthWest()),i=this.map.latLngToContainerPoint(t.getSouthEast()),o=Math.abs(i.x-r.x),l=Math.abs(i.y-r.y);if(o<this._minWidth||l<this._minHeight||o>this._maxWidth||l>this._maxHeight){this.cancelResize();return}}this.setBounds(t),this._textRedraw(),this.fire("resize:end",{bounds:t})}catch(r){console.error("[TextRectangle] Erreur lors de la fin du redimensionnement:",r),this.cancelResize()}finally{this._isResizing=!1}})}cancelResize(){St.measure("TextRectangle.cancelResize",()=>{if(!(!this._isResizing||!this._initialBounds))try{this._cleanupResizePreview(),this._textNode&&(this._textNode.style.opacity="1"),this.setBounds(this._initialBounds)}catch(t){console.error("[TextRectangle] Erreur lors de l'annulation du redimensionnement:",t)}finally{this._isResizing=!1,this._initialBounds=null}})}_cleanupResizePreview(){St.measure("TextRectangle._cleanupResizePreview",()=>{if(this._resizePreview&&this.map)try{this.map.removeLayer(this._resizePreview)}catch(t){console.error("[TextRectangle] Erreur lors du nettoyage du rectangle fantôme:",t)}finally{this._resizePreview=null}})}_onDoubleClick(t){St.measure("TextRectangle._onDoubleClick",()=>{this._isEditing||this._isResizing||(fn.DomEvent.stopPropagation(t),this.fire("edit:start"),this._isEditing=!0,this._removeTextNode(),this._createEditableDiv())})}_createEditableDiv(){St.measure("TextRectangle._createEditableDiv",()=>{var t;if(this.map)try{const r=this.getBounds(),i=this.map.latLngToContainerPoint(r.getNorthWest()),o=this.map.latLngToContainerPoint(r.getSouthEast()),l=o.x-i.x,h=o.y-i.y,g=document.createElement("div");g.className="leaflet-text-rectangle-editor",g.contentEditable="true",g.innerText=this.properties.text;let v=Math.min(l,h)*.1;const _=((t=this.properties.style.textStyle)==null?void 0:t.fontSize)||"",x=parseInt(_),E=isNaN(x)?v:x,b=Math.max(10,Math.min(48,E));if(Object.assign(g.style,{position:"absolute",left:`${i.x}px`,top:`${i.y}px`,width:`${l}px`,height:`${h}px`,backgroundColor:this.properties.style.fillColor||"#FFFFFF",opacity:`${this.properties.style.fillOpacity??1}`,color:this.properties.style.textColor||"#000000",fontSize:`${b}px`,fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",textAlign:this.properties.style.textAlign||"center",border:`${this.properties.style.weight||2}px solid ${this.properties.style.color||"#3388ff"}`,borderRadius:"2px",padding:"4px",boxSizing:"border-box",zIndex:"1000",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",cursor:"text",userSelect:"text",outline:"none",display:"flex",alignItems:"center",justifyContent:this._getJustifyContent()}),this.properties.rotation!==0){const I=this.map.latLngToContainerPoint(r.getCenter());g.style.transformOrigin=`${I.x-i.x}px ${I.y-i.y}px`,g.style.transform=`rotate(${this.properties.rotation}deg)`}this.map.getContainer().appendChild(g),this._editableDiv=g,g.focus();const $=window.getSelection(),Q=document.createRange();Q.selectNodeContents(g),$==null||$.removeAllRanges(),$==null||$.addRange(Q),g.addEventListener("keydown",this._onKeyDown.bind(this)),g.addEventListener("blur",this._finishEditing.bind(this)),g.addEventListener("paste",I=>{var ge;I.preventDefault();const W=((ge=I.clipboardData)==null?void 0:ge.getData("text/plain"))||"";document.execCommand("insertText",!1,W)}),this.map.dragging.enabled()&&this.map.dragging.disable(),console.log("[TextRectangle] Div éditable créé",{position:{left:i.x,top:i.y},size:{width:l,height:h},fontSize:b,styles:this.properties.style})}catch(r){console.error("[TextRectangle] Erreur lors de la création de l'éditeur :",r),this._isEditing=!1}})}_getJustifyContent(){return St.measure("TextRectangle._getJustifyContent",()=>{switch(this.properties.style.textAlign||"center"){case"left":return"flex-start";case"right":return"flex-end";case"center":default:return"center"}})}_cleanupEditableDiv(){St.measure("TextRectangle._cleanupEditableDiv",()=>{this._editableDiv&&(this._editableDiv.removeEventListener("keydown",this._onKeyDown),this._editableDiv.removeEventListener("blur",this._finishEditing),this._editableDiv.parentNode&&this._editableDiv.parentNode.removeChild(this._editableDiv),this._editableDiv=null,this._isEditing=!1)})}_textRedraw(){St.measure("TextRectangle._textRedraw",()=>{var r;if(!fn.Browser.svg||!this.map||this._isEditing||!this._path){console.log("[TextRectangle] _textRedraw ignoré",{reason:fn.Browser.svg?this.map?this._isEditing?"En cours d'édition":"Chemin SVG non trouvé":"Carte non disponible":"SVG non supporté"});return}this._removeTextNode();const t=this.properties.text;if(t)try{const i=this._path;if(!i){console.warn("[TextRectangle] Chemin SVG non trouvé");return}const o=i.ownerSVGElement;if(!o){console.warn("[TextRectangle] Élément SVG parent non trouvé");return}if(!this.map||!this.map.getContainer()||!this._map){console.warn("[TextRectangle] Carte non valide pour le rendu");return}const l=fn.SVG.create("text");l.setAttribute("class","leaflet-text-rectangle-text"),l.style.zIndex="1000",Object.assign(l.style,{fill:this.properties.style.textColor||"#000000",fontFamily:this.properties.style.fontFamily||"Arial, sans-serif",fontWeight:this.properties.style.bold?"bold":"normal",fontStyle:this.properties.style.italic?"italic":"normal",stroke:"white",strokeWidth:"0.5px",paintOrder:"stroke fill",pointerEvents:"none",userSelect:"none"});try{const h=this.getBounds();if(!h.isValid()){console.warn("[TextRectangle] Limites non valides pour le rendu");return}let g,v;try{g=this.map.latLngToLayerPoint(h.getNorthWest()),v=this.map.latLngToLayerPoint(h.getSouthEast())}catch(Ve){console.warn("[TextRectangle] Erreur de conversion de coordonnées:",Ve);return}const _=v.x-g.x,x=v.y-g.y;if(_<=0||x<=0||isNaN(_)||isNaN(x)){console.warn("[TextRectangle] Dimensions non valides:",{rectWidth:_,rectHeight:x});return}let E=Math.min(_,x)*.1;const b=((r=this.properties.style.textStyle)==null?void 0:r.fontSize)||"",R=parseInt(b),$=isNaN(R)?E:R,Q=Math.max(12,Math.min(48,$)),I=t.split(`
`),W=Q*1.2,ge=I.length*W,Se=g.y+(x-ge)/2,De=this._getTextAnchor(),Ye=this._calculateTextX(g.x,v.x,5);if(l.setAttribute("text-anchor",De),l.setAttribute("dominant-baseline","hanging"),l.setAttribute("vector-effect","non-scaling-stroke"),I.forEach((Ve,O)=>{const K=fn.SVG.create("tspan");K.textContent=Ve,K.setAttribute("x",Ye.toString()),K.setAttribute("dy",O===0?"0":`${W}px`),K.style.fontSize=`${Q}px`,K.style.textShadow="1px 1px 2px rgba(255,255,255,0.8)",l.appendChild(K)}),l.setAttribute("y",Se.toString()),this.properties.rotation!==0)try{const Ve=this.map.latLngToLayerPoint(h.getCenter());l.setAttribute("transform",`rotate(${this.properties.rotation}, ${Ve.x}, ${Ve.y})`)}catch(Ve){console.warn("[TextRectangle] Erreur lors de la rotation:",Ve)}this._textNode=l,o.appendChild(l),l.parentNode&&l.parentNode.appendChild(l),this.fire("text:redrawn",{text:t,fontSize:Q,position:{x:Ye,y:Se},dimensions:{width:_,height:x}})}catch(h){console.error("[TextRectangle] Erreur lors des calculs de coordonnées:",h),this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)}}catch(i){console.error("[TextRectangle] Erreur lors du rendu du texte:",i)}})}_calculateTextX(t,r,i){return St.measure("TextRectangle._calculateTextX",()=>{const o=r-t;switch(this.properties.style.textAlign){case"left":return t+i;case"right":return r-i;case"center":default:return t+o/2}})}_getTextAnchor(){return St.measure("TextRectangle._getTextAnchor",()=>{switch(this.properties.style.textAlign){case"left":return"start";case"right":return"end";case"center":default:return"middle"}})}_removeTextNode(){St.measure("TextRectangle._removeTextNode",()=>{this._textNode&&this._textNode.parentNode&&(this._textNode.parentNode.removeChild(this._textNode),this._textNode=null)})}getDimensions(){return St.measure("TextRectangle.getDimensions",()=>{const t=this.getBounds();if(!this.map)return{width:0,height:0};const r=t.getSouthWest(),i=fn.latLng(t.getSouth(),t.getEast()),o=this.map.distance(r,i),l=this.map.distance(r,fn.latLng(t.getNorth(),t.getWest()));return{width:o,height:l}})}getMidPoints(){return St.measure("TextRectangle.getMidPoints",()=>{const t=this.getBounds(),r=t.getNorthWest(),i=t.getNorthEast(),o=t.getSouthEast(),l=t.getSouthWest();return[fn.latLng((r.lat+i.lat)/2,(r.lng+i.lng)/2),fn.latLng((i.lat+o.lat)/2,(i.lng+o.lng)/2),fn.latLng((l.lat+o.lat)/2,(l.lng+o.lng)/2),fn.latLng((r.lat+l.lat)/2,(r.lng+l.lng)/2)]})}setName(t){St.measure("TextRectangle.setName",()=>{this.properties.style||(this.properties.style={textStyle:this._textStyle,name:t}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties,source:"setName"})})}getName(){return St.measure("TextRectangle.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}_animateZoom(t){if(this.map)try{const r=this._path;if(r&&(r.style.display="none"),this._textNode&&(this._textNode.style.display="none"),r){const i=r.style.transform;r.style.transform="",setTimeout(()=>{r&&(r.style.transform=i,r.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())},300)}}catch(r){console.warn("[TextRectangle] Erreur pendant l'animation du zoom:",r),setTimeout(()=>{try{this._path&&(this._path.style.display=""),this._textNode&&(this._textNode.style.display="",this._textRedraw())}catch(i){console.error("[TextRectangle] Erreur lors de la restauration après animation:",i)}},300)}}}var ba=63710088e-1,hb={centimeters:ba*100,centimetres:ba*100,degrees:360/(2*Math.PI),feet:ba*3.28084,inches:ba*39.37,kilometers:ba/1e3,kilometres:ba/1e3,meters:ba,metres:ba,miles:ba/1609.344,millimeters:ba*1e3,millimetres:ba*1e3,nauticalmiles:ba/1852,radians:1,yards:ba*1.0936};function Wh(e,n,t={}){const r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=n||{},r.geometry=e,r}function cp(e,n,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fy(e[0])||!fy(e[1]))throw new Error("coordinates must contain numbers");return Wh({type:"Point",coordinates:e},n,t)}function Pl(e,n,t={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return Wh({type:"Polygon",coordinates:e},n,t)}function El(e,n,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return Wh({type:"LineString",coordinates:e},n,t)}function bk(e,n={}){const t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=e,t}function wk(e,n,t={}){return Wh({type:"MultiPolygon",coordinates:e},n,t)}function xk(e,n="kilometers"){const t=hb[n];if(!t)throw new Error(n+" units is invalid");return e*t}function Lk(e,n="kilometers"){const t=hb[n];if(!t)throw new Error(n+" units is invalid");return e/t}function kg(e){return e%(2*Math.PI)*180/Math.PI}function Kl(e){return e%360*Math.PI/180}function fy(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function dy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Sk(e){return e.type==="Feature"?e.geometry:e}function fb(e,n,t={}){if(t.final===!0)return Ck(e,n);const r=dy(e),i=dy(n),o=Kl(r[0]),l=Kl(i[0]),h=Kl(r[1]),g=Kl(i[1]),v=Math.sin(l-o)*Math.cos(g),_=Math.cos(h)*Math.sin(g)-Math.sin(h)*Math.cos(g)*Math.cos(l-o);return kg(Math.atan2(v,_))}function Ck(e,n){let t=fb(n,e);return t=(t+180)%360,t}function Pk(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function wm(e,n,t,r={}){const i=Pk(e),o=Kl(i[0]),l=Kl(i[1]),h=Kl(t),g=Lk(n,r.units),v=Math.asin(Math.sin(l)*Math.cos(g)+Math.cos(l)*Math.sin(g)*Math.cos(h)),_=o+Math.atan2(Math.sin(h)*Math.sin(g)*Math.cos(l),Math.cos(g)-Math.sin(l)*Math.sin(v)),x=kg(_),E=kg(v);return cp([x,E],r.properties)}var py=wm;function gy(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function xm(e,n,t={}){var r=gy(e),i=gy(n),o=Kl(i[1]-r[1]),l=Kl(i[0]-r[0]),h=Kl(r[1]),g=Kl(i[1]),v=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(h)*Math.cos(g);return xk(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),t.units)}var U0=xm;function Ek(e,n,t={}){const i=Sk(e).coordinates;let o=0;for(let l=0;l<i.length&&!(n>=o&&l===i.length-1);l++)if(o>=n){const h=n-o;if(h){const g=fb(i[l],i[l-1])-180;return wm(i[l],h,g,t)}else return cp(i[l])}else o+=xm(i[l],i[l+1],t);return cp(i[i.length-1])}var Tg=Ek;function Ak(e,n){var t,r,i,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",R=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:R?e.geometry:e,v=b?e.features[t].properties:R?e.properties:{},_=b?e.features[t].bbox:R?e.bbox:void 0,x=b?e.features[t].id:R?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,i=0;i<l;i++){if(o=g?h.geometries[i]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(n(o.geometries[r],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function Mk(e,n,t){var r=t;return Ak(e,function(i,o,l,h,g){o===0&&t===void 0?r=i:r=n(r,i,o,l,h,g)}),r}function db(e){return Mk(e,(n,t)=>n+kk(t),0)}function kk(e){let n=0,t;switch(e.type){case"Polygon":return my(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=my(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function my(e){let n=0;if(e&&e.length>0){n+=Math.abs(vy(e[0]));for(let t=1;t<e.length;t++)n-=Math.abs(vy(e[t]))}return n}var Tk=ba*ba/2,$0=Math.PI/180;function vy(e){const n=e.length-1;if(n<=2)return 0;let t=0,r=0;for(;r<n;){const i=e[r],o=e[r+1===n?0:r+1],l=e[r+2>=n?(r+2)%n:r+2],h=i[0]*$0,g=o[1]*$0,v=l[0]*$0;t+=(v-h)*Math.sin(g),r++}return t*Tk}var pu=db;function pb(e,n,t){if(e!==null)for(var r,i,o,l,h,g,v,_=0,x=0,E,b=e.type,R=b==="FeatureCollection",$=b==="Feature",Q=R?e.features.length:1,I=0;I<Q;I++){v=R?e.features[I].geometry:$?e.geometry:e,E=v?v.type==="GeometryCollection":!1,h=E?v.geometries.length:1;for(var W=0;W<h;W++){var ge=0,Se=0;if(l=E?v.geometries[W]:v,l!==null){g=l.coordinates;var De=l.type;switch(_=De==="Polygon"||De==="MultiPolygon"?1:0,De){case null:break;case"Point":if(n(g,x,I,ge,Se)===!1)return!1;x++,ge++;break;case"LineString":case"MultiPoint":for(r=0;r<g.length;r++){if(n(g[r],x,I,ge,Se)===!1)return!1;x++,De==="MultiPoint"&&ge++}De==="LineString"&&ge++;break;case"Polygon":case"MultiLineString":for(r=0;r<g.length;r++){for(i=0;i<g[r].length-_;i++){if(n(g[r][i],x,I,ge,Se)===!1)return!1;x++}De==="MultiLineString"&&ge++,De==="Polygon"&&Se++}De==="Polygon"&&ge++;break;case"MultiPolygon":for(r=0;r<g.length;r++){for(Se=0,i=0;i<g[r].length;i++){for(o=0;o<g[r][i].length-_;o++){if(n(g[r][i][o],x,I,ge,Se)===!1)return!1;x++}Se++}ge++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(pb(l.geometries[r],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Bk(e,n={}){let t=0,r=0,i=0;return pb(e,function(o){t+=o[0],r+=o[1],i++}),cp([t/i,r/i],n.properties)}var Df=Bk;function Nk(e,n,t={}){const r=t.steps||64,i=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},o=[];for(let l=0;l<r;l++)o.push(wm(e,n,l*-360/r,t).geometry.coordinates);return o.push(o[0]),Pl([o],i)}var Rk=Nk,Dk=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,q0=Math.ceil,Sl=Math.floor,Ua="[BigNumber Error] ",yy=Ua+"Number primitive has more than 15 significant digits: ",Gl=1e14,Ar=14,_y=9007199254740991,V0=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],uc=1e7,ol=1e9;function gb(e){var n,t,r,i=W.prototype={constructor:W,toString:null,valueOf:null},o=new W(1),l=20,h=4,g=-7,v=21,_=-1e7,x=1e7,E=!1,b=1,R=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Q="0123456789abcdefghijklmnopqrstuvwxyz",I=!0;function W(O,K){var ce,H,D,V,z,U,G,ue,ie=this;if(!(ie instanceof W))return new W(O,K);if(K==null){if(O&&O._isBigNumber===!0){ie.s=O.s,!O.c||O.e>x?ie.c=ie.e=null:O.e<_?ie.c=[ie.e=0]:(ie.e=O.e,ie.c=O.c.slice());return}if((U=typeof O=="number")&&O*0==0){if(ie.s=1/O<0?(O=-O,-1):1,O===~~O){for(V=0,z=O;z>=10;z/=10,V++);V>x?ie.c=ie.e=null:(ie.e=V,ie.c=[O]);return}ue=String(O)}else{if(!Dk.test(ue=String(O)))return r(ie,ue,U);ie.s=ue.charCodeAt(0)==45?(ue=ue.slice(1),-1):1}(V=ue.indexOf("."))>-1&&(ue=ue.replace(".","")),(z=ue.search(/e/i))>0?(V<0&&(V=z),V+=+ue.slice(z+1),ue=ue.substring(0,z)):V<0&&(V=ue.length)}else{if(Cs(K,2,Q.length,"Base"),K==10&&I)return ie=new W(O),Ye(ie,l+ie.e+1,h);if(ue=String(O),U=typeof O=="number"){if(O*0!=0)return r(ie,ue,U,K);if(ie.s=1/O<0?(ue=ue.slice(1),-1):1,W.DEBUG&&ue.replace(/^0\.0*|\./,"").length>15)throw Error(yy+O)}else ie.s=ue.charCodeAt(0)===45?(ue=ue.slice(1),-1):1;for(ce=Q.slice(0,K),V=z=0,G=ue.length;z<G;z++)if(ce.indexOf(H=ue.charAt(z))<0){if(H=="."){if(z>V){V=G;continue}}else if(!D&&(ue==ue.toUpperCase()&&(ue=ue.toLowerCase())||ue==ue.toLowerCase()&&(ue=ue.toUpperCase()))){D=!0,z=-1,V=0;continue}return r(ie,String(O),U,K)}U=!1,ue=t(ue,K,10,ie.s),(V=ue.indexOf("."))>-1?ue=ue.replace(".",""):V=ue.length}for(z=0;ue.charCodeAt(z)===48;z++);for(G=ue.length;ue.charCodeAt(--G)===48;);if(ue=ue.slice(z,++G)){if(G-=z,U&&W.DEBUG&&G>15&&(O>_y||O!==Sl(O)))throw Error(yy+ie.s*O);if((V=V-z-1)>x)ie.c=ie.e=null;else if(V<_)ie.c=[ie.e=0];else{if(ie.e=V,ie.c=[],z=(V+1)%Ar,V<0&&(z+=Ar),z<G){for(z&&ie.c.push(+ue.slice(0,z)),G-=Ar;z<G;)ie.c.push(+ue.slice(z,z+=Ar));z=Ar-(ue=ue.slice(z)).length}else z-=G;for(;z--;ue+="0");ie.c.push(+ue)}}else ie.c=[ie.e=0]}W.clone=gb,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(O){var K,ce;if(O!=null)if(typeof O=="object"){if(O.hasOwnProperty(K="DECIMAL_PLACES")&&(ce=O[K],Cs(ce,0,ol,K),l=ce),O.hasOwnProperty(K="ROUNDING_MODE")&&(ce=O[K],Cs(ce,0,8,K),h=ce),O.hasOwnProperty(K="EXPONENTIAL_AT")&&(ce=O[K],ce&&ce.pop?(Cs(ce[0],-1e9,0,K),Cs(ce[1],0,ol,K),g=ce[0],v=ce[1]):(Cs(ce,-1e9,ol,K),g=-(v=ce<0?-ce:ce))),O.hasOwnProperty(K="RANGE"))if(ce=O[K],ce&&ce.pop)Cs(ce[0],-1e9,-1,K),Cs(ce[1],1,ol,K),_=ce[0],x=ce[1];else if(Cs(ce,-1e9,ol,K),ce)_=-(x=ce<0?-ce:ce);else throw Error(Ua+K+" cannot be zero: "+ce);if(O.hasOwnProperty(K="CRYPTO"))if(ce=O[K],ce===!!ce)if(ce)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))E=ce;else throw E=!ce,Error(Ua+"crypto unavailable");else E=ce;else throw Error(Ua+K+" not true or false: "+ce);if(O.hasOwnProperty(K="MODULO_MODE")&&(ce=O[K],Cs(ce,0,9,K),b=ce),O.hasOwnProperty(K="POW_PRECISION")&&(ce=O[K],Cs(ce,0,ol,K),R=ce),O.hasOwnProperty(K="FORMAT"))if(ce=O[K],typeof ce=="object")$=ce;else throw Error(Ua+K+" not an object: "+ce);if(O.hasOwnProperty(K="ALPHABET"))if(ce=O[K],typeof ce=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(ce))I=ce.slice(0,10)=="0123456789",Q=ce;else throw Error(Ua+K+" invalid: "+ce)}else throw Error(Ua+"Object expected: "+O);return{DECIMAL_PLACES:l,ROUNDING_MODE:h,EXPONENTIAL_AT:[g,v],RANGE:[_,x],CRYPTO:E,MODULO_MODE:b,POW_PRECISION:R,FORMAT:$,ALPHABET:Q}},W.isBigNumber=function(O){if(!O||O._isBigNumber!==!0)return!1;if(!W.DEBUG)return!0;var K,ce,H=O.c,D=O.e,V=O.s;e:if({}.toString.call(H)=="[object Array]"){if((V===1||V===-1)&&D>=-1e9&&D<=ol&&D===Sl(D)){if(H[0]===0){if(D===0&&H.length===1)return!0;break e}if(K=(D+1)%Ar,K<1&&(K+=Ar),String(H[0]).length==K){for(K=0;K<H.length;K++)if(ce=H[K],ce<0||ce>=Gl||ce!==Sl(ce))break e;if(ce!==0)return!0}}}else if(H===null&&D===null&&(V===null||V===1||V===-1))return!0;throw Error(Ua+"Invalid BigNumber: "+O)},W.maximum=W.max=function(){return Se(arguments,-1)},W.minimum=W.min=function(){return Se(arguments,1)},W.random=function(){var O=9007199254740992,K=Math.random()*O&2097151?function(){return Sl(Math.random()*O)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(ce){var H,D,V,z,U,G=0,ue=[],ie=new W(o);if(ce==null?ce=l:Cs(ce,0,ol),z=q0(ce/Ar),E)if(crypto.getRandomValues){for(H=crypto.getRandomValues(new Uint32Array(z*=2));G<z;)U=H[G]*131072+(H[G+1]>>>11),U>=9e15?(D=crypto.getRandomValues(new Uint32Array(2)),H[G]=D[0],H[G+1]=D[1]):(ue.push(U%1e14),G+=2);G=z/2}else if(crypto.randomBytes){for(H=crypto.randomBytes(z*=7);G<z;)U=(H[G]&31)*281474976710656+H[G+1]*1099511627776+H[G+2]*4294967296+H[G+3]*16777216+(H[G+4]<<16)+(H[G+5]<<8)+H[G+6],U>=9e15?crypto.randomBytes(7).copy(H,G):(ue.push(U%1e14),G+=7);G=z/7}else throw E=!1,Error(Ua+"crypto unavailable");if(!E)for(;G<z;)U=K(),U<9e15&&(ue[G++]=U%1e14);for(z=ue[--G],ce%=Ar,z&&ce&&(U=V0[Ar-ce],ue[G]=Sl(z/U)*U);ue[G]===0;ue.pop(),G--);if(G<0)ue=[V=0];else{for(V=-1;ue[0]===0;ue.splice(0,1),V-=Ar);for(G=1,U=ue[0];U>=10;U/=10,G++);G<Ar&&(V-=Ar-G)}return ie.e=V,ie.c=ue,ie}}(),W.sum=function(){for(var O=1,K=arguments,ce=new W(K[0]);O<K.length;)ce=ce.plus(K[O++]);return ce},t=function(){var O="0123456789";function K(ce,H,D,V){for(var z,U=[0],G,ue=0,ie=ce.length;ue<ie;){for(G=U.length;G--;U[G]*=H);for(U[0]+=V.indexOf(ce.charAt(ue++)),z=0;z<U.length;z++)U[z]>D-1&&(U[z+1]==null&&(U[z+1]=0),U[z+1]+=U[z]/D|0,U[z]%=D)}return U.reverse()}return function(ce,H,D,V,z){var U,G,ue,ie,Ae,Me,st,X,Ee=ce.indexOf("."),N=l,Z=h;for(Ee>=0&&(ie=R,R=0,ce=ce.replace(".",""),X=new W(H),Me=X.pow(ce.length-Ee),R=ie,X.c=K(Gu(Ll(Me.c),Me.e,"0"),10,D,O),X.e=X.c.length),st=K(ce,H,D,z?(U=Q,O):(U=O,Q)),ue=ie=st.length;st[--ie]==0;st.pop());if(!st[0])return U.charAt(0);if(Ee<0?--ue:(Me.c=st,Me.e=ue,Me.s=V,Me=n(Me,X,N,Z,D),st=Me.c,Ae=Me.r,ue=Me.e),G=ue+N+1,Ee=st[G],ie=D/2,Ae=Ae||G<0||st[G+1]!=null,Ae=Z<4?(Ee!=null||Ae)&&(Z==0||Z==(Me.s<0?3:2)):Ee>ie||Ee==ie&&(Z==4||Ae||Z==6&&st[G-1]&1||Z==(Me.s<0?8:7)),G<1||!st[0])ce=Ae?Gu(U.charAt(1),-N,U.charAt(0)):U.charAt(0);else{if(st.length=G,Ae)for(--D;++st[--G]>D;)st[G]=0,G||(++ue,st=[1].concat(st));for(ie=st.length;!st[--ie];);for(Ee=0,ce="";Ee<=ie;ce+=U.charAt(st[Ee++]));ce=Gu(ce,ue,U.charAt(0))}return ce}}(),n=function(){function O(H,D,V){var z,U,G,ue,ie=0,Ae=H.length,Me=D%uc,st=D/uc|0;for(H=H.slice();Ae--;)G=H[Ae]%uc,ue=H[Ae]/uc|0,z=st*G+ue*Me,U=Me*G+z%uc*uc+ie,ie=(U/V|0)+(z/uc|0)+st*ue,H[Ae]=U%V;return ie&&(H=[ie].concat(H)),H}function K(H,D,V,z){var U,G;if(V!=z)G=V>z?1:-1;else for(U=G=0;U<V;U++)if(H[U]!=D[U]){G=H[U]>D[U]?1:-1;break}return G}function ce(H,D,V,z){for(var U=0;V--;)H[V]-=U,U=H[V]<D[V]?1:0,H[V]=U*z+H[V]-D[V];for(;!H[0]&&H.length>1;H.splice(0,1));}return function(H,D,V,z,U){var G,ue,ie,Ae,Me,st,X,Ee,N,Z,he,ne,te,ee,se,Pe,oe,re=H.s==D.s?1:-1,xe=H.c,ye=D.c;if(!xe||!xe[0]||!ye||!ye[0])return new W(!H.s||!D.s||(xe?ye&&xe[0]==ye[0]:!ye)?NaN:xe&&xe[0]==0||!ye?re*0:re/0);for(Ee=new W(re),N=Ee.c=[],ue=H.e-D.e,re=V+ue+1,U||(U=Gl,ue=Cl(H.e/Ar)-Cl(D.e/Ar),re=re/Ar|0),ie=0;ye[ie]==(xe[ie]||0);ie++);if(ye[ie]>(xe[ie]||0)&&ue--,re<0)N.push(1),Ae=!0;else{for(ee=xe.length,Pe=ye.length,ie=0,re+=2,Me=Sl(U/(ye[0]+1)),Me>1&&(ye=O(ye,Me,U),xe=O(xe,Me,U),Pe=ye.length,ee=xe.length),te=Pe,Z=xe.slice(0,Pe),he=Z.length;he<Pe;Z[he++]=0);oe=ye.slice(),oe=[0].concat(oe),se=ye[0],ye[1]>=U/2&&se++;do{if(Me=0,G=K(ye,Z,Pe,he),G<0){if(ne=Z[0],Pe!=he&&(ne=ne*U+(Z[1]||0)),Me=Sl(ne/se),Me>1)for(Me>=U&&(Me=U-1),st=O(ye,Me,U),X=st.length,he=Z.length;K(st,Z,X,he)==1;)Me--,ce(st,Pe<X?oe:ye,X,U),X=st.length,G=1;else Me==0&&(G=Me=1),st=ye.slice(),X=st.length;if(X<he&&(st=[0].concat(st)),ce(Z,st,he,U),he=Z.length,G==-1)for(;K(ye,Z,Pe,he)<1;)Me++,ce(Z,Pe<he?oe:ye,he,U),he=Z.length}else G===0&&(Me++,Z=[0]);N[ie++]=Me,Z[0]?Z[he++]=xe[te]||0:(Z=[xe[te]],he=1)}while((te++<ee||Z[0]!=null)&&re--);Ae=Z[0]!=null,N[0]||N.splice(0,1)}if(U==Gl){for(ie=1,re=N[0];re>=10;re/=10,ie++);Ye(Ee,V+(Ee.e=ie+ue*Ar-1)+1,z,Ae)}else Ee.e=ue,Ee.r=+Ae;return Ee}}();function ge(O,K,ce,H){var D,V,z,U,G;if(ce==null?ce=h:Cs(ce,0,8),!O.c)return O.toString();if(D=O.c[0],z=O.e,K==null)G=Ll(O.c),G=H==1||H==2&&(z<=g||z>=v)?Md(G,z):Gu(G,z,"0");else if(O=Ye(new W(O),K,ce),V=O.e,G=Ll(O.c),U=G.length,H==1||H==2&&(K<=V||V<=g)){for(;U<K;G+="0",U++);G=Md(G,V)}else if(K-=z,G=Gu(G,V,"0"),V+1>U){if(--K>0)for(G+=".";K--;G+="0");}else if(K+=V-U,K>0)for(V+1==U&&(G+=".");K--;G+="0");return O.s<0&&D?"-"+G:G}function Se(O,K){for(var ce,H,D=1,V=new W(O[0]);D<O.length;D++)H=new W(O[D]),(!H.s||(ce=qc(V,H))===K||ce===0&&V.s===K)&&(V=H);return V}function De(O,K,ce){for(var H=1,D=K.length;!K[--D];K.pop());for(D=K[0];D>=10;D/=10,H++);return(ce=H+ce*Ar-1)>x?O.c=O.e=null:ce<_?O.c=[O.e=0]:(O.e=ce,O.c=K),O}r=function(){var O=/^(-?)0([xbo])(?=\w[\w.]*$)/i,K=/^([^.]+)\.$/,ce=/^\.([^.]+)$/,H=/^-?(Infinity|NaN)$/,D=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(V,z,U,G){var ue,ie=U?z:z.replace(D,"");if(H.test(ie))V.s=isNaN(ie)?null:ie<0?-1:1;else{if(!U&&(ie=ie.replace(O,function(Ae,Me,st){return ue=(st=st.toLowerCase())=="x"?16:st=="b"?2:8,!G||G==ue?Me:Ae}),G&&(ue=G,ie=ie.replace(K,"$1").replace(ce,"0.$1")),z!=ie))return new W(ie,ue);if(W.DEBUG)throw Error(Ua+"Not a"+(G?" base "+G:"")+" number: "+z);V.s=null}V.c=V.e=null}}();function Ye(O,K,ce,H){var D,V,z,U,G,ue,ie,Ae=O.c,Me=V0;if(Ae){e:{for(D=1,U=Ae[0];U>=10;U/=10,D++);if(V=K-D,V<0)V+=Ar,z=K,G=Ae[ue=0],ie=Sl(G/Me[D-z-1]%10);else if(ue=q0((V+1)/Ar),ue>=Ae.length)if(H){for(;Ae.length<=ue;Ae.push(0));G=ie=0,D=1,V%=Ar,z=V-Ar+1}else break e;else{for(G=U=Ae[ue],D=1;U>=10;U/=10,D++);V%=Ar,z=V-Ar+D,ie=z<0?0:Sl(G/Me[D-z-1]%10)}if(H=H||K<0||Ae[ue+1]!=null||(z<0?G:G%Me[D-z-1]),H=ce<4?(ie||H)&&(ce==0||ce==(O.s<0?3:2)):ie>5||ie==5&&(ce==4||H||ce==6&&(V>0?z>0?G/Me[D-z]:0:Ae[ue-1])%10&1||ce==(O.s<0?8:7)),K<1||!Ae[0])return Ae.length=0,H?(K-=O.e+1,Ae[0]=Me[(Ar-K%Ar)%Ar],O.e=-K||0):Ae[0]=O.e=0,O;if(V==0?(Ae.length=ue,U=1,ue--):(Ae.length=ue+1,U=Me[Ar-V],Ae[ue]=z>0?Sl(G/Me[D-z]%Me[z])*U:0),H)for(;;)if(ue==0){for(V=1,z=Ae[0];z>=10;z/=10,V++);for(z=Ae[0]+=U,U=1;z>=10;z/=10,U++);V!=U&&(O.e++,Ae[0]==Gl&&(Ae[0]=1));break}else{if(Ae[ue]+=U,Ae[ue]!=Gl)break;Ae[ue--]=0,U=1}for(V=Ae.length;Ae[--V]===0;Ae.pop());}O.e>x?O.c=O.e=null:O.e<_&&(O.c=[O.e=0])}return O}function Ve(O){var K,ce=O.e;return ce===null?O.toString():(K=Ll(O.c),K=ce<=g||ce>=v?Md(K,ce):Gu(K,ce,"0"),O.s<0?"-"+K:K)}return i.absoluteValue=i.abs=function(){var O=new W(this);return O.s<0&&(O.s=1),O},i.comparedTo=function(O,K){return qc(this,new W(O,K))},i.decimalPlaces=i.dp=function(O,K){var ce,H,D,V=this;if(O!=null)return Cs(O,0,ol),K==null?K=h:Cs(K,0,8),Ye(new W(V),O+V.e+1,K);if(!(ce=V.c))return null;if(H=((D=ce.length-1)-Cl(this.e/Ar))*Ar,D=ce[D])for(;D%10==0;D/=10,H--);return H<0&&(H=0),H},i.dividedBy=i.div=function(O,K){return n(this,new W(O,K),l,h)},i.dividedToIntegerBy=i.idiv=function(O,K){return n(this,new W(O,K),0,1)},i.exponentiatedBy=i.pow=function(O,K){var ce,H,D,V,z,U,G,ue,ie,Ae=this;if(O=new W(O),O.c&&!O.isInteger())throw Error(Ua+"Exponent not an integer: "+Ve(O));if(K!=null&&(K=new W(K)),U=O.e>14,!Ae.c||!Ae.c[0]||Ae.c[0]==1&&!Ae.e&&Ae.c.length==1||!O.c||!O.c[0])return ie=new W(Math.pow(+Ve(Ae),U?O.s*(2-Ad(O)):+Ve(O))),K?ie.mod(K):ie;if(G=O.s<0,K){if(K.c?!K.c[0]:!K.s)return new W(NaN);H=!G&&Ae.isInteger()&&K.isInteger(),H&&(Ae=Ae.mod(K))}else{if(O.e>9&&(Ae.e>0||Ae.e<-1||(Ae.e==0?Ae.c[0]>1||U&&Ae.c[1]>=24e7:Ae.c[0]<8e13||U&&Ae.c[0]<=9999975e7)))return V=Ae.s<0&&Ad(O)?-0:0,Ae.e>-1&&(V=1/V),new W(G?1/V:V);R&&(V=q0(R/Ar+2))}for(U?(ce=new W(.5),G&&(O.s=1),ue=Ad(O)):(D=Math.abs(+Ve(O)),ue=D%2),ie=new W(o);;){if(ue){if(ie=ie.times(Ae),!ie.c)break;V?ie.c.length>V&&(ie.c.length=V):H&&(ie=ie.mod(K))}if(D){if(D=Sl(D/2),D===0)break;ue=D%2}else if(O=O.times(ce),Ye(O,O.e+1,1),O.e>14)ue=Ad(O);else{if(D=+Ve(O),D===0)break;ue=D%2}Ae=Ae.times(Ae),V?Ae.c&&Ae.c.length>V&&(Ae.c.length=V):H&&(Ae=Ae.mod(K))}return H?ie:(G&&(ie=o.div(ie)),K?ie.mod(K):V?Ye(ie,R,h,z):ie)},i.integerValue=function(O){var K=new W(this);return O==null?O=h:Cs(O,0,8),Ye(K,K.e+1,O)},i.isEqualTo=i.eq=function(O,K){return qc(this,new W(O,K))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(O,K){return qc(this,new W(O,K))>0},i.isGreaterThanOrEqualTo=i.gte=function(O,K){return(K=qc(this,new W(O,K)))===1||K===0},i.isInteger=function(){return!!this.c&&Cl(this.e/Ar)>this.c.length-2},i.isLessThan=i.lt=function(O,K){return qc(this,new W(O,K))<0},i.isLessThanOrEqualTo=i.lte=function(O,K){return(K=qc(this,new W(O,K)))===-1||K===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(O,K){var ce,H,D,V,z=this,U=z.s;if(O=new W(O,K),K=O.s,!U||!K)return new W(NaN);if(U!=K)return O.s=-K,z.plus(O);var G=z.e/Ar,ue=O.e/Ar,ie=z.c,Ae=O.c;if(!G||!ue){if(!ie||!Ae)return ie?(O.s=-K,O):new W(Ae?z:NaN);if(!ie[0]||!Ae[0])return Ae[0]?(O.s=-K,O):new W(ie[0]?z:h==3?-0:0)}if(G=Cl(G),ue=Cl(ue),ie=ie.slice(),U=G-ue){for((V=U<0)?(U=-U,D=ie):(ue=G,D=Ae),D.reverse(),K=U;K--;D.push(0));D.reverse()}else for(H=(V=(U=ie.length)<(K=Ae.length))?U:K,U=K=0;K<H;K++)if(ie[K]!=Ae[K]){V=ie[K]<Ae[K];break}if(V&&(D=ie,ie=Ae,Ae=D,O.s=-O.s),K=(H=Ae.length)-(ce=ie.length),K>0)for(;K--;ie[ce++]=0);for(K=Gl-1;H>U;){if(ie[--H]<Ae[H]){for(ce=H;ce&&!ie[--ce];ie[ce]=K);--ie[ce],ie[H]+=Gl}ie[H]-=Ae[H]}for(;ie[0]==0;ie.splice(0,1),--ue);return ie[0]?De(O,ie,ue):(O.s=h==3?-1:1,O.c=[O.e=0],O)},i.modulo=i.mod=function(O,K){var ce,H,D=this;return O=new W(O,K),!D.c||!O.s||O.c&&!O.c[0]?new W(NaN):!O.c||D.c&&!D.c[0]?new W(D):(b==9?(H=O.s,O.s=1,ce=n(D,O,0,3),O.s=H,ce.s*=H):ce=n(D,O,0,b),O=D.minus(ce.times(O)),!O.c[0]&&b==1&&(O.s=D.s),O)},i.multipliedBy=i.times=function(O,K){var ce,H,D,V,z,U,G,ue,ie,Ae,Me,st,X,Ee,N,Z=this,he=Z.c,ne=(O=new W(O,K)).c;if(!he||!ne||!he[0]||!ne[0])return!Z.s||!O.s||he&&!he[0]&&!ne||ne&&!ne[0]&&!he?O.c=O.e=O.s=null:(O.s*=Z.s,!he||!ne?O.c=O.e=null:(O.c=[0],O.e=0)),O;for(H=Cl(Z.e/Ar)+Cl(O.e/Ar),O.s*=Z.s,G=he.length,Ae=ne.length,G<Ae&&(X=he,he=ne,ne=X,D=G,G=Ae,Ae=D),D=G+Ae,X=[];D--;X.push(0));for(Ee=Gl,N=uc,D=Ae;--D>=0;){for(ce=0,Me=ne[D]%N,st=ne[D]/N|0,z=G,V=D+z;V>D;)ue=he[--z]%N,ie=he[z]/N|0,U=st*ue+ie*Me,ue=Me*ue+U%N*N+X[V]+ce,ce=(ue/Ee|0)+(U/N|0)+st*ie,X[V--]=ue%Ee;X[V]=ce}return ce?++H:X.splice(0,1),De(O,X,H)},i.negated=function(){var O=new W(this);return O.s=-O.s||null,O},i.plus=function(O,K){var ce,H=this,D=H.s;if(O=new W(O,K),K=O.s,!D||!K)return new W(NaN);if(D!=K)return O.s=-K,H.minus(O);var V=H.e/Ar,z=O.e/Ar,U=H.c,G=O.c;if(!V||!z){if(!U||!G)return new W(D/0);if(!U[0]||!G[0])return G[0]?O:new W(U[0]?H:D*0)}if(V=Cl(V),z=Cl(z),U=U.slice(),D=V-z){for(D>0?(z=V,ce=G):(D=-D,ce=U),ce.reverse();D--;ce.push(0));ce.reverse()}for(D=U.length,K=G.length,D-K<0&&(ce=G,G=U,U=ce,K=D),D=0;K;)D=(U[--K]=U[K]+G[K]+D)/Gl|0,U[K]=Gl===U[K]?0:U[K]%Gl;return D&&(U=[D].concat(U),++z),De(O,U,z)},i.precision=i.sd=function(O,K){var ce,H,D,V=this;if(O!=null&&O!==!!O)return Cs(O,1,ol),K==null?K=h:Cs(K,0,8),Ye(new W(V),O,K);if(!(ce=V.c))return null;if(D=ce.length-1,H=D*Ar+1,D=ce[D]){for(;D%10==0;D/=10,H--);for(D=ce[0];D>=10;D/=10,H++);}return O&&V.e+1>H&&(H=V.e+1),H},i.shiftedBy=function(O){return Cs(O,-9007199254740991,_y),this.times("1e"+O)},i.squareRoot=i.sqrt=function(){var O,K,ce,H,D,V=this,z=V.c,U=V.s,G=V.e,ue=l+4,ie=new W("0.5");if(U!==1||!z||!z[0])return new W(!U||U<0&&(!z||z[0])?NaN:z?V:1/0);if(U=Math.sqrt(+Ve(V)),U==0||U==1/0?(K=Ll(z),(K.length+G)%2==0&&(K+="0"),U=Math.sqrt(+K),G=Cl((G+1)/2)-(G<0||G%2),U==1/0?K="5e"+G:(K=U.toExponential(),K=K.slice(0,K.indexOf("e")+1)+G),ce=new W(K)):ce=new W(U+""),ce.c[0]){for(G=ce.e,U=G+ue,U<3&&(U=0);;)if(D=ce,ce=ie.times(D.plus(n(V,D,ue,1))),Ll(D.c).slice(0,U)===(K=Ll(ce.c)).slice(0,U))if(ce.e<G&&--U,K=K.slice(U-3,U+1),K=="9999"||!H&&K=="4999"){if(!H&&(Ye(D,D.e+l+2,0),D.times(D).eq(V))){ce=D;break}ue+=4,U+=4,H=1}else{(!+K||!+K.slice(1)&&K.charAt(0)=="5")&&(Ye(ce,ce.e+l+2,1),O=!ce.times(ce).eq(V));break}}return Ye(ce,ce.e+l+1,h,O)},i.toExponential=function(O,K){return O!=null&&(Cs(O,0,ol),O++),ge(this,O,K,1)},i.toFixed=function(O,K){return O!=null&&(Cs(O,0,ol),O=O+this.e+1),ge(this,O,K)},i.toFormat=function(O,K,ce){var H,D=this;if(ce==null)O!=null&&K&&typeof K=="object"?(ce=K,K=null):O&&typeof O=="object"?(ce=O,O=K=null):ce=$;else if(typeof ce!="object")throw Error(Ua+"Argument not an object: "+ce);if(H=D.toFixed(O,K),D.c){var V,z=H.split("."),U=+ce.groupSize,G=+ce.secondaryGroupSize,ue=ce.groupSeparator||"",ie=z[0],Ae=z[1],Me=D.s<0,st=Me?ie.slice(1):ie,X=st.length;if(G&&(V=U,U=G,G=V,X-=V),U>0&&X>0){for(V=X%U||U,ie=st.substr(0,V);V<X;V+=U)ie+=ue+st.substr(V,U);G>0&&(ie+=ue+st.slice(V)),Me&&(ie="-"+ie)}H=Ae?ie+(ce.decimalSeparator||"")+((G=+ce.fractionGroupSize)?Ae.replace(new RegExp("\\d{"+G+"}\\B","g"),"$&"+(ce.fractionGroupSeparator||"")):Ae):ie}return(ce.prefix||"")+H+(ce.suffix||"")},i.toFraction=function(O){var K,ce,H,D,V,z,U,G,ue,ie,Ae,Me,st=this,X=st.c;if(O!=null&&(U=new W(O),!U.isInteger()&&(U.c||U.s!==1)||U.lt(o)))throw Error(Ua+"Argument "+(U.isInteger()?"out of range: ":"not an integer: ")+Ve(U));if(!X)return new W(st);for(K=new W(o),ue=ce=new W(o),H=G=new W(o),Me=Ll(X),V=K.e=Me.length-st.e-1,K.c[0]=V0[(z=V%Ar)<0?Ar+z:z],O=!O||U.comparedTo(K)>0?V>0?K:ue:U,z=x,x=1/0,U=new W(Me),G.c[0]=0;ie=n(U,K,0,1),D=ce.plus(ie.times(H)),D.comparedTo(O)!=1;)ce=H,H=D,ue=G.plus(ie.times(D=ue)),G=D,K=U.minus(ie.times(D=K)),U=D;return D=n(O.minus(ce),H,0,1),G=G.plus(D.times(ue)),ce=ce.plus(D.times(H)),G.s=ue.s=st.s,V=V*2,Ae=n(ue,H,V,h).minus(st).abs().comparedTo(n(G,ce,V,h).minus(st).abs())<1?[ue,H]:[G,ce],x=z,Ae},i.toNumber=function(){return+Ve(this)},i.toPrecision=function(O,K){return O!=null&&Cs(O,1,ol),ge(this,O,K,2)},i.toString=function(O){var K,ce=this,H=ce.s,D=ce.e;return D===null?H?(K="Infinity",H<0&&(K="-"+K)):K="NaN":(O==null?K=D<=g||D>=v?Md(Ll(ce.c),D):Gu(Ll(ce.c),D,"0"):O===10&&I?(ce=Ye(new W(ce),l+D+1,h),K=Gu(Ll(ce.c),ce.e,"0")):(Cs(O,2,Q.length,"Base"),K=t(Gu(Ll(ce.c),D,"0"),10,O,H,!0)),H<0&&ce.c[0]&&(K="-"+K)),K},i.valueOf=i.toJSON=function(){return Ve(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,e!=null&&W.set(e),W}function Cl(e){var n=e|0;return e>0||e===n?n:n-1}function Ll(e){for(var n,t,r=1,i=e.length,o=e[0]+"";r<i;){for(n=e[r++]+"",t=Ar-n.length;t--;n="0"+n);o+=n}for(i=o.length;o.charCodeAt(--i)===48;);return o.slice(0,i+1||1)}function qc(e,n){var t,r,i=e.c,o=n.c,l=e.s,h=n.s,g=e.e,v=n.e;if(!l||!h)return null;if(t=i&&!i[0],r=o&&!o[0],t||r)return t?r?0:-h:l;if(l!=h)return l;if(t=l<0,r=g==v,!i||!o)return r?0:!i^t?1:-1;if(!r)return g>v^t?1:-1;for(h=(g=i.length)<(v=o.length)?g:v,l=0;l<h;l++)if(i[l]!=o[l])return i[l]>o[l]^t?1:-1;return g==v?0:g>v^t?1:-1}function Cs(e,n,t,r){if(e<n||e>t||e!==Sl(e))throw Error(Ua+(r||"Argument")+(typeof e=="number"?e<n||e>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Ad(e){var n=e.c.length-1;return Cl(e.e/Ar)==n&&e.c[n]%2!=0}function Md(e,n){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(n<0?"e":"e+")+n}function Gu(e,n,t){var r,i;if(n<0){for(i=t+".";++n;i+=t);e=i+e}else if(r=e.length,++n>r){for(i=t,n-=r;--n;i+=t);e+=i}else n<r&&(e=e.slice(0,n)+"."+e.slice(n));return e}var xu=gb(),Ok=class{constructor(e){Pt(this,"key");Pt(this,"left",null);Pt(this,"right",null);this.key=e}},pf=class extends Ok{constructor(e){super(e)}},Ik=class{constructor(){Pt(this,"size",0);Pt(this,"modificationCount",0);Pt(this,"splayCount",0)}splay(e){const n=this.root;if(n==null)return this.compare(e,e),-1;let t=null,r=null,i=null,o=null,l=n;const h=this.compare;let g;for(;;)if(g=h(l.key,e),g>0){let v=l.left;if(v==null||(g=h(v.key,e),g>0&&(l.left=v.right,v.right=l,l=v,v=l.left,v==null)))break;t==null?r=l:t.left=l,t=l,l=v}else if(g<0){let v=l.right;if(v==null||(g=h(v.key,e),g<0&&(l.right=v.left,v.left=l,l=v,v=l.right,v==null)))break;i==null?o=l:i.right=l,i=l,l=v}else break;return i!=null&&(i.right=l.left,l.left=o),t!=null&&(t.left=l.right,l.right=r),this.root!==l&&(this.root=l,this.splayCount++),g}splayMin(e){let n=e,t=n.left;for(;t!=null;){const r=t;n.left=r.right,r.right=n,n=r,t=n.left}return n}splayMax(e){let n=e,t=n.right;for(;t!=null;){const r=t;n.right=r.left,r.left=n,n=r,t=n.right}return n}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let t=this.root;const r=t,i=t.left;if(this.size--,i==null)this.root=t.right;else{const o=t.right;t=this.splayMax(i),t.right=o,this.root=t}return this.modificationCount++,r}addNewRoot(e,n){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=e;return}n<0?(e.left=t,e.right=t.right,t.right=null):(e.right=t,e.left=t.left,t.left=null),this.root=e}_first(){const e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){const e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,n)=>e<n?-1:e>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},Ky,Jy,hp=class xf extends Ik{constructor(t,r){super();Pt(this,"root",null);Pt(this,"compare");Pt(this,"validKey");Pt(this,Ky,"[object Set]");this.compare=t??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(t){return this.validKey(t)?this._delete(t)!=null:!1}deleteAll(t){for(const r of t)this.delete(r)}forEach(t){const r=this[Symbol.iterator]();let i;for(;i=r.next(),!i.done;)t(i.value,i.value,this)}add(t){const r=this.splay(t);return r!=0&&this.addNewRoot(new pf(t),r),this}addAndReturn(t){const r=this.splay(t);return r!=0&&this.addNewRoot(new pf(t),r),this.root.key}addAll(t){for(const r of t)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let o=i.right;for(;o!=null;)i=o,o=i.right;return i.key}firstAfter(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let o=i.left;for(;o!=null;)i=o,o=i.left;return i.key}retainAll(t){const r=new xf(this.compare,this.validKey),i=this.modificationCount;for(const o of t){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(o)&&this.splay(o)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(t){return!this.validKey(t)||this.splay(t)!=0?null:this.root.key}intersection(t){const r=new xf(this.compare,this.validKey);for(const i of this)t.has(i)&&r.add(i);return r}difference(t){const r=new xf(this.compare,this.validKey);for(const i of this)t.has(i)||r.add(i);return r}union(t){const r=this.clone();return r.addAll(t),r}clone(){const t=new xf(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(t==null)return null;function r(o,l){let h,g;do{if(h=o.left,g=o.right,h!=null){const v=new pf(h.key);l.left=v,r(h,v)}if(g!=null){const v=new pf(g.key);l.right=v,o=g,l=v}}while(g!=null)}const i=new pf(t.key);return r(t,i),i}toSet(){return this.clone()}entries(){return new zk(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Jy=Symbol.iterator,Ky=Symbol.toStringTag,Jy)](){return new Fk(this.wrap())}},mb=class{constructor(e){Pt(this,"tree");Pt(this,"path",new Array);Pt(this,"modificationCount",null);Pt(this,"splayCount");this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],n=e.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},Fk=class extends mb{getValue(e){return e.key}},zk=class extends mb{getValue(e){return[e.key,e.key]}},vb=e=>()=>e,Bg=e=>{const n=e?(t,r)=>r.minus(t).abs().isLessThanOrEqualTo(e):vb(!1);return(t,r)=>n(t,r)?0:t.comparedTo(r)};function jk(e){const n=e?(t,r,i,o,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(o.minus(r).exponentiatedBy(2).plus(l.minus(i).exponentiatedBy(2)).times(e)):vb(!1);return(t,r,i)=>{const o=t.x,l=t.y,h=i.x,g=i.y,v=l.minus(g).times(r.x.minus(h)).minus(o.minus(h).times(r.y.minus(g)));return n(v,o,l,h,g)?0:v.comparedTo(0)}}var Uk=e=>e,$k=e=>{if(e){const n=new hp(Bg(e)),t=new hp(Bg(e)),r=(o,l)=>l.addAndReturn(o),i=o=>({x:r(o.x,n),y:r(o.y,t)});return i({x:new xu(0),y:new xu(0)}),i}return Uk},Ng=e=>({set:n=>{Xu=Ng(n)},reset:()=>Ng(e),compare:Bg(e),snap:$k(e),orient:jk(e)}),Xu=Ng(),gf=(e,n)=>e.ll.x.isLessThanOrEqualTo(n.x)&&n.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(n.y)&&n.y.isLessThanOrEqualTo(e.ur.y),Rg=(e,n)=>{if(n.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(n.ll.x)||n.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(n.ll.y))return null;const t=e.ll.x.isLessThan(n.ll.x)?n.ll.x:e.ll.x,r=e.ur.x.isLessThan(n.ur.x)?e.ur.x:n.ur.x,i=e.ll.y.isLessThan(n.ll.y)?n.ll.y:e.ll.y,o=e.ur.y.isLessThan(n.ur.y)?e.ur.y:n.ur.y;return{ll:{x:t,y:i},ur:{x:r,y:o}}},Gd=(e,n)=>e.x.times(n.y).minus(e.y.times(n.x)),yb=(e,n)=>e.x.times(n.x).plus(e.y.times(n.y)),fp=e=>yb(e,e).sqrt(),qk=(e,n,t)=>{const r={x:n.x.minus(e.x),y:n.y.minus(e.y)},i={x:t.x.minus(e.x),y:t.y.minus(e.y)};return Gd(i,r).div(fp(i)).div(fp(r))},Vk=(e,n,t)=>{const r={x:n.x.minus(e.x),y:n.y.minus(e.y)},i={x:t.x.minus(e.x),y:t.y.minus(e.y)};return yb(i,r).div(fp(i)).div(fp(r))},by=(e,n,t)=>n.y.isZero()?null:{x:e.x.plus(n.x.div(n.y).times(t.minus(e.y))),y:t},wy=(e,n,t)=>n.x.isZero()?null:{x:t,y:e.y.plus(n.y.div(n.x).times(t.minus(e.x)))},Gk=(e,n,t,r)=>{if(n.x.isZero())return wy(t,r,e.x);if(r.x.isZero())return wy(e,n,t.x);if(n.y.isZero())return by(t,r,e.y);if(r.y.isZero())return by(e,n,t.y);const i=Gd(n,r);if(i.isZero())return null;const o={x:t.x.minus(e.x),y:t.y.minus(e.y)},l=Gd(o,n).div(i),h=Gd(o,r).div(i),g=e.x.plus(h.times(n.x)),v=t.x.plus(l.times(r.x)),_=e.y.plus(h.times(n.y)),x=t.y.plus(l.times(r.y)),E=g.plus(v).div(2),b=_.plus(x).div(2);return{x:E,y:b}},_u=class _b{constructor(n,t){Pt(this,"point");Pt(this,"isLeft");Pt(this,"segment");Pt(this,"otherSE");Pt(this,"consumedBy");n.events===void 0?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=t}static compare(n,t){const r=_b.comparePoints(n.point,t.point);return r!==0?r:(n.point!==t.point&&n.link(t),n.isLeft!==t.isLeft?n.isLeft?1:-1:dp.compare(n.segment,t.segment))}static comparePoints(n,t){return n.x.isLessThan(t.x)?-1:n.x.isGreaterThan(t.x)?1:n.y.isLessThan(t.y)?-1:n.y.isGreaterThan(t.y)?1:0}link(n){if(n.point===this.point)throw new Error("Tried to link already linked events");const t=n.point.events;for(let r=0,i=t.length;r<i;r++){const o=t[r];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const n=this.point.events.length;for(let t=0;t<n;t++){const r=this.point.events[t];if(r.segment.consumedBy===void 0)for(let i=t+1;i<n;i++){const o=this.point.events[i];o.consumedBy===void 0&&r.otherSE.point.events===o.otherSE.point.events&&r.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const n=[];for(let t=0,r=this.point.events.length;t<r;t++){const i=this.point.events[t];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&n.push(i)}return n}getLeftmostComparator(n){const t=new Map,r=i=>{const o=i.otherSE;t.set(i,{sine:qk(this.point,n.point,o.point),cosine:Vk(this.point,n.point,o.point)})};return(i,o)=>{t.has(i)||r(i),t.has(o)||r(o);const{sine:l,cosine:h}=t.get(i),{sine:g,cosine:v}=t.get(o);return l.isGreaterThanOrEqualTo(0)&&g.isGreaterThanOrEqualTo(0)?h.isLessThan(v)?1:h.isGreaterThan(v)?-1:0:l.isLessThan(0)&&g.isLessThan(0)?h.isLessThan(v)?-1:h.isGreaterThan(v)?1:0:g.isLessThan(l)?-1:g.isGreaterThan(l)?1:0}}},Hk=class Dg{constructor(n){Pt(this,"events");Pt(this,"poly");Pt(this,"_isExteriorRing");Pt(this,"_enclosingRing");this.events=n;for(let t=0,r=n.length;t<r;t++)n[t].segment.ringOut=this;this.poly=null}static factory(n){const t=[];for(let r=0,i=n.length;r<i;r++){const o=n[r];if(!o.isInResult()||o.ringOut)continue;let l=null,h=o.leftSE,g=o.rightSE;const v=[h],_=h.point,x=[];for(;l=h,h=g,v.push(h),h.point!==_;)for(;;){const E=h.getAvailableLinkedEvents();if(E.length===0){const $=v[0].point,Q=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${$.x}, ${$.y}]. Last matching segment found ends at [${Q.x}, ${Q.y}].`)}if(E.length===1){g=E[0].otherSE;break}let b=null;for(let $=0,Q=x.length;$<Q;$++)if(x[$].point===h.point){b=$;break}if(b!==null){const $=x.splice(b)[0],Q=v.splice($.index);Q.unshift(Q[0].otherSE),t.push(new Dg(Q.reverse()));continue}x.push({index:v.length,point:h.point});const R=h.getLeftmostComparator(l);g=E.sort(R)[0].otherSE;break}t.push(new Dg(v))}return t}getGeom(){let n=this.events[0].point;const t=[n];for(let v=1,_=this.events.length-1;v<_;v++){const x=this.events[v].point,E=this.events[v+1].point;Xu.orient(x,n,E)!==0&&(t.push(x),n=x)}if(t.length===1)return null;const r=t[0],i=t[1];Xu.orient(r,n,i)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,h=this.isExteriorRing()?t.length:-1,g=[];for(let v=l;v!=h;v+=o)g.push([t[v].x.toNumber(),t[v].y.toNumber()]);return g}isExteriorRing(){if(this._isExteriorRing===void 0){const n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,o;let n=this.events[0];for(let l=1,h=this.events.length;l<h;l++){const g=this.events[l];_u.compare(n,g)>0&&(n=g)}let t=n.segment.prevInResult(),r=t?t.prevInResult():null;for(;;){if(!t)return null;if(!r)return t.ringOut;if(r.ringOut!==t.ringOut)return((i=r.ringOut)==null?void 0:i.enclosingRing())!==t.ringOut?t.ringOut:(o=t.ringOut)==null?void 0:o.enclosingRing();t=r.prevInResult(),r=t?t.prevInResult():null}}},xy=class{constructor(e){Pt(this,"exteriorRing");Pt(this,"interiorRings");this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=this.exteriorRing.getGeom();if(e===null)return null;const n=[e];for(let t=0,r=this.interiorRings.length;t<r;t++){const i=this.interiorRings[t].getGeom();i!==null&&n.push(i)}return n}},Wk=class{constructor(e){Pt(this,"rings");Pt(this,"polys");this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const r=this.polys[n].getGeom();r!==null&&e.push(r)}return e}_composePolys(e){var t;const n=[];for(let r=0,i=e.length;r<i;r++){const o=e[r];if(!o.poly)if(o.isExteriorRing())n.push(new xy(o));else{const l=o.enclosingRing();l!=null&&l.poly||n.push(new xy(l)),(t=l==null?void 0:l.poly)==null||t.addInterior(o)}}return n}},Zk=class{constructor(e,n=dp.compare){Pt(this,"queue");Pt(this,"tree");Pt(this,"segments");this.queue=e,this.tree=new hp(n),this.segments=[]}process(e){const n=e.segment,t=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(n),t;e.isLeft&&this.tree.add(n);let r=n,i=n;do r=this.tree.lastBefore(r);while(r!=null&&r.consumedBy!=null);do i=this.tree.firstAfter(i);while(i!=null&&i.consumedBy!=null);if(e.isLeft){let o=null;if(r){const h=r.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(o=h),!r.isAnEndpoint(h))){const g=this._splitSafely(r,h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}}let l=null;if(i){const h=i.getIntersection(n);if(h!==null&&(n.isAnEndpoint(h)||(l=h),!i.isAnEndpoint(h))){const g=this._splitSafely(i,h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}}if(o!==null||l!==null){let h=null;o===null?h=l:l===null?h=o:h=_u.comparePoints(o,l)<=0?o:l,this.queue.delete(n.rightSE),t.push(n.rightSE);const g=n.split(h);for(let v=0,_=g.length;v<_;v++)t.push(g[v])}t.length>0?(this.tree.delete(n),t.push(e)):(this.segments.push(n),n.prev=r)}else{if(r&&i){const o=r.getIntersection(i);if(o!==null){if(!r.isAnEndpoint(o)){const l=this._splitSafely(r,o);for(let h=0,g=l.length;h<g;h++)t.push(l[h])}if(!i.isAnEndpoint(o)){const l=this._splitSafely(i,o);for(let h=0,g=l.length;h<g;h++)t.push(l[h])}}}this.tree.delete(n)}return t}_splitSafely(e,n){this.tree.delete(e);const t=e.rightSE;this.queue.delete(t);const r=e.split(n);return r.push(t),e.consumedBy===void 0&&this.tree.add(e),r}},Kk=class{constructor(){Pt(this,"type");Pt(this,"numMultiPolys")}run(e,n,t){Lf.type=e;const r=[new Sy(n,!0)];for(let v=0,_=t.length;v<_;v++)r.push(new Sy(t[v],!1));if(Lf.numMultiPolys=r.length,Lf.type==="difference"){const v=r[0];let _=1;for(;_<r.length;)Rg(r[_].bbox,v.bbox)!==null?_++:r.splice(_,1)}if(Lf.type==="intersection")for(let v=0,_=r.length;v<_;v++){const x=r[v];for(let E=v+1,b=r.length;E<b;E++)if(Rg(x.bbox,r[E].bbox)===null)return[]}const i=new hp(_u.compare);for(let v=0,_=r.length;v<_;v++){const x=r[v].getSweepEvents();for(let E=0,b=x.length;E<b;E++)i.add(x[E])}const o=new Zk(i);let l=null;for(i.size!=0&&(l=i.first(),i.delete(l));l;){const v=o.process(l);for(let _=0,x=v.length;_<x;_++){const E=v[_];E.consumedBy===void 0&&i.add(E)}i.size!=0?(l=i.first(),i.delete(l)):l=null}Xu.reset();const h=Hk.factory(o.segments);return new Wk(h).getGeom()}},Lf=new Kk,Og=Lf,Jk=0,dp=class Hd{constructor(n,t,r,i){Pt(this,"id");Pt(this,"leftSE");Pt(this,"rightSE");Pt(this,"rings");Pt(this,"windings");Pt(this,"ringOut");Pt(this,"consumedBy");Pt(this,"prev");Pt(this,"_prevInResult");Pt(this,"_beforeState");Pt(this,"_afterState");Pt(this,"_isInResult");this.id=++Jk,this.leftSE=n,n.segment=this,n.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=n,this.rings=r,this.windings=i}static compare(n,t){const r=n.leftSE.point.x,i=t.leftSE.point.x,o=n.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(r))return 1;if(o.isLessThan(i))return-1;const h=n.leftSE.point.y,g=t.leftSE.point.y,v=n.rightSE.point.y,_=t.rightSE.point.y;if(r.isLessThan(i)){if(g.isLessThan(h)&&g.isLessThan(v))return 1;if(g.isGreaterThan(h)&&g.isGreaterThan(v))return-1;const x=n.comparePoint(t.leftSE.point);if(x<0)return 1;if(x>0)return-1;const E=t.comparePoint(n.rightSE.point);return E!==0?E:-1}if(r.isGreaterThan(i)){if(h.isLessThan(g)&&h.isLessThan(_))return-1;if(h.isGreaterThan(g)&&h.isGreaterThan(_))return 1;const x=t.comparePoint(n.leftSE.point);if(x!==0)return x;const E=n.comparePoint(t.rightSE.point);return E<0?1:E>0?-1:1}if(h.isLessThan(g))return-1;if(h.isGreaterThan(g))return 1;if(o.isLessThan(l)){const x=t.comparePoint(n.rightSE.point);if(x!==0)return x}if(o.isGreaterThan(l)){const x=n.comparePoint(t.rightSE.point);if(x<0)return 1;if(x>0)return-1}if(!o.eq(l)){const x=v.minus(h),E=o.minus(r),b=_.minus(g),R=l.minus(i);if(x.isGreaterThan(E)&&b.isLessThan(R))return 1;if(x.isLessThan(E)&&b.isGreaterThan(R))return-1}return o.isGreaterThan(l)?1:o.isLessThan(l)||v.isLessThan(_)?-1:v.isGreaterThan(_)?1:n.id<t.id?-1:n.id>t.id?1:0}static fromRing(n,t,r){let i,o,l;const h=_u.comparePoints(n,t);if(h<0)i=n,o=t,l=1;else if(h>0)i=t,o=n,l=-1;else throw new Error(`Tried to create degenerate segment at [${n.x}, ${n.y}]`);const g=new _u(i,!0),v=new _u(o,!1);return new Hd(g,v,[r],[l])}replaceRightSE(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const n=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n.isLessThan(t)?n:t},ur:{x:this.rightSE.point.x,y:n.isGreaterThan(t)?n:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(n){return n.x.eq(this.leftSE.point.x)&&n.y.eq(this.leftSE.point.y)||n.x.eq(this.rightSE.point.x)&&n.y.eq(this.rightSE.point.y)}comparePoint(n){return Xu.orient(this.leftSE.point,n,this.rightSE.point)}getIntersection(n){const t=this.bbox(),r=n.bbox(),i=Rg(t,r);if(i===null)return null;const o=this.leftSE.point,l=this.rightSE.point,h=n.leftSE.point,g=n.rightSE.point,v=gf(t,h)&&this.comparePoint(h)===0,_=gf(r,o)&&n.comparePoint(o)===0,x=gf(t,g)&&this.comparePoint(g)===0,E=gf(r,l)&&n.comparePoint(l)===0;if(_&&v)return E&&!x?l:!E&&x?g:null;if(_)return x&&o.x.eq(g.x)&&o.y.eq(g.y)?null:o;if(v)return E&&l.x.eq(h.x)&&l.y.eq(h.y)?null:h;if(E&&x)return null;if(E)return l;if(x)return g;const b=Gk(o,this.vector(),h,n.vector());return b===null||!gf(i,b)?null:Xu.snap(b)}split(n){const t=[],r=n.events!==void 0,i=new _u(n,!0),o=new _u(n,!1),l=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(i);const h=new Hd(i,l,this.rings.slice(),this.windings.slice());return _u.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),_u.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,r=this.windings.length;t<r;t++)this.windings[t]*=-1}consume(n){let t=this,r=n;for(;t.consumedBy;)t=t.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=Hd.compare(t,r);if(i!==0){if(i>0){const o=t;t=r,r=o}if(t.prev===r){const o=t;t=r,r=o}for(let o=0,l=r.rings.length;o<l;o++){const h=r.rings[o],g=r.windings[o],v=t.rings.indexOf(h);v===-1?(t.rings.push(h),t.windings.push(g)):t.windings[v]+=g}r.rings=null,r.windings=null,r.consumedBy=t,r.leftSE.consumedBy=t.leftSE,r.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let h=0,g=this.rings.length;h<g;h++){const v=this.rings[h],_=this.windings[h],x=t.indexOf(v);x===-1?(t.push(v),r.push(_)):r[x]+=_}const o=[],l=[];for(let h=0,g=t.length;h<g;h++){if(r[h]===0)continue;const v=t[h],_=v.poly;if(l.indexOf(_)===-1)if(v.isExterior)o.push(_);else{l.indexOf(_)===-1&&l.push(_);const x=o.indexOf(v.poly);x!==-1&&o.splice(x,1)}}for(let h=0,g=o.length;h<g;h++){const v=o[h].multiPoly;i.indexOf(v)===-1&&i.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const n=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Og.type){case"union":{const r=n.length===0,i=t.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;n.length<t.length?(r=n.length,i=t.length):(r=t.length,i=n.length),this._isInResult=i===Og.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(n.length-t.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(n)!==r(t);break}}return this._isInResult}},Ly=class{constructor(e,n,t){Pt(this,"poly");Pt(this,"isExterior");Pt(this,"segments");Pt(this,"bbox");if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=t,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=Xu.snap({x:new xu(e[0][0]),y:new xu(e[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let o=1,l=e.length;o<l;o++){if(typeof e[o][0]!="number"||typeof e[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const h=Xu.snap({x:new xu(e[o][0]),y:new xu(e[o][1])});h.x.eq(i.x)&&h.y.eq(i.y)||(this.segments.push(dp.fromRing(i,h,this)),h.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=h.x),h.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=h.y),h.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=h.x),h.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=h.y),i=h)}(!r.x.eq(i.x)||!r.y.eq(i.y))&&this.segments.push(dp.fromRing(i,r,this))}getSweepEvents(){const e=[];for(let n=0,t=this.segments.length;n<t;n++){const r=this.segments[n];e.push(r.leftSE),e.push(r.rightSE)}return e}},Yk=class{constructor(e,n){Pt(this,"multiPoly");Pt(this,"exteriorRing");Pt(this,"interiorRings");Pt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ly(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,r=e.length;t<r;t++){const i=new Ly(e[t],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,t=this.interiorRings.length;n<t;n++){const r=this.interiorRings[n].getSweepEvents();for(let i=0,o=r.length;i<o;i++)e.push(r[i])}return e}},Sy=class{constructor(e,n){Pt(this,"isSubject");Pt(this,"polys");Pt(this,"bbox");if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new xu(Number.POSITIVE_INFINITY),y:new xu(Number.POSITIVE_INFINITY)},ur:{x:new xu(Number.NEGATIVE_INFINITY),y:new xu(Number.NEGATIVE_INFINITY)}};for(let t=0,r=e.length;t<r;t++){const i=new Yk(e[t],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,t=this.polys.length;n<t;n++){const r=this.polys[n].getSweepEvents();for(let i=0,o=r.length;i<o;i++)e.push(r[i])}return e}},Xk=(e,...n)=>Og.run("intersection",e,n);Xu.set;function Qk(e,n){var t,r,i,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",R=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:R?e.geometry:e,v=b?e.features[t].properties:R?e.properties:{},_=b?e.features[t].bbox:R?e.bbox:void 0,x=b?e.features[t].id:R?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,i=0;i<l;i++){if(o=g?h.geometries[i]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(n(o.geometries[r],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function e8(e,n={}){const t=[];if(Qk(e,i=>{t.push(i.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const r=Xk(t[0],...t.slice(1));return r.length===0?null:r.length===1?Pl(r[0],n.properties):wk(r,n.properties)}var t8=e8;function bb(e,n,t){if(e!==null)for(var r,i,o,l,h,g,v,_=0,x=0,E,b=e.type,R=b==="FeatureCollection",$=b==="Feature",Q=R?e.features.length:1,I=0;I<Q;I++){v=R?e.features[I].geometry:$?e.geometry:e,E=v?v.type==="GeometryCollection":!1,h=E?v.geometries.length:1;for(var W=0;W<h;W++){var ge=0,Se=0;if(l=E?v.geometries[W]:v,l!==null){g=l.coordinates;var De=l.type;switch(_=0,De){case null:break;case"Point":if(n(g,x,I,ge,Se)===!1)return!1;x++,ge++;break;case"LineString":case"MultiPoint":for(r=0;r<g.length;r++){if(n(g[r],x,I,ge,Se)===!1)return!1;x++,De==="MultiPoint"&&ge++}De==="LineString"&&ge++;break;case"Polygon":case"MultiLineString":for(r=0;r<g.length;r++){for(i=0;i<g[r].length-_;i++){if(n(g[r][i],x,I,ge,Se)===!1)return!1;x++}De==="MultiLineString"&&ge++,De==="Polygon"&&Se++}De==="Polygon"&&ge++;break;case"MultiPolygon":for(r=0;r<g.length;r++){for(Se=0,i=0;i<g[r].length;i++){for(o=0;o<g[r][i].length-_;o++){if(n(g[r][i][o],x,I,ge,Se)===!1)return!1;x++}Se++}ge++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(bb(l.geometries[r],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n8(e,n){var t,r,i,o,l,h,g,v,_,x,E=0,b=e.type==="FeatureCollection",R=e.type==="Feature",$=b?e.features.length:1;for(t=0;t<$;t++){for(h=b?e.features[t].geometry:R?e.geometry:e,v=b?e.features[t].properties:R?e.properties:{},_=b?e.features[t].bbox:R?e.bbox:void 0,x=b?e.features[t].id:R?e.id:void 0,g=h?h.type==="GeometryCollection":!1,l=g?h.geometries.length:1,i=0;i<l;i++){if(o=g?h.geometries[i]:h,o===null){if(n(null,E,v,_,x)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(o,E,v,_,x)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(n(o.geometries[r],E,v,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function r8(e,n){n8(e,function(t,r,i,o,l){var h=t===null?null:t.type;switch(h){case null:case"Point":case"LineString":case"Polygon":return n(Wh(t,i,{bbox:o,id:l}),r,0)===!1?!1:void 0}var g;switch(h){case"MultiPoint":g="Point";break;case"MultiLineString":g="LineString";break;case"MultiPolygon":g="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var _=t.coordinates[v],x={type:g,coordinates:_};if(n(Wh(x,i),r,v)===!1)return!1}})}function i8(e,n){r8(e,function(t,r,i){var o=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var h,g=0,v=0,_=0;if(bb(t,function(x,E,b,R,$){if(h===void 0||r>g||R>v||$>_){h=x,g=r,v=R,_=$,o=0;return}var Q=El([h,x],t.properties);if(n(Q,r,i,$,o)===!1)return!1;o++,h=x})===!1)return!1}}})}function s8(e,n,t){var r=t,i=!1;return i8(e,function(o,l,h,g,v){i===!1&&t===void 0?r=o:r=n(r,o,l,h,g,v),i=!0}),r}function pp(e,n={}){return s8(e,(t,r)=>{const i=r.geometry.coordinates;return t+xm(i[0],i[1],n)},0)}var Vc=pp;class zh extends fn.Polygon{constructor(t,r={}){super(t,{...r,pmIgnore:!1,interactive:!0});Pt(this,"properties");this.properties=St.measure("Polygon.constructor.initProperties",()=>({type:"Polygon",style:{color:r.color||"#3388ff",weight:r.weight||3,opacity:r.opacity||1,fillColor:r.fillColor||"#3388ff",fillOpacity:r.fillOpacity||.2,dashArray:r.dashArray||"",name:r.name||""}})),this.updateProperties(),this.on({add:()=>this.updateProperties(),edit:()=>this.updateProperties(),drag:()=>this.updateProperties()})}updateProperties(){St.measure("Polygon.updateProperties",()=>{var t,r,i;try{const o=this.getLatLngs()[0];if(!o||o.length<3){console.warn("Polygon has less than 3 points, cannot calculate properties");return}const l=o.map(b=>[b.lng,b.lat]);l.push(l[0]);const h=Pl([l]),g=db(h),v=pp(El([...l]),{units:"meters"}),_=Df(h),x=fn.latLng(_.geometry.coordinates[1],_.geometry.coordinates[0]),E=((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||"";this.properties={type:"Polygon",coordinates:o.map(b=>({lat:b.lat,lng:b.lng})),surface:g,perimeter:v,center:{lat:x.lat,lng:x.lng},vertices:o.length,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((i=this.options)==null?void 0:i.dashArray)||"",name:E}},this.fire("properties:updated",{shape:this,properties:this.properties})}catch(o){console.error("Failed to calculate polygon properties",o)}})}setName(t){St.measure("Polygon.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return St.measure("Polygon.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}setLatLngs(t){return St.measure("Polygon.setLatLngs",()=>(super.setLatLngs(t),this.updateProperties(),this))}getMidPoints(){return St.measure("Polygon.getMidPoints",()=>{const t=this.getLatLngs()[0],r=[];if(t.length<2)return r;for(let i=0;i<t.length;i++){const o=t[i],l=t[(i+1)%t.length];r.push(fn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return r})}moveVertex(t,r){St.measure("Polygon.moveVertex",()=>{const i=this.getLatLngs()[0];t>=0&&t<i.length&&(i[t]=r,fn.Polygon.prototype.setLatLngs.call(this,[i]))})}addVertex(t,r){St.measure("Polygon.addVertex",()=>{const i=this.getLatLngs()[0];t>=0&&t<i.length&&(i.splice((t+1)%i.length,0,r),fn.Polygon.prototype.setLatLngs.call(this,[i]))})}move(t){return St.measure("Polygon.move",()=>{const i=this.getLatLngs()[0].map(o=>fn.latLng(o.lat+t.lat,o.lng+t.lng));return fn.Polygon.prototype.setLatLngs.call(this,[i]),this})}getCenter(){return St.measure("Polygon.getCenter",()=>{const t=this.getLatLngs()[0];if(!t||t.length===0)return new fn.LatLng(0,0);try{const r=t.filter(v=>v&&typeof v.lat=="number"&&typeof v.lng=="number"&&!isNaN(v.lat)&&!isNaN(v.lng)&&Math.abs(v.lat)<=90&&Math.abs(v.lng)<=180);if(r.length===0)return console.warn("Aucun point valide dans le polygone pour calculer le centre"),new fn.LatLng(0,0);const i=r.map(v=>[v.lng,v.lat]);i.push(i[0]);const o=Pl([i]),l=Df(o),h=l.geometry.coordinates[1],g=l.geometry.coordinates[0];if(typeof h!="number"||typeof g!="number"||isNaN(h)||isNaN(g)||Math.abs(h)>90||Math.abs(g)>180)throw new Error("Centroid calculé invalide");return fn.latLng(h,g)}catch(r){console.warn("Erreur lors du calcul du centroïde avec turf.js, utilisation de la méthode simple",r);let i=0,o=0,l=0;for(const h of t)h&&typeof h.lat=="number"&&typeof h.lng=="number"&&!isNaN(h.lat)&&!isNaN(h.lng)&&Math.abs(h.lat)<=90&&Math.abs(h.lng)<=180&&(i+=h.lat,o+=h.lng,l++);return l===0?(console.error("Impossible de calculer un centre valide pour le polygone"),new fn.LatLng(0,0)):new fn.LatLng(i/l,o/l)}})}getSegmentLengths(){return St.measure("Polygon.getSegmentLengths",()=>{const t=this.getLatLngs()[0],r=[];if(t.length<2)return r;for(let i=0;i<t.length;i++){const o=t[i],l=t[(i+1)%t.length];r.push(o.distanceTo(l))}return r})}}class Lo extends fn.Polyline{constructor(t,r={}){super(t,{...r,pmIgnore:!1,interactive:!0});Pt(this,"properties");Pt(this,"cachedProperties",{});Pt(this,"needsUpdate",!0);this.properties=St.measure("Line.constructor.initProperties",()=>({type:"Line",style:{...r||{},name:r.name||""}})),this.updateProperties(),this.on("add",()=>{this.updateProperties()})}updateProperties(){St.measure("Line.updateProperties",()=>{var i,o,l;const t=this.getLatLngs();if(!t||t.length<2){console.warn("Line has less than 2 points, cannot calculate properties");return}const r=t.map(h=>[h.lng,h.lat]);try{const h=El(r),g=pp(h,{units:"meters"});let v;if(t.length===2)v=fn.latLng((t[0].lat+t[1].lat)/2,(t[0].lng+t[1].lng)/2);else{const E=Tg(h,g/2,{units:"meters"});v=fn.latLng(E.geometry.coordinates[1],E.geometry.coordinates[0])}const _=10,x=((o=(i=this.properties)==null?void 0:i.style)==null?void 0:o.name)||"";this.properties={type:"Line",length:g,coordinates:t.map(E=>({lat:E.lat,lng:E.lng})),center:{lat:v.lat,lng:v.lng},vertices:t.length,surfaceInfluence:g*_,dimensions:{width:_},style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:x}},this.cachedProperties.length=g,this.cachedProperties.center=v,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.needsUpdate=!1,this.fire("properties:updated",{shape:this,properties:this.properties})}catch(h){console.error("Failed to calculate line properties",h)}})}setName(t){St.measure("Line.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return St.measure("Line.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}invalidateCache(){St.measure("Line.invalidateCache",()=>{this.needsUpdate=!0,this.cachedProperties={}})}setLatLngs(t){return super.setLatLngs(t),this.needsUpdate=!0,this.cachedProperties={},this.fire("latlngs:updated",{latlngs:this.getLatLngs()}),this}getMidPoints(){return St.measure("Line.getMidPoints",()=>{if(!this.needsUpdate&&this.cachedProperties.midPoints)return this.cachedProperties.midPoints;const t=this.getLatLngs(),r=[];if(t.length<2)return r;for(let i=0;i<t.length-1;i++){const o=t[i],l=t[i+1];if(!o||!l){console.warn("Points invalides détectés pour le segment",i);continue}r.push(fn.latLng((o.lat+l.lat)/2,(o.lng+l.lng)/2))}return this.cachedProperties.midPoints=r,r})}getMidPointAt(t){return St.measure("Line.getMidPointAt",()=>{const r=this.getLatLngs();if(t<0||t>=r.length-1||r.length<2)return null;const i=r[t],o=r[t+1];return!i||!o?(console.warn("Points invalides pour calcul du midpoint au segment",t),null):fn.latLng((i.lat+o.lat)/2,(i.lng+o.lng)/2)})}moveVertex(t,r,i=!1){St.measure("Line.moveVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length&&(o[t]=r,this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("vertex:moved",{index:t,latlng:r,allPoints:o}),i&&this.updateProperties())})}addVertex(t,r,i=!1){St.measure("Line.addVertex",()=>{const o=this.getLatLngs();t>=0&&t<o.length-1&&(o.splice(t+1,0,r),fn.Polyline.prototype.setLatLngs.call(this,o),this.needsUpdate=!0,this.cachedProperties.midPoints=void 0,this.cachedProperties.segmentLengths=void 0,this.cachedProperties.center=void 0,this.cachedProperties.length=void 0,i&&this.updateProperties())})}move(t,r=!0){return St.measure("Line.move",()=>{this.fire("move:start");const i=this.getLatLngs(),o=i.map(l=>fn.latLng(l.lat+t.lat,l.lng+t.lng));return this.setLatLngs(o),this.needsUpdate=!0,this.cachedProperties={},this.fire("move",{delta:t,newPositions:o,oldPositions:i}),r&&(this.updateProperties(),this.fire("properties:updated",{shape:this,properties:this.properties}),this.fire("move:end")),this})}getCenter(){return St.measure("Line.getCenter",()=>{if(!this.needsUpdate&&this.cachedProperties.center)return this.cachedProperties.center;const t=this.getLatLngs();if(t.length<2)return t[0]||new fn.LatLng(0,0);try{const r=t.map(g=>[g.lng,g.lat]),i=El(r),o=pp(i,{units:"meters"}),l=Tg(i,o/2,{units:"meters"}),h=fn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0]);return this.cachedProperties.center=h,h}catch(r){console.warn("Error calculating line center with turf.js, using simple method",r);const i=t.reduce((h,g)=>h+g.lat,0)/t.length,o=t.reduce((h,g)=>h+g.lng,0)/t.length,l=new fn.LatLng(i,o);return this.cachedProperties.center=l,l}})}getSegmentLengths(){return St.measure("Line.getSegmentLengths",()=>{if(!this.needsUpdate&&this.cachedProperties.segmentLengths)return this.cachedProperties.segmentLengths;const t=this.getLatLngs(),r=[];if(t.length<2)return r;for(let i=0;i<t.length-1;i++){const o=t[i],l=t[i+1];r.push(o.distanceTo(l))}return this.cachedProperties.segmentLengths=r,r})}getSegmentLengthAt(t){return St.measure("Line.getSegmentLengthAt",()=>{const r=this.getLatLngs();if(t<0||t>=r.length-1||r.length<2)return 0;const i=r[t],o=r[t+1];return i.distanceTo(o)})}getLengthToVertex(t){return St.measure("Line.getLengthToVertex",()=>{const r=this.getLatLngs();let i=0;if(t<=0||r.length<2)return 0;for(let o=0;o<Math.min(t,r.length-1);o++)i+=r[o].distanceTo(r[o+1]);return i})}getLength(){return St.measure("Line.getLength",()=>{if(!this.needsUpdate&&this.cachedProperties.length)return this.cachedProperties.length;const t=this.getLatLngs();let r=0;for(let i=0;i<t.length-1;i++)r+=t[i].distanceTo(t[i+1]);return this.cachedProperties.length=r,r})}}const wa=class wa extends Lo{constructor(t,r={}){super(t,{...r,color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});Pt(this,"elevationData",[]);Pt(this,"elevationProfile",null);Pt(this,"elevationMarker",null);Pt(this,"samplePoints",[]);Pt(this,"sampleTooltips",[]);Pt(this,"isZooming",!1);Pt(this,"simpleLine",null);Pt(this,"isDestroyed",!1);Pt(this,"zoomAnimationTimeout",null);Pt(this,"samplePointStyle",{radius:4,color:"#FF4500",fillColor:"#FF4500",fillOpacity:.6,weight:2,opacity:.8});Pt(this,"minMaxPointStyle",{radius:6,weight:3,opacity:1,fillOpacity:1});this.properties=St.measure("ElevationLine.constructor.initProperties",()=>({...this.properties,type:"ElevationLine",style:{...this.properties.style||{},name:r.name||""},elevationProfile:null,maxElevation:0,minElevation:0,elevationGain:0,elevationLoss:0,dataSource:"pending",samplePointStyle:this.samplePointStyle,minMaxPointStyle:this.minMaxPointStyle})),this.setupEventListeners()}setupEventListeners(){St.measure("ElevationLine.setupEventListeners",()=>{this.on("move",()=>this.updateElevationProfile()),this.on("add",()=>{this._map&&(this._map.on("zoomstart",this.handleZoomStart,this),this._map.on("zoomend",this.handleZoomEnd,this),this._map.on("zoomanim",this._animateZoom,this))}),this.on("remove",()=>{this.cleanupEventListeners()})})}cleanupEventListeners(){this._map&&(this._map.off("zoomstart",this.handleZoomStart,this),this._map.off("zoomend",this.handleZoomEnd,this),this._map.off("zoomanim",this._animateZoom,this)),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null)}_animateZoom(t){if(this.isDestroyed||!this._map||!this.getLatLngs().length){console.debug("[ElevationLine] Animation de zoom ignorée - ligne détruite ou carte non disponible");return}this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null);try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const r=this._path;r&&(r.style.display="none");const i=this.getLatLngs();if(i&&i.length>0&&this._map&&!this.isDestroyed&&(this.simpleLine?this.simpleLine.setLatLngs(i):this.simpleLine=fn.polyline(i,{color:"#FF4500",weight:3,opacity:.6,smoothFactor:1,interactive:!1}).addTo(this._map),this.simpleLine&&this.simpleLine._path)){const o=this.simpleLine._path.style.transform;this.simpleLine._path.style.transform="",this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this.simpleLine&&this.simpleLine._path&&(this.simpleLine._path.style.transform=o,this.simpleLine._path.style.display=""),r&&!this.isDestroyed&&(r.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(l){console.warn("[ElevationLine] Erreur lors de la restauration après animation:",l),this.cleanup()}},300)}}catch(r){console.debug("[ElevationLine] Animation de zoom ignorée:",r),this.zoomAnimationTimeout=setTimeout(()=>{if(this.isDestroyed||!this._map){this.cleanup();return}try{this._path&&(this._path.style.display=""),this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(i){console.error("[ElevationLine] Erreur lors de la restauration après animation:",i),this.cleanup()}},300)}}handleZoomStart(){this.isDestroyed||St.measure("ElevationLine.handleZoomStart",()=>{if(!(this.isZooming||!this._map)){this.isZooming=!0;try{this.clearSamplePoints(),this.elevationMarker&&this.elevationMarker.remove();const t=this._path;t&&(t.style.display="none"),this.isDestroyed||this.setStyle({opacity:.3})}catch(t){console.error("[ElevationLine] Error in handleZoomStart:",t),this.cleanup()}}})}handleZoomEnd(){this.isDestroyed||St.measure("ElevationLine.handleZoomEnd",()=>{if(!this._map){this.isZooming=!1;return}try{this.simpleLine&&this._map&&(this.simpleLine.remove(),this.simpleLine=null);const t=this._path;t&&(t.style.display=""),this.isDestroyed||this.setStyle({opacity:.8}),this.zoomAnimationTimeout&&clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=setTimeout(()=>{if(!(this.isDestroyed||!this._map))try{this._map&&this._map.hasLayer(this)&&!this.isDestroyed&&(this.redraw(),this.showSamplePoints())}catch(r){console.warn("[ElevationLine] Erreur lors du redraw après zoom:",r),this.cleanup()}},50)}catch(t){console.error("[ElevationLine] Error in handleZoomEnd:",t)}finally{this.isZooming=!1}})}cleanup(){St.measure("ElevationLine.cleanup",()=>{if(this.isZooming=!1,this.clearSamplePoints(),this.hideElevationMarker(),this.zoomAnimationTimeout&&(clearTimeout(this.zoomAnimationTimeout),this.zoomAnimationTimeout=null),this.simpleLine&&this._map){try{this.simpleLine.remove()}catch(r){console.error("[ElevationLine] Error removing simpleLine:",r)}this.simpleLine=null}if(this.elevationProfile){try{this.elevationProfile.remove()}catch(r){console.error("[ElevationLine] Error removing elevationProfile:",r)}this.elevationProfile=null}const t=this._path;t&&(t.style.display=""),!this.isDestroyed&&this._map&&this._map.hasLayer(this)&&this.setStyle({opacity:.8})})}calculateOptimalSampleCount(){return St.measure("ElevationLine.calculateOptimalSampleCount",()=>{const t=this.getLength(),r=Math.ceil(t/wa.SAMPLE_DISTANCE);return Math.min(Math.max(r,wa.MIN_SAMPLES),wa.MAX_SAMPLES)})}async fetchElevationData(t=0){return St.measure("ElevationLine.fetchElevationData",async()=>{if(this.getLatLngs().length===0)return;const i=this.getLength();let o="";const l=this.calculateOptimalSampleCount();console.log(`[ElevationLine] Using ${l} sample points for ${i.toFixed(0)}m line`);const h=[];for(let g=0;g<l;g++){const v=g/(l-1)*i,_=this.getPointAtDistance(v);_&&h.push(`${_.lat},${_.lng}`)}o=h.join("|");try{const g=await fetch(`${wa.API_URL}?locations=${o}`);if(!g.ok)throw new Error(`HTTP error ${g.status}`);const v=await g.json();if(!v.results||!Array.isArray(v.results))throw new Error("Invalid API response format");this.elevationData=v.results.map((_,x)=>({distance:x/(l-1)*i,elevation:_.elevation})),this.properties.dataSource="api"}catch(g){if(console.warn(`[ElevationLine] API fetch attempt ${t+1}/${wa.MAX_RETRIES} failed:`,g),t<wa.MAX_RETRIES)return await new Promise(v=>setTimeout(v,wa.RETRY_DELAY)),this.fetchElevationData(t+1);console.warn("[ElevationLine] All API attempts failed, falling back to simulation"),this.simulateElevationData(),this.properties.dataSource="simulation"}this.calculateElevationStatistics()})}simulateElevationData(){St.measure("ElevationLine.simulateElevationData",()=>{const t=this.getLength(),r=this.calculateOptimalSampleCount();this.elevationData=Array.from({length:r},(i,o)=>{const l=o/(r-1)*t,h=100+Math.sin(l/t*Math.PI*2)*50;return{distance:l,elevation:h}})})}calculateElevationStatistics(){St.measure("ElevationLine.calculateElevationStatistics",()=>{if(!this.elevationData.length)return;const t=this.elevationData.map(_=>_.elevation),r=t.length?Math.max(...t):0,i=t.length?Math.min(...t):0;let o=0,l=0,h=0,g=0,v=0;console.log("[ElevationLine][calculateElevationStatistics] Données brutes:",{elevationsCount:t.length,maxElevation:r,minElevation:i});for(let _=1;_<this.elevationData.length;_++){const x=this.elevationData[_-1],E=this.elevationData[_],b=E.elevation-x.elevation;b>0?o+=b:l+=Math.abs(b);const R=E.distance-x.distance;if(R>0){const $=b/R*100;h=Math.max(h,Math.abs($)),g+=Math.abs($),v++}}console.log("[ElevationLine][calculateElevationStatistics] Calculs intermédiaires:",{gain:o,loss:l,maxSlope:h,averageSlope:v>0?g/v:0}),this.properties={...this.properties,type:"ElevationLine",maxElevation:r,minElevation:i,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:v>0?g/v:0,elevationData:this.elevationData,dataSource:this.properties.dataSource,length:this.getLength()},console.log("[ElevationLine][calculateElevationStatistics] Propriétés mises à jour:",this.properties)})}showSamplePoints(){St.measure("ElevationLine.showSamplePoints",()=>{if(this.clearSamplePoints(),!this.elevationData.length)return;const t=this.elevationData.map(o=>o.elevation),r=Math.max(...t),i=Math.min(...t);this.elevationData.forEach(o=>{const l=this.getPointAtDistance(o.distance);if(!l)return;const h=o.elevation===i,g=o.elevation===r;let v={...this.samplePointStyle};h?v={...v,...this.minMaxPointStyle,color:"#DC2626",fillColor:"#DC2626"}:g&&(v={...v,...this.minMaxPointStyle,color:"#059669",fillColor:"#059669"});const _=fn.circleMarker(l,v),x=fn.tooltip({permanent:!1,direction:"top",className:"elevation-tooltip",offset:[0,-10]});let E=`
          Distance: ${this.formatDistance(o.distance)}<br>
          Altitude: ${this.formatElevation(o.elevation)}
        `;h&&(E+="<br><strong>Point le plus bas</strong>"),g&&(E+="<br><strong>Point le plus haut</strong>"),x.setContent(E),_.on("mouseover",()=>{_.setStyle({...v,radius:v.radius+2,fillOpacity:1}),_.bindTooltip(x).openTooltip()}),_.on("mouseout",()=>{_.setStyle(v),_.closeTooltip()}),this._map&&(_.addTo(this._map),this.samplePoints.push(_),this.sampleTooltips.push(x))})})}clearSamplePoints(){St.measure("ElevationLine.clearSamplePoints",()=>{this.samplePoints.forEach(t=>t.remove()),this.samplePoints=[],this.sampleTooltips.forEach(t=>t.remove()),this.sampleTooltips=[]})}formatDistance(t){return St.measure("ElevationLine.formatDistance",()=>t>=1e3?`${(t/1e3).toFixed(2)} km`:`${t.toFixed(0)} m`)}formatElevation(t){return St.measure("ElevationLine.formatElevation",()=>`${t.toFixed(0)} m`)}onAdd(t){return St.measure("ElevationLine.onAdd",()=>(super.onAdd(t),this.showSamplePoints(),this))}onRemove(t){return this.isDestroyed=!0,this.cleanupEventListeners(),this.cleanup(),super.onRemove(t)}async updateElevationProfile(){return St.measure("ElevationLine.updateElevationProfile",async()=>{try{if(this.properties.elevationData&&this.properties.dataSource==="restored"){this.elevationData=this.properties.elevationData,this.calculateElevationStatistics(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties});return}await this.fetchElevationData(),this.updateProperties(),this._map&&this._map.hasLayer(this)&&this.showSamplePoints(),this.fire("elevation:updated",{shape:this,elevationData:this.elevationData,properties:this.properties})}catch(t){console.error("[ElevationLine] Erreur lors de la mise à jour du profil d'élévation:",t),this.properties.dataSource="error"}})}updateProperties(){St.measure("ElevationLine.updateProperties",()=>{if(super.updateProperties(),this.elevationData&&this.elevationData.length>0){const t=this.elevationData.map(E=>E.elevation),r=Math.max(...t),i=Math.min(...t);let o=0,l=0,h=0,g=0,v=0;for(let E=1;E<this.elevationData.length;E++){const b=this.elevationData[E-1],R=this.elevationData[E],$=R.elevation-b.elevation;$>0?o+=$:l+=Math.abs($);const Q=R.distance-b.distance;if(Q>0){const I=$/Q*100;h=Math.max(h,Math.abs(I)),g+=Math.abs(I),v++}}const x=this.getLatLngs().map(E=>({lat:E.lat,lng:E.lng}));this.properties={...this.properties,type:"ElevationLine",coordinates:x,elevationData:this.elevationData.map(E=>({distance:E.distance,elevation:E.elevation})),maxElevation:r,minElevation:i,elevationGain:o,elevationLoss:l,maxSlope:h,averageSlope:v>0?g/v:0,dataSource:this.properties.dataSource||"api"},this.fire("properties:updated",{shape:this,properties:this.properties})}})}getElevationData(){return St.measure("ElevationLine.getElevationData",()=>this.elevationData)}showElevationAt(t){St.measure("ElevationLine.showElevationAt",()=>{if(!(!this.elevationData.length||!this._map))try{const r=this.elevationData.reduce((o,l)=>Math.abs(l.distance-t)<Math.abs(o.distance-t)?l:o),i=this.getPointAtDistance(t);if(!i)return;this.elevationMarker?(this.elevationMarker.setLatLng(i),this.elevationMarker.setTooltipContent(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`)):(this.elevationMarker=fn.circleMarker(i,{radius:6,color:"#FF4500",fillColor:"#FF4500",fillOpacity:1,weight:2,className:"elevation-marker"}),this.elevationMarker.bindTooltip(`Distance: ${this.formatDistance(r.distance)}<br>Altitude: ${this.formatElevation(r.elevation)}`,{permanent:!0,direction:"top",offset:[0,-10],className:"elevation-marker-tooltip"}),this._map&&this._map.hasLayer(this)&&this.elevationMarker.addTo(this._map)),this.fire("elevation:show",{distance:t,elevation:r.elevation,latLng:i})}catch(r){console.error("[ElevationLine] Erreur lors de l'affichage de l'élévation:",r),this.hideElevationMarker()}})}hideElevationMarker(){St.measure("ElevationLine.hideElevationMarker",()=>{this.elevationMarker&&(this.elevationMarker.remove(),this.elevationMarker=null)})}getPointAtDistance(t){return St.measure("ElevationLine.getPointAtDistance",()=>{try{const i=this.getLatLngs().map(h=>[h.lng,h.lat]),o=El(i),l=Tg(o,t,{units:"meters"});return fn.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0])}catch(r){return console.error("Error calculating point at distance",r),null}})}moveVertex(t,r,i=!1){St.measure("ElevationLine.moveVertex",()=>{super.moveVertex(t,r,!1),this.properties.type="ElevationLine",i&&this.updateElevationProfile()})}addVertex(t,r,i=!1){St.measure("ElevationLine.addVertex",()=>{console.warn("[ElevationLine] Tentative d'ajout de vertex ignorée - non autorisé pour un profil altimétrique")})}setLatLngs(t){return St.measure("ElevationLine.setLatLngs",()=>(super.setLatLngs(t),this.properties.type="ElevationLine",this.updateElevationProfile(),this))}move(t,r=!0){return St.measure("ElevationLine.move",()=>(super.move(t,!1),this.properties.type="ElevationLine",r&&this.updateElevationProfile(),this))}setSamplePointStyle(t){St.measure("ElevationLine.setSamplePointStyle",()=>{this.samplePointStyle={...this.samplePointStyle,...t},this.properties.samplePointStyle=this.samplePointStyle,this._map&&this.showSamplePoints()})}setMinMaxPointStyle(t){St.measure("ElevationLine.setMinMaxPointStyle",()=>{this.minMaxPointStyle={...this.minMaxPointStyle,...t},this.properties.minMaxPointStyle=this.minMaxPointStyle,this._map&&this.showSamplePoints()})}setName(t){St.measure("ElevationLine.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return St.measure("ElevationLine.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}};Pt(wa,"API_URL","https://api.open-elevation.com/api/v1/lookup"),Pt(wa,"RETRY_DELAY",2e3),Pt(wa,"MAX_RETRIES",3),Pt(wa,"SAMPLE_DISTANCE",100),Pt(wa,"MIN_SAMPLES",10),Pt(wa,"MAX_SAMPLES",50);let lh=wa;class wu extends fn.Polygon{constructor(t,r,i=0,o=180,l={}){super([[]],{...l,pmIgnore:!1,interactive:!0,className:"leaflet-semicircle"});Pt(this,"center");Pt(this,"radius");Pt(this,"startAngle");Pt(this,"stopAngle");Pt(this,"numPoints");Pt(this,"properties");Pt(this,"pm");Pt(this,"getRadius",()=>this.radius);Pt(this,"getStartAngle",()=>this.startAngle);Pt(this,"getStopAngle",()=>this.stopAngle);this.center=t,this.radius=r,this.startAngle=this.normalizeAngle(i),this.stopAngle=this.normalizeAngle(o),this.numPoints=64,this.properties=St.measure("CircleArc.constructor.initProperties",()=>({type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,style:{...l,startAngle:this.startAngle,stopAngle:this.stopAngle,name:l.name||""}})),this.on("pm:enable",()=>{var h;this.pm&&(this.pm._layers=[],this.pm._markers=[],(h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("pm:vertexadded",()=>{var h;this.pm&&((h=this.pm._markerGroup)==null||h.clearLayers())}),this.on("add",()=>{this._map&&(this.updateGeometry(),this.pm&&this.pm.enable({allowSelfIntersection:!1,preventMarkerRemoval:!0}))}),this.updateProperties()}normalizeAngle(t){return St.measure("CircleArc.normalizeAngle",()=>(t%360+360)%360)}calculateArcPoints(){return St.measure("CircleArc.calculateArcPoints",()=>{if(!this._map)return[];const t=[],r=this.getOpeningAngle();t.push(this.center);for(let i=0;i<=this.numPoints;i++){const l=(this.startAngle+r*i/this.numPoints)*Math.PI/180,h=this.radius*Math.cos(l),v=this.radius*Math.sin(l)/111319.9,_=h/(111319.9*Math.cos(this.center.lat*Math.PI/180)),x=fn.latLng(this.center.lat+v,this.center.lng+_);t.push(x)}return t.push(this.center),t})}setRadius(t){return St.measure("CircleArc.setRadius",()=>t<=0?this:(this.radius=t,this.properties.radius=t,this.updateGeometry(),this.updateProperties(),this))}setAngles(t,r){return St.measure("CircleArc.setAngles",()=>{const i=this.normalizeAngle(t),o=this.normalizeAngle(r),l=this.getOpeningAngle();let h=(o-i+360)%360;const g=45;return Math.abs(h-l)>g&&(h>l?h=l+g:h=l-g),h=Math.max(5,Math.min(355,h)),this.startAngle===t?this.stopAngle=(this.startAngle+h)%360:(this.startAngle=i,this.stopAngle=(i+h)%360),this.properties.startAngle=this.startAngle,this.properties.stopAngle=this.stopAngle,this.properties.openingAngle=h,this.properties.style.startAngle=this.startAngle,this.properties.style.stopAngle=this.stopAngle,this.updateGeometry(),this})}setOpeningAngle(t){return St.measure("CircleArc.setOpeningAngle",()=>t<5||t>355?this:(this.stopAngle=(this.startAngle+t)%360,this.properties.openingAngle=t,this.updateGeometry(),this.updateProperties(),this))}setCenter(t){return St.measure("CircleArc.setCenter",()=>!t.lat||!t.lng?this:(this.center=t,this.updateGeometry(),this.updateProperties(),this))}getCenter(){return St.measure("CircleArc.getCenter",()=>this.center)}getOpeningAngle(){return St.measure("CircleArc.getOpeningAngle",()=>(this.stopAngle-this.startAngle+360)%360)}calculatePointOnArc(t){return St.measure("CircleArc.calculatePointOnArc",()=>{const r=t*Math.PI/180,i=this.radius*Math.cos(r),l=this.radius*Math.sin(r)/111319.9,h=i/(111319.9*Math.cos(this.center.lat*Math.PI/180));return fn.latLng(this.center.lat+l,this.center.lng+h)})}calculateMidpointPosition(){return St.measure("CircleArc.calculateMidpointPosition",()=>{const t=this.getOpeningAngle(),r=(this.startAngle+t/2)%360;return this.calculatePointOnArc(r)})}calculateAngleToPoint(t){return St.measure("CircleArc.calculateAngleToPoint",()=>Math.atan2(t.lat-this.center.lat,t.lng-this.center.lng)*180/Math.PI)}createControlPoints(t,r){St.measure("CircleArc.createControlPoints",()=>{const i=[],o=this.calculatePointOnArc(this.startAngle),l=this.calculatePointOnArc(this.stopAngle),h=this.calculateMidpointPosition(),g=this.createControlPoint(t,this.center,"#059669"),v=this.createControlPoint(t,o,"#DC2626"),_=this.createControlPoint(t,l,"#DC2626"),x=this.createControlPoint(t,h,"#2563EB");i.push(g,v,_,x),r(i)})}createControlPoint(t,r,i){return St.measure("CircleArc.createControlPoint",()=>fn.circleMarker(r,{radius:6,color:i,fillColor:i,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0}).addTo(t))}updateProperties(){St.measure("CircleArc.updateProperties",()=>{var l,h,g,v;const t=this.getOpeningAngle(),r=Math.PI*Math.pow(this.radius,2)*t/360,i=2*Math.PI*this.radius*t/360,o=i+2*this.radius;console.log(`
Mise à jour des propriétés du secteur de cercle:`),console.log(`- Rayon: ${this.radius.toFixed(2)}m`),console.log(`- Angle d'ouverture: ${t.toFixed(2)}°`),console.log(`- Surface calculée: ${r.toFixed(2)}m²`),console.log(`- Longueur d'arc: ${i.toFixed(2)}m`),console.log(`- Périmètre total: ${o.toFixed(2)}m`),this.properties={type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,surface:r,arcLength:i,perimeter:o,openingAngle:t,diameter:this.radius*2,center:{lat:this.center.lat,lng:this.center.lng},style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((v=(g=this.properties)==null?void 0:g.style)==null?void 0:v.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}updateGeometry(){St.measure("CircleArc.updateGeometry",()=>{if(!this._map)return;const t=this.calculateArcPoints();t.length>0&&(this.setLatLngs([t]),this.updateProperties())})}toGeoJSON(){return St.measure("CircleArc.toGeoJSON",()=>{const t=super.toGeoJSON();return{...t,properties:{...t.properties,type:"Semicircle",radius:this.radius,startAngle:this.startAngle,stopAngle:this.stopAngle,openingAngle:this.getOpeningAngle()}}})}setName(t){St.measure("CircleArc.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return St.measure("CircleArc.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}}var gp={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */gp.exports;(function(e,n){(function(){var t,r="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",v=500,_="__lodash_placeholder__",x=1,E=2,b=4,R=1,$=2,Q=1,I=2,W=4,ge=8,Se=16,De=32,Ye=64,Ve=128,O=256,K=512,ce=30,H="...",D=800,V=16,z=1,U=2,G=3,ue=1/0,ie=9007199254740991,Ae=17976931348623157e292,Me=NaN,st=4294967295,X=st-1,Ee=st>>>1,N=[["ary",Ve],["bind",Q],["bindKey",I],["curry",ge],["curryRight",Se],["flip",K],["partial",De],["partialRight",Ye],["rearg",O]],Z="[object Arguments]",he="[object Array]",ne="[object AsyncFunction]",te="[object Boolean]",ee="[object Date]",se="[object DOMException]",Pe="[object Error]",oe="[object Function]",re="[object GeneratorFunction]",xe="[object Map]",ye="[object Number]",le="[object Null]",Ue="[object Object]",Ie="[object Promise]",Ce="[object Proxy]",qe="[object RegExp]",Re="[object Set]",rt="[object String]",Ze="[object Symbol]",gt="[object Undefined]",_t="[object WeakMap]",$t="[object WeakSet]",tn="[object ArrayBuffer]",Qe="[object DataView]",Yt="[object Float32Array]",Qt="[object Float64Array]",Zt="[object Int8Array]",wt="[object Int16Array]",He="[object Int32Array]",Kt="[object Uint8Array]",on="[object Uint8ClampedArray]",Bn="[object Uint16Array]",kn="[object Uint32Array]",et=/\b__p \+= '';/g,On=/\b(__p \+=) '' \+/g,Nn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mn=/&(?:amp|lt|gt|quot|#39);/g,Pn=/[&<>"']/g,zr=RegExp(mn.source),Gn=RegExp(Pn.source),Dt=/<%-([\s\S]+?)%>/g,xr=/<%([\s\S]+?)%>/g,lr=/<%=([\s\S]+?)%>/g,hi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ri=/^\w*$/,Fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xi=/[\\^$.*+?()[\]{}|]/g,Lr=RegExp(xi.source),Gr=/^\s+/,Qn=/\s/,kt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ei=/\{\n\/\* \[wrapped with (.+)\] \*/,Ai=/,? & /,fi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ei=/[()=,{}\[\]\/\s]/,Di=/\\(\\)?/g,Qi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Yn=/\w*$/,Mi=/^[-+]0x[0-9a-f]+$/i,Xs=/^0b[01]+$/i,Ps=/^\[object .+?Constructor\]$/,Tr=/^0o[0-7]+$/i,Cn=/^(?:0|[1-9]\d*)$/,di=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Dr=/($^)/,si=/['\n\r\u2028\u2029\\]/g,mi="\\ud800-\\udfff",Es="\\u0300-\\u036f",is="\\ufe20-\\ufe2f",pr="\\u20d0-\\u20ff",fo=Es+is+pr,ti="\\u2700-\\u27bf",ki="a-z\\xdf-\\xf6\\xf8-\\xff",Br="\\xac\\xb1\\xd7\\xf7",_n="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xt="\\u2000-\\u206f",Tn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",In="A-Z\\xc0-\\xd6\\xd8-\\xde",Oi="\\ufe0e\\ufe0f",es=Br+_n+Xt+Tn,ss="['’]",ps="["+mi+"]",tr="["+es+"]",pn="["+fo+"]",pi="\\d+",$r="["+ti+"]",oi="["+ki+"]",Qs="[^"+mi+es+pi+ti+ki+In+"]",Ao="\\ud83c[\\udffb-\\udfff]",oo="(?:"+pn+"|"+Ao+")",vi="[^"+mi+"]",As="(?:\\ud83c[\\udde6-\\uddff]){2}",ao="[\\ud800-\\udbff][\\udc00-\\udfff]",os="["+In+"]",Ea="\\u200d",jr="(?:"+oi+"|"+Qs+")",lo="(?:"+os+"|"+Qs+")",Li="(?:"+ss+"(?:d|ll|m|re|s|t|ve))?",Vo="(?:"+ss+"(?:D|LL|M|RE|S|T|VE))?",ca=oo+"?",Wa="["+Oi+"]?",ts="(?:"+Ea+"(?:"+[vi,As,ao].join("|")+")"+Wa+ca+")*",ru="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ir=Wa+ca+ts,ur="(?:"+[$r,As,ao].join("|")+")"+ir,po="(?:"+[vi+pn+"?",pn,As,ao,ps].join("|")+")",Or=RegExp(ss,"g"),Nl=RegExp(pn,"g"),Aa=RegExp(Ao+"(?="+Ao+")|"+po+ir,"g"),Ma=RegExp([os+"?"+oi+"+"+Li+"(?="+[tr,os,"$"].join("|")+")",lo+"+"+Vo+"(?="+[tr,os+jr,"$"].join("|")+")",os+"?"+jr+"+"+Li,os+"+"+Vo,hl,ru,pi,ur].join("|"),"g"),go=RegExp("["+Ea+mi+fo+Oi+"]"),ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Za=-1,or={};or[Yt]=or[Qt]=or[Zt]=or[wt]=or[He]=or[Kt]=or[on]=or[Bn]=or[kn]=!0,or[Z]=or[he]=or[tn]=or[te]=or[Qe]=or[ee]=or[Pe]=or[oe]=or[xe]=or[ye]=or[Ue]=or[qe]=or[Re]=or[rt]=or[_t]=!1;var _r={};_r[Z]=_r[he]=_r[tn]=_r[Qe]=_r[te]=_r[ee]=_r[Yt]=_r[Qt]=_r[Zt]=_r[wt]=_r[He]=_r[xe]=_r[ye]=_r[Ue]=_r[qe]=_r[Re]=_r[rt]=_r[Ze]=_r[Kt]=_r[on]=_r[Bn]=_r[kn]=!0,_r[Pe]=_r[oe]=_r[_t]=!1;var fa={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},iu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ka={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ka=parseFloat,Ja=parseInt,dl=typeof qo=="object"&&qo&&qo.Object===Object&&qo,Sr=typeof self=="object"&&self&&self.Object===Object&&self,Ii=dl||Sr||Function("return this")(),Wn=n&&!n.nodeType&&n,Fi=Wn&&!0&&e&&!e.nodeType&&e,Ta=Fi&&Fi.exports===Wn,Go=Ta&&dl.process,yi=function(){try{var bt=Fi&&Fi.require&&Fi.require("util").types;return bt||Go&&Go.binding&&Go.binding("util")}catch{}}(),pl=yi&&yi.isArrayBuffer,Mo=yi&&yi.isDate,Ya=yi&&yi.isMap,Xa=yi&&yi.isRegExp,uo=yi&&yi.isSet,Qa=yi&&yi.isTypedArray;function Zr(bt,qt,Bt){switch(Bt.length){case 0:return bt.call(qt);case 1:return bt.call(qt,Bt[0]);case 2:return bt.call(qt,Bt[0],Bt[1]);case 3:return bt.call(qt,Bt[0],Bt[1],Bt[2])}return bt.apply(qt,Bt)}function su(bt,qt,Bt,wn){for(var zn=-1,sr=bt==null?0:bt.length;++zn<sr;){var _i=bt[zn];qt(wn,_i,Bt(_i),bt)}return wn}function as(bt,qt){for(var Bt=-1,wn=bt==null?0:bt.length;++Bt<wn&&qt(bt[Bt],Bt,bt)!==!1;);return bt}function mo(bt,qt){for(var Bt=bt==null?0:bt.length;Bt--&&qt(bt[Bt],Bt,bt)!==!1;);return bt}function el(bt,qt){for(var Bt=-1,wn=bt==null?0:bt.length;++Bt<wn;)if(!qt(bt[Bt],Bt,bt))return!1;return!0}function vo(bt,qt){for(var Bt=-1,wn=bt==null?0:bt.length,zn=0,sr=[];++Bt<wn;){var _i=bt[Bt];qt(_i,Bt,bt)&&(sr[zn++]=_i)}return sr}function Ba(bt,qt){var Bt=bt==null?0:bt.length;return!!Bt&&ln(bt,qt,0)>-1}function Na(bt,qt,Bt){for(var wn=-1,zn=bt==null?0:bt.length;++wn<zn;)if(Bt(qt,bt[wn]))return!0;return!1}function Kr(bt,qt){for(var Bt=-1,wn=bt==null?0:bt.length,zn=Array(wn);++Bt<wn;)zn[Bt]=qt(bt[Bt],Bt,bt);return zn}function eo(bt,qt){for(var Bt=-1,wn=qt.length,zn=bt.length;++Bt<wn;)bt[zn+Bt]=qt[Bt];return bt}function Ho(bt,qt,Bt,wn){var zn=-1,sr=bt==null?0:bt.length;for(wn&&sr&&(Bt=bt[++zn]);++zn<sr;)Bt=qt(Bt,bt[zn],zn,bt);return Bt}function zi(bt,qt,Bt,wn){var zn=bt==null?0:bt.length;for(wn&&zn&&(Bt=bt[--zn]);zn--;)Bt=qt(Bt,bt[zn],zn,bt);return Bt}function A(bt,qt){for(var Bt=-1,wn=bt==null?0:bt.length;++Bt<wn;)if(qt(bt[Bt],Bt,bt))return!0;return!1}var de=nr("length");function We(bt){return bt.split("")}function ut(bt){return bt.match(fi)||[]}function Ct(bt,qt,Bt){var wn;return Bt(bt,function(zn,sr,_i){if(qt(zn,sr,_i))return wn=sr,!1}),wn}function zt(bt,qt,Bt,wn){for(var zn=bt.length,sr=Bt+(wn?1:-1);wn?sr--:++sr<zn;)if(qt(bt[sr],sr,bt))return sr;return-1}function ln(bt,qt,Bt){return qt===qt?ns(bt,qt,Bt):zt(bt,En,Bt)}function Ln(bt,qt,Bt,wn){for(var zn=Bt-1,sr=bt.length;++zn<sr;)if(wn(bt[zn],qt))return zn;return-1}function En(bt){return bt!==bt}function Hn(bt,qt){var Bt=bt==null?0:bt.length;return Bt?Jr(bt,qt)/Bt:Me}function nr(bt){return function(qt){return qt==null?t:qt[bt]}}function mr(bt){return function(qt){return bt==null?t:bt[qt]}}function gi(bt,qt,Bt,wn,zn){return zn(bt,function(sr,_i,Yr){Bt=wn?(wn=!1,sr):qt(Bt,sr,_i,Yr)}),Bt}function qr(bt,qt){var Bt=bt.length;for(bt.sort(qt);Bt--;)bt[Bt]=bt[Bt].value;return bt}function Jr(bt,qt){for(var Bt,wn=-1,zn=bt.length;++wn<zn;){var sr=qt(bt[wn]);sr!==t&&(Bt=Bt===t?sr:Bt+sr)}return Bt}function ji(bt,qt){for(var Bt=-1,wn=Array(bt);++Bt<bt;)wn[Bt]=qt(Bt);return wn}function Hi(bt,qt){return Kr(qt,function(Bt){return[Bt,bt[Bt]]})}function to(bt){return bt&&bt.slice(0,Zo(bt)+1).replace(Gr,"")}function vr(bt){return function(qt){return bt(qt)}}function gs(bt,qt){return Kr(qt,function(Bt){return bt[Bt]})}function Ra(bt,qt){return bt.has(qt)}function Ms(bt,qt){for(var Bt=-1,wn=bt.length;++Bt<wn&&ln(qt,bt[Bt],0)>-1;);return Bt}function gl(bt,qt){for(var Bt=bt.length;Bt--&&ln(qt,bt[Bt],0)>-1;);return Bt}function ko(bt,qt){for(var Bt=bt.length,wn=0;Bt--;)bt[Bt]===qt&&++wn;return wn}var Dl=mr(fa),da=mr(iu);function pa(bt){return"\\"+fl[bt]}function Wi(bt,qt){return bt==null?t:bt[qt]}function To(bt){return go.test(bt)}function no(bt){return ha.test(bt)}function Fs(bt){for(var qt,Bt=[];!(qt=bt.next()).done;)Bt.push(qt.value);return Bt}function Da(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(wn,zn){Bt[++qt]=[zn,wn]}),Bt}function ms(bt,qt){return function(Bt){return bt(qt(Bt))}}function ks(bt,qt){for(var Bt=-1,wn=bt.length,zn=0,sr=[];++Bt<wn;){var _i=bt[Bt];(_i===qt||_i===_)&&(bt[Bt]=_,sr[zn++]=Bt)}return sr}function Ts(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(wn){Bt[++qt]=wn}),Bt}function ou(bt){var qt=-1,Bt=Array(bt.size);return bt.forEach(function(wn){Bt[++qt]=[wn,wn]}),Bt}function ns(bt,qt,Bt){for(var wn=Bt-1,zn=bt.length;++wn<zn;)if(bt[wn]===qt)return wn;return-1}function Wo(bt,qt,Bt){for(var wn=Bt+1;wn--;)if(bt[wn]===qt)return wn;return wn}function vs(bt){return To(bt)?_s(bt):de(bt)}function ys(bt){return To(bt)?ls(bt):We(bt)}function Zo(bt){for(var qt=bt.length;qt--&&Qn.test(bt.charAt(qt)););return qt}var Ko=mr(Ka);function _s(bt){for(var qt=Aa.lastIndex=0;Aa.test(bt);)++qt;return qt}function ls(bt){return bt.match(Aa)||[]}function Bo(bt){return bt.match(Ma)||[]}var ro=function bt(qt){qt=qt==null?Ii:bs.defaults(Ii.Object(),qt,bs.pick(Ii,Rl));var Bt=qt.Array,wn=qt.Date,zn=qt.Error,sr=qt.Function,_i=qt.Math,Yr=qt.Object,tl=qt.RegExp,Bs=qt.String,bi=qt.TypeError,No=Bt.prototype,Jo=sr.prototype,Ro=Yr.prototype,Do=qt["__core-js_shared__"],Oo=Jo.toString,Cr=Ro.hasOwnProperty,yo=0,us=function(){var u=/[^.]+$/.exec(Do&&Do.keys&&Do.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Xr=Ro.toString,ni=Oo.call(Yr),Ui=Ii._,li=tl("^"+Oo.call(Cr).replace(xi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=Ta?qt.Buffer:t,zs=qt.Symbol,co=qt.Uint8Array,Ol=io?io.allocUnsafe:t,Io=ms(Yr.getPrototypeOf,Yr),Zi=Yr.create,ai=Ro.propertyIsEnumerable,ws=No.splice,js=zs?zs.isConcatSpreadable:t,er=zs?zs.iterator:t,Yo=zs?zs.toStringTag:t,Xo=function(){try{var u=Oc(Yr,"defineProperty");return u({},"",{}),u}catch{}}(),_o=qt.clearTimeout!==Ii.clearTimeout&&qt.clearTimeout,Ns=wn&&wn.now!==Ii.Date.now&&wn.now,ku=qt.setTimeout!==Ii.setTimeout&&qt.setTimeout,cs=_i.ceil,hs=_i.floor,bo=Yr.getOwnPropertySymbols,s=io?io.isBuffer:t,f=qt.isFinite,w=No.join,T=ms(Yr.keys,Yr),J=_i.max,_e=_i.min,ot=wn.now,Tt=qt.parseInt,jt=_i.random,rn=No.reverse,Sn=Oc(qt,"DataView"),$n=Oc(qt,"Map"),gr=Oc(qt,"Promise"),Ki=Oc(qt,"Set"),Ti=Oc(qt,"WeakMap"),fs=Oc(Yr,"create"),wi=Ti&&new Ti,Us={},Tu=Ic(Sn),Fo=Ic($n),wo=Ic(gr),ho=Ic(Ki),Mc=Ic(Ti),ml=zs?zs.prototype:t,Hr=ml?ml.valueOf:t,xs=ml?ml.toString:t;function Te(u){if(Rs(u)&&!Er(u)&&!(u instanceof yr)){if(u instanceof ds)return u;if(Cr.call(u,"__wrapped__"))return n1(u)}return new ds(u)}var $s=function(){function u(){}return function(d){if(!Ss(d))return{};if(Zi)return Zi(d);u.prototype=d;var P=new u;return u.prototype=t,P}}();function Il(){}function ds(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}Te.templateSettings={escape:Dt,evaluate:xr,interpolate:lr,variable:"",imports:{_:Te}},Te.prototype=Il.prototype,Te.prototype.constructor=Te,ds.prototype=$s(Il.prototype),ds.prototype.constructor=ds;function yr(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=st,this.__views__=[]}function ec(){var u=new yr(this.__wrapped__);return u.__actions__=Ia(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Ia(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Ia(this.__views__),u}function hh(){if(this.__filtered__){var u=new yr(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function tc(){var u=this.__wrapped__.value(),d=this.__dir__,P=Er(u),j=d<0,me=P?u.length:0,Fe=l5(0,me,this.__views__),it=Fe.start,pt=Fe.end,Mt=pt-it,sn=j?pt:it-1,an=this.__iteratees__,dn=an.length,Mn=0,Zn=_e(Mt,this.__takeCount__);if(!P||!j&&me==Mt&&Zn==Mt)return vl(u,this.__actions__);var cr=[];e:for(;Mt--&&Mn<Zn;){sn+=d;for(var Ur=-1,hr=u[sn];++Ur<dn;){var Qr=an[Ur],ii=Qr.iteratee,il=Qr.type,ya=ii(hr);if(il==U)hr=ya;else if(!ya){if(il==z)continue e;break e}}cr[Mn++]=hr}return cr}yr.prototype=$s(Il.prototype),yr.prototype.constructor=yr;function ga(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function Bu(){this.__data__=fs?fs(null):{},this.size=0}function kc(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function Qh(u){var d=this.__data__;if(fs){var P=d[u];return P===g?t:P}return Cr.call(d,u)?d[u]:t}function au(u){var d=this.__data__;return fs?d[u]!==t:Cr.call(d,u)}function nc(u,d){var P=this.__data__;return this.size+=this.has(u)?0:1,P[u]=fs&&d===t?g:d,this}ga.prototype.clear=Bu,ga.prototype.delete=kc,ga.prototype.get=Qh,ga.prototype.has=au,ga.prototype.set=nc;function nl(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function ef(){this.__data__=[],this.size=0}function rc(u){var d=this.__data__,P=yt(d,u);if(P<0)return!1;var j=d.length-1;return P==j?d.pop():ws.call(d,P,1),--this.size,!0}function ic(u){var d=this.__data__,P=yt(d,u);return P<0?t:d[P][1]}function fh(u){return yt(this.__data__,u)>-1}function dh(u,d){var P=this.__data__,j=yt(P,u);return j<0?(++this.size,P.push([u,d])):P[j][1]=d,this}nl.prototype.clear=ef,nl.prototype.delete=rc,nl.prototype.get=ic,nl.prototype.has=fh,nl.prototype.set=dh;function Qo(u){var d=-1,P=u==null?0:u.length;for(this.clear();++d<P;){var j=u[d];this.set(j[0],j[1])}}function ph(){this.size=0,this.__data__={hash:new ga,map:new($n||nl),string:new ga}}function gh(u){var d=hd(this,u).delete(u);return this.size-=d?1:0,d}function mh(u){return hd(this,u).get(u)}function m(u){return hd(this,u).has(u)}function C(u,d){var P=hd(this,u),j=P.size;return P.set(u,d),this.size+=P.size==j?0:1,this}Qo.prototype.clear=ph,Qo.prototype.delete=gh,Qo.prototype.get=mh,Qo.prototype.has=m,Qo.prototype.set=C;function B(u){var d=-1,P=u==null?0:u.length;for(this.__data__=new Qo;++d<P;)this.add(u[d])}function Y(u){return this.__data__.set(u,g),this}function pe(u){return this.__data__.has(u)}B.prototype.add=B.prototype.push=Y,B.prototype.has=pe;function be(u){var d=this.__data__=new nl(u);this.size=d.size}function Le(){this.__data__=new nl,this.size=0}function ke(u){var d=this.__data__,P=d.delete(u);return this.size=d.size,P}function Be(u){return this.__data__.get(u)}function Ge(u){return this.__data__.has(u)}function ht(u,d){var P=this.__data__;if(P instanceof nl){var j=P.__data__;if(!$n||j.length<i-1)return j.push([u,d]),this.size=++P.size,this;P=this.__data__=new Qo(j)}return P.set(u,d),this.size=P.size,this}be.prototype.clear=Le,be.prototype.delete=ke,be.prototype.get=Be,be.prototype.has=Ge,be.prototype.set=ht;function Ot(u,d){var P=Er(u),j=!P&&Fc(u),me=!P&&!j&&oc(u),Fe=!P&&!j&&!me&&Ch(u),it=P||j||me||Fe,pt=it?ji(u.length,Bs):[],Mt=pt.length;for(var sn in u)(d||Cr.call(u,sn))&&!(it&&(sn=="length"||me&&(sn=="offset"||sn=="parent")||Fe&&(sn=="buffer"||sn=="byteLength"||sn=="byteOffset")||Fu(sn,Mt)))&&pt.push(sn);return pt}function It(u){var d=u.length;return d?u[Nc(0,d-1)]:t}function Lt(u,d){return fd(Ia(u),qn(d,0,u.length))}function Vt(u){return fd(Ia(u))}function Ut(u,d,P){(P!==t&&!ql(u[d],P)||P===t&&!(d in u))&&xn(u,d,P)}function ft(u,d,P){var j=u[d];(!(Cr.call(u,d)&&ql(j,P))||P===t&&!(d in u))&&xn(u,d,P)}function yt(u,d){for(var P=u.length;P--;)if(ql(u[P][0],d))return P;return-1}function Jt(u,d,P,j){return k(u,function(me,Fe,it){d(j,me,P(me),it)}),j}function cn(u,d){return u&&cu(d,xo(d),u)}function en(u,d){return u&&cu(d,za(d),u)}function xn(u,d,P){d=="__proto__"&&Xo?Xo(u,d,{configurable:!0,enumerable:!0,value:P,writable:!0}):u[d]=P}function bn(u,d){for(var P=-1,j=d.length,me=Bt(j),Fe=u==null;++P<j;)me[P]=Fe?t:f0(u,d[P]);return me}function qn(u,d,P){return u===u&&(P!==t&&(u=u<=P?u:P),d!==t&&(u=u>=d?u:d)),u}function a(u,d,P,j,me,Fe){var it,pt=d&x,Mt=d&E,sn=d&b;if(P&&(it=me?P(u,j,me,Fe):P(u)),it!==t)return it;if(!Ss(u))return u;var an=Er(u);if(an){if(it=c5(u),!pt)return Ia(u,it)}else{var dn=ta(u),Mn=dn==oe||dn==re;if(oc(u))return Am(u,pt);if(dn==Ue||dn==Z||Mn&&!me){if(it=Mt||Mn?{}:Wm(u),!pt)return Mt?Qb(u,en(it,u)):Xb(u,cn(it,u))}else{if(!_r[dn])return me?u:{};it=h5(u,dn,pt)}}Fe||(Fe=new be);var Zn=Fe.get(u);if(Zn)return Zn;Fe.set(u,it),x1(u)?u.forEach(function(hr){it.add(a(hr,d,P,hr,u,Fe))}):b1(u)&&u.forEach(function(hr,Qr){it.set(Qr,a(hr,d,P,Qr,u,Fe))});var cr=sn?Mt?Xp:Yp:Mt?za:xo,Ur=an?t:cr(u);return as(Ur||u,function(hr,Qr){Ur&&(Qr=hr,hr=u[Qr]),ft(it,Qr,a(hr,d,P,Qr,u,Fe))}),it}function c(u){var d=xo(u);return function(P){return p(P,u,d)}}function p(u,d,P){var j=P.length;if(u==null)return!j;for(u=Yr(u);j--;){var me=P[j],Fe=d[me],it=u[me];if(it===t&&!(me in u)||!Fe(it))return!1}return!0}function y(u,d,P){if(typeof u!="function")throw new bi(l);return of(function(){u.apply(t,P)},d)}function S(u,d,P,j){var me=-1,Fe=Ba,it=!0,pt=u.length,Mt=[],sn=d.length;if(!pt)return Mt;P&&(d=Kr(d,vr(P))),j?(Fe=Na,it=!1):d.length>=i&&(Fe=Ra,it=!1,d=new B(d));e:for(;++me<pt;){var an=u[me],dn=P==null?an:P(an);if(an=j||an!==0?an:0,it&&dn===dn){for(var Mn=sn;Mn--;)if(d[Mn]===dn)continue e;Mt.push(an)}else Fe(d,dn,j)||Mt.push(an)}return Mt}var k=Nm(Wt),F=Nm(gn,!0);function q(u,d){var P=!0;return k(u,function(j,me,Fe){return P=!!d(j,me,Fe),P}),P}function ae(u,d,P){for(var j=-1,me=u.length;++j<me;){var Fe=u[j],it=d(Fe);if(it!=null&&(pt===t?it===it&&!rl(it):P(it,pt)))var pt=it,Mt=Fe}return Mt}function ve(u,d,P,j){var me=u.length;for(P=Fr(P),P<0&&(P=-P>me?0:me+P),j=j===t||j>me?me:Fr(j),j<0&&(j+=me),j=P>j?0:S1(j);P<j;)u[P++]=d;return u}function Je(u,d){var P=[];return k(u,function(j,me,Fe){d(j,me,Fe)&&P.push(j)}),P}function $e(u,d,P,j,me){var Fe=-1,it=u.length;for(P||(P=d5),me||(me=[]);++Fe<it;){var pt=u[Fe];d>0&&P(pt)?d>1?$e(pt,d-1,P,j,me):eo(me,pt):j||(me[me.length]=pt)}return me}var mt=Rm(),Nt=Rm(!0);function Wt(u,d){return u&&mt(u,d,xo)}function gn(u,d){return u&&Nt(u,d,xo)}function vn(u,d){return vo(d,function(P){return zu(u[P])})}function Jn(u,d){d=$l(d,u);for(var P=0,j=d.length;u!=null&&P<j;)u=u[hu(d[P++])];return P&&P==j?u:t}function Ke(u,d,P){var j=d(u);return Er(u)?j:eo(j,P(u))}function nt(u){return u==null?u===t?gt:le:Yo&&Yo in Yr(u)?a5(u):b5(u)}function ct(u,d){return u>d}function Ft(u,d){return u!=null&&Cr.call(u,d)}function xt(u,d){return u!=null&&d in Yr(u)}function Rt(u,d,P){return u>=_e(d,P)&&u<J(d,P)}function fe(u,d,P){for(var j=P?Na:Ba,me=u[0].length,Fe=u.length,it=Fe,pt=Bt(Fe),Mt=1/0,sn=[];it--;){var an=u[it];it&&d&&(an=Kr(an,vr(d))),Mt=_e(an.length,Mt),pt[it]=!P&&(d||me>=120&&an.length>=120)?new B(it&&an):t}an=u[0];var dn=-1,Mn=pt[0];e:for(;++dn<me&&sn.length<Mt;){var Zn=an[dn],cr=d?d(Zn):Zn;if(Zn=P||Zn!==0?Zn:0,!(Mn?Ra(Mn,cr):j(sn,cr,P))){for(it=Fe;--it;){var Ur=pt[it];if(!(Ur?Ra(Ur,cr):j(u[it],cr,P)))continue e}Mn&&Mn.push(cr),sn.push(Zn)}}return sn}function we(u,d,P,j){return Wt(u,function(me,Fe,it){d(j,P(me),Fe,it)}),j}function Oe(u,d,P){d=$l(d,u),u=Ym(u,d);var j=u==null?u:u[hu(bl(d))];return j==null?t:Zr(j,u,P)}function Ne(u){return Rs(u)&&nt(u)==Z}function ze(u){return Rs(u)&&nt(u)==tn}function je(u){return Rs(u)&&nt(u)==ee}function at(u,d,P,j,me){return u===d?!0:u==null||d==null||!Rs(u)&&!Rs(d)?u!==u&&d!==d:lt(u,d,P,j,at,me)}function lt(u,d,P,j,me,Fe){var it=Er(u),pt=Er(d),Mt=it?he:ta(u),sn=pt?he:ta(d);Mt=Mt==Z?Ue:Mt,sn=sn==Z?Ue:sn;var an=Mt==Ue,dn=sn==Ue,Mn=Mt==sn;if(Mn&&oc(u)){if(!oc(d))return!1;it=!0,an=!1}if(Mn&&!an)return Fe||(Fe=new be),it||Ch(u)?Vm(u,d,P,j,me,Fe):s5(u,d,Mt,P,j,me,Fe);if(!(P&R)){var Zn=an&&Cr.call(u,"__wrapped__"),cr=dn&&Cr.call(d,"__wrapped__");if(Zn||cr){var Ur=Zn?u.value():u,hr=cr?d.value():d;return Fe||(Fe=new be),me(Ur,hr,P,j,Fe)}}return Mn?(Fe||(Fe=new be),o5(u,d,P,j,me,Fe)):!1}function dt(u){return Rs(u)&&ta(u)==xe}function Et(u,d,P,j){var me=P.length,Fe=me,it=!j;if(u==null)return!Fe;for(u=Yr(u);me--;){var pt=P[me];if(it&&pt[2]?pt[1]!==u[pt[0]]:!(pt[0]in u))return!1}for(;++me<Fe;){pt=P[me];var Mt=pt[0],sn=u[Mt],an=pt[1];if(it&&pt[2]){if(sn===t&&!(Mt in u))return!1}else{var dn=new be;if(j)var Mn=j(sn,an,Mt,u,d,dn);if(!(Mn===t?at(an,sn,R|$,j,dn):Mn))return!1}}return!0}function At(u){if(!Ss(u)||g5(u))return!1;var d=zu(u)?li:Ps;return d.test(Ic(u))}function nn(u){return Rs(u)&&nt(u)==qe}function An(u){return Rs(u)&&ta(u)==Re}function Rn(u){return Rs(u)&&yd(u.length)&&!!or[nt(u)]}function Vn(u){return typeof u=="function"?u:u==null?ja:typeof u=="object"?Er(u)?Fl(u[0],u[1]):qs(u):D1(u)}function Wr(u){if(!sf(u))return T(u);var d=[];for(var P in Yr(u))Cr.call(u,P)&&P!="constructor"&&d.push(P);return d}function ri(u){if(!Ss(u))return _5(u);var d=sf(u),P=[];for(var j in u)j=="constructor"&&(d||!Cr.call(u,j))||P.push(j);return P}function Pr(u,d){return u<d}function ui(u,d){var P=-1,j=Fa(u)?Bt(u.length):[];return k(u,function(me,Fe,it){j[++P]=d(me,Fe,it)}),j}function qs(u){var d=e0(u);return d.length==1&&d[0][2]?Km(d[0][0],d[0][1]):function(P){return P===u||Et(P,u,d)}}function Fl(u,d){return n0(u)&&Zm(d)?Km(hu(u),d):function(P){var j=f0(P,u);return j===t&&j===d?d0(P,u):at(d,j,R|$)}}function zo(u,d,P,j,me){u!==d&&mt(d,function(Fe,it){if(me||(me=new be),Ss(Fe))Tc(u,d,it,P,zo,j,me);else{var pt=j?j(i0(u,it),Fe,it+"",u,d,me):t;pt===t&&(pt=Fe),Ut(u,it,pt)}},za)}function Tc(u,d,P,j,me,Fe,it){var pt=i0(u,P),Mt=i0(d,P),sn=it.get(Mt);if(sn){Ut(u,P,sn);return}var an=Fe?Fe(pt,Mt,P+"",u,d,it):t,dn=an===t;if(dn){var Mn=Er(Mt),Zn=!Mn&&oc(Mt),cr=!Mn&&!Zn&&Ch(Mt);an=Mt,Mn||Zn||cr?Er(pt)?an=pt:Vs(pt)?an=Ia(pt):Zn?(dn=!1,an=Am(Mt,!0)):cr?(dn=!1,an=Mm(Mt,!0)):an=[]:af(Mt)||Fc(Mt)?(an=pt,Fc(pt)?an=C1(pt):(!Ss(pt)||zu(pt))&&(an=Wm(Mt))):dn=!1}dn&&(it.set(Mt,an),me(an,Mt,j,Fe,it),it.delete(Mt)),Ut(u,P,an)}function ma(u,d){var P=u.length;if(P)return d+=d<0?P:0,Fu(d,P)?u[d]:t}function lu(u,d,P){d.length?d=Kr(d,function(Fe){return Er(Fe)?function(it){return Jn(it,Fe.length===1?Fe[0]:Fe)}:Fe}):d=[ja];var j=-1;d=Kr(d,vr(ar()));var me=ui(u,function(Fe,it,pt){var Mt=Kr(d,function(sn){return sn(Fe)});return{criteria:Mt,index:++j,value:Fe}});return qr(me,function(Fe,it){return Yb(Fe,it,P)})}function jo(u,d){return Ls(u,d,function(P,j){return d0(u,j)})}function Ls(u,d,P){for(var j=-1,me=d.length,Fe={};++j<me;){var it=d[j],pt=Jn(u,it);P(pt,it)&&Nu(Fe,$l(it,u),pt)}return Fe}function $i(u){return function(d){return Jn(d,u)}}function vh(u,d,P,j){var me=j?Ln:ln,Fe=-1,it=d.length,pt=u;for(u===d&&(d=Ia(d)),P&&(pt=Kr(u,vr(P)));++Fe<it;)for(var Mt=0,sn=d[Fe],an=P?P(sn):sn;(Mt=me(pt,an,Mt,j))>-1;)pt!==u&&ws.call(pt,Mt,1),ws.call(u,Mt,1);return u}function Bc(u,d){for(var P=u?d.length:0,j=P-1;P--;){var me=d[P];if(P==j||me!==Fe){var Fe=me;Fu(me)?ws.call(u,me,1):Ru(u,me)}}return u}function Nc(u,d){return u+hs(jt()*(d-u+1))}function Rc(u,d,P,j){for(var me=-1,Fe=J(cs((d-u)/(P||1)),0),it=Bt(Fe);Fe--;)it[j?Fe:++me]=u,u+=P;return it}function yh(u,d){var P="";if(!u||d<1||d>ie)return P;do d%2&&(P+=u),d=hs(d/2),d&&(u+=u);while(d);return P}function Ir(u,d){return s0(Jm(u,d,ja),u+"")}function _h(u){return It(Ph(u))}function ed(u,d){var P=Ph(u);return fd(P,qn(d,0,P.length))}function Nu(u,d,P,j){if(!Ss(u))return u;d=$l(d,u);for(var me=-1,Fe=d.length,it=Fe-1,pt=u;pt!=null&&++me<Fe;){var Mt=hu(d[me]),sn=P;if(Mt==="__proto__"||Mt==="constructor"||Mt==="prototype")return u;if(me!=it){var an=pt[Mt];sn=j?j(an,Mt,pt):t,sn===t&&(sn=Ss(an)?an:Fu(d[me+1])?[]:{})}ft(pt,Mt,sn),pt=pt[Mt]}return u}var zl=wi?function(u,d){return wi.set(u,d),u}:ja,td=Xo?function(u,d){return Xo(u,"toString",{configurable:!0,enumerable:!1,value:g0(d),writable:!0})}:ja;function nd(u){return fd(Ph(u))}function Oa(u,d,P){var j=-1,me=u.length;d<0&&(d=-d>me?0:me+d),P=P>me?me:P,P<0&&(P+=me),me=d>P?0:P-d>>>0,d>>>=0;for(var Fe=Bt(me);++j<me;)Fe[j]=u[j+d];return Fe}function rd(u,d){var P;return k(u,function(j,me,Fe){return P=d(j,me,Fe),!P}),!!P}function jl(u,d,P){var j=0,me=u==null?j:u.length;if(typeof d=="number"&&d===d&&me<=Ee){for(;j<me;){var Fe=j+me>>>1,it=u[Fe];it!==null&&!rl(it)&&(P?it<=d:it<d)?j=Fe+1:me=Fe}return me}return tf(u,d,ja,P)}function tf(u,d,P,j){var me=0,Fe=u==null?0:u.length;if(Fe===0)return 0;d=P(d);for(var it=d!==d,pt=d===null,Mt=rl(d),sn=d===t;me<Fe;){var an=hs((me+Fe)/2),dn=P(u[an]),Mn=dn!==t,Zn=dn===null,cr=dn===dn,Ur=rl(dn);if(it)var hr=j||cr;else sn?hr=cr&&(j||Mn):pt?hr=cr&&Mn&&(j||!Zn):Mt?hr=cr&&Mn&&!Zn&&(j||!Ur):Zn||Ur?hr=!1:hr=j?dn<=d:dn<d;hr?me=an+1:Fe=an}return _e(Fe,X)}function nf(u,d){for(var P=-1,j=u.length,me=0,Fe=[];++P<j;){var it=u[P],pt=d?d(it):it;if(!P||!ql(pt,Mt)){var Mt=pt;Fe[me++]=it===0?0:it}}return Fe}function id(u){return typeof u=="number"?u:rl(u)?Me:+u}function ea(u){if(typeof u=="string")return u;if(Er(u))return Kr(u,ea)+"";if(rl(u))return xs?xs.call(u):"";var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function uu(u,d,P){var j=-1,me=Ba,Fe=u.length,it=!0,pt=[],Mt=pt;if(P)it=!1,me=Na;else if(Fe>=i){var sn=d?null:r5(u);if(sn)return Ts(sn);it=!1,me=Ra,Mt=new B}else Mt=d?[]:pt;e:for(;++j<Fe;){var an=u[j],dn=d?d(an):an;if(an=P||an!==0?an:0,it&&dn===dn){for(var Mn=Mt.length;Mn--;)if(Mt[Mn]===dn)continue e;d&&Mt.push(dn),pt.push(an)}else me(Mt,dn,P)||(Mt!==pt&&Mt.push(dn),pt.push(an))}return pt}function Ru(u,d){return d=$l(d,u),u=Ym(u,d),u==null||delete u[hu(bl(d))]}function bh(u,d,P,j){return Nu(u,d,P(Jn(u,d)),j)}function Du(u,d,P,j){for(var me=u.length,Fe=j?me:-1;(j?Fe--:++Fe<me)&&d(u[Fe],Fe,u););return P?Oa(u,j?0:Fe,j?Fe+1:me):Oa(u,j?Fe+1:0,j?me:Fe)}function vl(u,d){var P=u;return P instanceof yr&&(P=P.value()),Ho(d,function(j,me){return me.func.apply(me.thisArg,eo([j],me.args))},P)}function yl(u,d,P){var j=u.length;if(j<2)return j?uu(u[0]):[];for(var me=-1,Fe=Bt(j);++me<j;)for(var it=u[me],pt=-1;++pt<j;)pt!=me&&(Fe[me]=S(Fe[me]||it,u[pt],d,P));return uu($e(Fe,1),d,P)}function Ul(u,d,P){for(var j=-1,me=u.length,Fe=d.length,it={};++j<me;){var pt=j<Fe?d[j]:t;P(it,u[j],pt)}return it}function sc(u){return Vs(u)?u:[]}function Dc(u){return typeof u=="function"?u:ja}function $l(u,d){return Er(u)?u:n0(u,d)?[u]:t1(Si(u))}var Wp=Ir;function _l(u,d,P){var j=u.length;return P=P===t?j:P,!d&&P>=j?u:Oa(u,d,P)}var wh=_o||function(u){return Ii.clearTimeout(u)};function Am(u,d){if(d)return u.slice();var P=u.length,j=Ol?Ol(P):new u.constructor(P);return u.copy(j),j}function Zp(u){var d=new u.constructor(u.byteLength);return new co(d).set(new co(u)),d}function Zb(u,d){var P=d?Zp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.byteLength)}function Kb(u){var d=new u.constructor(u.source,Yn.exec(u));return d.lastIndex=u.lastIndex,d}function Jb(u){return Hr?Yr(Hr.call(u)):{}}function Mm(u,d){var P=d?Zp(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.length)}function km(u,d){if(u!==d){var P=u!==t,j=u===null,me=u===u,Fe=rl(u),it=d!==t,pt=d===null,Mt=d===d,sn=rl(d);if(!pt&&!sn&&!Fe&&u>d||Fe&&it&&Mt&&!pt&&!sn||j&&it&&Mt||!P&&Mt||!me)return 1;if(!j&&!Fe&&!sn&&u<d||sn&&P&&me&&!j&&!Fe||pt&&P&&me||!it&&me||!Mt)return-1}return 0}function Yb(u,d,P){for(var j=-1,me=u.criteria,Fe=d.criteria,it=me.length,pt=P.length;++j<it;){var Mt=km(me[j],Fe[j]);if(Mt){if(j>=pt)return Mt;var sn=P[j];return Mt*(sn=="desc"?-1:1)}}return u.index-d.index}function Tm(u,d,P,j){for(var me=-1,Fe=u.length,it=P.length,pt=-1,Mt=d.length,sn=J(Fe-it,0),an=Bt(Mt+sn),dn=!j;++pt<Mt;)an[pt]=d[pt];for(;++me<it;)(dn||me<Fe)&&(an[P[me]]=u[me]);for(;sn--;)an[pt++]=u[me++];return an}function Bm(u,d,P,j){for(var me=-1,Fe=u.length,it=-1,pt=P.length,Mt=-1,sn=d.length,an=J(Fe-pt,0),dn=Bt(an+sn),Mn=!j;++me<an;)dn[me]=u[me];for(var Zn=me;++Mt<sn;)dn[Zn+Mt]=d[Mt];for(;++it<pt;)(Mn||me<Fe)&&(dn[Zn+P[it]]=u[me++]);return dn}function Ia(u,d){var P=-1,j=u.length;for(d||(d=Bt(j));++P<j;)d[P]=u[P];return d}function cu(u,d,P,j){var me=!P;P||(P={});for(var Fe=-1,it=d.length;++Fe<it;){var pt=d[Fe],Mt=j?j(P[pt],u[pt],pt,P,u):t;Mt===t&&(Mt=u[pt]),me?xn(P,pt,Mt):ft(P,pt,Mt)}return P}function Xb(u,d){return cu(u,t0(u),d)}function Qb(u,d){return cu(u,Gm(u),d)}function sd(u,d){return function(P,j){var me=Er(P)?su:Jt,Fe=d?d():{};return me(P,u,ar(j,2),Fe)}}function xh(u){return Ir(function(d,P){var j=-1,me=P.length,Fe=me>1?P[me-1]:t,it=me>2?P[2]:t;for(Fe=u.length>3&&typeof Fe=="function"?(me--,Fe):t,it&&va(P[0],P[1],it)&&(Fe=me<3?t:Fe,me=1),d=Yr(d);++j<me;){var pt=P[j];pt&&u(d,pt,j,Fe)}return d})}function Nm(u,d){return function(P,j){if(P==null)return P;if(!Fa(P))return u(P,j);for(var me=P.length,Fe=d?me:-1,it=Yr(P);(d?Fe--:++Fe<me)&&j(it[Fe],Fe,it)!==!1;);return P}}function Rm(u){return function(d,P,j){for(var me=-1,Fe=Yr(d),it=j(d),pt=it.length;pt--;){var Mt=it[u?pt:++me];if(P(Fe[Mt],Mt,Fe)===!1)break}return d}}function e5(u,d,P){var j=d&Q,me=rf(u);function Fe(){var it=this&&this!==Ii&&this instanceof Fe?me:u;return it.apply(j?P:this,arguments)}return Fe}function Dm(u){return function(d){d=Si(d);var P=To(d)?ys(d):t,j=P?P[0]:d.charAt(0),me=P?_l(P,1).join(""):d.slice(1);return j[u]()+me}}function Lh(u){return function(d){return Ho(N1(B1(d).replace(Or,"")),u,"")}}function rf(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var P=$s(u.prototype),j=u.apply(P,d);return Ss(j)?j:P}}function t5(u,d,P){var j=rf(u);function me(){for(var Fe=arguments.length,it=Bt(Fe),pt=Fe,Mt=Sh(me);pt--;)it[pt]=arguments[pt];var sn=Fe<3&&it[0]!==Mt&&it[Fe-1]!==Mt?[]:ks(it,Mt);if(Fe-=sn.length,Fe<P)return jm(u,d,od,me.placeholder,t,it,sn,t,t,P-Fe);var an=this&&this!==Ii&&this instanceof me?j:u;return Zr(an,this,it)}return me}function Om(u){return function(d,P,j){var me=Yr(d);if(!Fa(d)){var Fe=ar(P,3);d=xo(d),P=function(pt){return Fe(me[pt],pt,me)}}var it=u(d,P,j);return it>-1?me[Fe?d[it]:it]:t}}function Im(u){return Iu(function(d){var P=d.length,j=P,me=ds.prototype.thru;for(u&&d.reverse();j--;){var Fe=d[j];if(typeof Fe!="function")throw new bi(l);if(me&&!it&&cd(Fe)=="wrapper")var it=new ds([],!0)}for(j=it?j:P;++j<P;){Fe=d[j];var pt=cd(Fe),Mt=pt=="wrapper"?Qp(Fe):t;Mt&&r0(Mt[0])&&Mt[1]==(Ve|ge|De|O)&&!Mt[4].length&&Mt[9]==1?it=it[cd(Mt[0])].apply(it,Mt[3]):it=Fe.length==1&&r0(Fe)?it[pt]():it.thru(Fe)}return function(){var sn=arguments,an=sn[0];if(it&&sn.length==1&&Er(an))return it.plant(an).value();for(var dn=0,Mn=P?d[dn].apply(this,sn):an;++dn<P;)Mn=d[dn].call(this,Mn);return Mn}})}function od(u,d,P,j,me,Fe,it,pt,Mt,sn){var an=d&Ve,dn=d&Q,Mn=d&I,Zn=d&(ge|Se),cr=d&K,Ur=Mn?t:rf(u);function hr(){for(var Qr=arguments.length,ii=Bt(Qr),il=Qr;il--;)ii[il]=arguments[il];if(Zn)var ya=Sh(hr),sl=ko(ii,ya);if(j&&(ii=Tm(ii,j,me,Zn)),Fe&&(ii=Bm(ii,Fe,it,Zn)),Qr-=sl,Zn&&Qr<sn){var Gs=ks(ii,ya);return jm(u,d,od,hr.placeholder,P,ii,Gs,pt,Mt,sn-Qr)}var Vl=dn?P:this,Uu=Mn?Vl[u]:u;return Qr=ii.length,pt?ii=w5(ii,pt):cr&&Qr>1&&ii.reverse(),an&&Mt<Qr&&(ii.length=Mt),this&&this!==Ii&&this instanceof hr&&(Uu=Ur||rf(Uu)),Uu.apply(Vl,ii)}return hr}function Fm(u,d){return function(P,j){return we(P,u,d(j),{})}}function ad(u,d){return function(P,j){var me;if(P===t&&j===t)return d;if(P!==t&&(me=P),j!==t){if(me===t)return j;typeof P=="string"||typeof j=="string"?(P=ea(P),j=ea(j)):(P=id(P),j=id(j)),me=u(P,j)}return me}}function Kp(u){return Iu(function(d){return d=Kr(d,vr(ar())),Ir(function(P){var j=this;return u(d,function(me){return Zr(me,j,P)})})})}function ld(u,d){d=d===t?" ":ea(d);var P=d.length;if(P<2)return P?yh(d,u):d;var j=yh(d,cs(u/vs(d)));return To(d)?_l(ys(j),0,u).join(""):j.slice(0,u)}function n5(u,d,P,j){var me=d&Q,Fe=rf(u);function it(){for(var pt=-1,Mt=arguments.length,sn=-1,an=j.length,dn=Bt(an+Mt),Mn=this&&this!==Ii&&this instanceof it?Fe:u;++sn<an;)dn[sn]=j[sn];for(;Mt--;)dn[sn++]=arguments[++pt];return Zr(Mn,me?P:this,dn)}return it}function zm(u){return function(d,P,j){return j&&typeof j!="number"&&va(d,P,j)&&(P=j=t),d=ju(d),P===t?(P=d,d=0):P=ju(P),j=j===t?d<P?1:-1:ju(j),Rc(d,P,j,u)}}function ud(u){return function(d,P){return typeof d=="string"&&typeof P=="string"||(d=wl(d),P=wl(P)),u(d,P)}}function jm(u,d,P,j,me,Fe,it,pt,Mt,sn){var an=d&ge,dn=an?it:t,Mn=an?t:it,Zn=an?Fe:t,cr=an?t:Fe;d|=an?De:Ye,d&=~(an?Ye:De),d&W||(d&=-4);var Ur=[u,d,me,Zn,dn,cr,Mn,pt,Mt,sn],hr=P.apply(t,Ur);return r0(u)&&Xm(hr,Ur),hr.placeholder=j,Qm(hr,u,d)}function Jp(u){var d=_i[u];return function(P,j){if(P=wl(P),j=j==null?0:_e(Fr(j),292),j&&f(P)){var me=(Si(P)+"e").split("e"),Fe=d(me[0]+"e"+(+me[1]+j));return me=(Si(Fe)+"e").split("e"),+(me[0]+"e"+(+me[1]-j))}return d(P)}}var r5=Ki&&1/Ts(new Ki([,-0]))[1]==ue?function(u){return new Ki(u)}:y0;function Um(u){return function(d){var P=ta(d);return P==xe?Da(d):P==Re?ou(d):Hi(d,u(d))}}function Ou(u,d,P,j,me,Fe,it,pt){var Mt=d&I;if(!Mt&&typeof u!="function")throw new bi(l);var sn=j?j.length:0;if(sn||(d&=-97,j=me=t),it=it===t?it:J(Fr(it),0),pt=pt===t?pt:Fr(pt),sn-=me?me.length:0,d&Ye){var an=j,dn=me;j=me=t}var Mn=Mt?t:Qp(u),Zn=[u,d,P,j,me,an,dn,Fe,it,pt];if(Mn&&y5(Zn,Mn),u=Zn[0],d=Zn[1],P=Zn[2],j=Zn[3],me=Zn[4],pt=Zn[9]=Zn[9]===t?Mt?0:u.length:J(Zn[9]-sn,0),!pt&&d&(ge|Se)&&(d&=-25),!d||d==Q)var cr=e5(u,d,P);else d==ge||d==Se?cr=t5(u,d,pt):(d==De||d==(Q|De))&&!me.length?cr=n5(u,d,P,j):cr=od.apply(t,Zn);var Ur=Mn?zl:Xm;return Qm(Ur(cr,Zn),u,d)}function $m(u,d,P,j){return u===t||ql(u,Ro[P])&&!Cr.call(j,P)?d:u}function qm(u,d,P,j,me,Fe){return Ss(u)&&Ss(d)&&(Fe.set(d,u),zo(u,d,t,qm,Fe),Fe.delete(d)),u}function i5(u){return af(u)?t:u}function Vm(u,d,P,j,me,Fe){var it=P&R,pt=u.length,Mt=d.length;if(pt!=Mt&&!(it&&Mt>pt))return!1;var sn=Fe.get(u),an=Fe.get(d);if(sn&&an)return sn==d&&an==u;var dn=-1,Mn=!0,Zn=P&$?new B:t;for(Fe.set(u,d),Fe.set(d,u);++dn<pt;){var cr=u[dn],Ur=d[dn];if(j)var hr=it?j(Ur,cr,dn,d,u,Fe):j(cr,Ur,dn,u,d,Fe);if(hr!==t){if(hr)continue;Mn=!1;break}if(Zn){if(!A(d,function(Qr,ii){if(!Ra(Zn,ii)&&(cr===Qr||me(cr,Qr,P,j,Fe)))return Zn.push(ii)})){Mn=!1;break}}else if(!(cr===Ur||me(cr,Ur,P,j,Fe))){Mn=!1;break}}return Fe.delete(u),Fe.delete(d),Mn}function s5(u,d,P,j,me,Fe,it){switch(P){case Qe:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case tn:return!(u.byteLength!=d.byteLength||!Fe(new co(u),new co(d)));case te:case ee:case ye:return ql(+u,+d);case Pe:return u.name==d.name&&u.message==d.message;case qe:case rt:return u==d+"";case xe:var pt=Da;case Re:var Mt=j&R;if(pt||(pt=Ts),u.size!=d.size&&!Mt)return!1;var sn=it.get(u);if(sn)return sn==d;j|=$,it.set(u,d);var an=Vm(pt(u),pt(d),j,me,Fe,it);return it.delete(u),an;case Ze:if(Hr)return Hr.call(u)==Hr.call(d)}return!1}function o5(u,d,P,j,me,Fe){var it=P&R,pt=Yp(u),Mt=pt.length,sn=Yp(d),an=sn.length;if(Mt!=an&&!it)return!1;for(var dn=Mt;dn--;){var Mn=pt[dn];if(!(it?Mn in d:Cr.call(d,Mn)))return!1}var Zn=Fe.get(u),cr=Fe.get(d);if(Zn&&cr)return Zn==d&&cr==u;var Ur=!0;Fe.set(u,d),Fe.set(d,u);for(var hr=it;++dn<Mt;){Mn=pt[dn];var Qr=u[Mn],ii=d[Mn];if(j)var il=it?j(ii,Qr,Mn,d,u,Fe):j(Qr,ii,Mn,u,d,Fe);if(!(il===t?Qr===ii||me(Qr,ii,P,j,Fe):il)){Ur=!1;break}hr||(hr=Mn=="constructor")}if(Ur&&!hr){var ya=u.constructor,sl=d.constructor;ya!=sl&&"constructor"in u&&"constructor"in d&&!(typeof ya=="function"&&ya instanceof ya&&typeof sl=="function"&&sl instanceof sl)&&(Ur=!1)}return Fe.delete(u),Fe.delete(d),Ur}function Iu(u){return s0(Jm(u,t,s1),u+"")}function Yp(u){return Ke(u,xo,t0)}function Xp(u){return Ke(u,za,Gm)}var Qp=wi?function(u){return wi.get(u)}:y0;function cd(u){for(var d=u.name+"",P=Us[d],j=Cr.call(Us,d)?P.length:0;j--;){var me=P[j],Fe=me.func;if(Fe==null||Fe==u)return me.name}return d}function Sh(u){var d=Cr.call(Te,"placeholder")?Te:u;return d.placeholder}function ar(){var u=Te.iteratee||m0;return u=u===m0?Vn:u,arguments.length?u(arguments[0],arguments[1]):u}function hd(u,d){var P=u.__data__;return p5(d)?P[typeof d=="string"?"string":"hash"]:P.map}function e0(u){for(var d=xo(u),P=d.length;P--;){var j=d[P],me=u[j];d[P]=[j,me,Zm(me)]}return d}function Oc(u,d){var P=Wi(u,d);return At(P)?P:t}function a5(u){var d=Cr.call(u,Yo),P=u[Yo];try{u[Yo]=t;var j=!0}catch{}var me=Xr.call(u);return j&&(d?u[Yo]=P:delete u[Yo]),me}var t0=bo?function(u){return u==null?[]:(u=Yr(u),vo(bo(u),function(d){return ai.call(u,d)}))}:_0,Gm=bo?function(u){for(var d=[];u;)eo(d,t0(u)),u=Io(u);return d}:_0,ta=nt;(Sn&&ta(new Sn(new ArrayBuffer(1)))!=Qe||$n&&ta(new $n)!=xe||gr&&ta(gr.resolve())!=Ie||Ki&&ta(new Ki)!=Re||Ti&&ta(new Ti)!=_t)&&(ta=function(u){var d=nt(u),P=d==Ue?u.constructor:t,j=P?Ic(P):"";if(j)switch(j){case Tu:return Qe;case Fo:return xe;case wo:return Ie;case ho:return Re;case Mc:return _t}return d});function l5(u,d,P){for(var j=-1,me=P.length;++j<me;){var Fe=P[j],it=Fe.size;switch(Fe.type){case"drop":u+=it;break;case"dropRight":d-=it;break;case"take":d=_e(d,u+it);break;case"takeRight":u=J(u,d-it);break}}return{start:u,end:d}}function u5(u){var d=u.match(Ei);return d?d[1].split(Ai):[]}function Hm(u,d,P){d=$l(d,u);for(var j=-1,me=d.length,Fe=!1;++j<me;){var it=hu(d[j]);if(!(Fe=u!=null&&P(u,it)))break;u=u[it]}return Fe||++j!=me?Fe:(me=u==null?0:u.length,!!me&&yd(me)&&Fu(it,me)&&(Er(u)||Fc(u)))}function c5(u){var d=u.length,P=new u.constructor(d);return d&&typeof u[0]=="string"&&Cr.call(u,"index")&&(P.index=u.index,P.input=u.input),P}function Wm(u){return typeof u.constructor=="function"&&!sf(u)?$s(Io(u)):{}}function h5(u,d,P){var j=u.constructor;switch(d){case tn:return Zp(u);case te:case ee:return new j(+u);case Qe:return Zb(u,P);case Yt:case Qt:case Zt:case wt:case He:case Kt:case on:case Bn:case kn:return Mm(u,P);case xe:return new j;case ye:case rt:return new j(u);case qe:return Kb(u);case Re:return new j;case Ze:return Jb(u)}}function f5(u,d){var P=d.length;if(!P)return u;var j=P-1;return d[j]=(P>1?"& ":"")+d[j],d=d.join(P>2?", ":" "),u.replace(kt,`{
/* [wrapped with `+d+`] */
`)}function d5(u){return Er(u)||Fc(u)||!!(js&&u&&u[js])}function Fu(u,d){var P=typeof u;return d=d??ie,!!d&&(P=="number"||P!="symbol"&&Cn.test(u))&&u>-1&&u%1==0&&u<d}function va(u,d,P){if(!Ss(P))return!1;var j=typeof d;return(j=="number"?Fa(P)&&Fu(d,P.length):j=="string"&&d in P)?ql(P[d],u):!1}function n0(u,d){if(Er(u))return!1;var P=typeof u;return P=="number"||P=="symbol"||P=="boolean"||u==null||rl(u)?!0:Ri.test(u)||!hi.test(u)||d!=null&&u in Yr(d)}function p5(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function r0(u){var d=cd(u),P=Te[d];if(typeof P!="function"||!(d in yr.prototype))return!1;if(u===P)return!0;var j=Qp(P);return!!j&&u===j[0]}function g5(u){return!!us&&us in u}var m5=Do?zu:b0;function sf(u){var d=u&&u.constructor,P=typeof d=="function"&&d.prototype||Ro;return u===P}function Zm(u){return u===u&&!Ss(u)}function Km(u,d){return function(P){return P==null?!1:P[u]===d&&(d!==t||u in Yr(P))}}function v5(u){var d=md(u,function(j){return P.size===v&&P.clear(),j}),P=d.cache;return d}function y5(u,d){var P=u[1],j=d[1],me=P|j,Fe=me<(Q|I|Ve),it=j==Ve&&P==ge||j==Ve&&P==O&&u[7].length<=d[8]||j==(Ve|O)&&d[7].length<=d[8]&&P==ge;if(!(Fe||it))return u;j&Q&&(u[2]=d[2],me|=P&Q?0:W);var pt=d[3];if(pt){var Mt=u[3];u[3]=Mt?Tm(Mt,pt,d[4]):pt,u[4]=Mt?ks(u[3],_):d[4]}return pt=d[5],pt&&(Mt=u[5],u[5]=Mt?Bm(Mt,pt,d[6]):pt,u[6]=Mt?ks(u[5],_):d[6]),pt=d[7],pt&&(u[7]=pt),j&Ve&&(u[8]=u[8]==null?d[8]:_e(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=me,u}function _5(u){var d=[];if(u!=null)for(var P in Yr(u))d.push(P);return d}function b5(u){return Xr.call(u)}function Jm(u,d,P){return d=J(d===t?u.length-1:d,0),function(){for(var j=arguments,me=-1,Fe=J(j.length-d,0),it=Bt(Fe);++me<Fe;)it[me]=j[d+me];me=-1;for(var pt=Bt(d+1);++me<d;)pt[me]=j[me];return pt[d]=P(it),Zr(u,this,pt)}}function Ym(u,d){return d.length<2?u:Jn(u,Oa(d,0,-1))}function w5(u,d){for(var P=u.length,j=_e(d.length,P),me=Ia(u);j--;){var Fe=d[j];u[j]=Fu(Fe,P)?me[Fe]:t}return u}function i0(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var Xm=e1(zl),of=ku||function(u,d){return Ii.setTimeout(u,d)},s0=e1(td);function Qm(u,d,P){var j=d+"";return s0(u,f5(j,x5(u5(j),P)))}function e1(u){var d=0,P=0;return function(){var j=ot(),me=V-(j-P);if(P=j,me>0){if(++d>=D)return arguments[0]}else d=0;return u.apply(t,arguments)}}function fd(u,d){var P=-1,j=u.length,me=j-1;for(d=d===t?j:d;++P<d;){var Fe=Nc(P,me),it=u[Fe];u[Fe]=u[P],u[P]=it}return u.length=d,u}var t1=v5(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(Fn,function(P,j,me,Fe){d.push(me?Fe.replace(Di,"$1"):j||P)}),d});function hu(u){if(typeof u=="string"||rl(u))return u;var d=u+"";return d=="0"&&1/u==-1/0?"-0":d}function Ic(u){if(u!=null){try{return Oo.call(u)}catch{}try{return u+""}catch{}}return""}function x5(u,d){return as(N,function(P){var j="_."+P[0];d&P[1]&&!Ba(u,j)&&u.push(j)}),u.sort()}function n1(u){if(u instanceof yr)return u.clone();var d=new ds(u.__wrapped__,u.__chain__);return d.__actions__=Ia(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function L5(u,d,P){(P?va(u,d,P):d===t)?d=1:d=J(Fr(d),0);var j=u==null?0:u.length;if(!j||d<1)return[];for(var me=0,Fe=0,it=Bt(cs(j/d));me<j;)it[Fe++]=Oa(u,me,me+=d);return it}function S5(u){for(var d=-1,P=u==null?0:u.length,j=0,me=[];++d<P;){var Fe=u[d];Fe&&(me[j++]=Fe)}return me}function C5(){var u=arguments.length;if(!u)return[];for(var d=Bt(u-1),P=arguments[0],j=u;j--;)d[j-1]=arguments[j];return eo(Er(P)?Ia(P):[P],$e(d,1))}var P5=Ir(function(u,d){return Vs(u)?S(u,$e(d,1,Vs,!0)):[]}),E5=Ir(function(u,d){var P=bl(d);return Vs(P)&&(P=t),Vs(u)?S(u,$e(d,1,Vs,!0),ar(P,2)):[]}),A5=Ir(function(u,d){var P=bl(d);return Vs(P)&&(P=t),Vs(u)?S(u,$e(d,1,Vs,!0),t,P):[]});function M5(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Fr(d),Oa(u,d<0?0:d,j)):[]}function k5(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Fr(d),d=j-d,Oa(u,0,d<0?0:d)):[]}function T5(u,d){return u&&u.length?Du(u,ar(d,3),!0,!0):[]}function B5(u,d){return u&&u.length?Du(u,ar(d,3),!0):[]}function N5(u,d,P,j){var me=u==null?0:u.length;return me?(P&&typeof P!="number"&&va(u,d,P)&&(P=0,j=me),ve(u,d,P,j)):[]}function r1(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var me=P==null?0:Fr(P);return me<0&&(me=J(j+me,0)),zt(u,ar(d,3),me)}function i1(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var me=j-1;return P!==t&&(me=Fr(P),me=P<0?J(j+me,0):_e(me,j-1)),zt(u,ar(d,3),me,!0)}function s1(u){var d=u==null?0:u.length;return d?$e(u,1):[]}function R5(u){var d=u==null?0:u.length;return d?$e(u,ue):[]}function D5(u,d){var P=u==null?0:u.length;return P?(d=d===t?1:Fr(d),$e(u,d)):[]}function O5(u){for(var d=-1,P=u==null?0:u.length,j={};++d<P;){var me=u[d];j[me[0]]=me[1]}return j}function o1(u){return u&&u.length?u[0]:t}function I5(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var me=P==null?0:Fr(P);return me<0&&(me=J(j+me,0)),ln(u,d,me)}function F5(u){var d=u==null?0:u.length;return d?Oa(u,0,-1):[]}var z5=Ir(function(u){var d=Kr(u,sc);return d.length&&d[0]===u[0]?fe(d):[]}),j5=Ir(function(u){var d=bl(u),P=Kr(u,sc);return d===bl(P)?d=t:P.pop(),P.length&&P[0]===u[0]?fe(P,ar(d,2)):[]}),U5=Ir(function(u){var d=bl(u),P=Kr(u,sc);return d=typeof d=="function"?d:t,d&&P.pop(),P.length&&P[0]===u[0]?fe(P,t,d):[]});function $5(u,d){return u==null?"":w.call(u,d)}function bl(u){var d=u==null?0:u.length;return d?u[d-1]:t}function q5(u,d,P){var j=u==null?0:u.length;if(!j)return-1;var me=j;return P!==t&&(me=Fr(P),me=me<0?J(j+me,0):_e(me,j-1)),d===d?Wo(u,d,me):zt(u,En,me,!0)}function V5(u,d){return u&&u.length?ma(u,Fr(d)):t}var G5=Ir(a1);function a1(u,d){return u&&u.length&&d&&d.length?vh(u,d):u}function H5(u,d,P){return u&&u.length&&d&&d.length?vh(u,d,ar(P,2)):u}function W5(u,d,P){return u&&u.length&&d&&d.length?vh(u,d,t,P):u}var Z5=Iu(function(u,d){var P=u==null?0:u.length,j=bn(u,d);return Bc(u,Kr(d,function(me){return Fu(me,P)?+me:me}).sort(km)),j});function K5(u,d){var P=[];if(!(u&&u.length))return P;var j=-1,me=[],Fe=u.length;for(d=ar(d,3);++j<Fe;){var it=u[j];d(it,j,u)&&(P.push(it),me.push(j))}return Bc(u,me),P}function o0(u){return u==null?u:rn.call(u)}function J5(u,d,P){var j=u==null?0:u.length;return j?(P&&typeof P!="number"&&va(u,d,P)?(d=0,P=j):(d=d==null?0:Fr(d),P=P===t?j:Fr(P)),Oa(u,d,P)):[]}function Y5(u,d){return jl(u,d)}function X5(u,d,P){return tf(u,d,ar(P,2))}function Q5(u,d){var P=u==null?0:u.length;if(P){var j=jl(u,d);if(j<P&&ql(u[j],d))return j}return-1}function e4(u,d){return jl(u,d,!0)}function t4(u,d,P){return tf(u,d,ar(P,2),!0)}function n4(u,d){var P=u==null?0:u.length;if(P){var j=jl(u,d,!0)-1;if(ql(u[j],d))return j}return-1}function r4(u){return u&&u.length?nf(u):[]}function i4(u,d){return u&&u.length?nf(u,ar(d,2)):[]}function s4(u){var d=u==null?0:u.length;return d?Oa(u,1,d):[]}function o4(u,d,P){return u&&u.length?(d=P||d===t?1:Fr(d),Oa(u,0,d<0?0:d)):[]}function a4(u,d,P){var j=u==null?0:u.length;return j?(d=P||d===t?1:Fr(d),d=j-d,Oa(u,d<0?0:d,j)):[]}function l4(u,d){return u&&u.length?Du(u,ar(d,3),!1,!0):[]}function u4(u,d){return u&&u.length?Du(u,ar(d,3)):[]}var c4=Ir(function(u){return uu($e(u,1,Vs,!0))}),h4=Ir(function(u){var d=bl(u);return Vs(d)&&(d=t),uu($e(u,1,Vs,!0),ar(d,2))}),f4=Ir(function(u){var d=bl(u);return d=typeof d=="function"?d:t,uu($e(u,1,Vs,!0),t,d)});function d4(u){return u&&u.length?uu(u):[]}function p4(u,d){return u&&u.length?uu(u,ar(d,2)):[]}function g4(u,d){return d=typeof d=="function"?d:t,u&&u.length?uu(u,t,d):[]}function a0(u){if(!(u&&u.length))return[];var d=0;return u=vo(u,function(P){if(Vs(P))return d=J(P.length,d),!0}),ji(d,function(P){return Kr(u,nr(P))})}function l1(u,d){if(!(u&&u.length))return[];var P=a0(u);return d==null?P:Kr(P,function(j){return Zr(d,t,j)})}var m4=Ir(function(u,d){return Vs(u)?S(u,d):[]}),v4=Ir(function(u){return yl(vo(u,Vs))}),y4=Ir(function(u){var d=bl(u);return Vs(d)&&(d=t),yl(vo(u,Vs),ar(d,2))}),_4=Ir(function(u){var d=bl(u);return d=typeof d=="function"?d:t,yl(vo(u,Vs),t,d)}),b4=Ir(a0);function w4(u,d){return Ul(u||[],d||[],ft)}function x4(u,d){return Ul(u||[],d||[],Nu)}var L4=Ir(function(u){var d=u.length,P=d>1?u[d-1]:t;return P=typeof P=="function"?(u.pop(),P):t,l1(u,P)});function u1(u){var d=Te(u);return d.__chain__=!0,d}function S4(u,d){return d(u),u}function dd(u,d){return d(u)}var C4=Iu(function(u){var d=u.length,P=d?u[0]:0,j=this.__wrapped__,me=function(Fe){return bn(Fe,u)};return d>1||this.__actions__.length||!(j instanceof yr)||!Fu(P)?this.thru(me):(j=j.slice(P,+P+(d?1:0)),j.__actions__.push({func:dd,args:[me],thisArg:t}),new ds(j,this.__chain__).thru(function(Fe){return d&&!Fe.length&&Fe.push(t),Fe}))});function P4(){return u1(this)}function E4(){return new ds(this.value(),this.__chain__)}function A4(){this.__values__===t&&(this.__values__=L1(this.value()));var u=this.__index__>=this.__values__.length,d=u?t:this.__values__[this.__index__++];return{done:u,value:d}}function M4(){return this}function k4(u){for(var d,P=this;P instanceof Il;){var j=n1(P);j.__index__=0,j.__values__=t,d?me.__wrapped__=j:d=j;var me=j;P=P.__wrapped__}return me.__wrapped__=u,d}function T4(){var u=this.__wrapped__;if(u instanceof yr){var d=u;return this.__actions__.length&&(d=new yr(this)),d=d.reverse(),d.__actions__.push({func:dd,args:[o0],thisArg:t}),new ds(d,this.__chain__)}return this.thru(o0)}function B4(){return vl(this.__wrapped__,this.__actions__)}var N4=sd(function(u,d,P){Cr.call(u,P)?++u[P]:xn(u,P,1)});function R4(u,d,P){var j=Er(u)?el:q;return P&&va(u,d,P)&&(d=t),j(u,ar(d,3))}function D4(u,d){var P=Er(u)?vo:Je;return P(u,ar(d,3))}var O4=Om(r1),I4=Om(i1);function F4(u,d){return $e(pd(u,d),1)}function z4(u,d){return $e(pd(u,d),ue)}function j4(u,d,P){return P=P===t?1:Fr(P),$e(pd(u,d),P)}function c1(u,d){var P=Er(u)?as:k;return P(u,ar(d,3))}function h1(u,d){var P=Er(u)?mo:F;return P(u,ar(d,3))}var U4=sd(function(u,d,P){Cr.call(u,P)?u[P].push(d):xn(u,P,[d])});function $4(u,d,P,j){u=Fa(u)?u:Ph(u),P=P&&!j?Fr(P):0;var me=u.length;return P<0&&(P=J(me+P,0)),_d(u)?P<=me&&u.indexOf(d,P)>-1:!!me&&ln(u,d,P)>-1}var q4=Ir(function(u,d,P){var j=-1,me=typeof d=="function",Fe=Fa(u)?Bt(u.length):[];return k(u,function(it){Fe[++j]=me?Zr(d,it,P):Oe(it,d,P)}),Fe}),V4=sd(function(u,d,P){xn(u,P,d)});function pd(u,d){var P=Er(u)?Kr:ui;return P(u,ar(d,3))}function G4(u,d,P,j){return u==null?[]:(Er(d)||(d=d==null?[]:[d]),P=j?t:P,Er(P)||(P=P==null?[]:[P]),lu(u,d,P))}var H4=sd(function(u,d,P){u[P?0:1].push(d)},function(){return[[],[]]});function W4(u,d,P){var j=Er(u)?Ho:gi,me=arguments.length<3;return j(u,ar(d,4),P,me,k)}function Z4(u,d,P){var j=Er(u)?zi:gi,me=arguments.length<3;return j(u,ar(d,4),P,me,F)}function K4(u,d){var P=Er(u)?vo:Je;return P(u,vd(ar(d,3)))}function J4(u){var d=Er(u)?It:_h;return d(u)}function Y4(u,d,P){(P?va(u,d,P):d===t)?d=1:d=Fr(d);var j=Er(u)?Lt:ed;return j(u,d)}function X4(u){var d=Er(u)?Vt:nd;return d(u)}function Q4(u){if(u==null)return 0;if(Fa(u))return _d(u)?vs(u):u.length;var d=ta(u);return d==xe||d==Re?u.size:Wr(u).length}function ew(u,d,P){var j=Er(u)?A:rd;return P&&va(u,d,P)&&(d=t),j(u,ar(d,3))}var tw=Ir(function(u,d){if(u==null)return[];var P=d.length;return P>1&&va(u,d[0],d[1])?d=[]:P>2&&va(d[0],d[1],d[2])&&(d=[d[0]]),lu(u,$e(d,1),[])}),gd=Ns||function(){return Ii.Date.now()};function nw(u,d){if(typeof d!="function")throw new bi(l);return u=Fr(u),function(){if(--u<1)return d.apply(this,arguments)}}function f1(u,d,P){return d=P?t:d,d=u&&d==null?u.length:d,Ou(u,Ve,t,t,t,t,d)}function d1(u,d){var P;if(typeof d!="function")throw new bi(l);return u=Fr(u),function(){return--u>0&&(P=d.apply(this,arguments)),u<=1&&(d=t),P}}var l0=Ir(function(u,d,P){var j=Q;if(P.length){var me=ks(P,Sh(l0));j|=De}return Ou(u,j,d,P,me)}),p1=Ir(function(u,d,P){var j=Q|I;if(P.length){var me=ks(P,Sh(p1));j|=De}return Ou(d,j,u,P,me)});function g1(u,d,P){d=P?t:d;var j=Ou(u,ge,t,t,t,t,t,d);return j.placeholder=g1.placeholder,j}function m1(u,d,P){d=P?t:d;var j=Ou(u,Se,t,t,t,t,t,d);return j.placeholder=m1.placeholder,j}function v1(u,d,P){var j,me,Fe,it,pt,Mt,sn=0,an=!1,dn=!1,Mn=!0;if(typeof u!="function")throw new bi(l);d=wl(d)||0,Ss(P)&&(an=!!P.leading,dn="maxWait"in P,Fe=dn?J(wl(P.maxWait)||0,d):Fe,Mn="trailing"in P?!!P.trailing:Mn);function Zn(Gs){var Vl=j,Uu=me;return j=me=t,sn=Gs,it=u.apply(Uu,Vl),it}function cr(Gs){return sn=Gs,pt=of(Qr,d),an?Zn(Gs):it}function Ur(Gs){var Vl=Gs-Mt,Uu=Gs-sn,O1=d-Vl;return dn?_e(O1,Fe-Uu):O1}function hr(Gs){var Vl=Gs-Mt,Uu=Gs-sn;return Mt===t||Vl>=d||Vl<0||dn&&Uu>=Fe}function Qr(){var Gs=gd();if(hr(Gs))return ii(Gs);pt=of(Qr,Ur(Gs))}function ii(Gs){return pt=t,Mn&&j?Zn(Gs):(j=me=t,it)}function il(){pt!==t&&wh(pt),sn=0,j=Mt=me=pt=t}function ya(){return pt===t?it:ii(gd())}function sl(){var Gs=gd(),Vl=hr(Gs);if(j=arguments,me=this,Mt=Gs,Vl){if(pt===t)return cr(Mt);if(dn)return wh(pt),pt=of(Qr,d),Zn(Mt)}return pt===t&&(pt=of(Qr,d)),it}return sl.cancel=il,sl.flush=ya,sl}var rw=Ir(function(u,d){return y(u,1,d)}),iw=Ir(function(u,d,P){return y(u,wl(d)||0,P)});function sw(u){return Ou(u,K)}function md(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new bi(l);var P=function(){var j=arguments,me=d?d.apply(this,j):j[0],Fe=P.cache;if(Fe.has(me))return Fe.get(me);var it=u.apply(this,j);return P.cache=Fe.set(me,it)||Fe,it};return P.cache=new(md.Cache||Qo),P}md.Cache=Qo;function vd(u){if(typeof u!="function")throw new bi(l);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function ow(u){return d1(2,u)}var aw=Wp(function(u,d){d=d.length==1&&Er(d[0])?Kr(d[0],vr(ar())):Kr($e(d,1),vr(ar()));var P=d.length;return Ir(function(j){for(var me=-1,Fe=_e(j.length,P);++me<Fe;)j[me]=d[me].call(this,j[me]);return Zr(u,this,j)})}),u0=Ir(function(u,d){var P=ks(d,Sh(u0));return Ou(u,De,t,d,P)}),y1=Ir(function(u,d){var P=ks(d,Sh(y1));return Ou(u,Ye,t,d,P)}),lw=Iu(function(u,d){return Ou(u,O,t,t,t,d)});function uw(u,d){if(typeof u!="function")throw new bi(l);return d=d===t?d:Fr(d),Ir(u,d)}function cw(u,d){if(typeof u!="function")throw new bi(l);return d=d==null?0:J(Fr(d),0),Ir(function(P){var j=P[d],me=_l(P,0,d);return j&&eo(me,j),Zr(u,this,me)})}function hw(u,d,P){var j=!0,me=!0;if(typeof u!="function")throw new bi(l);return Ss(P)&&(j="leading"in P?!!P.leading:j,me="trailing"in P?!!P.trailing:me),v1(u,d,{leading:j,maxWait:d,trailing:me})}function fw(u){return f1(u,1)}function dw(u,d){return u0(Dc(d),u)}function pw(){if(!arguments.length)return[];var u=arguments[0];return Er(u)?u:[u]}function gw(u){return a(u,b)}function mw(u,d){return d=typeof d=="function"?d:t,a(u,b,d)}function vw(u){return a(u,x|b)}function yw(u,d){return d=typeof d=="function"?d:t,a(u,x|b,d)}function _w(u,d){return d==null||p(u,d,xo(d))}function ql(u,d){return u===d||u!==u&&d!==d}var bw=ud(ct),ww=ud(function(u,d){return u>=d}),Fc=Ne(function(){return arguments}())?Ne:function(u){return Rs(u)&&Cr.call(u,"callee")&&!ai.call(u,"callee")},Er=Bt.isArray,xw=pl?vr(pl):ze;function Fa(u){return u!=null&&yd(u.length)&&!zu(u)}function Vs(u){return Rs(u)&&Fa(u)}function Lw(u){return u===!0||u===!1||Rs(u)&&nt(u)==te}var oc=s||b0,Sw=Mo?vr(Mo):je;function Cw(u){return Rs(u)&&u.nodeType===1&&!af(u)}function Pw(u){if(u==null)return!0;if(Fa(u)&&(Er(u)||typeof u=="string"||typeof u.splice=="function"||oc(u)||Ch(u)||Fc(u)))return!u.length;var d=ta(u);if(d==xe||d==Re)return!u.size;if(sf(u))return!Wr(u).length;for(var P in u)if(Cr.call(u,P))return!1;return!0}function Ew(u,d){return at(u,d)}function Aw(u,d,P){P=typeof P=="function"?P:t;var j=P?P(u,d):t;return j===t?at(u,d,t,P):!!j}function c0(u){if(!Rs(u))return!1;var d=nt(u);return d==Pe||d==se||typeof u.message=="string"&&typeof u.name=="string"&&!af(u)}function Mw(u){return typeof u=="number"&&f(u)}function zu(u){if(!Ss(u))return!1;var d=nt(u);return d==oe||d==re||d==ne||d==Ce}function _1(u){return typeof u=="number"&&u==Fr(u)}function yd(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=ie}function Ss(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function Rs(u){return u!=null&&typeof u=="object"}var b1=Ya?vr(Ya):dt;function kw(u,d){return u===d||Et(u,d,e0(d))}function Tw(u,d,P){return P=typeof P=="function"?P:t,Et(u,d,e0(d),P)}function Bw(u){return w1(u)&&u!=+u}function Nw(u){if(m5(u))throw new zn(o);return At(u)}function Rw(u){return u===null}function Dw(u){return u==null}function w1(u){return typeof u=="number"||Rs(u)&&nt(u)==ye}function af(u){if(!Rs(u)||nt(u)!=Ue)return!1;var d=Io(u);if(d===null)return!0;var P=Cr.call(d,"constructor")&&d.constructor;return typeof P=="function"&&P instanceof P&&Oo.call(P)==ni}var h0=Xa?vr(Xa):nn;function Ow(u){return _1(u)&&u>=-9007199254740991&&u<=ie}var x1=uo?vr(uo):An;function _d(u){return typeof u=="string"||!Er(u)&&Rs(u)&&nt(u)==rt}function rl(u){return typeof u=="symbol"||Rs(u)&&nt(u)==Ze}var Ch=Qa?vr(Qa):Rn;function Iw(u){return u===t}function Fw(u){return Rs(u)&&ta(u)==_t}function zw(u){return Rs(u)&&nt(u)==$t}var jw=ud(Pr),Uw=ud(function(u,d){return u<=d});function L1(u){if(!u)return[];if(Fa(u))return _d(u)?ys(u):Ia(u);if(er&&u[er])return Fs(u[er]());var d=ta(u),P=d==xe?Da:d==Re?Ts:Ph;return P(u)}function ju(u){if(!u)return u===0?u:0;if(u=wl(u),u===ue||u===-1/0){var d=u<0?-1:1;return d*Ae}return u===u?u:0}function Fr(u){var d=ju(u),P=d%1;return d===d?P?d-P:d:0}function S1(u){return u?qn(Fr(u),0,st):0}function wl(u){if(typeof u=="number")return u;if(rl(u))return Me;if(Ss(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=Ss(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=to(u);var P=Xs.test(u);return P||Tr.test(u)?Ja(u.slice(2),P?2:8):Mi.test(u)?Me:+u}function C1(u){return cu(u,za(u))}function $w(u){return u?qn(Fr(u),-9007199254740991,ie):u===0?u:0}function Si(u){return u==null?"":ea(u)}var qw=xh(function(u,d){if(sf(d)||Fa(d)){cu(d,xo(d),u);return}for(var P in d)Cr.call(d,P)&&ft(u,P,d[P])}),P1=xh(function(u,d){cu(d,za(d),u)}),bd=xh(function(u,d,P,j){cu(d,za(d),u,j)}),Vw=xh(function(u,d,P,j){cu(d,xo(d),u,j)}),Gw=Iu(bn);function Hw(u,d){var P=$s(u);return d==null?P:cn(P,d)}var Ww=Ir(function(u,d){u=Yr(u);var P=-1,j=d.length,me=j>2?d[2]:t;for(me&&va(d[0],d[1],me)&&(j=1);++P<j;)for(var Fe=d[P],it=za(Fe),pt=-1,Mt=it.length;++pt<Mt;){var sn=it[pt],an=u[sn];(an===t||ql(an,Ro[sn])&&!Cr.call(u,sn))&&(u[sn]=Fe[sn])}return u}),Zw=Ir(function(u){return u.push(t,qm),Zr(E1,t,u)});function Kw(u,d){return Ct(u,ar(d,3),Wt)}function Jw(u,d){return Ct(u,ar(d,3),gn)}function Yw(u,d){return u==null?u:mt(u,ar(d,3),za)}function Xw(u,d){return u==null?u:Nt(u,ar(d,3),za)}function Qw(u,d){return u&&Wt(u,ar(d,3))}function e3(u,d){return u&&gn(u,ar(d,3))}function t3(u){return u==null?[]:vn(u,xo(u))}function n3(u){return u==null?[]:vn(u,za(u))}function f0(u,d,P){var j=u==null?t:Jn(u,d);return j===t?P:j}function r3(u,d){return u!=null&&Hm(u,d,Ft)}function d0(u,d){return u!=null&&Hm(u,d,xt)}var i3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=Xr.call(d)),u[d]=P},g0(ja)),s3=Fm(function(u,d,P){d!=null&&typeof d.toString!="function"&&(d=Xr.call(d)),Cr.call(u,d)?u[d].push(P):u[d]=[P]},ar),o3=Ir(Oe);function xo(u){return Fa(u)?Ot(u):Wr(u)}function za(u){return Fa(u)?Ot(u,!0):ri(u)}function a3(u,d){var P={};return d=ar(d,3),Wt(u,function(j,me,Fe){xn(P,d(j,me,Fe),j)}),P}function l3(u,d){var P={};return d=ar(d,3),Wt(u,function(j,me,Fe){xn(P,me,d(j,me,Fe))}),P}var u3=xh(function(u,d,P){zo(u,d,P)}),E1=xh(function(u,d,P,j){zo(u,d,P,j)}),c3=Iu(function(u,d){var P={};if(u==null)return P;var j=!1;d=Kr(d,function(Fe){return Fe=$l(Fe,u),j||(j=Fe.length>1),Fe}),cu(u,Xp(u),P),j&&(P=a(P,x|E|b,i5));for(var me=d.length;me--;)Ru(P,d[me]);return P});function h3(u,d){return A1(u,vd(ar(d)))}var f3=Iu(function(u,d){return u==null?{}:jo(u,d)});function A1(u,d){if(u==null)return{};var P=Kr(Xp(u),function(j){return[j]});return d=ar(d),Ls(u,P,function(j,me){return d(j,me[0])})}function d3(u,d,P){d=$l(d,u);var j=-1,me=d.length;for(me||(me=1,u=t);++j<me;){var Fe=u==null?t:u[hu(d[j])];Fe===t&&(j=me,Fe=P),u=zu(Fe)?Fe.call(u):Fe}return u}function p3(u,d,P){return u==null?u:Nu(u,d,P)}function g3(u,d,P,j){return j=typeof j=="function"?j:t,u==null?u:Nu(u,d,P,j)}var M1=Um(xo),k1=Um(za);function m3(u,d,P){var j=Er(u),me=j||oc(u)||Ch(u);if(d=ar(d,4),P==null){var Fe=u&&u.constructor;me?P=j?new Fe:[]:Ss(u)?P=zu(Fe)?$s(Io(u)):{}:P={}}return(me?as:Wt)(u,function(it,pt,Mt){return d(P,it,pt,Mt)}),P}function v3(u,d){return u==null?!0:Ru(u,d)}function y3(u,d,P){return u==null?u:bh(u,d,Dc(P))}function _3(u,d,P,j){return j=typeof j=="function"?j:t,u==null?u:bh(u,d,Dc(P),j)}function Ph(u){return u==null?[]:gs(u,xo(u))}function b3(u){return u==null?[]:gs(u,za(u))}function w3(u,d,P){return P===t&&(P=d,d=t),P!==t&&(P=wl(P),P=P===P?P:0),d!==t&&(d=wl(d),d=d===d?d:0),qn(wl(u),d,P)}function x3(u,d,P){return d=ju(d),P===t?(P=d,d=0):P=ju(P),u=wl(u),Rt(u,d,P)}function L3(u,d,P){if(P&&typeof P!="boolean"&&va(u,d,P)&&(d=P=t),P===t&&(typeof d=="boolean"?(P=d,d=t):typeof u=="boolean"&&(P=u,u=t)),u===t&&d===t?(u=0,d=1):(u=ju(u),d===t?(d=u,u=0):d=ju(d)),u>d){var j=u;u=d,d=j}if(P||u%1||d%1){var me=jt();return _e(u+me*(d-u+ka("1e-"+((me+"").length-1))),d)}return Nc(u,d)}var S3=Lh(function(u,d,P){return d=d.toLowerCase(),u+(P?T1(d):d)});function T1(u){return p0(Si(u).toLowerCase())}function B1(u){return u=Si(u),u&&u.replace(di,Dl).replace(Nl,"")}function C3(u,d,P){u=Si(u),d=ea(d);var j=u.length;P=P===t?j:qn(Fr(P),0,j);var me=P;return P-=d.length,P>=0&&u.slice(P,me)==d}function P3(u){return u=Si(u),u&&Gn.test(u)?u.replace(Pn,da):u}function E3(u){return u=Si(u),u&&Lr.test(u)?u.replace(xi,"\\$&"):u}var A3=Lh(function(u,d,P){return u+(P?"-":"")+d.toLowerCase()}),M3=Lh(function(u,d,P){return u+(P?" ":"")+d.toLowerCase()}),k3=Dm("toLowerCase");function T3(u,d,P){u=Si(u),d=Fr(d);var j=d?vs(u):0;if(!d||j>=d)return u;var me=(d-j)/2;return ld(hs(me),P)+u+ld(cs(me),P)}function B3(u,d,P){u=Si(u),d=Fr(d);var j=d?vs(u):0;return d&&j<d?u+ld(d-j,P):u}function N3(u,d,P){u=Si(u),d=Fr(d);var j=d?vs(u):0;return d&&j<d?ld(d-j,P)+u:u}function R3(u,d,P){return P||d==null?d=0:d&&(d=+d),Tt(Si(u).replace(Gr,""),d||0)}function D3(u,d,P){return(P?va(u,d,P):d===t)?d=1:d=Fr(d),yh(Si(u),d)}function O3(){var u=arguments,d=Si(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var I3=Lh(function(u,d,P){return u+(P?"_":"")+d.toLowerCase()});function F3(u,d,P){return P&&typeof P!="number"&&va(u,d,P)&&(d=P=t),P=P===t?st:P>>>0,P?(u=Si(u),u&&(typeof d=="string"||d!=null&&!h0(d))&&(d=ea(d),!d&&To(u))?_l(ys(u),0,P):u.split(d,P)):[]}var z3=Lh(function(u,d,P){return u+(P?" ":"")+p0(d)});function j3(u,d,P){return u=Si(u),P=P==null?0:qn(Fr(P),0,u.length),d=ea(d),u.slice(P,P+d.length)==d}function U3(u,d,P){var j=Te.templateSettings;P&&va(u,d,P)&&(d=t),u=Si(u),d=bd({},d,j,$m);var me=bd({},d.imports,j.imports,$m),Fe=xo(me),it=gs(me,Fe),pt,Mt,sn=0,an=d.interpolate||Dr,dn="__p += '",Mn=tl((d.escape||Dr).source+"|"+an.source+"|"+(an===lr?Qi:Dr).source+"|"+(d.evaluate||Dr).source+"|$","g"),Zn="//# sourceURL="+(Cr.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Za+"]")+`
`;u.replace(Mn,function(hr,Qr,ii,il,ya,sl){return ii||(ii=il),dn+=u.slice(sn,sl).replace(si,pa),Qr&&(pt=!0,dn+=`' +
__e(`+Qr+`) +
'`),ya&&(Mt=!0,dn+=`';
`+ya+`;
__p += '`),ii&&(dn+=`' +
((__t = (`+ii+`)) == null ? '' : __t) +
'`),sn=sl+hr.length,hr}),dn+=`';
`;var cr=Cr.call(d,"variable")&&d.variable;if(!cr)dn=`with (obj) {
`+dn+`
}
`;else if(ei.test(cr))throw new zn(h);dn=(Mt?dn.replace(et,""):dn).replace(On,"$1").replace(Nn,"$1;"),dn="function("+(cr||"obj")+`) {
`+(cr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(pt?", __e = _.escape":"")+(Mt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+dn+`return __p
}`;var Ur=R1(function(){return sr(Fe,Zn+"return "+dn).apply(t,it)});if(Ur.source=dn,c0(Ur))throw Ur;return Ur}function $3(u){return Si(u).toLowerCase()}function q3(u){return Si(u).toUpperCase()}function V3(u,d,P){if(u=Si(u),u&&(P||d===t))return to(u);if(!u||!(d=ea(d)))return u;var j=ys(u),me=ys(d),Fe=Ms(j,me),it=gl(j,me)+1;return _l(j,Fe,it).join("")}function G3(u,d,P){if(u=Si(u),u&&(P||d===t))return u.slice(0,Zo(u)+1);if(!u||!(d=ea(d)))return u;var j=ys(u),me=gl(j,ys(d))+1;return _l(j,0,me).join("")}function H3(u,d,P){if(u=Si(u),u&&(P||d===t))return u.replace(Gr,"");if(!u||!(d=ea(d)))return u;var j=ys(u),me=Ms(j,ys(d));return _l(j,me).join("")}function W3(u,d){var P=ce,j=H;if(Ss(d)){var me="separator"in d?d.separator:me;P="length"in d?Fr(d.length):P,j="omission"in d?ea(d.omission):j}u=Si(u);var Fe=u.length;if(To(u)){var it=ys(u);Fe=it.length}if(P>=Fe)return u;var pt=P-vs(j);if(pt<1)return j;var Mt=it?_l(it,0,pt).join(""):u.slice(0,pt);if(me===t)return Mt+j;if(it&&(pt+=Mt.length-pt),h0(me)){if(u.slice(pt).search(me)){var sn,an=Mt;for(me.global||(me=tl(me.source,Si(Yn.exec(me))+"g")),me.lastIndex=0;sn=me.exec(an);)var dn=sn.index;Mt=Mt.slice(0,dn===t?pt:dn)}}else if(u.indexOf(ea(me),pt)!=pt){var Mn=Mt.lastIndexOf(me);Mn>-1&&(Mt=Mt.slice(0,Mn))}return Mt+j}function Z3(u){return u=Si(u),u&&zr.test(u)?u.replace(mn,Ko):u}var K3=Lh(function(u,d,P){return u+(P?" ":"")+d.toUpperCase()}),p0=Dm("toUpperCase");function N1(u,d,P){return u=Si(u),d=P?t:d,d===t?no(u)?Bo(u):ut(u):u.match(d)||[]}var R1=Ir(function(u,d){try{return Zr(u,t,d)}catch(P){return c0(P)?P:new zn(P)}}),J3=Iu(function(u,d){return as(d,function(P){P=hu(P),xn(u,P,l0(u[P],u))}),u});function Y3(u){var d=u==null?0:u.length,P=ar();return u=d?Kr(u,function(j){if(typeof j[1]!="function")throw new bi(l);return[P(j[0]),j[1]]}):[],Ir(function(j){for(var me=-1;++me<d;){var Fe=u[me];if(Zr(Fe[0],this,j))return Zr(Fe[1],this,j)}})}function X3(u){return c(a(u,x))}function g0(u){return function(){return u}}function Q3(u,d){return u==null||u!==u?d:u}var ex=Im(),tx=Im(!0);function ja(u){return u}function m0(u){return Vn(typeof u=="function"?u:a(u,x))}function nx(u){return qs(a(u,x))}function rx(u,d){return Fl(u,a(d,x))}var ix=Ir(function(u,d){return function(P){return Oe(P,u,d)}}),sx=Ir(function(u,d){return function(P){return Oe(u,P,d)}});function v0(u,d,P){var j=xo(d),me=vn(d,j);P==null&&!(Ss(d)&&(me.length||!j.length))&&(P=d,d=u,u=this,me=vn(d,xo(d)));var Fe=!(Ss(P)&&"chain"in P)||!!P.chain,it=zu(u);return as(me,function(pt){var Mt=d[pt];u[pt]=Mt,it&&(u.prototype[pt]=function(){var sn=this.__chain__;if(Fe||sn){var an=u(this.__wrapped__),dn=an.__actions__=Ia(this.__actions__);return dn.push({func:Mt,args:arguments,thisArg:u}),an.__chain__=sn,an}return Mt.apply(u,eo([this.value()],arguments))})}),u}function ox(){return Ii._===this&&(Ii._=Ui),this}function y0(){}function ax(u){return u=Fr(u),Ir(function(d){return ma(d,u)})}var lx=Kp(Kr),ux=Kp(el),cx=Kp(A);function D1(u){return n0(u)?nr(hu(u)):$i(u)}function hx(u){return function(d){return u==null?t:Jn(u,d)}}var fx=zm(),dx=zm(!0);function _0(){return[]}function b0(){return!1}function px(){return{}}function gx(){return""}function mx(){return!0}function vx(u,d){if(u=Fr(u),u<1||u>ie)return[];var P=st,j=_e(u,st);d=ar(d),u-=st;for(var me=ji(j,d);++P<u;)d(P);return me}function yx(u){return Er(u)?Kr(u,hu):rl(u)?[u]:Ia(t1(Si(u)))}function _x(u){var d=++yo;return Si(u)+d}var bx=ad(function(u,d){return u+d},0),wx=Jp("ceil"),xx=ad(function(u,d){return u/d},1),Lx=Jp("floor");function Sx(u){return u&&u.length?ae(u,ja,ct):t}function Cx(u,d){return u&&u.length?ae(u,ar(d,2),ct):t}function Px(u){return Hn(u,ja)}function Ex(u,d){return Hn(u,ar(d,2))}function Ax(u){return u&&u.length?ae(u,ja,Pr):t}function Mx(u,d){return u&&u.length?ae(u,ar(d,2),Pr):t}var kx=ad(function(u,d){return u*d},1),Tx=Jp("round"),Bx=ad(function(u,d){return u-d},0);function Nx(u){return u&&u.length?Jr(u,ja):0}function Rx(u,d){return u&&u.length?Jr(u,ar(d,2)):0}return Te.after=nw,Te.ary=f1,Te.assign=qw,Te.assignIn=P1,Te.assignInWith=bd,Te.assignWith=Vw,Te.at=Gw,Te.before=d1,Te.bind=l0,Te.bindAll=J3,Te.bindKey=p1,Te.castArray=pw,Te.chain=u1,Te.chunk=L5,Te.compact=S5,Te.concat=C5,Te.cond=Y3,Te.conforms=X3,Te.constant=g0,Te.countBy=N4,Te.create=Hw,Te.curry=g1,Te.curryRight=m1,Te.debounce=v1,Te.defaults=Ww,Te.defaultsDeep=Zw,Te.defer=rw,Te.delay=iw,Te.difference=P5,Te.differenceBy=E5,Te.differenceWith=A5,Te.drop=M5,Te.dropRight=k5,Te.dropRightWhile=T5,Te.dropWhile=B5,Te.fill=N5,Te.filter=D4,Te.flatMap=F4,Te.flatMapDeep=z4,Te.flatMapDepth=j4,Te.flatten=s1,Te.flattenDeep=R5,Te.flattenDepth=D5,Te.flip=sw,Te.flow=ex,Te.flowRight=tx,Te.fromPairs=O5,Te.functions=t3,Te.functionsIn=n3,Te.groupBy=U4,Te.initial=F5,Te.intersection=z5,Te.intersectionBy=j5,Te.intersectionWith=U5,Te.invert=i3,Te.invertBy=s3,Te.invokeMap=q4,Te.iteratee=m0,Te.keyBy=V4,Te.keys=xo,Te.keysIn=za,Te.map=pd,Te.mapKeys=a3,Te.mapValues=l3,Te.matches=nx,Te.matchesProperty=rx,Te.memoize=md,Te.merge=u3,Te.mergeWith=E1,Te.method=ix,Te.methodOf=sx,Te.mixin=v0,Te.negate=vd,Te.nthArg=ax,Te.omit=c3,Te.omitBy=h3,Te.once=ow,Te.orderBy=G4,Te.over=lx,Te.overArgs=aw,Te.overEvery=ux,Te.overSome=cx,Te.partial=u0,Te.partialRight=y1,Te.partition=H4,Te.pick=f3,Te.pickBy=A1,Te.property=D1,Te.propertyOf=hx,Te.pull=G5,Te.pullAll=a1,Te.pullAllBy=H5,Te.pullAllWith=W5,Te.pullAt=Z5,Te.range=fx,Te.rangeRight=dx,Te.rearg=lw,Te.reject=K4,Te.remove=K5,Te.rest=uw,Te.reverse=o0,Te.sampleSize=Y4,Te.set=p3,Te.setWith=g3,Te.shuffle=X4,Te.slice=J5,Te.sortBy=tw,Te.sortedUniq=r4,Te.sortedUniqBy=i4,Te.split=F3,Te.spread=cw,Te.tail=s4,Te.take=o4,Te.takeRight=a4,Te.takeRightWhile=l4,Te.takeWhile=u4,Te.tap=S4,Te.throttle=hw,Te.thru=dd,Te.toArray=L1,Te.toPairs=M1,Te.toPairsIn=k1,Te.toPath=yx,Te.toPlainObject=C1,Te.transform=m3,Te.unary=fw,Te.union=c4,Te.unionBy=h4,Te.unionWith=f4,Te.uniq=d4,Te.uniqBy=p4,Te.uniqWith=g4,Te.unset=v3,Te.unzip=a0,Te.unzipWith=l1,Te.update=y3,Te.updateWith=_3,Te.values=Ph,Te.valuesIn=b3,Te.without=m4,Te.words=N1,Te.wrap=dw,Te.xor=v4,Te.xorBy=y4,Te.xorWith=_4,Te.zip=b4,Te.zipObject=w4,Te.zipObjectDeep=x4,Te.zipWith=L4,Te.entries=M1,Te.entriesIn=k1,Te.extend=P1,Te.extendWith=bd,v0(Te,Te),Te.add=bx,Te.attempt=R1,Te.camelCase=S3,Te.capitalize=T1,Te.ceil=wx,Te.clamp=w3,Te.clone=gw,Te.cloneDeep=vw,Te.cloneDeepWith=yw,Te.cloneWith=mw,Te.conformsTo=_w,Te.deburr=B1,Te.defaultTo=Q3,Te.divide=xx,Te.endsWith=C3,Te.eq=ql,Te.escape=P3,Te.escapeRegExp=E3,Te.every=R4,Te.find=O4,Te.findIndex=r1,Te.findKey=Kw,Te.findLast=I4,Te.findLastIndex=i1,Te.findLastKey=Jw,Te.floor=Lx,Te.forEach=c1,Te.forEachRight=h1,Te.forIn=Yw,Te.forInRight=Xw,Te.forOwn=Qw,Te.forOwnRight=e3,Te.get=f0,Te.gt=bw,Te.gte=ww,Te.has=r3,Te.hasIn=d0,Te.head=o1,Te.identity=ja,Te.includes=$4,Te.indexOf=I5,Te.inRange=x3,Te.invoke=o3,Te.isArguments=Fc,Te.isArray=Er,Te.isArrayBuffer=xw,Te.isArrayLike=Fa,Te.isArrayLikeObject=Vs,Te.isBoolean=Lw,Te.isBuffer=oc,Te.isDate=Sw,Te.isElement=Cw,Te.isEmpty=Pw,Te.isEqual=Ew,Te.isEqualWith=Aw,Te.isError=c0,Te.isFinite=Mw,Te.isFunction=zu,Te.isInteger=_1,Te.isLength=yd,Te.isMap=b1,Te.isMatch=kw,Te.isMatchWith=Tw,Te.isNaN=Bw,Te.isNative=Nw,Te.isNil=Dw,Te.isNull=Rw,Te.isNumber=w1,Te.isObject=Ss,Te.isObjectLike=Rs,Te.isPlainObject=af,Te.isRegExp=h0,Te.isSafeInteger=Ow,Te.isSet=x1,Te.isString=_d,Te.isSymbol=rl,Te.isTypedArray=Ch,Te.isUndefined=Iw,Te.isWeakMap=Fw,Te.isWeakSet=zw,Te.join=$5,Te.kebabCase=A3,Te.last=bl,Te.lastIndexOf=q5,Te.lowerCase=M3,Te.lowerFirst=k3,Te.lt=jw,Te.lte=Uw,Te.max=Sx,Te.maxBy=Cx,Te.mean=Px,Te.meanBy=Ex,Te.min=Ax,Te.minBy=Mx,Te.stubArray=_0,Te.stubFalse=b0,Te.stubObject=px,Te.stubString=gx,Te.stubTrue=mx,Te.multiply=kx,Te.nth=V5,Te.noConflict=ox,Te.noop=y0,Te.now=gd,Te.pad=T3,Te.padEnd=B3,Te.padStart=N3,Te.parseInt=R3,Te.random=L3,Te.reduce=W4,Te.reduceRight=Z4,Te.repeat=D3,Te.replace=O3,Te.result=d3,Te.round=Tx,Te.runInContext=bt,Te.sample=J4,Te.size=Q4,Te.snakeCase=I3,Te.some=ew,Te.sortedIndex=Y5,Te.sortedIndexBy=X5,Te.sortedIndexOf=Q5,Te.sortedLastIndex=e4,Te.sortedLastIndexBy=t4,Te.sortedLastIndexOf=n4,Te.startCase=z3,Te.startsWith=j3,Te.subtract=Bx,Te.sum=Nx,Te.sumBy=Rx,Te.template=U3,Te.times=vx,Te.toFinite=ju,Te.toInteger=Fr,Te.toLength=S1,Te.toLower=$3,Te.toNumber=wl,Te.toSafeInteger=$w,Te.toString=Si,Te.toUpper=q3,Te.trim=V3,Te.trimEnd=G3,Te.trimStart=H3,Te.truncate=W3,Te.unescape=Z3,Te.uniqueId=_x,Te.upperCase=K3,Te.upperFirst=p0,Te.each=c1,Te.eachRight=h1,Te.first=o1,v0(Te,function(){var u={};return Wt(Te,function(d,P){Cr.call(Te.prototype,P)||(u[P]=d)}),u}(),{chain:!1}),Te.VERSION=r,as(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Te[u].placeholder=Te}),as(["drop","take"],function(u,d){yr.prototype[u]=function(P){P=P===t?1:J(Fr(P),0);var j=this.__filtered__&&!d?new yr(this):this.clone();return j.__filtered__?j.__takeCount__=_e(P,j.__takeCount__):j.__views__.push({size:_e(P,st),type:u+(j.__dir__<0?"Right":"")}),j},yr.prototype[u+"Right"]=function(P){return this.reverse()[u](P).reverse()}}),as(["filter","map","takeWhile"],function(u,d){var P=d+1,j=P==z||P==G;yr.prototype[u]=function(me){var Fe=this.clone();return Fe.__iteratees__.push({iteratee:ar(me,3),type:P}),Fe.__filtered__=Fe.__filtered__||j,Fe}}),as(["head","last"],function(u,d){var P="take"+(d?"Right":"");yr.prototype[u]=function(){return this[P](1).value()[0]}}),as(["initial","tail"],function(u,d){var P="drop"+(d?"":"Right");yr.prototype[u]=function(){return this.__filtered__?new yr(this):this[P](1)}}),yr.prototype.compact=function(){return this.filter(ja)},yr.prototype.find=function(u){return this.filter(u).head()},yr.prototype.findLast=function(u){return this.reverse().find(u)},yr.prototype.invokeMap=Ir(function(u,d){return typeof u=="function"?new yr(this):this.map(function(P){return Oe(P,u,d)})}),yr.prototype.reject=function(u){return this.filter(vd(ar(u)))},yr.prototype.slice=function(u,d){u=Fr(u);var P=this;return P.__filtered__&&(u>0||d<0)?new yr(P):(u<0?P=P.takeRight(-u):u&&(P=P.drop(u)),d!==t&&(d=Fr(d),P=d<0?P.dropRight(-d):P.take(d-u)),P)},yr.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},yr.prototype.toArray=function(){return this.take(st)},Wt(yr.prototype,function(u,d){var P=/^(?:filter|find|map|reject)|While$/.test(d),j=/^(?:head|last)$/.test(d),me=Te[j?"take"+(d=="last"?"Right":""):d],Fe=j||/^find/.test(d);me&&(Te.prototype[d]=function(){var it=this.__wrapped__,pt=j?[1]:arguments,Mt=it instanceof yr,sn=pt[0],an=Mt||Er(it),dn=function(Qr){var ii=me.apply(Te,eo([Qr],pt));return j&&Mn?ii[0]:ii};an&&P&&typeof sn=="function"&&sn.length!=1&&(Mt=an=!1);var Mn=this.__chain__,Zn=!!this.__actions__.length,cr=Fe&&!Mn,Ur=Mt&&!Zn;if(!Fe&&an){it=Ur?it:new yr(this);var hr=u.apply(it,pt);return hr.__actions__.push({func:dd,args:[dn],thisArg:t}),new ds(hr,Mn)}return cr&&Ur?u.apply(this,pt):(hr=this.thru(dn),cr?j?hr.value()[0]:hr.value():hr)})}),as(["pop","push","shift","sort","splice","unshift"],function(u){var d=No[u],P=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",j=/^(?:pop|shift)$/.test(u);Te.prototype[u]=function(){var me=arguments;if(j&&!this.__chain__){var Fe=this.value();return d.apply(Er(Fe)?Fe:[],me)}return this[P](function(it){return d.apply(Er(it)?it:[],me)})}}),Wt(yr.prototype,function(u,d){var P=Te[d];if(P){var j=P.name+"";Cr.call(Us,j)||(Us[j]=[]),Us[j].push({name:d,func:P})}}),Us[od(t,I).name]=[{name:"wrapper",func:t}],yr.prototype.clone=ec,yr.prototype.reverse=hh,yr.prototype.value=tc,Te.prototype.at=C4,Te.prototype.chain=P4,Te.prototype.commit=E4,Te.prototype.next=A4,Te.prototype.plant=k4,Te.prototype.reverse=T4,Te.prototype.toJSON=Te.prototype.valueOf=Te.prototype.value=B4,Te.prototype.first=Te.prototype.head,er&&(Te.prototype[er]=M4),Te},bs=ro();Fi?((Fi.exports=bs)._=bs,Wn._=bs):Ii._=bs}).call(qo)})(gp,gp.exports);var wb=gp.exports;class $o extends fn.Polygon{constructor(t,r={}){super([],{...r,pmIgnore:!1,interactive:!0});Pt(this,"_width");Pt(this,"_height");Pt(this,"_center");Pt(this,"_rotation");Pt(this,"_isMapReady",!1);Pt(this,"properties");Pt(this,"_helperPoints",{corners:[],midPoints:[]});Pt(this,"_throttledUpdateProperties");const i=t instanceof fn.LatLngBounds?t:fn.latLngBounds(t);if(this._center=i.getCenter(),this._rotation=0,console.log("[Rectangle][constructor] Initialisation avec options:",{bounds:i,center:this._center,hasExplicitDimensions:!!(r.width&&r.height),width:r.width,height:r.height}),r.width&&r.height)this._width=r.width,this._height=r.height,console.log("[Rectangle][constructor] Utilisation des dimensions explicites:",{width:this._width,height:this._height});else{const o=i.getSouthWest(),l=i.getNorthEast();this._width=St.measure("Rectangle.constructor.calculateWidth",()=>{const h=U0([o.lng,o.lat],[l.lng,o.lat],{units:"meters"});return Math.max(h,1)}),this._height=St.measure("Rectangle.constructor.calculateHeight",()=>{const h=U0([o.lng,o.lat],[o.lng,l.lat],{units:"meters"});return Math.max(h,1)}),console.log("[Rectangle][constructor] Dimensions calculées depuis bounds:",{width:this._width,height:this._height})}(this._width<1||this._height<1)&&this._getPixelsPerMeter()>0&&(this._width=Math.max(this._width,1),this._height=Math.max(this._height,1),this._updatePolygonCoordinates()),this.properties=St.measure("Rectangle.constructor.initProperties",()=>({type:"Rectangle",style:{...r,name:r.name||""},rotation:this._rotation})),this._throttledUpdateProperties=St.measure("Rectangle.constructor.initThrottle",()=>wb.throttle(()=>{this.updateProperties()},100)),this.on("add",()=>{this._isMapReady=!0,this._updatePolygonCoordinates(),this.updateProperties()}),this.on("remove",()=>{this._isMapReady=!1})}_updatePolygonCoordinates(){St.measure("Rectangle._updatePolygonCoordinates",()=>{if(!this._isMapReady||!this._map)return;console.log("[Rectangle][_updatePolygonCoordinates] Début mise à jour avec:",{width:this._width,height:this._height,center:this._center,rotation:this._rotation}),this._width=Math.max(this._width,1),this._height=Math.max(this._height,1);const t=this._width/2,r=this._height/2,i=py([this._center.lng,this._center.lat],r,0,{units:"meters"}).geometry.coordinates,o=py([this._center.lng,this._center.lat],t,90,{units:"meters"}).geometry.coordinates,l=Math.abs(i[1]-this._center.lat)*2,h=Math.abs(o[0]-this._center.lng)*2,g=[fn.latLng(this._center.lat+l/2,this._center.lng-h/2),fn.latLng(this._center.lat+l/2,this._center.lng+h/2),fn.latLng(this._center.lat-l/2,this._center.lng+h/2),fn.latLng(this._center.lat-l/2,this._center.lng-h/2)];if(this._rotation===0){this.setLatLngs(g);return}const v=this._map.latLngToContainerPoint(this._center),_=g.map(Q=>this._map.latLngToContainerPoint(Q)),x=-this._rotation*Math.PI/180,E=Math.cos(x),b=Math.sin(x),$=_.map(Q=>{const I=Q.x-v.x,W=Q.y-v.y;return fn.point(v.x+(I*E-W*b),v.y+(I*b+W*E))}).map(Q=>this._map.containerPointToLatLng(Q));console.log("[Rectangle][_updatePolygonCoordinates] Résultat final:",{corners:$,dimensions:{width:this._width,height:this._height}}),this.setLatLngs($),this.fire("coordinates:updated",{corners:$,center:this._center,rotation:this._rotation,dimensions:{width:this._width,height:this._height}})})}_getPixelsPerMeter(){return St.measure("Rectangle._getPixelsPerMeter",()=>{if(!this._isMapReady||!this._map)return 1;const t=Math.max(this._width/1e3,1e-4),r=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(fn.latLng(this._center.lat,this._center.lng+t)).x-r.x,l=U0([this._center.lng,this._center.lat],[this._center.lng+t,this._center.lat],{units:"meters"}),h=Math.abs(o/l);return isNaN(h)||h<=0?(console.warn("[Rectangle][_getPixelsPerMeter] Ratio invalide, utilisation de la valeur par défaut"),1):h})}getRotatedCorners(){return St.measure("Rectangle.getRotatedCorners",()=>{try{const t=this.getLatLngs();if(!t||!Array.isArray(t)||t.length===0){const r=this._width/2,i=this._height/2;return[fn.latLng(this._center.lat+i,this._center.lng-r),fn.latLng(this._center.lat+i,this._center.lng+r),fn.latLng(this._center.lat-i,this._center.lng+r),fn.latLng(this._center.lat-i,this._center.lng-r)]}return t[0]}catch(t){console.warn("Error in getRotatedCorners:",t);const r=this._width/2,i=this._height/2;return[fn.latLng(this._center.lat+i,this._center.lng-r),fn.latLng(this._center.lat+i,this._center.lng+r),fn.latLng(this._center.lat-i,this._center.lng+r),fn.latLng(this._center.lat-i,this._center.lng-r)]}})}getMidPoints(){return St.measure("Rectangle.getMidPoints",()=>{try{const t=this.getRotatedCorners();if(!t||t.length<4){const i=this._width/2,o=this._height/2;return[fn.latLng(this._center.lat+o,this._center.lng),fn.latLng(this._center.lat,this._center.lng+i),fn.latLng(this._center.lat-o,this._center.lng),fn.latLng(this._center.lat,this._center.lng-i)]}if(!t.every(i=>i&&typeof i.lat=="number"&&typeof i.lng=="number"))throw new Error("Invalid corner coordinates");return[this._getMidPoint(t[3],t[0]),this._getMidPoint(t[0],t[1]),this._getMidPoint(t[1],t[2]),this._getMidPoint(t[2],t[3])]}catch(t){console.warn("Error in getMidPoints:",t);const r=this._width/2,i=this._height/2;return[fn.latLng(this._center.lat+i,this._center.lng),fn.latLng(this._center.lat,this._center.lng+r),fn.latLng(this._center.lat-i,this._center.lng),fn.latLng(this._center.lat,this._center.lng-r)]}})}_getMidPoint(t,r){return St.measure("Rectangle._getMidPoint",()=>{if(!t||!r||typeof t.lat!="number"||typeof t.lng!="number"||typeof r.lat!="number"||typeof r.lng!="number")throw new Error("Invalid points for midpoint calculation");return fn.latLng((t.lat+r.lat)/2,(t.lng+r.lng)/2)})}getCenter(){return St.measure("Rectangle.getCenter",()=>this._center)}setCenter(t){St.measure("Rectangle.setCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties(),this.updateHelperPointPositions()})}getRotation(){return St.measure("Rectangle.getRotation",()=>this._rotation)}setRotation(t,r=!1){St.measure("Rectangle.setRotation",()=>{this._rotation=(t%360+360)%360,this._updatePolygonCoordinates(),r&&this.updateProperties(),this.updateHelperPointPositions(),this.fire("rotation:updated",{angle:this._rotation,corners:this.getRotatedCorners(),center:this._center})})}finalizeRotation(){St.measure("Rectangle.finalizeRotation",()=>{this.updateProperties()})}getDimensions(){return St.measure("Rectangle.getDimensions",()=>({width:this._width,height:this._height}))}setDimensions(t,r){St.measure("Rectangle.setDimensions",()=>{console.log("[Rectangle][setDimensions] Début de la mise à jour des dimensions:",{oldWidth:this._width,oldHeight:this._height,newWidth:t,newHeight:r}),this._width=t,this._height=r,console.log("[Rectangle][setDimensions] Mise à jour des coordonnées du polygone"),this._updatePolygonCoordinates(),console.log("[Rectangle][setDimensions] Mise à jour des propriétés"),this.updateProperties(),console.log("[Rectangle][setDimensions] Émission de l'événement dimensions:updated"),this.fire("dimensions:updated",{width:this._width,height:this._height,corners:this.getRotatedCorners(),center:this._center}),this.updateHelperPointPositions()})}resizeFromCorner(t,r){St.measure("Rectangle.resizeFromCorner",()=>{if(!(!this._isMapReady||!this._map))try{const i=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(r),l=o.x-i.x,h=o.y-i.y,g=-this._rotation*Math.PI/180,v=Math.cos(g),_=Math.sin(g),x=l*v-h*_,E=l*_+h*v,b=this._getPixelsPerMeter(),R=t===0||t===3?-1:1,$=t===0||t===1?1:-1,Q=Math.max(Math.abs(x*2)/b,1),I=Math.max(Math.abs(E*2)/b,1),W=Q*b/2,ge=I*b/2,Se=R*W*v-$*ge*_,De=R*W*_+$*ge*v,Ye=fn.point(o.x-Se,o.y-De),Ve=this._map.containerPointToLatLng(Ye),ce=[fn.point(Ye.x-W,Ye.y+ge),fn.point(Ye.x+W,Ye.y+ge),fn.point(Ye.x+W,Ye.y-ge),fn.point(Ye.x-W,Ye.y-ge)].map(H=>{const D=H.x-Ye.x,V=H.y-Ye.y;return fn.point(Ye.x+(D*v-V*_),Ye.y+(D*_+V*v))}).map(H=>this._map.containerPointToLatLng(H));this._width=Q,this._height=I,this._center=Ve,this.setLatLngs(ce),this.fire("coordinates:updated",{corners:ce,center:this._center,rotation:this._rotation})}catch(i){console.warn("Error in resizeFromCorner:",i)}})}resizeFromSide(t,r){St.measure("Rectangle.resizeFromSide",()=>{if(!this._isMapReady||!this._map)return;const i=this._map.latLngToContainerPoint(this._center),o=this._map.latLngToContainerPoint(r),l=o.x-i.x,h=o.y-i.y,g=-this._rotation*Math.PI/180,v=Math.cos(g),_=Math.sin(g),x=l*v-h*_,E=l*_+h*v,b=this._getPixelsPerMeter();t%2===0?this._height=Math.abs(E*2)/b:this._width=Math.abs(x*2)/b,this._updatePolygonCoordinates(),this.updateProperties()})}moveFromCenter(t){St.measure("Rectangle.moveFromCenter",()=>{this._center=t,this._updatePolygonCoordinates(),this.updateProperties()})}updateProperties(){St.measure("Rectangle.updateProperties",()=>{var i,o,l;const t=this.getRotatedCorners(),r=((o=(i=this.properties)==null?void 0:i.style)==null?void 0:o.name)||"";this.properties={...this.properties,width:this._width,height:this._height,surface:this._width*this._height,perimeter:2*(this._width+this._height),center:this._center,corners:t,midPoints:this.getMidPoints(),rotation:this._rotation,style:{...this.options,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((l=this.options)==null?void 0:l.dashArray)||"",name:r}},this.fire("properties:updated",{shape:this,properties:this.properties,corners:t,midPoints:this.getMidPoints()})})}setName(t){St.measure("Rectangle.setName",()=>{this.properties.style||(this.properties.style={}),this.properties.style.name=t,this.fire("properties:updated",{shape:this,properties:this.properties})})}getName(){return St.measure("Rectangle.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""})}generateHelperPoints(t,r="rgba(220, 38, 38, 0.5)",i="rgba(37, 99, 235, 0.5)"){St.measure("Rectangle.generateHelperPoints",()=>{this.clearHelperPoints();const o=this.getRotatedCorners(),l=this.getMidPoints();this._helperPoints.corners=o.map(h=>fn.circleMarker(h,{radius:5,color:r,fillColor:r,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-corner",pmIgnore:!0,interactive:!1}).addTo(t)),this._helperPoints.midPoints=l.map(h=>fn.circleMarker(h,{radius:5,color:i,fillColor:i,fillOpacity:.6,weight:1,opacity:.8,className:"rectangle-helper-midpoint",pmIgnore:!0,interactive:!1}).addTo(t))})}clearHelperPoints(){St.measure("Rectangle.clearHelperPoints",()=>{this._helperPoints.corners.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de coin:",r)}}),this._helperPoints.midPoints.forEach(t=>{if(t&&t.remove)try{t.remove()}catch(r){console.warn("Erreur lors de la suppression d'un point d'aide de milieu:",r)}}),this._helperPoints.corners=[],this._helperPoints.midPoints=[]})}updateHelperPointPositions(){St.measure("Rectangle.updateHelperPointPositions",()=>{if(this._helperPoints.corners.length===0&&this._helperPoints.midPoints.length===0)return;const t=this.getRotatedCorners(),r=this.getMidPoints();t.forEach((i,o)=>{this._helperPoints.corners[o]&&this._helperPoints.corners[o].setLatLng(i)}),r.forEach((i,o)=>{this._helperPoints.midPoints[o]&&this._helperPoints.midPoints[o].setLatLng(i)})})}findClosestHelperPoint(t){return St.measure("Rectangle.findClosestHelperPoint",()=>{const r=this.getRotatedCorners(),i=this.getMidPoints(),o=[...r,...i];if(o.length===0)return null;let l=o[0],h=t.distanceTo(l);for(let g=1;g<o.length;g++){const v=t.distanceTo(o[g]);v<h&&(h=v,l=o[g])}return l})}toggleHelperPoints(t,r,i,o){St.measure("Rectangle.toggleHelperPoints",()=>{r&&t?this.generateHelperPoints(t,i,o):this.clearHelperPoints()})}containsPoint(t){return St.measure("Rectangle.containsPoint",()=>{const r=this.getRotatedCorners();if(r.length!==4)return!1;let i=!1;for(let o=0,l=r.length-1;o<r.length;l=o++){const h=r[o].lng,g=r[o].lat,v=r[l].lng,_=r[l].lat;g>t.lat!=_>t.lat&&t.lng<(v-h)*(t.lat-g)/(_-g)+h&&(i=!i)}return i})}}class Zc extends fn.Circle{constructor(t,r){const i=r.radius||10;super(t,i,r);Pt(this,"properties");Pt(this,"angleCache",new Map);Pt(this,"lastCenter");Pt(this,"lastCenterCosLat");Pt(this,"_pendingNameUpdate",!1);Pt(this,"_nameUpdateTimeout",null);St.measure("Circle.constructor.init",()=>{this.properties={type:"Circle",style:{name:r.name||""}},requestAnimationFrame(()=>{this.updateProperties()}),this.on("add",()=>{requestAnimationFrame(()=>{this.updateProperties()})})},"Circle")}updateProperties(){St.measure("Circle.updateProperties",()=>{var h,g,v,_;const t=this.getRadius(),r=this.getLatLng(),i=((g=(h=this.properties)==null?void 0:h.style)==null?void 0:g.name)||"",o=((v=this.properties)==null?void 0:v.style)||{},l={type:"Circle",radius:t,diameter:t*2,surface:Math.PI*Math.pow(t,2),perimeter:2*Math.PI*t,center:{lat:r.lat,lng:r.lng},style:{...o,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((_=this.options)==null?void 0:_.dashArray)||"",name:i}};JSON.stringify(this.properties)!==JSON.stringify(l)&&(this.properties=l,this.fire("properties:updated",{shape:this,properties:this.properties}))},"Circle")}setName(t){St.measure("Circle.setName",()=>{var r,i;((i=(r=this.properties)==null?void 0:r.style)==null?void 0:i.name)!==t&&(this.properties.style||(this.properties.style={}),this.properties.style.name=t,!this._pendingNameUpdate&&(this._pendingNameUpdate=!0,this._nameUpdateTimeout&&clearTimeout(this._nameUpdateTimeout),this._nameUpdateTimeout=setTimeout(()=>{this._pendingNameUpdate=!1,this._nameUpdateTimeout=null,this.fire("properties:updated",{shape:this,properties:this.properties})},100)))},"Circle")}getName(){return St.measure("Circle.getName",()=>{var t,r;return((r=(t=this.properties)==null?void 0:t.style)==null?void 0:r.name)||""},"Circle")}setRadius(t){return St.measure("Circle.setRadius",()=>(super.setRadius(t),this.updateProperties(),this),"Circle")}setLatLng(t){return St.measure("Circle.setLatLng",()=>(super.setLatLng(t),this.updateProperties(),this),"Circle")}calculatePointOnCircle(t){return St.measure("Circle.calculatePointOnCircle",()=>{const r=this.getLatLng(),i=this.getRadius();let o=this.angleCache.get(t);if(!o){const l=t*Math.PI/180;o={sin:Math.sin(l),cos:Math.cos(l)},this.angleCache.set(t,o)}return(!this.lastCenter||!this.lastCenter.equals(r))&&(this.lastCenter=r,this.lastCenterCosLat=Math.cos(r.lat*Math.PI/180)),fn.latLng(r.lat+i/111319.9*o.sin,r.lng+i/(111319.9*this.lastCenterCosLat)*o.cos)},"Circle")}getCardinalPoints(){return St.measure("Circle.getCardinalPoints",()=>[0,45,90,135,180,225,270,315].map(t=>this.calculatePointOnCircle(t)),"Circle")}calculateAngleFromPoint(t){return St.measure("Circle.calculateAngleFromPoint",()=>{const r=this.getLatLng(),i=t.lng-r.lng,o=t.lat-r.lat;let l=Math.atan2(o,i)*180/Math.PI;return l<0&&(l+=360),l},"Circle")}resizeFromControlPoint(t){St.measure("Circle.resizeFromControlPoint",()=>{const i=this.getLatLng().distanceTo(t);i>0&&super.setRadius(i)},"Circle")}clearCache(){this.angleCache.clear(),this.lastCenter=void 0,this.lastCenterCosLat=void 0}}class eh extends Zc{constructor(t,r){super(t,r);Pt(this,"_sections",[]);Pt(this,"_sectionLayers",[]);Pt(this,"_isDragging",!1);Pt(this,"_dragTimeout",null);St.measure("CircleWithSections.constructor",()=>(this._sections=r.sections||[],this.properties.type="CircleWithSections",this.properties.sections=this._sections,this.on("add",()=>{setTimeout(()=>this._initSections(),100)}),this.on("remove",()=>this._clearSections()),this.on("dragstart",()=>{this._isDragging=!0,this._clearSections()}),this.on("drag",()=>{this._dragTimeout&&clearTimeout(this._dragTimeout),this._dragTimeout=window.setTimeout(()=>{this._isDragging&&this._map&&this._renderSectionsPreview()},50)}),this.on("dragend",()=>{this._isDragging=!1,this._dragTimeout&&(clearTimeout(this._dragTimeout),this._dragTimeout=null),setTimeout(()=>{this._map&&(this._initSections(),this.updateProperties())},100)}),this.on("zoomanim",()=>{this._map&&this._clearSections()}),this.on("zoomend",()=>{this._map&&setTimeout(()=>{this._map&&(this._clearSections(),this._initSections())},100)}),this.updateProperties(),this))}_initSections(){St.measure("CircleWithSections._initSections",()=>{this.getMap()&&(this._clearSections(),setTimeout(()=>{this.getMap()&&this._sections.forEach(r=>{this._renderSection(r)})},0))})}_clearSections(){St.measure("CircleWithSections._clearSections",()=>{this._sectionLayers.forEach(t=>{try{t&&t.remove&&this._map&&this._map.hasLayer(t)&&t.remove()}catch(r){console.warn("Erreur lors de la suppression d'une section:",r)}}),this._sectionLayers=[]})}_isFullCircle(t){return St.measure("CircleWithSections._isFullCircle",()=>t.startAngle===0&&t.endAngle===360)}_renderSection(t){St.measure("CircleWithSections._renderSection",()=>{const r=this.getMap();if(!r)return;const i=this.getLatLng(),o=[];if(this._isFullCircle(t)){console.log("[CircleWithSections] Rendu d'une section circulaire complète",{sectionId:t.id,name:t.name,radius:t.radius});const _=new fn.Circle(i,{radius:t.radius,color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});_.addTo(r),this._sectionLayers.push(_),_.on("click",x=>{console.log("[CircleWithSections] Clic sur une section circulaire complète",{sectionId:t.id,name:t.name,event:x,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const E=this._findFeatureGroup();E&&E.fire("click",{...x,layer:this,target:this,type:"click"})});return}console.log("[CircleWithSections] Rendu d'une section partielle",{sectionId:t.id,name:t.name,startAngle:t.startAngle,endAngle:t.endAngle,radius:t.radius}),o.push(i);const h=32,g=t.endAngle-t.startAngle;for(let _=0;_<=h;_++){const x=t.startAngle+g*_/h,E=this._calculatePointOnCircle(x,t.radius);o.push(E)}o.push(i);const v=new fn.Polygon(o,{color:t.color,fillColor:t.color,fillOpacity:.4,weight:2,interactive:!0});v.addTo(r),this._sectionLayers.push(v),v.on("click",_=>{console.log("[CircleWithSections] Clic sur une section partielle",{sectionId:t.id,name:t.name,event:_,parentCircle:this}),this._emitCustomEvent("section:clicked",{section:t,parentCircle:this});const x=this._findFeatureGroup();x&&x.fire("click",{..._,layer:this,target:this,type:"click"})})})}_findFeatureGroup(){return St.measure("CircleWithSections._findFeatureGroup",()=>{if(!this._map)return null;let t=null;return this._map.eachLayer(r=>{r instanceof fn.FeatureGroup&&r.hasLayer(this)&&(t=r)}),t})}_normalizeAngle(t){return St.measure("CircleWithSections._normalizeAngle",()=>(t%360+360)%360)}_updateSectionAngles(t,r,i){St.measure("CircleWithSections._updateSectionAngles",()=>{const o=this._normalizeAngle(t.startAngle),l=this._normalizeAngle(t.endAngle),h=(l-o+360)%360;let g=r!==null?this._normalizeAngle(r):o,v=i!==null?this._normalizeAngle(i):l,_=(v-g+360)%360;const x=45;Math.abs(_-h)>x&&(_>h?_=h+x:_=h-x,r!==null?v=(g+_)%360:g=(v-_+360)%360),_<355&&(_=Math.max(5,_),r!==null?v=(g+_)%360:g=(v-_+360)%360),t.startAngle=g,t.endAngle=v})}_addMarkerEvents(t,r,i){St.measure("CircleWithSections._addMarkerEvents",()=>{let o=!1;const l=this.getMap();if(!l)return;const h=(_,x)=>{if(!o)return;const E=this._calculateAngleFromPoint(_.latlng);x?this._updateSectionAngles(i,E,null):this._updateSectionAngles(i,null,E),this._clearSections(),this._renderSection(i),this._emitCustomEvent("section:visual-update",{section:i,sections:this._sections})},g=()=>{o=!1,l.dragging.enable(),this.updateProperties(),this._emitCustomEvent("section:updated",{section:i,sections:this._sections})};t.on("mousedown",()=>{o=!0,l.dragging.disable()}),t.on("mousemove",_=>{h(_,!0)}),t.on("mouseup",g),t.on("mouseout",()=>{o&&g(),t.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""}),r.on("mousedown",()=>{o=!0,l.dragging.disable()}),r.on("mousemove",_=>{h(_,!1)}),r.on("mouseup",g),r.on("mouseout",()=>{o&&g(),r.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor=""});const v=(_,x)=>{x?(_.setStyle({radius:6,fillOpacity:.8}),l.getContainer().style.cursor="pointer"):o||(_.setStyle({radius:5,fillOpacity:1}),l.getContainer().style.cursor="")};t.on("mouseover",()=>v(t,!0)),t.on("mouseout",()=>v(t,!1)),r.on("mouseover",()=>v(r,!0)),r.on("mouseout",()=>v(r,!1)),l.on("mousemove",_=>{if(o){const x=_.originalEvent.target;x===t.getElement()?h(_,!0):x===r.getElement()&&h(_,!1)}}),l.on("mouseup",()=>{o&&g()})})}_calculatePointOnCircle(t,r){return St.measure("CircleWithSections._calculatePointOnCircle",()=>{const i=this.getLatLng(),o=t*Math.PI/180,l=r;return fn.latLng(i.lat+l/111319.9*Math.sin(o),i.lng+l/(111319.9*Math.cos(i.lat*Math.PI/180))*Math.cos(o))})}_calculateAngleFromPoint(t){return St.measure("CircleWithSections._calculateAngleFromPoint",()=>{const r=this.getLatLng(),i=t.lng-r.lng,o=t.lat-r.lat;let l=Math.atan2(o,i)*180/Math.PI;return l=(90-l)%360,l<0&&(l+=360),Math.round(l)})}updateSection(t,r){return St.measure("CircleWithSections.updateSection",()=>{const i=this._sections.findIndex(o=>o.id===t);if(i!==-1){r.radius!==void 0&&(r.radius=Math.max(1,r.radius),r.radius=Math.floor(r.radius)),this._sections[i]={...this._sections[i],...r};const o=this._sections[i];return r.startAngle===0&&r.endAngle===360&&(o.startAngle=0,o.endAngle=360),this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(l=>{this._renderSection(l)}),this._emitCustomEvent("section:updated",{section:this._sections[i],sections:this._sections}),this.updateProperties(),!0}return!1})}addSection(t={}){return St.measure("CircleWithSections.addSection",()=>{const r=this.getRadius();let i;if(t.radius!==void 0)i=Math.max(1,t.radius);else{const h=this._sections[this._sections.length-1];h?i=Math.max(h.radius-20,20):i=Math.max(r-20,20)}const o={id:`section-${Date.now()}-${Math.floor(Math.random()*1e3)}`,startAngle:t.startAngle||0,endAngle:t.endAngle||45,radius:Math.floor(i),color:t.color||this._getRandomColor(),name:t.name||`Section ${this._sections.length+1}`};return this._sections.push(o),this.properties.sections=this._sections,this.getMap()&&this._renderSection(o),this._emitCustomEvent("section:added",{section:o,sections:this._sections}),this.updateProperties(),o})}removeSection(t){return St.measure("CircleWithSections.removeSection",()=>{const r=this._sections.length;return this._sections=this._sections.filter(i=>i.id!==t),r!==this._sections.length?(this.properties.sections=this._sections,this._clearSections(),this._sections.forEach(i=>{this._renderSection(i)}),this._emitCustomEvent("section:removed",{sectionId:t,sections:this._sections}),this.updateProperties(),!0):!1})}makeFullCircle(t){St.measure("CircleWithSections.makeFullCircle",()=>{t.startAngle=0,t.endAngle=360,this._clearSections(),this._renderSection(t),this._emitCustomEvent("section:updated",{section:t,sections:this._sections}),this.updateProperties()})}getSections(){return St.measure("CircleWithSections.getSections",()=>[...this._sections])}updateProperties(){St.measure("CircleWithSections.updateProperties",()=>{var l,h,g,v;const t=this.getLatLng(),r=this.getRadius();let i=0;const o=this._sections.map(_=>{const E=(_.endAngle-_.startAngle)*Math.PI/180/(2*Math.PI)*Math.PI*Math.pow(_.radius,2),b=Math.round(E*100)/100;return i+=E,{..._,surface:b}});this.properties={type:"CircleWithSections",radius:r,diameter:r*2,surface:Math.PI*Math.pow(r,2),perimeter:2*Math.PI*r,center:{lat:t.lat,lng:t.lng},sections:o,sectionArea:i,style:{...(l=this.properties)==null?void 0:l.style,color:this.options.color||"#3388ff",weight:this.options.weight||3,opacity:this.options.opacity||1,fillColor:this.options.fillColor||"#3388ff",fillOpacity:this.options.fillOpacity||.2,dashArray:((h=this.options)==null?void 0:h.dashArray)||"",name:((v=(g=this.properties)==null?void 0:g.style)==null?void 0:v.name)||""}},this.fire("properties:updated",{shape:this,properties:this.properties})})}_getRandomColor(){return St.measure("CircleWithSections._getRandomColor",()=>{const t=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],r=this._sections.map(o=>o.color),i=t.filter(o=>!r.includes(o));return i.length>0?i[Math.floor(Math.random()*i.length)]:t[Math.floor(Math.random()*t.length)]})}setRadius(t){return St.measure("CircleWithSections.setRadius",()=>(super.setRadius(t),this._sections=this._sections.map(r=>({...r,radius:Math.min(r.radius,t)})),this._clearSections(),this._initSections(),this))}setLatLng(t){return St.measure("CircleWithSections.setLatLng",()=>(super.setLatLng(t),this._isDragging?this._renderSectionsPreview():(this._clearSections(),this._initSections()),this))}getMap(){return St.measure("CircleWithSections.getMap",()=>this._map)}_renderSectionsPreview(){St.measure("CircleWithSections._renderSectionsPreview",()=>{const t=this.getMap();if(!(!t||!this._map))try{this._clearSections(),this._sections.forEach(r=>{if(Math.abs(r.endAngle-r.startAngle)>=360)try{const o=new fn.Circle(this.getLatLng(),{radius:r.radius,color:r.color,fillColor:r.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(o.addTo(t),this._sectionLayers.push(o))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation du cercle complet:",o)}else try{const o=[];o.push(this.getLatLng());const l=16,h=r.endAngle-r.startAngle;for(let v=0;v<=l;v++){const _=r.startAngle+h*v/l,x=this._calculatePointOnCircle(_,r.radius);o.push(x)}o.push(this.getLatLng());const g=new fn.Polygon(o,{color:r.color,fillColor:r.color,fillOpacity:.2,weight:1,dashArray:"5,5",interactive:!1});t&&t.hasLayer(this)&&(g.addTo(t),this._sectionLayers.push(g))}catch(o){console.warn("Erreur lors du rendu de la prévisualisation de la section partielle:",o)}})}catch(r){console.error("Erreur lors du rendu des prévisualisations:",r)}})}getMinRadius(){return St.measure("CircleWithSections.getMinRadius",()=>1)}_emitCustomEvent(t,r){St.measure("CircleWithSections._emitCustomEvent",()=>{this.fire(t,r);const i=new CustomEvent(t,{detail:r,bubbles:!0,cancelable:!0});window.dispatchEvent(i),console.log(`[CircleWithSections] Événement émis: ${t}`,r)})}}function Ig(e){return"content"in e&&"bounds"in e}function o8(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function a8(e){if(!e||typeof e!="object")return console.log("[DrawingStore] ElevationData invalide: pas un objet",{data:e}),!1;const n=Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2,t=typeof e.style=="object"&&e.style!==null,r=!e.elevationData||Array.isArray(e.elevationData)&&e.elevationData.every(i=>typeof i=="object"&&"distance"in i&&"elevation"in i);return n&&t&&r}function l8(e){return e&&Array.isArray(e.points)&&e.points.length>0&&Array.isArray(e.points[0])&&e.points[0].length===2}function Cy(e){var n,t,r,i,o,l,h,g,v,_,x,E,b,R,$,Q,I,W,ge,Se,De,Ye,Ve,O,K,ce,H;if(console.log("[DrawingStore] Conversion de la forme en élément",{type:(n=e.properties)==null?void 0:n.type,name:(r=(t=e.properties)==null?void 0:t.style)==null?void 0:r.name,properties:e.properties}),((i=e.properties)==null?void 0:i.type)==="Note"){const D=e.getLatLng();return{type_forme:"Note",data:{location:[D.lng,D.lat],title:e.properties.title||"",description:e.properties.description||"",visibility:e.properties.visibility||"private",attachments:e.properties.attachments||[],style:{color:((o=e.properties.style)==null?void 0:o.color)||"#3388ff",weight:((l=e.properties.style)==null?void 0:l.weight)||3,opacity:((h=e.properties.style)==null?void 0:h.opacity)||1,fillColor:((g=e.properties.style)==null?void 0:g.fillColor)||"#3388ff",fillOpacity:((v=e.properties.style)==null?void 0:v.fillOpacity)||.2,name:((_=e.properties.style)==null?void 0:_.name)||""}}}}if(e instanceof lh||((x=e.properties)==null?void 0:x.type)==="ElevationLine")return{type_forme:"ElevationLine",data:{points:e.getLatLngs().map(z=>[z.lng,z.lat]),style:{color:((E=e.properties.style)==null?void 0:E.color)||"#FF4500",weight:((b=e.properties.style)==null?void 0:b.weight)||4,opacity:((R=e.properties.style)==null?void 0:R.opacity)||.8,name:(($=e.properties.style)==null?void 0:$.name)||""},elevationData:e.properties.elevationData,minElevation:e.properties.minElevation,maxElevation:e.properties.maxElevation,elevationGain:e.properties.elevationGain,elevationLoss:e.properties.elevationLoss,averageSlope:e.properties.averageSlope,maxSlope:e.properties.maxSlope}};if(e instanceof zh||((Q=e.properties)==null?void 0:Q.type)==="Polygon")return{type_forme:"Polygon",data:{points:e.getLatLngs()[0].map(z=>[z.lng,z.lat]),style:{color:((I=e.properties.style)==null?void 0:I.color)||"#3388ff",weight:((W=e.properties.style)==null?void 0:W.weight)||3,opacity:((ge=e.properties.style)==null?void 0:ge.opacity)||1,fillColor:((Se=e.properties.style)==null?void 0:Se.fillColor)||"#3388ff",fillOpacity:((De=e.properties.style)==null?void 0:De.fillOpacity)||.2,name:((Ye=e.properties.style)==null?void 0:Ye.name)||""},area:e.properties.area||0}};if(e instanceof Lo||((Ve=e.properties)==null?void 0:Ve.type)==="Line")return{type_forme:"Line",data:{points:e.getLatLngs().map(z=>[z.lng,z.lat]),style:{color:((O=e.properties.style)==null?void 0:O.color)||"#3388ff",weight:((K=e.properties.style)==null?void 0:K.weight)||3,opacity:((ce=e.properties.style)==null?void 0:ce.opacity)||1,name:((H=e.properties.style)==null?void 0:H.name)||""},length:e.properties.length||0}};throw new Error("Type de forme non reconnu")}function u8(e){var n,t,r,i,o,l,h,g,v,_,x,E,b,R,$,Q,I,W,ge,Se,De,Ye,Ve,O,K,ce,H,D,V,z,U,G,ue,ie,Ae,Me,st,X,Ee,N,Z,he,ne,te,ee,se,Pe,oe,re,xe,ye,le,Ue,Ie,Ce,qe,Re,rt,Ze,gt,_t,$t,tn;switch(console.log("[DrawingStore] Conversion de l'élément stocké en forme",{element:e}),e.type_forme){case"CircleWithSections":{const Qe=e.data;if(!Qe.center||!Qe.radius)return console.error("[DrawingStore] Données invalides pour CircleWithSections"),null;const Yt=new eh(fn.latLng(Qe.center[1],Qe.center[0]),{color:((n=Qe.style)==null?void 0:n.color)||"#3388ff",weight:((t=Qe.style)==null?void 0:t.weight)||3,opacity:((r=Qe.style)==null?void 0:r.opacity)||1,fillColor:((i=Qe.style)==null?void 0:i.fillColor)||"#3388ff",fillOpacity:((o=Qe.style)==null?void 0:o.fillOpacity)||.2,dashArray:((l=Qe.style)==null?void 0:l.dashArray)||"",name:((h=Qe.style)==null?void 0:h.name)||"",radius:Qe.radius,sections:Qe.sections||[]});return Yt.properties.type="CircleWithSections",console.log("[DrawingStore] CircleWithSections restauré:",{center:Qe.center,radius:Qe.radius,sections:((g=Qe.sections)==null?void 0:g.length)||0}),Yt}case"TextRectangle":{if(!Ig(e.data))return console.error("[DrawingStore] Données invalides pour TextRectangle"),null;const Qe=e.data;if(!Qe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour TextRectangle"),null;const Yt=new fn.LatLngBounds(fn.latLng(Qe.bounds.southWest[1],Qe.bounds.southWest[0]),fn.latLng(Qe.bounds.northEast[1],Qe.bounds.northEast[0])),Qt={color:((v=Qe.style)==null?void 0:v.color)||"#3388ff",fillColor:((_=Qe.style)==null?void 0:_.fillColor)||"#3388ff",fillOpacity:((x=Qe.style)==null?void 0:x.fillOpacity)||.2,weight:((E=Qe.style)==null?void 0:E.weight)||3,opacity:((b=Qe.style)==null?void 0:b.opacity)||1,name:((R=Qe.style)==null?void 0:R.name)||"",textStyle:{color:(($=Qe.style.textStyle)==null?void 0:$.color)||"#000000",fontSize:((Q=Qe.style.textStyle)==null?void 0:Q.fontSize)||"14px",fontFamily:((I=Qe.style.textStyle)==null?void 0:I.fontFamily)||"Arial, sans-serif",textAlign:((W=Qe.style.textStyle)==null?void 0:W.textAlign)||"center",backgroundColor:((ge=Qe.style.textStyle)==null?void 0:ge.backgroundColor)||"#FFFFFF",backgroundOpacity:((Se=Qe.style.textStyle)==null?void 0:Se.backgroundOpacity)??1,bold:((De=Qe.style.textStyle)==null?void 0:De.bold)||!1,italic:((Ye=Qe.style.textStyle)==null?void 0:Ye.italic)||!1}},Zt=new yu(Yt,Qe.content||"Double-cliquez pour éditer",Qt);return Qe.rotation&&Zt.setRotation(Qe.rotation),(Ve=Qe.style)!=null&&Ve.name&&(Zt.properties.style.name=Qe.style.name),Zt}case"Polygon":{const Qe=e.data;if(!o8(Qe))return console.error("[DrawingStore] Données invalides pour Polygon"),null;const Yt=Qe.points.map(Zt=>fn.latLng(Zt[1],Zt[0])),Qt=new zh([Yt],{color:((O=Qe.style)==null?void 0:O.color)||"#3388ff",weight:((K=Qe.style)==null?void 0:K.weight)||3,opacity:((ce=Qe.style)==null?void 0:ce.opacity)||1,fillColor:((H=Qe.style)==null?void 0:H.fillColor)||"#3388ff",fillOpacity:((D=Qe.style)==null?void 0:D.fillOpacity)||.2,dashArray:((V=Qe.style)==null?void 0:V.dashArray)||"",name:((z=Qe.style)==null?void 0:z.name)||""});return Qt.updateProperties(),Qt}case"ElevationLine":{const Qe=e.data;if(!a8(Qe))return console.error("[DrawingStore] Données invalides pour ElevationLine"),null;const Yt=Qe.points.map(Zt=>fn.latLng(Zt[1],Zt[0])),Qt=new lh(Yt,{color:((U=Qe.style)==null?void 0:U.color)||"#FF4500",weight:((G=Qe.style)==null?void 0:G.weight)||4,opacity:((ue=Qe.style)==null?void 0:ue.opacity)||.8,name:((ie=Qe.style)==null?void 0:ie.name)||""});return Qt.properties={type:"ElevationLine",style:{...Qe.style||{},name:((Ae=Qe.style)==null?void 0:Ae.name)||""},elevationData:Qe.elevationData,minElevation:Qe.minElevation,maxElevation:Qe.maxElevation,elevationGain:Qe.elevationGain,elevationLoss:Qe.elevationLoss,averageSlope:Qe.averageSlope,maxSlope:Qe.maxSlope,dataSource:"restored"},Qe.elevationData&&Qt.updateElevationProfile(),console.log("[DrawingStore] ElevationLine restored:",{points:Yt.length,hasElevationData:!!Qe.elevationData,name:(Me=Qe.style)==null?void 0:Me.name,properties:Qt.properties}),Qt}case"Line":{const Qe=e.data;if(!l8(Qe))return console.error("[DrawingStore] Données invalides pour Ligne"),null;const Yt=Qe.points.map(Zt=>fn.latLng(Zt[1],Zt[0])),Qt=new Lo(Yt,{...Qe.style||{},name:((st=Qe.style)==null?void 0:st.name)||""});return Qt.updateProperties(),Qt}case"Semicircle":{const Qe=e.data;if(!Qe.center||!Qe.radius)return console.error("[DrawingStore] Données invalides pour Semicircle"),null;const Yt=fn.latLng(Qe.center[1],Qe.center[0]),Qt=new wu(Yt,Qe.radius,Qe.startAngle||0,Qe.endAngle||180,{color:((X=Qe.style)==null?void 0:X.color)||"#3388ff",weight:((Ee=Qe.style)==null?void 0:Ee.weight)||3,opacity:((N=Qe.style)==null?void 0:N.opacity)||1,fillColor:((Z=Qe.style)==null?void 0:Z.fillColor)||"#3388ff",fillOpacity:((he=Qe.style)==null?void 0:he.fillOpacity)||.2,dashArray:((ne=Qe.style)==null?void 0:ne.dashArray)||"",name:((te=Qe.style)==null?void 0:te.name)||""});Qt.properties={type:"Semicircle",radius:Qe.radius,startAngle:Qe.startAngle||0,stopAngle:Qe.endAngle||180,style:{...Qe.style||{},name:((ee=Qe.style)==null?void 0:ee.name)||""},center:Yt};const Zt=((Qe.endAngle||180)-(Qe.startAngle||0)+360)%360,wt=Math.PI*Math.pow(Qe.radius,2)*Zt/360,He=2*Math.PI*Qe.radius*Zt/360,Kt=He+2*Qe.radius;return Qt.properties.surface=wt,Qt.properties.arcLength=He,Qt.properties.perimeter=Kt,Qt.properties.openingAngle=Zt,Qt.properties.diameter=Qe.radius*2,console.log("[DrawingStore] Semicircle restauré:",{center:Qe.center,radius:Qe.radius,angles:{start:Qe.startAngle,end:Qe.endAngle},properties:Qt.properties}),Qt}case"Rectangle":{const Qe=e.data;if(console.log("[DrawingStore][convertStoredElementToShape] Restauration Rectangle:",{data:Qe,bounds:Qe.bounds,width:Qe.width,height:Qe.height,rotation:Qe.rotation}),!Qe.bounds)return console.error("[DrawingStore] Données de bounds manquantes pour Rectangle"),null;const Yt=new fn.LatLngBounds(fn.latLng(Qe.bounds.southWest[1],Qe.bounds.southWest[0]),fn.latLng(Qe.bounds.northEast[1],Qe.bounds.northEast[0])),Qt=new $o(Yt,{color:((se=Qe.style)==null?void 0:se.color)||"#3388ff",weight:((Pe=Qe.style)==null?void 0:Pe.weight)||3,opacity:((oe=Qe.style)==null?void 0:oe.opacity)||1,fillColor:((re=Qe.style)==null?void 0:re.fillColor)||"#3388ff",fillOpacity:((xe=Qe.style)==null?void 0:xe.fillOpacity)||.2,dashArray:((ye=Qe.style)==null?void 0:ye.dashArray)||"",name:((le=Qe.style)==null?void 0:le.name)||"",width:Qe.width,height:Qe.height});return Qe.rotation&&Qt.setRotation(Qe.rotation),console.log("[DrawingStore][convertStoredElementToShape] Rectangle restauré:",{bounds:Qt.getBounds(),dimensions:Qt.getDimensions(),properties:Qt.properties}),Qt}case"Circle":{console.log("[DrawingStore] Traitement d'un Circle à partir de l'API",{id:e.id,data:e.data,hasName:((Ie=(Ue=e.data)==null?void 0:Ue.style)==null?void 0:Ie.name)!==void 0,name:(qe=(Ce=e.data)==null?void 0:Ce.style)==null?void 0:qe.name});const Qe=e.data;if(!Qe.center||!Qe.radius)return console.error("[DrawingStore] Données invalides pour Circle"),null;const Yt=fn.circle([Qe.center[1],Qe.center[0]],{color:((Re=Qe.style)==null?void 0:Re.color)||"#3388ff",weight:((rt=Qe.style)==null?void 0:rt.weight)||3,opacity:((Ze=Qe.style)==null?void 0:Ze.opacity)||1,fillColor:((gt=Qe.style)==null?void 0:gt.fillColor)||"#3388ff",fillOpacity:((_t=Qe.style)==null?void 0:_t.fillOpacity)||.2,dashArray:(($t=Qe.style)==null?void 0:$t.dashArray)||"",radius:Qe.radius});return Yt.properties={type:"Circle",radius:Qe.radius,diameter:Qe.radius*2,surface:Math.PI*Qe.radius*Qe.radius,perimeter:2*Math.PI*Qe.radius,style:{...Qe.style||{},name:((tn=Qe.style)==null?void 0:tn.name)||""}},console.log("[DrawingStore] Cercle créé:",{centerType:typeof Qe.center,center:Qe.center,radius:Qe.radius,style:Yt.properties.style,name:Yt.properties.style.name}),Yt}default:return console.warn("[DrawingStore] Type non géré pour la restauration:",e.type_forme),null}}const xb=Np("drawing",{state:()=>({currentMapId:null,elements:[],selectedElement:null,unsavedChanges:!1,loading:!1,error:null,currentTool:"",currentStyle:{strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2},lastUsedType:null,performanceMonitor:Xh()}),getters:{hasUnsavedChanges:e=>e.unsavedChanges,getCurrentElements:e=>e.elements,getSelectedElement:e=>e.selectedElement,getCurrentTool:e=>e.currentTool,getCurrentStyle:e=>e.currentStyle,getLastUsedType:e=>e.lastUsedType},actions:{setCurrentPlan(e){window.dispatchEvent(new CustomEvent("clearControlPoints")),this.currentMapId=e,e===null&&this.clearElements(),this.selectedElement=null,this.unsavedChanges=!1,this.currentTool="",this.lastUsedType=null,this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2}},clearCurrentPlan(){(this.currentMapId!==null||this.elements.length>0)&&(this.currentMapId=null,this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.loading=!1,this.error=null)},clearElements(){this.elements=[],this.selectedElement=null,this.unsavedChanges=!1,this.error=null},addElement(e){var t;const n=this.performanceMonitor.startMeasure("addElement","DrawingStore");try{if(console.log("[DrawingStore] Ajout d'un élément",{element:e,isLeafletLayer:e instanceof fn.Layer,hasProperties:!!e.properties,properties:e.properties,type:(t=e.properties)==null?void 0:t.type}),e instanceof fn.Layer&&e.properties){const r=this.performanceMonitor.measure("addElement_convert",()=>Cy(e),"DrawingStore");console.log("[DrawingStore] Élément converti avant ajout",{original:e,converted:r,type:r.type_forme,data:r.data}),this.elements.push(r)}else!e.type_forme&&this.lastUsedType&&(e.type_forme=this.lastUsedType),this.elements.push(e);this.unsavedChanges=!0}finally{n()}},updateElement(e){const n=this.elements.findIndex(t=>t.id===e.id);if(n!==-1){const t=this.elements[n].type_forme;this.elements[n]={...e,type_forme:t},this.unsavedChanges=!0}},removeElement(e){const n=this.elements.findIndex(t=>t.id===e);n!==-1&&(this.elements.splice(n,1),this.unsavedChanges=!0)},selectElement(e){this.selectedElement=e},setCurrentTool(e){this.currentTool=e,["CERCLE","RECTANGLE","DEMI_CERCLE","LIGNE","TEXTE"].includes(e)&&(this.lastUsedType=e)},setCurrentStyle(e){if(!e||Object.keys(e).length===0){this.currentStyle={strokeStyle:"solid",strokeWidth:2,strokeColor:"#2563EB",fillColor:"#3B82F6",fillOpacity:.2};return}this.currentStyle={...this.currentStyle,...e}},async loadPlanElements(e){const n=this.performanceMonitor.startMeasure("loadPlanElements","DrawingStore");if(this.currentMapId===e&&this.elements.length>0)return console.log(`[DrawingStore] Plan ${e} déjà chargé avec ${this.elements.length} éléments`),n(),this.elements;this.loading=!0;try{console.log("[DrawingStore] Début du chargement du plan",{planId:e});const r=(await this.performanceMonitor.measureAsync("loadPlanElements_apiCall",()=>Xn.get(`/plans/${e}/`),"DrawingStore")).data;return console.log("[DrawingStore] Données du plan reçues",{formes:r.formes,preferences:r.preferences}),r.formes&&Array.isArray(r.formes)&&r.formes.forEach((i,o)=>{var l,h,g;console.log(`[DrawingStore] Analyse détaillée forme ${o}:`,{id:i.id,type_forme:i.type_forme,hasData:!!i.data,dataKeys:i.data?Object.keys(i.data):[],name:(l=i.data)==null?void 0:l.name,hasName:i.data&&"name"in i.data,centerType:(h=i.data)!=null&&h.center?typeof i.data.center:"undefined",center:(g=i.data)==null?void 0:g.center})}),this.elements=r.formes.map(i=>{var o;if(console.log("[DrawingStore] Traitement de la forme stockée",{id:i.id,type_forme:i.type_forme,data:i.data,isTextRectangle:i.type_forme==="TEXTE"||i.data&&Ig(i.data)}),i.type_forme)return console.log("[DrawingStore] Forme déjà au format élément",{type_forme:i.type_forme,data:i.data,hasName:i.data&&"name"in i.data,name:(o=i.data)==null?void 0:o.name}),{id:i.id,type_forme:i.type_forme,data:i.data||{}};try{const l=u8(i);if(l)return console.log("[DrawingStore] Forme convertie avec succès",{originalType:i.type_forme,convertedType:l.type,properties:l.properties}),Cy(l)}catch(l){console.error("[DrawingStore] Erreur lors de la conversion de la forme",{error:l,forme:i})}return console.warn("[DrawingStore] Utilisation de la forme sans conversion",{type_forme:i.type_forme,data:i.data}),i}),console.log(`[DrawingStore] Plan ${e} - Chargé ${this.elements.length} éléments`,{elements:this.elements.map(i=>({id:i.id,type_forme:i.type_forme,isTextRectangle:i.type_forme==="TextRectangle"||Ig(i.data)}))}),this.currentMapId=e,this.unsavedChanges=!1,r.preferences&&(console.log("[DrawingStore] Chargement des préférences",r.preferences),r.preferences.currentTool&&this.setCurrentTool(r.preferences.currentTool),r.preferences.currentStyle&&(this.currentStyle={...this.currentStyle,...r.preferences.currentStyle}),r.preferences.lastUsedType&&(this.lastUsedType=r.preferences.lastUsedType)),this.elements}catch(t){throw console.error("[DrawingStore] Erreur lors du chargement des éléments:",t),this.error="Erreur lors du chargement des éléments du plan",t}finally{this.loading=!1,n()}},async saveToPlan(e,n){const t=this.performanceMonitor.startMeasure("saveToPlan","DrawingStore");this.loading=!0;try{const r=e||this.currentMapId;if(console.log("[DrawingStore][saveToPlan] Début de la sauvegarde",{targetPlanId:r,currentPlanId:this.currentMapId,elementsCount:this.elements.length,elementsToDelete:n==null?void 0:n.elementsToDelete}),!r)throw new Error("Aucun plan sélectionné pour la sauvegarde");const i=this.performanceMonitor.measure("saveToPlan_prepareElements",()=>this.elements.map(g=>({...g,type_forme:g.type_forme||this.lastUsedType})),"DrawingStore"),o=(n==null?void 0:n.elementsToDelete)||[],l=`/plans/${r}/save_with_elements/`,h=await this.performanceMonitor.measureAsync("saveToPlan_apiCall",()=>Xn.post(l,{formes:i,connexions:[],annotations:[],elementsToDelete:o,preferences:{currentTool:this.currentTool,currentStyle:this.currentStyle,lastUsedType:this.lastUsedType}}),"DrawingStore");return this.elements=this.performanceMonitor.measure("saveToPlan_processResponse",()=>h.data.formes.map(g=>({...g,type_forme:g.type_forme})),"DrawingStore"),this.unsavedChanges=!1,h.data}catch(r){throw console.error("[DrawingStore][saveToPlan] ERREUR:",r),console.error("[DrawingStore][saveToPlan] Stack trace:",r instanceof Error?r.stack:"No stack trace"),this.error="Erreur lors de la sauvegarde du plan",r}finally{this.loading=!1,t()}}}}),c8={class:"h-full flex flex-col bg-white overflow-y-auto"},h8={class:"p-3 border-b border-gray-200"},f8={class:"grid grid-cols-4 gap-1"},d8=["onClick","title"],p8=["innerHTML"],g8={key:0,class:"flex-1 overflow-y-auto"},m8={class:"p-3 border-b border-gray-200"},v8={class:"p-3"},y8={class:"grid grid-cols-6 gap-2 mb-4"},_8=["onClick","title"],b8={key:0,class:"space-y-4"},w8={class:"flex items-center gap-4"},x8={class:"flex items-center gap-2"},L8={class:"flex items-center gap-4"},S8=["value"],C8={key:0,class:"flex items-center gap-4"},P8={class:"flex items-center gap-2"},E8={key:1,class:"space-y-4"},A8={class:"flex items-center gap-4"},M8={class:"flex items-center gap-2"},k8={class:"flex items-center gap-4"},T8={class:"flex items-center gap-2"},B8={class:"flex items-center gap-4"},N8={class:"flex items-center gap-2"},R8={class:"flex items-center gap-4"},D8={class:"flex items-center gap-2 w-full"},O8={class:"flex items-center gap-4"},I8={class:"flex items-center gap-2"},F8={class:"flex items-center gap-4"},z8={class:"flex items-center gap-2"},j8=["onClick","title"],U8=["innerHTML"],$8={key:1,class:"p-3 border-t border-gray-200"},q8={class:"mt-3"},V8={key:0},G8={class:"mb-4"},H8={class:"grid grid-cols-1 gap-4"},W8={key:0,class:"space-y-1"},Z8={class:"flex justify-between items-center"},K8={class:"text-sm font-medium text-gray-500"},J8={class:"flex justify-between items-center"},Y8={class:"text-sm font-medium text-gray-500"},X8={class:"flex justify-between items-center"},Q8={class:"text-sm font-medium text-gray-500"},eT={key:1,class:"space-y-1"},tT={class:"flex justify-between items-center"},nT={class:"text-sm font-medium text-gray-500"},rT={class:"flex justify-between items-center"},iT={class:"text-sm font-medium text-gray-500"},sT={class:"flex justify-between items-center"},oT={class:"text-sm font-medium text-gray-500"},aT={class:"flex justify-between items-center"},lT={class:"text-sm font-medium text-gray-500"},uT={key:2,class:"space-y-1"},cT={class:"flex items-center mb-2"},hT={class:"flex-1 flex items-center"},fT={class:"flex items-center mb-2"},dT={class:"flex-1 flex items-center"},pT={class:"flex justify-between items-center"},gT={class:"text-sm font-medium text-gray-500"},mT={class:"flex justify-between items-center"},vT={class:"text-sm font-medium text-gray-500"},yT={key:3,class:"space-y-1"},_T={class:"flex justify-between items-center"},bT={class:"text-sm font-medium text-gray-500"},wT={class:"flex justify-between items-center"},xT={class:"text-sm font-medium text-gray-500"},LT={class:"flex justify-between items-center"},ST={class:"text-sm font-medium text-gray-500"},CT={class:"flex justify-between items-center"},PT={class:"text-sm font-medium text-gray-500"},ET={class:"text-sm font-medium text-gray-500"},AT={key:5,class:"space-y-1"},MT={class:"flex justify-between items-center"},kT={class:"text-sm font-medium text-gray-500"},TT={class:"flex justify-between items-center"},BT={class:"text-sm font-medium text-gray-500"},NT={class:"flex justify-between items-center"},RT={class:"text-sm font-medium text-gray-500"},DT={class:"flex flex-col space-y-2 w-full"},OT={class:"flex justify-between items-center"},IT={class:"text-sm font-medium text-gray-500 ml-2"},FT={class:"flex justify-between items-center"},zT={class:"text-sm font-medium text-gray-500 ml-2"},jT={class:"flex justify-between items-center"},UT={class:"text-sm font-medium text-gray-500 ml-2"},$T={class:"flex justify-between items-center"},qT={class:"text-sm font-medium text-gray-500 ml-2"},VT={class:"flex justify-between items-center"},GT={class:"text-sm font-medium text-gray-500 ml-2"},HT={ref:"elevationCanvas"},WT={key:1,class:"text-center text-sm text-gray-500"},ZT={key:2,class:"p-3 border-t border-gray-200"},KT={class:"mt-3"},JT={class:"mb-4"},YT={class:"grid grid-cols-2 gap-2"},XT={class:"grid grid-cols-2 gap-2"},QT={key:3,class:"p-3 border-t border-gray-200"},eB={class:"mt-3"},tB={class:"flex justify-between items-center mb-3"},nB={key:0,class:"space-y-3"},rB={class:"pl-3"},iB={class:"flex justify-between items-center mb-2"},sB={class:"flex-grow min-w-0 mr-2"},oB=["onUpdate:modelValue","onChange"],aB=["onClick"],lB={class:"grid grid-cols-2 gap-2 mb-2"},uB={class:"min-w-0"},cB=["onUpdate:modelValue","onChange"],hB={class:"min-w-0"},fB=["onUpdate:modelValue","onChange"],dB={class:"min-w-0"},pB=["onUpdate:modelValue","onChange"],gB={class:"min-w-0"},mB={class:"w-full px-2 py-1 text-sm text-gray-700 bg-gray-50 rounded truncate"},vB={class:"col-span-2"},yB=["onUpdate:modelValue","onChange"],_B={class:"w-full h-8 bg-gray-100 rounded relative overflow-hidden"},bB=["onClick"],wB={key:0,class:"mt-1 text-xs text-center p-1 bg-blue-100 text-blue-800 rounded"},xB={key:1,class:"text-center text-sm text-gray-500 py-2"},LB=Pa({__name:"DrawingTools",setup(e){const n=[{type:"polygon",label:"Polygone"},{type:"line",label:"Ligne"},{type:"elevation",label:"Profil altimétrique"},{type:"note",label:"Note géolocalisée"}],t=r=>{switch(r){case"polygon":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5l16 0l0 14l-16 0l0 -14z"/></svg>';case"line":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20l16 -16"/></svg>';case"elevation":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 20h18l-3-3l-4 4l-4-7l-4 4l-3-3"/></svg>';case"note":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>'}};return un({title:"",description:"",visibility:"private",attachments:[],location:null}),Rr(()=>{var i;switch((i=useAuthStore().user)==null?void 0:i.user_type){case"admin":case"entreprise":return[{value:"private",label:"Privé"},{value:"enterprise",label:"Entreprise"},{value:"employee",label:"Salaries"},{value:"visitor",label:"Visiteurs"}];case"salarie":return[{value:"private",label:"Privé"},{value:"employee",label:"Salaries"},{value:"visitor",label:"Visiteurs"}];default:return[{value:"private",label:"Privé"}]}}),(r,i)=>(Xe(),tt("div",c8,[i[121]||(i[121]=M("div",{class:"p-3 bg-gray-50 border-b border-gray-200"},[M("h3",{class:"text-sm font-semibold text-gray-700"},"Outils de dessin")],-1)),M("div",h8,[M("div",f8,[(Xe(!0),tt(Un,null,kr(n.filter(o=>o.type!=="delete"),o=>(Xe(),tt("button",{key:o.type,class:Yi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":r.currentTool===o.type}]),onClick:l=>r.$emit("tool-change",r.currentTool===o.type?"":o.type),title:o.label},[M("span",{class:"icon",innerHTML:t(o.type)},null,8,p8)],10,d8))),128))]),r.selectedShape?(Xe(),tt("button",{key:0,class:Yi(["w-full mt-2 p-2 rounded border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",{"bg-red-100":r.currentTool==="delete"}]),onClick:i[0]||(i[0]=o=>r.$emit("delete-shape")),title:"Supprimer la forme"},i[54]||(i[54]=[M("svg",{class:"w-4 h-4 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),2)):yn("",!0)]),r.selectedShape&&r.localProperties?(Xe(),tt("div",g8,[M("div",m8,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:i[1]||(i[1]=o=>r.toggleSection("style"))},[i[56]||(i[56]=M("span",null,"Style",-1)),(Xe(),tt("svg",{class:Yi(["w-4 h-4",{"rotate-180":!r.sectionsCollapsed.style}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i[55]||(i[55]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),Dn(M("div",v8,[M("div",y8,[(Xe(!0),tt(Un,null,kr(r.predefinedColors,o=>(Xe(),tt("button",{key:o,class:"w-8 h-8 rounded-full",style:Jc({backgroundColor:o}),onClick:l=>r.selectPresetColor(o),title:o},null,12,_8))),128))]),r.localProperties.type!=="TextRectangle"?(Xe(),tt("div",b8,[M("div",w8,[i[57]||(i[57]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),M("div",x8,[Dn(M("input",{type:"color","onUpdate:modelValue":i[2]||(i[2]=o=>r.strokeColor=o),class:"w-16 h-8 rounded border",onChange:i[3]||(i[3]=o=>r.updateStyle({strokeColor:r.strokeColor})),title:"Couleur du contour"},null,544),[[Mr,r.strokeColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":i[4]||(i[4]=o=>r.strokeWidth=o),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:i[5]||(i[5]=o=>r.updateStyle({strokeWidth:r.strokeWidth})),title:"Épaisseur du contour"},null,544),[[Mr,r.strokeWidth]])])]),M("div",L8,[i[58]||(i[58]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Style",-1)),Dn(M("select",{"onUpdate:modelValue":i[6]||(i[6]=o=>r.strokeStyle=o),class:"w-full rounded border",onChange:i[7]||(i[7]=o=>r.updateStyle({strokeStyle:r.strokeStyle}))},[(Xe(!0),tt(Un,null,kr(r.strokeStyles,o=>(Xe(),tt("option",{key:o.value,value:o.value},Ht(o.label),9,S8))),128))],544),[[Hs,r.strokeStyle]])]),r.showFillOptions?(Xe(),tt("div",C8,[i[59]||(i[59]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),M("div",P8,[Dn(M("input",{type:"color","onUpdate:modelValue":i[8]||(i[8]=o=>r.fillColor=o),class:"w-16 h-8 rounded border",onChange:i[9]||(i[9]=o=>r.updateStyle({fillColor:r.fillColor})),title:"Couleur de remplissage"},null,544),[[Mr,r.fillColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":i[10]||(i[10]=o=>r.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:i[11]||(i[11]=o=>r.updateStyle({fillOpacity:r.fillOpacity})),title:"Opacité du remplissage"},null,544),[[Mr,r.fillOpacity]])])])):yn("",!0)])):yn("",!0),r.localProperties.type==="TextRectangle"?(Xe(),tt("div",E8,[M("div",A8,[i[60]||(i[60]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Contour",-1)),M("div",M8,[Dn(M("input",{type:"color","onUpdate:modelValue":i[12]||(i[12]=o=>r.strokeColor=o),class:"w-16 h-8 rounded border",onChange:i[13]||(i[13]=o=>r.updateStyle({strokeColor:r.strokeColor})),title:"Couleur du contour"},null,544),[[Mr,r.strokeColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":i[14]||(i[14]=o=>r.strokeWidth=o),min:"1",max:"10",class:"w-16 h-2 rounded-md",onChange:i[15]||(i[15]=o=>r.updateStyle({strokeWidth:r.strokeWidth})),title:"Épaisseur du contour"},null,544),[[Mr,r.strokeWidth]])])]),M("div",k8,[i[61]||(i[61]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Remplir",-1)),M("div",T8,[Dn(M("input",{type:"color","onUpdate:modelValue":i[16]||(i[16]=o=>r.fillColor=o),class:"w-16 h-8 rounded border",onChange:i[17]||(i[17]=o=>r.updateStyle({fillColor:r.fillColor})),title:"Couleur de remplissage"},null,544),[[Mr,r.fillColor]]),Dn(M("input",{type:"range","onUpdate:modelValue":i[18]||(i[18]=o=>r.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-16 h-2 rounded-md",onChange:i[19]||(i[19]=o=>r.updateStyle({fillOpacity:r.fillOpacity})),title:"Opacité du remplissage"},null,544),[[Mr,r.fillOpacity]])])]),M("div",B8,[i[62]||(i[62]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Texte",-1)),M("div",N8,[Dn(M("input",{type:"color","onUpdate:modelValue":i[20]||(i[20]=o=>r.textColor=o),class:"w-16 h-8 rounded border",onChange:i[21]||(i[21]=o=>r.updateTextStyle({textColor:r.textColor})),title:"Couleur du texte"},null,544),[[Mr,r.textColor]])])]),M("div",R8,[i[64]||(i[64]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Taille",-1)),M("div",D8,[Dn(M("select",{"onUpdate:modelValue":i[22]||(i[22]=o=>r.fontSize=o),class:"w-full rounded border",onChange:i[23]||(i[23]=o=>r.updateTextStyle({fontSize:r.fontSize}))},i[63]||(i[63]=[wc('<option value="10px" data-v-6512c03b>Très petit</option><option value="12px" data-v-6512c03b>Petit</option><option value="14px" data-v-6512c03b>Normal</option><option value="16px" data-v-6512c03b>Moyen</option><option value="18px" data-v-6512c03b>Grand</option><option value="24px" data-v-6512c03b>Très grand</option><option value="32px" data-v-6512c03b>Énorme</option>',7)]),544),[[Hs,r.fontSize]])])]),M("div",O8,[i[66]||(i[66]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Police",-1)),M("div",I8,[Dn(M("select",{"onUpdate:modelValue":i[24]||(i[24]=o=>r.fontFamily=o),class:"w-full rounded border",onChange:i[25]||(i[25]=o=>r.updateTextStyle({fontFamily:r.fontFamily}))},i[65]||(i[65]=[wc('<option value="Arial, sans-serif" data-v-6512c03b>Arial</option><option value="&#39;Times New Roman&#39;, serif" data-v-6512c03b>Times</option><option value="&#39;Courier New&#39;, monospace" data-v-6512c03b>Courier</option><option value="Georgia, serif" data-v-6512c03b>Georgia</option><option value="Verdana, sans-serif" data-v-6512c03b>Verdana</option>',5)]),544),[[Hs,r.fontFamily]])])]),M("div",F8,[i[67]||(i[67]=M("span",{class:"w-20 text-sm font-semibold text-gray-700"},"Align.",-1)),M("div",z8,[(Xe(!0),tt(Un,null,kr(r.textAlignOptions,o=>(Xe(),tt("button",{key:o.value,class:Yi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":r.currentTextAlign===o.value}]),onClick:l=>r.updateTextStyle({textAlign:o.value}),title:o.label},[M("span",{innerHTML:o.icon},null,8,U8)],10,j8))),128)),M("button",{class:Yi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":r.isBold}]),onClick:i[26]||(i[26]=(...o)=>r.toggleBold&&r.toggleBold(...o)),title:"Gras"}," B ",2),M("button",{class:Yi(["flex items-center justify-center p-2 rounded border",{"bg-blue-50 border-blue-200 text-blue-700":r.isItalic}]),onClick:i[27]||(i[27]=(...o)=>r.toggleItalic&&r.toggleItalic(...o)),title:"Italique"}," I ",2)])])])):yn("",!0)],512),[[_f,!r.sectionsCollapsed.style]])])):yn("",!0),r.selectedShape&&r.localProperties&&r.localProperties.type!=="TextRectangle"?(Xe(),tt("div",$8,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:i[28]||(i[28]=o=>r.toggleSection("properties"))},[i[69]||(i[69]=M("span",null,"Propriétés",-1)),(Xe(),tt("svg",{class:Yi(["w-4 h-4",{"rotate-180":!r.sectionsCollapsed.properties}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i[68]||(i[68]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",q8,[r.localProperties?(Xe(),tt("div",V8,[M("div",G8,[i[70]||(i[70]=M("label",{for:"shapeName",class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la forme",-1)),Dn(M("input",{type:"text",id:"shapeName","onUpdate:modelValue":i[29]||(i[29]=o=>r.shapeName=o),onChange:i[30]||(i[30]=(...o)=>r.updateShapeName&&r.updateShapeName(...o)),placeholder:"Donnez un nom à cette forme",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},null,544),[[Mr,r.shapeName]])]),M("div",H8,[r.localProperties.type==="Circle"?(Xe(),tt("div",W8,[M("div",Z8,[i[71]||(i[71]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),M("span",K8,Ht(r.formatLength(r.localProperties.radius||0)),1)]),M("div",J8,[i[72]||(i[72]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",Y8,Ht(r.formatArea(r.localProperties.surface||0)),1)]),M("div",X8,[i[73]||(i[73]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",Q8,Ht(r.formatArea(r.totalCoverageArea||0)),1)])])):r.localProperties.type==="CircleWithSections"?(Xe(),tt("div",eT,[M("div",tT,[i[74]||(i[74]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon total :",-1)),M("span",nT,Ht(r.formatLength(r.localProperties.radius||0)),1)]),M("div",rT,[i[75]||(i[75]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale :",-1)),M("span",iT,Ht(r.formatArea(r.localProperties.surface||0)),1)]),M("div",sT,[i[76]||(i[76]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface des sections :",-1)),M("span",oT,Ht(r.formatArea(r.localProperties.sectionArea||0)),1)]),M("div",aT,[i[77]||(i[77]=M("span",{class:"text-sm font-semibold text-gray-700"},"Nombre de sections :",-1)),M("span",lT,Ht(r.circleSections.length),1)])])):r.localProperties.type==="Rectangle"?(Xe(),tt("div",uT,[M("div",cT,[i[79]||(i[79]=M("label",{for:"rectangle-width",class:"text-sm font-semibold text-gray-700 w-20"},"Largeur :",-1)),M("div",hT,[Dn(M("input",{id:"rectangle-width",type:"number","onUpdate:modelValue":i[31]||(i[31]=o=>r.rectangleWidth=o),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:i[32]||(i[32]=(...o)=>r.updateRectangleDimensions&&r.updateRectangleDimensions(...o))},null,544),[[Mr,r.rectangleWidth]]),i[78]||(i[78]=M("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),M("div",fT,[i[81]||(i[81]=M("label",{for:"rectangle-height",class:"text-sm font-semibold text-gray-700 w-20"},"Hauteur :",-1)),M("div",dT,[Dn(M("input",{id:"rectangle-height",type:"number","onUpdate:modelValue":i[33]||(i[33]=o=>r.rectangleHeight=o),min:"1",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm",onChange:i[34]||(i[34]=(...o)=>r.updateRectangleDimensions&&r.updateRectangleDimensions(...o))},null,544),[[Mr,r.rectangleHeight]]),i[80]||(i[80]=M("span",{class:"text-sm text-gray-500 ml-1"},"m",-1))])]),M("div",pT,[i[82]||(i[82]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",gT,Ht(r.formatArea(r.localProperties.surface||0)),1)]),M("div",mT,[i[83]||(i[83]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",vT,Ht(r.formatArea(r.totalCoverageArea||0)),1)])])):r.localProperties.type==="Semicircle"?(Xe(),tt("div",yT,[M("div",_T,[i[84]||(i[84]=M("span",{class:"text-sm font-semibold text-gray-700"},"Rayon :",-1)),M("span",bT,Ht(r.formatLength(r.localProperties.radius||0)),1)]),M("div",wT,[i[85]||(i[85]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",xT,Ht(r.formatArea(r.localProperties.surface||0)),1)]),M("div",LT,[i[86]||(i[86]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",ST,Ht(r.formatArea(r.totalCoverageArea||0)),1)]),M("div",CT,[i[87]||(i[87]=M("span",{class:"text-sm font-semibold text-gray-700"},"Angle :",-1)),M("span",PT,Ht(Math.round(r.localProperties.openingAngle||0))+"°",1)])])):r.localProperties.type==="Line"?(Xe(),tt(Un,{key:4},[i[88]||(i[88]=M("span",{class:"text-sm font-semibold text-gray-700"},"Longueur :",-1)),M("span",ET,Ht(r.formatLength(r.localProperties.length||0)),1)],64)):r.localProperties.type==="Polygon"?(Xe(),tt("div",AT,[M("div",MT,[i[89]||(i[89]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface :",-1)),M("span",kT,Ht(r.formatArea(r.localProperties.surface||0)),1)]),M("div",TT,[i[90]||(i[90]=M("span",{class:"text-sm font-semibold text-gray-700"},"Surface totale d'irrigation :",-1)),M("span",BT,Ht(r.formatArea(r.totalCoverageArea||0)),1)]),M("div",NT,[i[91]||(i[91]=M("span",{class:"text-sm font-semibold text-gray-700"},"Périmètre :",-1)),M("span",RT,Ht(r.formatLength(r.localProperties.perimeter||0)),1)])])):r.localProperties.type==="ElevationLine"?(Xe(),tt(Un,{key:6},[M("div",DT,[M("div",OT,[i[92]||(i[92]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Distance totale :",-1)),M("span",IT,Ht(r.formatLength(r.localProperties.length||0)),1)]),M("div",FT,[i[93]||(i[93]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé + :",-1)),M("span",zT,Ht(r.formatLength(r.localProperties.elevationGain||0)),1)]),M("div",jT,[i[94]||(i[94]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Dénivelé - :",-1)),M("span",UT,Ht(r.formatLength(r.localProperties.elevationLoss||0)),1)]),M("div",$T,[i[95]||(i[95]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente moy. :",-1)),M("span",qT,Ht(r.formatSlope(r.localProperties.averageSlope||0)),1)]),M("div",VT,[i[96]||(i[96]=M("span",{class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},"Pente max :",-1)),M("span",GT,Ht(r.formatSlope(r.localProperties.maxSlope||0)),1)])]),M("div",{ref:"elevationProfileContainer",class:"elevation-profile-container w-full h-48 bg-gray-50 rounded border border-gray-200 relative mt-4",onMousemove:i[35]||(i[35]=(...o)=>r.handleProfileHover&&r.handleProfileHover(...o)),onMouseleave:i[36]||(i[36]=(...o)=>r.handleProfileLeave&&r.handleProfileLeave(...o))},[M("canvas",HT,null,512)],544)],64)):yn("",!0)])])):(Xe(),tt("div",WT," Aucune propriété disponible "))],512),[[_f,!r.sectionsCollapsed.properties]])])):yn("",!0),r.selectedShape&&r.localProperties&&r.localProperties.type==="ElevationLine"?(Xe(),tt("div",ZT,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:i[37]||(i[37]=o=>r.toggleSection("samplePoints"))},[i[98]||(i[98]=M("span",null,"Points d'échantillonnage",-1)),(Xe(),tt("svg",{class:Yi(["w-4 h-4",{"rotate-180":!r.sectionsCollapsed.samplePoints}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i[97]||(i[97]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",KT,[M("div",JT,[i[103]||(i[103]=M("h4",{class:"text-sm font-semibold mb-2"},"Points normaux",-1)),M("div",YT,[M("div",null,[i[99]||(i[99]=M("label",{class:"text-xs text-gray-600"},"Taille",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":i[38]||(i[38]=o=>r.samplePointStyle.radius=o),min:"2",max:"10",step:"1",class:"w-full px-2 py-1 border rounded",onChange:i[39]||(i[39]=(...o)=>r.updateSamplePointStyle&&r.updateSamplePointStyle(...o))},null,544),[[Mr,r.samplePointStyle.radius]])]),M("div",null,[i[100]||(i[100]=M("label",{class:"text-xs text-gray-600"},"Couleur",-1)),Dn(M("input",{type:"color","onUpdate:modelValue":i[40]||(i[40]=o=>r.samplePointStyle.color=o),class:"w-full h-8 px-1 border rounded",onChange:i[41]||(i[41]=(...o)=>r.updateSamplePointStyle&&r.updateSamplePointStyle(...o))},null,544),[[Mr,r.samplePointStyle.color]])]),M("div",null,[i[101]||(i[101]=M("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Dn(M("input",{type:"range","onUpdate:modelValue":i[42]||(i[42]=o=>r.samplePointStyle.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-full",onChange:i[43]||(i[43]=(...o)=>r.updateSamplePointStyle&&r.updateSamplePointStyle(...o))},null,544),[[Mr,r.samplePointStyle.fillOpacity]])]),M("div",null,[i[102]||(i[102]=M("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":i[44]||(i[44]=o=>r.samplePointStyle.weight=o),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:i[45]||(i[45]=(...o)=>r.updateSamplePointStyle&&r.updateSamplePointStyle(...o))},null,544),[[Mr,r.samplePointStyle.weight]])])])]),M("div",null,[i[107]||(i[107]=M("h4",{class:"text-sm font-semibold mb-2"},"Points min/max",-1)),M("div",XT,[M("div",null,[i[104]||(i[104]=M("label",{class:"text-xs text-gray-600"},"Taille",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":i[46]||(i[46]=o=>r.minMaxPointStyle.radius=o),min:"4",max:"12",step:"1",class:"w-full px-2 py-1 border rounded",onChange:i[47]||(i[47]=(...o)=>r.updateMinMaxPointStyle&&r.updateMinMaxPointStyle(...o))},null,544),[[Mr,r.minMaxPointStyle.radius]])]),M("div",null,[i[105]||(i[105]=M("label",{class:"text-xs text-gray-600"},"Bordure",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":i[48]||(i[48]=o=>r.minMaxPointStyle.weight=o),min:"1",max:"5",step:"1",class:"w-full px-2 py-1 border rounded",onChange:i[49]||(i[49]=(...o)=>r.updateMinMaxPointStyle&&r.updateMinMaxPointStyle(...o))},null,544),[[Mr,r.minMaxPointStyle.weight]])]),M("div",null,[i[106]||(i[106]=M("label",{class:"text-xs text-gray-600"},"Opacité",-1)),Dn(M("input",{type:"range","onUpdate:modelValue":i[50]||(i[50]=o=>r.minMaxPointStyle.fillOpacity=o),min:"0",max:"1",step:"0.1",class:"w-full",onChange:i[51]||(i[51]=(...o)=>r.updateMinMaxPointStyle&&r.updateMinMaxPointStyle(...o))},null,544),[[Mr,r.minMaxPointStyle.fillOpacity]])])])])],512),[[_f,!r.sectionsCollapsed.samplePoints]])])):yn("",!0),r.selectedShape&&r.localProperties&&r.localProperties.type==="CircleWithSections"?(Xe(),tt("div",QT,[M("button",{class:"flex items-center justify-between w-full text-sm font-semibold text-gray-700",onClick:i[52]||(i[52]=o=>r.toggleSection("circleSections"))},[i[109]||(i[109]=M("span",null,"Sections",-1)),(Xe(),tt("svg",{class:Yi(["w-4 h-4",{"rotate-180":!r.sectionsCollapsed.circleSections}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i[108]||(i[108]=[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),Dn(M("div",eB,[M("div",tB,[i[111]||(i[111]=M("h4",{class:"text-sm font-semibold"},"Sections d'irrigation",-1)),M("button",{class:"p-1 rounded-full bg-blue-500 text-white hover:bg-blue-600",onClick:i[53]||(i[53]=(...o)=>r.addSection&&r.addSection(...o)),title:"Ajouter une section"},i[110]||(i[110]=[M("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]))]),r.circleSections.length>0?(Xe(),tt("div",nB,[(Xe(!0),tt(Un,null,kr(r.circleSections,o=>(Xe(),tt("div",{key:o.id,class:"border rounded p-2 relative"},[M("div",{class:"absolute top-0 left-0 w-1 h-full",style:Jc({backgroundColor:o.color})},null,4),M("div",rB,[M("div",iB,[M("div",sB,[Dn(M("input",{type:"text","onUpdate:modelValue":l=>o.name=l,class:"w-full font-medium px-2 py-1 border border-gray-200 focus:border-blue-300 rounded text-sm truncate text-ellipsis",onChange:l=>r.updateSection(o.id,{name:o.name})},null,40,oB),[[Mr,o.name]])]),M("button",{class:"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 flex-shrink-0",onClick:l=>r.removeSection(o.id),title:"Supprimer la section"},i[112]||(i[112]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,aB)]),M("div",lB,[M("div",uB,[i[113]||(i[113]=M("label",{class:"text-xs text-gray-600 block truncate"},"Angle début",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.startAngle=l,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>r.updateSection(o.id,{startAngle:o.startAngle})},null,40,cB),[[Mr,o.startAngle,void 0,{number:!0}]])]),M("div",hB,[i[114]||(i[114]=M("label",{class:"text-xs text-gray-600 block truncate"},"Angle fin",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.endAngle=l,min:"0",max:"360",step:"5",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>r.updateSection(o.id,{endAngle:o.endAngle})},null,40,fB),[[Mr,o.endAngle,void 0,{number:!0}]])]),M("div",dB,[i[115]||(i[115]=M("label",{class:"text-xs text-gray-600 block truncate"},"Rayon (m)",-1)),Dn(M("input",{type:"number","onUpdate:modelValue":l=>o.radius=l,min:1,step:"1",class:"w-full px-2 py-1 border rounded text-sm",onChange:l=>r.updateSection(o.id,{radius:o.radius})},null,40,pB),[[Mr,o.radius,void 0,{number:!0}]])]),M("div",gB,[i[116]||(i[116]=M("label",{class:"text-xs text-gray-600 block truncate"},"Surface",-1)),M("div",mB,Ht(r.formatArea(Math.PI*o.radius*o.radius*(o.endAngle-o.startAngle)/360||0)),1)]),M("div",vB,[i[117]||(i[117]=M("label",{class:"text-xs text-gray-600 block truncate"},"Couleur",-1)),Dn(M("input",{type:"color","onUpdate:modelValue":l=>o.color=l,class:"w-full h-8 px-1 border rounded",onChange:l=>r.updateSection(o.id,{color:o.color})},null,40,yB),[[Mr,o.color]])])]),M("div",_B,[r.isFullCircle(o)?(Xe(),tt("div",{key:0,class:"absolute h-full w-full",style:Jc({backgroundColor:o.color,opacity:.5})},null,4)):(Xe(),tt("div",{key:1,class:"absolute h-full",style:Jc({backgroundColor:o.color,opacity:.5,left:o.startAngle/360*100+"%",width:(o.endAngle-o.startAngle+360)%360/360*100+"%"})},null,4)),r.isFullCircle(o)?yn("",!0):(Xe(),tt("button",{key:2,class:"absolute right-0 top-0 p-0.5 text-xs text-gray-500 hover:text-gray-700 z-10",title:"Faire un cercle complet",onClick:l=>r.makeFullCircle(o)},i[118]||(i[118]=[M("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,bB)),i[119]||(i[119]=wc('<div class="absolute h-full w-px bg-gray-400 left-0" data-v-6512c03b></div><div class="absolute h-full w-px bg-gray-400 left-25%" data-v-6512c03b></div><div class="absolute h-full w-px bg-gray-400 left-50%" data-v-6512c03b></div><div class="absolute h-full w-px bg-gray-400 left-75%" data-v-6512c03b></div><div class="absolute h-full w-px bg-gray-400 right-0" data-v-6512c03b></div><div class="absolute text-xs bottom-0 left-0 text-gray-600" data-v-6512c03b>0°</div><div class="absolute text-xs bottom-0 left-25% -ml-2 text-gray-600" data-v-6512c03b>90°</div><div class="absolute text-xs bottom-0 left-50% -ml-2 text-gray-600" data-v-6512c03b>180°</div><div class="absolute text-xs bottom-0 left-75% -ml-2 text-gray-600" data-v-6512c03b>270°</div><div class="absolute text-xs bottom-0 right-0 -mr-6 text-gray-600" data-v-6512c03b>360°</div>',10))]),r.isFullCircle(o)?(Xe(),tt("div",wB," Cercle complet (360°) ")):yn("",!0)])]))),128))])):(Xe(),tt("div",xB,i[120]||(i[120]=[Ni(" Aucune section d'irrigation définie. "),M("br",null,null,-1),Ni(" Cliquez sur le bouton + pour en ajouter. ")])))],512),[[_f,!r.sectionsCollapsed.circleSections]])])):yn("",!0)]))}}),SB=bm(LB,[["__scopeId","data-v-6512c03b"]]),CB={class:"map-toolbar w-full"},PB={class:"hidden md:flex items-center space-x-2"},EB={class:"dropdown"},AB={class:"dropdown-menu"},MB=["onClick"],kB={key:0,class:"border-l pl-2 flex-1"},TB={class:"flex items-center"},BB={class:"plan-info"},NB={class:"plan-name"},RB={key:0,class:"plan-description"},DB={class:"border-l pl-2 ml-auto"},OB={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},IB={key:1,class:"h-4 w-4 mr-2 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},FB={key:"saving"},zB={key:"success",class:"save-success-text"},jB={key:"default"},UB={class:"md:hidden"},$B={class:"flex justify-between items-center"},qB={key:0,class:"truncate mx-2 text-sm font-medium"},VB={key:0,class:"mobile-menu mt-2 bg-white shadow-md rounded p-2 z-50"},GB={class:"flex flex-col space-y-2"},HB={key:0,class:"flex flex-col pb-2 border-b"},WB={class:"text-sm font-semibold text-gray-800"},ZB={key:0,class:"text-xs text-gray-600 mt-1"},KB={class:"flex flex-col"},JB={class:"grid grid-cols-2 gap-1"},YB=["onClick"],XB={key:0,class:"animate-spin h-3 w-3 mr-1 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},QB={key:1,class:"h-3 w-3 mr-1 text-primary-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},e7={key:"saving"},t7={key:"success",class:"save-success-text"},n7={key:"default"},r7=Pa({__name:"MapToolbar",props:{lastSave:{},planName:{},planDescription:{},saveStatus:{}},emits:["change-map-type","create-new-plan","load-plan","save-plan","adjust-view","generate-summary"],setup(e,{emit:n}){const t=n,r=e,i=un("Hybride"),o=un(!1),l=Q=>{const I=Q.currentTarget,W=I.nextElementSibling;if(W&&W.classList.contains("dropdown-menu")){const ge=I.getBoundingClientRect();W.style.top=`${ge.bottom}px`,W.style.left=`${ge.left}px`}},h={Hybride:"Hybride",Cadastre:"Cadastre",IGN:"IGN"},g=Rr(()=>r.lastSave?new Date(r.lastSave).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais"),v=Q=>{i.value=Q,t("change-map-type",Q),$()},_=()=>{t("create-new-plan"),$()},x=()=>{t("load-plan"),$()},E=()=>{t("save-plan"),$()},b=()=>{t("adjust-view"),$()},R=()=>{t("generate-summary"),$()},$=()=>{o.value=!1};return(Q,I)=>(Xe(),tt("div",CB,[M("div",PB,[M("div",EB,[M("button",{class:"btn-toolbar dropdown-toggle",onMouseover:l},[I[1]||(I[1]=M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M12 1.586l-4 4V17h8V5.586l-4-4zM2 17V9.276l4-3.638V17H2zM2 8.162V3h4.5L12 8.5V17H6V5.638L2 8.162z","clip-rule":"evenodd"})],-1)),M("span",null,Ht(h[i.value]),1)],32),M("div",AB,[(Xe(),tt(Un,null,kr(h,(W,ge)=>M("button",{key:ge,class:Yi(["dropdown-item",{active:ge===i.value}]),onClick:Se=>v(ge)},Ht(W),11,MB)),64))])]),Q.planName?(Xe(),tt("div",kB,[M("div",TB,[M("div",BB,[M("h2",NB,Ht(Q.planName),1),Q.planDescription?(Xe(),tt("p",RB,Ht(Q.planDescription),1)):yn("",!0)])])])):yn("",!0),M("div",{class:"border-l pl-2"},[M("div",{class:"flex items-center space-x-1"},[M("button",{onClick:_,class:"btn-toolbar",title:"Nouveau plan"},I[2]||(I[2]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Nouveau",-1)])),M("button",{onClick:x,class:"btn-toolbar",title:"Charger un plan"},I[3]||(I[3]=[wc('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" data-v-9ca51e88><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" data-v-9ca51e88></path><path d="M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z" data-v-9ca51e88></path><path fill-rule="evenodd" d="M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z" clip-rule="evenodd" data-v-9ca51e88></path></svg><span class="hidden lg:inline ml-1" data-v-9ca51e88>Charger</span>',2)])),M("button",{onClick:E,class:"btn-toolbar",title:"Enregistrer le plan"},I[4]||(I[4]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Enregistrer",-1)]))])]),M("div",{class:"border-l pl-2"},[M("div",{class:"flex items-center space-x-1"},[M("button",{onClick:b,class:"btn-toolbar",title:"Ajuster la vue"},I[5]||(I[5]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Ajuster",-1)])),M("button",{onClick:R,class:"btn-toolbar",title:"Générer une synthèse"},I[6]||(I[6]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),M("span",{class:"hidden lg:inline ml-1"},"Synthèse",-1)]))])]),M("div",DB,[M("div",{class:Yi(["text-xs hidden lg:flex items-center",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(Xe(),tt("svg",OB,I[7]||(I[7]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yn("",!0),Q.saveStatus==="success"?(Xe(),tt("svg",IB,I[8]||(I[8]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):yn("",!0),Xi(ov,{name:"fade-slide",mode:"out-in"},{default:vc(()=>[Q.saveStatus==="saving"?(Xe(),tt("span",FB," Sauvegarde en cours... ")):Q.saveStatus==="success"?(Xe(),tt("span",zB," Sauvegarde réussie ! ")):(Xe(),tt("span",jB," Dernière modification : "+Ht(g.value),1))]),_:1})],2)])]),M("div",UB,[M("div",$B,[M("button",{onClick:I[0]||(I[0]=W=>o.value=!o.value),class:"p-1 rounded border"},I[9]||(I[9]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-600",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1)])),Q.planName?(Xe(),tt("div",qB,Ht(Q.planName),1)):yn("",!0),M("div",{class:"flex space-x-1"},[M("button",{onClick:_,class:"p-1 rounded border bg-white"},I[10]||(I[10]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule":"evenodd"})],-1)])),M("button",{onClick:E,class:"p-1 rounded border bg-white"},I[11]||(I[11]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"})],-1)])),M("button",{onClick:b,class:"p-1 rounded border bg-white"},I[12]||(I[12]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)]))])]),o.value?(Xe(),tt("div",VB,[M("div",GB,[Q.planName?(Xe(),tt("div",HB,[M("h3",WB,Ht(Q.planName),1),Q.planDescription?(Xe(),tt("p",ZB,Ht(Q.planDescription),1)):yn("",!0)])):yn("",!0),M("div",KB,[I[13]||(I[13]=M("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Type de carte",-1)),M("div",JB,[(Xe(),tt(Un,null,kr(h,(W,ge)=>M("button",{key:ge,class:Yi(["px-2 py-1 text-xs rounded border",{"bg-blue-50 border-blue-200 text-blue-700":ge===i.value}]),onClick:Se=>v(ge)},Ht(W),11,YB)),64))])]),M("div",{class:"flex flex-col"},[I[16]||(I[16]=M("span",{class:"text-xs font-medium text-gray-500 mb-1"},"Outils de plan",-1)),M("div",{class:"grid grid-cols-2 gap-1"},[M("button",{onClick:x,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},I[14]||(I[14]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"}),M("path",{d:"M10 9a1 1 0 011-1h5a1 1 0 110 2h-5a1 1 0 01-1-1z"}),M("path",{"fill-rule":"evenodd",d:"M13 5a1 1 0 011 1v4a1 1 0 11-2 0V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),Ni(" Charger ")])),M("button",{onClick:R,class:"px-2 py-1 text-xs rounded border flex items-center justify-center"},I[15]||(I[15]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})],-1),Ni(" Synthèse ")]))])]),M("div",{class:Yi(["text-xs text-center pt-1 border-t flex items-center justify-center space-x-1",{"text-gray-500":!Q.saveStatus,"text-primary-600 font-medium":Q.saveStatus==="success","text-blue-600 font-medium":Q.saveStatus==="saving"}])},[Q.saveStatus==="saving"?(Xe(),tt("svg",XB,I[17]||(I[17]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yn("",!0),Q.saveStatus==="success"?(Xe(),tt("svg",QB,I[18]||(I[18]=[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):yn("",!0),Xi(ov,{name:"fade-slide",mode:"out-in"},{default:vc(()=>[Q.saveStatus==="saving"?(Xe(),tt("span",e7," Sauvegarde en cours... ")):Q.saveStatus==="success"?(Xe(),tt("span",t7," Sauvegarde réussie ! ")):(Xe(),tt("span",n7," Dernière modification : "+Ht(g.value),1))]),_:1})],2)])])):yn("",!0)])]))}}),i7=bm(r7,[["__scopeId","data-v-9ca51e88"]]),mp=(e,n)=>{if(!e||typeof e!="string"||!e.startsWith("#"))return`rgba(0, 0, 0, ${n})`;const t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return`rgba(${t}, ${r}, ${i}, ${n})`},Py=(e,n)=>{e.style.fontSize=n.fontSize,e.style.color=n.color,e.style.backgroundColor=mp(n.backgroundColor,n.backgroundOpacity),n.hasBorder?e.style.border=`${n.borderWidth} solid ${mp(n.borderColor,n.borderOpacity)}`:e.style.border="none",e.style.padding=n.padding,e.style.borderRadius=n.borderRadius},Uo=e=>{document.querySelectorAll(".drawing-help-message").forEach(r=>r.remove());const t=vt.DomUtil.create("div","drawing-help-message");return t.innerHTML=e,t.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 2000;
    pointer-events: none;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  `,document.body.appendChild(t),t};function Ey(e,n,t){const r=156543.03392*Math.cos(n*Math.PI/180)/Math.pow(2,t);return e/r}const Vr=(e,n="m",t="")=>{let r,i;return n==="m²"?e>=1e4?(r=(e/1e4).toFixed(2),i="ha"):(r=e.toFixed(2),i="m²"):n==="m"?e>=1e3?(r=(e/1e3).toFixed(2),i="km"):(r=e.toFixed(2),i="m"):(r=e.toFixed(2),i=n),t?`${t}: ${r} ${i}`:`${r} ${i}`},s7=e=>({...e,clientX:e.clientX,clientY:e.clientY,button:e.button||0,buttons:e.buttons||0,altKey:e.altKey||!1}),o7=(e,n)=>{let t;return function(...r){window.clearTimeout(t),t=window.setTimeout(()=>e.apply(this,r),n)}},Hu=(e,n)=>{let t=0;return function(...r){const i=Date.now();if(!(i-t<n))return t=i,e.apply(this,r)}};function a7(){const e=un(null),n=un(null),t=un(null),r=un(null),i=un(""),o=un(null),l=un(!1),h=un(null);window.addEventListener("clearControlPoints",()=>{o.value=null,t.value&&t.value.clearLayers(),r.value&&r.value.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(N=>N.remove()),document.querySelectorAll(".drawing-help-message").forEach(N=>N.remove())}),Kh(()=>{window.removeEventListener("clearControlPoints",()=>{}),e.value&&(e.value.remove(),e.value=null)});const g=(N,Z="Double-cliquez pour éditer")=>{const he={fontSize:"14px",color:"#000000",backgroundColor:"#FFFFFF",backgroundOpacity:1,borderColor:"#000000",borderWidth:"1px",borderOpacity:1,padding:"5px 10px",borderRadius:"3px",hasBorder:!0,rotation:0,physicalSize:2},ne=(Ie,Ce)=>{var Ze;const qe=((Ze=e.value)==null?void 0:Ze.getZoom())||14,Re=N.lat,rt=Ey(Ce.physicalSize,Re,qe);return`<div class="text-container" style="width:${rt}px;height:${rt}px;transform:rotate(${Ce.rotation}deg)">
        <div class="text-annotation" style="font-size:${rt*.2}px;color:${Ce.color};background-color:${mp(Ce.backgroundColor,Ce.backgroundOpacity)};border:${Ce.hasBorder?Ce.borderWidth+" solid "+mp(Ce.borderColor,Ce.borderOpacity):"none"};padding:${Ce.padding};border-radius:${Ce.borderRadius}">${Ie}</div>
        <div class="text-controls"><div class="control-button rotate"></div><div class="control-button move"></div></div>
      </div>`},te=()=>{if(!e.value)return;const Ie=se.getIcon(),Ce={html:ne(se.properties.text,se.properties.style),className:Ie.options.className};se.setIcon(vt.divIcon(Ce))},ee=vt.divIcon({html:ne(Z,he),className:"text-container",iconSize:[40,40],iconAnchor:[20,20]}),se=vt.marker(N,{icon:ee,draggable:!1,pmIgnore:!0});se.properties={type:"text",text:Z,style:{...he}},e.value&&(e.value.on("zoomend",te),se.on("remove",()=>{var Ie;(Ie=e.value)==null||Ie.off("zoomend",te)})),te();let Pe=!1,oe=!1,re=0,xe=0;const ye=Ie=>{if(!e.value)return;const Ce=Ie.target;if(Ce.classList.contains("rotate")){Pe=!0;const qe=se.getLatLng(),Re=e.value.mouseEventToLatLng(Ie);re=Math.atan2(Re.lat-qe.lat,Re.lng-qe.lng)*180/Math.PI,xe=se.properties.style.rotation||0}else Ce.classList.contains("move")&&(oe=!0);document.addEventListener("mousemove",le),document.addEventListener("mouseup",Ue)},le=Ie=>{if(!(!oe||!e.value)){if(Pe){const Ce=se.getLatLng(),qe=e.value.mouseEventToLatLng(Ie),Re=Math.atan2(qe.lat-Ce.lat,qe.lng-Ce.lng)*180/Math.PI,rt=(xe+(Re-re))%360;se.properties.style.rotation=rt;const Ze=se.getIcon(),gt={html:ne(se.properties.text,se.properties.style),className:Ze.options.className};se.setIcon(vt.divIcon(gt))}else if(oe){const Ce=s7(Ie),qe=e.value.mouseEventToLatLng(Ce);se.setLatLng(qe)}}},Ue=()=>{Pe=!1,oe=!1,document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",Ue)};return se.on("add",()=>{const Ie=se.getElement();Ie&&Ie.querySelectorAll(".control-button").forEach(qe=>{qe.addEventListener("mousedown",ye)})}),se.on("remove",()=>{const Ie=se.getElement();Ie&&Ie.querySelectorAll(".control-button").forEach(qe=>{qe.removeEventListener("mousedown",ye)})}),se.on("dblclick",Ie=>{var gt;vt.DomEvent.stopPropagation(Ie);const Ce=(gt=se.getElement())==null?void 0:gt.querySelector(".text-annotation");if(!Ce)return;Ce.contentEditable="true",Ce.focus(),Ce.classList.add("editing");const qe=window.getSelection(),Re=document.createRange();Re.selectNodeContents(Ce),qe==null||qe.removeAllRanges(),qe==null||qe.addRange(Re);const rt=()=>{Ce.contentEditable="false",Ce.classList.remove("editing");const _t=Ce.innerText.trim();if(_t){se.properties.text=_t;const $t=se.getIcon(),tn={html:ne(_t,se.properties.style),className:$t.options.className};se.setIcon(vt.divIcon(tn))}Ce.removeEventListener("blur",rt),Ce.removeEventListener("keydown",Ze)},Ze=_t=>{_t.key==="Enter"&&!_t.shiftKey&&(_t.preventDefault(),rt())};Ce.addEventListener("blur",rt),Ce.addEventListener("keydown",Ze)}),se},v=(N,Z)=>{const he=vt.DomUtil.create("div","measure-tooltip");if(he.innerHTML=Z,he.style.cssText=`
      position: fixed;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2000;
      pointer-events: none;
      white-space: pre-line;
    `,document.body.appendChild(he),e.value){const ne=e.value.latLngToContainerPoint(N);he.style.left=`${ne.x+10}px`,he.style.top=`${ne.y-25}px`}return he},_=Hu((N,Z,he)=>{if(N&&(N.innerHTML=he,e.value)){const ne=e.value.latLngToContainerPoint(Z);N.style.left=`${ne.x+10}px`,N.style.top=`${ne.y-25}px`}},100),x=(N,Z,he)=>{N.on("mouseover",()=>{const ne=v(N.getLatLng(),he());N.measureDiv=ne}),N.on("mousemove",ne=>{N.measureDiv&&e.value&&_(N.measureDiv,ne.latlng,he())}),N.on("mouseout",()=>{N.measureDiv&&(N.measureDiv.remove(),N.measureDiv=void 0)})};let E=[];const b=()=>{var N;E.cleanup&&E.cleanup(),t.value&&t.value.clearLayers(),E=[],(N=r.value)==null||N.clearLayers(),document.querySelectorAll(".measure-tooltip").forEach(Z=>Z.remove()),n.value&&n.value.getLayers().forEach(Z=>{Z instanceof $o&&Z.clearHelperPoints()})},R=(N,Z="#2563EB")=>{const he=vt.circleMarker(N,{radius:6,color:Z,fillColor:Z,fillOpacity:1,weight:2,className:"control-point",pmIgnore:!0});return t.value&&t.value.addLayer(he),he},$=(N,Z)=>{var ne,te,ee,se,Pe,oe,re,xe,ye,le,Ue,Ie,Ce,qe;console.log("Input layer:",{type:Z,instanceof:{Circle:N instanceof vt.Circle,Rectangle:N instanceof vt.Rectangle,Polygon:N instanceof vt.Polygon,Polyline:N instanceof vt.Polyline,CircleArc:N instanceof wu,TextRectangle:N instanceof yu,ElevationLine:N instanceof lh,Line:N instanceof Lo,CircleWithSections:((ne=N.properties)==null?void 0:ne.type)==="CircleWithSections"},options:N.options});const he={type:Z,style:N.options||{}};try{if(N instanceof yu)return N.properties;if(((te=N.properties)==null?void 0:te.type)==="CircleWithSections"){const Re=N.properties;return{...Re,type:"CircleWithSections",style:{...Re.style,color:((ee=N.options)==null?void 0:ee.color)||"#3388ff",weight:((se=N.options)==null?void 0:se.weight)||3,opacity:((Pe=N.options)==null?void 0:Pe.opacity)||1,fillColor:((oe=N.options)==null?void 0:oe.fillColor)||"#3388ff",fillOpacity:((re=N.options)==null?void 0:re.fillOpacity)||.2,dashArray:((xe=N.options)==null?void 0:xe.dashArray)||""}}}else if(N instanceof vt.Circle){const Re=N.getRadius();he.radius=Re,he.diameter=Re*2,he.surface=Math.PI*Math.pow(Re,2),he.perimeter=2*Math.PI*Re,he.center=N.getLatLng()}else if(N instanceof wu){const Re=N.getRadius?N.getRadius():0,rt=N.getCenter?N.getCenter():{lat:0,lng:0},Ze=N.getStartAngle?N.getStartAngle():0,gt=N.getStopAngle?N.getStopAngle():180,_t=(gt-Ze+360)%360;he.radius=Re,he.diameter=Re*2,he.surface=Math.PI*Math.pow(Re,2)*_t/360,he.arcLength=2*Math.PI*Re*_t/360,he.perimeter=he.arcLength+2*Re,he.center=rt,he.startAngle=Ze,he.stopAngle=gt,he.openingAngle=_t}else if(N instanceof vt.Rectangle){const Re=N.getBounds(),rt=Re.getNorthEast(),Ze=Re.getSouthWest(),gt=El([[Ze.lng,Ze.lat],[rt.lng,Ze.lat]]),_t=El([[Ze.lng,Ze.lat],[Ze.lng,rt.lat]]),$t=Vc(gt,{units:"meters"}),tn=Vc(_t,{units:"meters"});he.width=$t,he.height=tn,he.surface=$t*tn,he.perimeter=2*($t+tn),he.dimensions={width:$t,height:tn}}else if(N instanceof vt.Polygon)try{const rt=N.getLatLngs()[0].map(gt=>[gt.lng,gt.lat]);rt.push(rt[0]);const Ze=Pl([rt]);he.surface=pu(Ze),he.perimeter=Vc(El(rt),{units:"meters"})}catch(Re){console.error("Erreur lors du calcul des propriétés du polygone",Re)}else if(N instanceof vt.Polyline&&!(N instanceof vt.Polygon))try{const Re=N.getLatLngs();let rt=0;for(let Ze=1;Ze<Re.length;Ze++)rt+=Re[Ze].distanceTo(Re[Ze-1]);he.length=rt}catch(Re){console.error("Erreur lors du calcul de la longueur de la ligne",Re)}he.style={...he.style,color:((ye=N.options)==null?void 0:ye.color)||"#3388ff",weight:((le=N.options)==null?void 0:le.weight)||3,opacity:((Ue=N.options)==null?void 0:Ue.opacity)||1,fillColor:((Ie=N.options)==null?void 0:Ie.fillColor)||"#3388ff",fillOpacity:((Ce=N.options)==null?void 0:Ce.fillOpacity)||.2,dashArray:((qe=N.options)==null?void 0:qe.dashArray)||""}}catch(Re){console.error("Error calculating shape properties:",Re)}return he},Q=(N,Z=2)=>{var se;if(!e.value){console.warn("Map is not available for text size update");return}const he=e.value.getZoom(),ne=N.getLatLng().lat,te=Ey(Z,ne,he),ee=(se=N.getElement())==null?void 0:se.querySelector(".text-annotation");ee&&(N.properties.style.fontSize=`${te}px`,N.properties.physicalWidth=Z,N.properties.physicalHeight=Z,Py(ee,N.properties.style))},I=(N,Z,he)=>{const ne=vt.map(N).setView(Z,he);e.value=ne,vt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:5}).addTo(ne);const te=new vt.FeatureGroup;return te.addTo(ne),n.value=te,t.value=vt.featureGroup().addTo(ne),r.value=vt.featureGroup().addTo(ne),ne.pm.setGlobalOptions({snappable:!0,snapDistance:20,allowSelfIntersection:!1,preventMarkerRemoval:!0,syncLayersOnDrag:!0,layerGroup:te,snapLayers:[te,r.value],templineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6},hintlineStyle:{color:"#3388ff",weight:2,opacity:.7,dashArray:"6,6",radius:6}}),ne.on("pm:drawstart",ee=>{l.value=!0,ee.shape==="Circle"&&i.value==="Semicircle"&&(ne.getContainer().style.cursor="crosshair")}),ne.on("pm:drawend",()=>{l.value=!1,ne.getContainer().style.cursor="",o.value&&Uo("Cliquez sur la forme pour afficher les points de contrôle")}),ne.on("pm:create",X),te.on("click",ee=>{var Pe,oe,re,xe,ye,le,Ue,Ie,Ce,qe,Re,rt,Ze,gt,_t,$t,tn,Qe,Yt;vt.DomEvent.stopPropagation(ee);const se=ee.layer;if(se.name&&!((Pe=se.properties)!=null&&Pe.name)?(se.properties||(se.properties={}),se.properties.name=se.name):(oe=se.properties)!=null&&oe.name&&!se.name&&(se.name=se.properties.name),console.log("[featureGroup click] État du nom:",{directName:se.name,propertiesName:(re=se.properties)==null?void 0:re.name,fullProperties:se.properties}),(xe=r.value)==null||xe.clearLayers(),b(),o.value=se,se instanceof yu){console.log("[featureGroup click] TextRectangle sélectionné",{id:se._leaflet_id,bounds:se.getBounds(),hasTextContainer:!!se.getTextElement(),properties:se.properties}),(ye=e.value)!=null&&ye.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),U(se),Uo("Double-cliquez pour éditer le texte. Utilisez les points rouges pour redimensionner.");return}if(se instanceof eh||((le=se.properties)==null?void 0:le.type)==="CircleWithSections"){console.log("[featureGroup click] CircleWithSections sélectionné",{id:se._leaflet_id,properties:se.properties,sections:(Ue=se.properties)==null?void 0:Ue.sections}),K(se),Uo("Utilisez les points de contrôle verts pour manipuler le cercle. Configurez les sections dans le panneau latéral.");return}if(se instanceof wu||((Ie=se.properties)==null?void 0:Ie.type)==="Semicircle")V(se);else if(se instanceof Zc)K(se);else if(se instanceof vt.Circle){console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(se,"name"),directName:se.name,propertiesName:(Ce=se.properties)==null?void 0:Ce.name,styleNameBeforeTransfer:(Re=(qe=se.properties)==null?void 0:qe.style)==null?void 0:Re.name,nameIsEnumerable:Object.keys(se).includes("name"),allProperties:Object.keys(se.properties||{}),_dbId:se._dbId});const Qt=se.name,Zt=(rt=se.properties)==null?void 0:rt.name,wt=(gt=(Ze=se.properties)==null?void 0:Ze.style)==null?void 0:gt.name,He=se._dbId,Kt=new Zc(se.getLatLng(),{...se.options,radius:se.getRadius()});se.properties?Kt.properties={...se.properties||{}}:Kt.updateProperties();const on=Qt||Zt||wt;on&&(Kt.properties.name=on,Kt.properties.style||(Kt.properties.style={}),Kt.properties.style.name=on,Kt.name=on),He&&(Kt._dbId=He),console.log("[useMapDrawing] Cercle après conversion:",{name:Kt.name,propertiesName:Kt.properties.name,stylePropertyName:(_t=Kt.properties.style)==null?void 0:_t.name,allProperties:Object.keys(Kt.properties||{})}),($t=n.value)==null||$t.removeLayer(se),(tn=n.value)==null||tn.addLayer(Kt),o.value=Kt,K(Kt)}else if(se instanceof $o)ce(se);else if(se instanceof vt.Rectangle){const Qt=new $o(se.getBounds(),{...se.options});Qt.updateProperties(),(Qe=n.value)==null||Qe.removeLayer(se),(Yt=n.value)==null||Yt.addLayer(Qt),o.value=Qt,ce(Qt)}else se instanceof vt.Polygon?D(se):(se instanceof Lo||se instanceof vt.Polyline)&&H(se)}),ne.on("pm:edit",ee=>{var Pe,oe,re;console.log("[pm:edit] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const se=ee.layer;if(se){const xe=((Pe=se.properties)==null?void 0:Pe.type)||"unknown";if(Ve(se,xe),console.log("[pm:edit] Après updateLayerProperties",{updatedProperties:se.properties,selectedShape:o.value}),xe==="Semicircle")V(se);else if(se instanceof Zc)K(se);else if(se instanceof $o)ce(se);else if(se instanceof vt.Rectangle){const ye=new $o(se.getBounds(),{...se.options});ye.updateProperties(),(oe=n.value)==null||oe.removeLayer(se),(re=n.value)==null||re.addLayer(ye),o.value=ye,ce(ye)}else se instanceof vt.Polygon?D(se):se instanceof Lo?(se.updateProperties(),Ve(se,"Line"),H(se)):se instanceof vt.Polyline&&H(se)}}),ne.on("pm:dragstart",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()),Uo("Déplacez la forme à l'endroit souhaité")}),ne.on("pm:dragend",ee=>{var Pe,oe,re;console.log("[pm:dragend] Début",{layer:ee.layer,currentProperties:ee.layer.properties});const se=ee.layer;if(se){const xe=((Pe=se.properties)==null?void 0:Pe.type)||"unknown";if(se instanceof vt.Rectangle&&!(se instanceof $o)){const ye=new $o(se.getBounds(),{...se.options});ye.updateProperties(),(oe=n.value)==null||oe.removeLayer(se),(re=n.value)==null||re.addLayer(ye),o.value=ye,ce(ye)}else se instanceof Lo?(se.updateProperties(),Ve(se,"Line"),H(se)):Ve(se,xe);console.log("[pm:dragend] Après updateLayerProperties",{updatedProperties:se.properties,selectedShape:o.value})}setTimeout(()=>{Uo("Cliquez sur la forme pour afficher les points de contrôle")},100)}),ne.on("pm:remove",()=>{var ee;(ee=document.querySelector(".drawing-help-message"))==null||ee.remove()}),ne.on("pm:select",ee=>{var Pe;const se=ee.layer;document.querySelectorAll(".drawing-help-message").forEach(oe=>oe.remove()),se instanceof wu||((Pe=se.properties)==null?void 0:Pe.type)==="Semicircle"?Uo(`Points de contrôle : <span style="color: #059669">●</span> Ajuster le rayon, <span style="color: #2563EB">●</span> et <span style="color: #DC2626">●</span> Modifier l'ouverture du demi-cercle`):Uo("Utilisez les points de contrôle pour modifier la forme")}),ne.on("pm:unselect",()=>{document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove())}),ne.on("zoomstart",()=>{o.value&&(b(),o.value=null,document.querySelectorAll(".drawing-help-message").forEach(ee=>ee.remove()))}),ne},W=()=>{if(!(!e.value||!n.value||!n.value.getLayers().length))try{const N=n.value.getBounds();if(N.isValid()){const Z={zoomAnimation:e.value.options.zoomAnimation,fadeAnimation:e.value.options.fadeAnimation,markerZoomAnimation:e.value.options.markerZoomAnimation};e.value.options.zoomAnimation=!1,e.value.options.fadeAnimation=!1,e.value.options.markerZoomAnimation=!1,e.value.fitBounds(N,{padding:[50,50],maxZoom:18,animate:!1,duration:0,noMoveStart:!0}),e.value.invalidateSize({animate:!1,pan:!1}),setTimeout(()=>{try{e.value.options.fadeAnimation=Z.fadeAnimation,setTimeout(()=>{try{e.value.options.zoomAnimation=Z.zoomAnimation,e.value.options.markerZoomAnimation=Z.markerZoomAnimation}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}catch(he){console.warn("[useMapDrawing] Erreur lors de la restauration des animations:",he)}},500)}}catch(N){if(console.warn("[useMapDrawing] Error adjusting view:",N),e.value)try{e.value.options.zoomAnimation=!0,e.value.options.fadeAnimation=!0,e.value.options.markerZoomAnimation=!0,e.value.invalidateSize({animate:!1,pan:!1})}catch(Z){console.error("[useMapDrawing] Erreur lors de la restauration après échec:",Z)}}},ge=N=>{var Z;if(e.value){document.querySelectorAll(".drawing-help-message").forEach(he=>he.remove());try{const he=e.value.pm;he.globalEditModeEnabled()&&he.disableGlobalEditMode(),he.globalRemovalModeEnabled()&&he.disableGlobalRemovalMode(),he.disableDraw(),b(),(Z=r.value)==null||Z.clearLayers()}catch(he){console.error("Error disabling modes:",he)}if(i.value=N,!N){b();return}Ee(),setTimeout(()=>{var he,ne,te,ee,se,Pe,oe,re,xe,ye,le,Ue;try{switch(N){case"Circle":case"Semicircle":n.value&&n.value.getLayers().filter(qe=>qe instanceof $o).forEach(qe=>{qe.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,r.value],snapMiddle:!0,snapIntersections:!0});let Ie="Positionnez le centre du cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre";N==="Semicircle"&&(Ie="Positionnez le centre du demi-cercle. Points bleus : milieu des côtés, Points rouges : sommets, Point vert : centre"),Uo(Ie),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1});break;case"CircleWithSections":n.value&&n.value.getLayers().filter(qe=>qe instanceof $o).forEach(qe=>{qe.toggleHelperPoints(e.value,!0,"#DC2626","#2563EB")}),e.value.pm.setGlobalOptions({snapDistance:15,snapSegment:!0,snapVertices:!0,snapLayers:[n.value,r.value],snapMiddle:!0,snapIntersections:!0}),Uo("Positionnez le centre du cercle d'irrigation. Vous pourrez ajouter des sections après sa création."),e.value.pm.enableDraw("Circle",{finishOn:"mouseup",continueDrawing:!1}),e.value.off("pm:create"),e.value.on("pm:create",Ce=>{var qe,Re,rt;if(Ce.shape==="Circle"&&Ce.layer&&i.value==="CircleWithSections"){const Ze=Ce.layer,gt=Ze.getLatLng(),_t=Ze.getRadius();(qe=e.value)==null||qe.removeLayer(Ze),(Re=n.value)!=null&&Re.hasLayer(Ze)&&n.value.removeLayer(Ze);const $t=new eh(gt,{radius:_t,color:"#3B82F6",weight:2,fillColor:"#3B82F6",fillOpacity:.2,name:"Cercle d'irrigation"});n.value&&(n.value.addLayer($t),o.value=$t,$t.updateProperties(),console.log("[CircleWithSections] Nouveau cercle avec sections créé",{center:gt,radius:_t,properties:$t.properties}),$t.addSection({startAngle:0,endAngle:90,radius:_t>=20?_t-20:_t,name:"Section 1"})),(rt=e.value)==null||rt.pm.disableDraw(),Ee()}});break;case"Rectangle":Uo("Cliquez et maintenez pour dessiner un rectangle, relâchez pour terminer"),(he=e.value)==null||he.pm.enableDraw("Rectangle",{finishOn:"mouseup"});break;case"Polygon":Uo("Cliquez pour ajouter des points, double-cliquez pour terminer le polygone"),(ne=e.value)==null||ne.pm.enableDraw("Polygon",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Line":Uo("Cliquez pour ajouter des points, double-cliquez pour terminer la ligne"),(te=e.value)==null||te.pm.enableDraw("Line",{finishOn:"dblclick",continueDrawing:!1,snapMiddle:!0,snapDistance:20});break;case"Text":if(Uo("Cliquez pour ajouter du texte, double-cliquez pour éditer"),e.value){const Ce=qe=>{if(!e.value||!n.value)return;const Re=g(qe.latlng);n.value.addLayer(Re),o.value=Re,e.value.off("click",Ce),ge("")};e.value.on("click",Ce)}break;case"delete":Uo("Cliquez sur une forme pour la supprimer"),(ee=e.value)==null||ee.pm.enableGlobalRemovalMode();break;case"TextRectangle":Uo("Cliquez et maintenez pour dessiner un rectangle avec texte, relâchez pour terminer"),(se=e.value)!=null&&se.pm.globalEditModeEnabled()&&e.value.pm.disableGlobalEditMode(),(Pe=e.value)==null||Pe.pm.enableDraw("Rectangle",{finishOn:"mouseup",continueDrawing:!1,templineStyle:{color:"#3B82F6",weight:2,dashArray:"5,5"}}),(oe=e.value)==null||oe.off("pm:create"),(re=e.value)==null||re.on("pm:create",Ce=>{var qe,Re,rt;if(Ce.shape==="Rectangle"&&Ce.layer){const Ze=Ce.layer.getBounds();let gt=!1;if(n.value&&n.value.eachLayer(_t=>{if(_t instanceof yu){const $t=_t.getBounds(),tn=1e-8;Math.abs($t.getNorth()-Ze.getNorth())<tn&&Math.abs($t.getSouth()-Ze.getSouth())<tn&&Math.abs($t.getEast()-Ze.getEast())<tn&&Math.abs($t.getWest()-Ze.getWest())<tn&&(gt=!0,o.value=_t,console.log("[TextRectangle] Rectangle existant trouvé, sélection au lieu de création"))}}),!gt){(qe=e.value)==null||qe.removeLayer(Ce.layer),(Re=n.value)!=null&&Re.hasLayer(Ce.layer)&&n.value.removeLayer(Ce.layer);const _t=new yu(Ze,"Double-cliquez pour éditer",{color:"#3B82F6",weight:2,fillColor:"#F9FAFB",fillOpacity:.8,textColor:"#000000",fontFamily:"Arial, sans-serif",textAlign:"center",bold:!1,italic:!1});n.value&&(n.value.addLayer(_t),o.value=_t,_t.updateProperties(),U(_t),console.log("[TextRectangle] Nouveau rectangle créé avec succès",{bounds:_t.getBounds(),properties:_t.properties,style:_t.properties.style}))}(rt=e.value)==null||rt.pm.disableDraw(),Ee()}});break;case"ElevationLine":Uo("Cliquez et maintenez pour tracer le profil altimétrique"),(xe=e.value)==null||xe.pm.enableDraw("Line",{finishOn:"mouseup",continueDrawing:!1,allowSelfIntersection:!1,templineStyle:{color:"#FF4500",weight:4,opacity:.8}}),(ye=e.value)==null||ye.pm.setGlobalOptions({continueDrawing:!1,finishOn:"mouseup",preventMarkerRemoval:!0,preventVertexEdit:!0,preventMarkerEdit:!0}),(le=e.value)==null||le.off("pm:create"),(Ue=e.value)==null||Ue.on("pm:create",async Ce=>{var qe,Re,rt;if(Ce.shape==="Line"&&Ce.layer){const Ze=Ce.layer.getLatLngs();(qe=e.value)==null||qe.removeLayer(Ce.layer),(Re=n.value)!=null&&Re.hasLayer(Ce.layer)&&n.value.removeLayer(Ce.layer);const gt=new lh(Ze,{color:"#FF4500",weight:4,opacity:.8,interactive:!1,pmIgnore:!0});if(n.value){n.value.addLayer(gt),o.value=gt,await gt.updateElevationProfile();const _t=$(gt,"ElevationLine");Object.assign(gt.properties,{..._t,...gt.properties,type:"ElevationLine",elevationData:gt.getElevationData()}),o.value=null,Ds(()=>{o.value=gt})}(rt=e.value)==null||rt.pm.disableDraw(),i.value="",Ee()}});break}}catch(Ie){console.error("[setDrawingTool] Erreur lors de la configuration de l'outil:",Ie)}},100)}},Se=N=>{var he;if(!o.value)return;const Z=o.value;if(Z.properties=Z.properties||{},Z.properties.style=Z.properties.style||{},Z.properties.style={...Z.properties.style,...N},Z.properties.type==="text"){const ne=Z.properties._textLayer,te=(he=ne==null?void 0:ne.getElement())==null?void 0:he.querySelector(".text-annotation");te&&Py(te,Z.properties.style);const ee={color:N.borderColor||Z.properties.style.borderColor,weight:parseInt(N.borderWidth||Z.properties.style.borderWidth),opacity:N.borderOpacity??Z.properties.style.borderOpacity};"setStyle"in Z&&Z.setStyle(ee)}else if(Z.properties.type==="TextRectangle"){if(Z instanceof yu){console.log("[updateShapeStyle] Processing TextRectangle style update",{incoming:N,currentStyle:Z.properties.style,hasTextStyle:!!Z.properties.style.textStyle,textStyleIncoming:N.textStyle});let ne={};N.textStyle?(console.log("[updateShapeStyle] Using nested textStyle object",N.textStyle),ne={...N.textStyle}):(N.textColor!==void 0&&(ne.color=N.textColor),N.fontSize!==void 0&&(ne.fontSize=N.fontSize,console.log(`[updateShapeStyle] Setting fontSize to ${N.fontSize}`)),N.fontFamily!==void 0&&(ne.fontFamily=N.fontFamily),N.backgroundColor!==void 0&&(ne.backgroundColor=N.backgroundColor),N.backgroundOpacity!==void 0&&(ne.backgroundOpacity=N.backgroundOpacity),N.textAlign!==void 0&&(ne.textAlign=N.textAlign),N.bold!==void 0&&(ne.bold=N.bold),N.italic!==void 0&&(ne.italic=N.italic)),N.fillColor&&(ne.fillColor=N.fillColor),N.fillOpacity!==void 0&&(ne.fillOpacity=N.fillOpacity),N.strokeColor&&(ne.color=N.strokeColor),N.color&&(ne.color=N.color),N.strokeOpacity!==void 0&&(ne.opacity=N.strokeOpacity),N.strokeWidth!==void 0&&(ne.weight=N.strokeWidth),N.weight!==void 0&&(ne.weight=N.weight),N.dashArray&&(ne.dashArray=N.dashArray),console.log("[updateShapeStyle] Final textStyles being applied:",ne),Z.setTextStyle(ne)}}else{const ne={};N.fillColor&&(ne.fillColor=N.fillColor),N.fillOpacity!==void 0&&(ne.fillOpacity=N.fillOpacity),N.strokeColor&&(ne.color=N.strokeColor),N.strokeOpacity!==void 0&&(ne.opacity=N.strokeOpacity),N.strokeWidth!==void 0&&(ne.weight=N.strokeWidth),N.dashArray&&(ne.dashArray=N.dashArray),"setStyle"in Z&&Z.setStyle(ne)}},De=N=>{var he,ne,te,ee;if(!o.value){console.warn("[useMapDrawing] Cannot update properties: no shape selected");return}if(console.log("[useMapDrawing] Updating shape properties",{before:o.value.properties,newProps:N,layerType:(he=o.value.properties)==null?void 0:he.type,beforeName:o.value.name,beforePropertiesName:(ne=o.value.properties)==null?void 0:ne.name,nameIsDirectProperty:"name"in o.value}),o.value.properties&&Object.keys(N).forEach(se=>{o.value.properties[se]=N[se],se==="name"&&(console.log(`[useMapDrawing] Setting name "${N[se]}" directly on layer`),o.value.name=N[se])}),console.log("[useMapDrawing] Updated shape properties",{after:o.value.properties,name:o.value.name,propertiesName:(te=o.value.properties)==null?void 0:te.name,allLayerKeys:Object.keys(o.value),allPropertiesKeys:Object.keys(o.value.properties||{})}),((ee=o.value.properties)==null?void 0:ee.type)==="Circle"){const se=o.value,Pe=se.getRadius();se.properties.radius=Pe,se.properties.diameter=Pe*2,se.properties.surface=Math.PI*Pe*Pe,se.properties.perimeter=2*Math.PI*Pe,N.name&&(console.log(`[useMapDrawing] Ensuring circle name "${N.name}" is set in multiple places`),se.properties.name=N.name,se.properties.style.name=N.name,se.name=N.name,console.log("[useMapDrawing] Circle name verification:",{circleDirectName:se.name,circlePropertiesName:se.properties.name,nameIsEnumerable:Object.keys(se).includes("name"),propertiesNameIsEnumerable:Object.keys(se.properties).includes("name")}))}const Z=new CustomEvent("shape:propertiesUpdated",{detail:{shape:o.value,properties:o.value.properties}});window.dispatchEvent(Z)},Ye=N=>{console.log("[forceShapeUpdate] Début",{currentProperties:N.properties,selectedShapeRef:o.value}),o.value=null,Ds(()=>{o.value=N,console.log("[forceShapeUpdate] Après mise à jour",{selectedShape:o.value,properties:o.value.properties})})},Ve=(N,Z)=>{console.log("[updateLayerProperties] Début",{layer:N,shapeType:Z,currentProperties:N.properties}),o7((ne,te)=>{const ee=$(ne,te);console.log("[updateLayerProperties] Nouvelles propriétés calculées",{newProperties:ee}),ne.properties={...ee},Ye(ne),ne.fire("properties:updated",{shape:ne,properties:ne.properties}),console.log("[updateLayerProperties] Fin",{finalProperties:ne.properties,selectedShape:o.value})},100)(N,Z)},O=(N,Z)=>vt.latLng((N.lat+Z.lat)/2,(N.lng+Z.lng)/2),K=N=>{var Pe;if(!e.value||!n.value)return;b();const Z=N.getLatLng(),he=N.getRadius(),ne=N instanceof eh||((Pe=N.properties)==null?void 0:Pe.type)==="CircleWithSections",te=R(Z,"#059669");E.push(te),x(te,N,()=>[Vr(he,"m","Rayon"),Vr(he*2,"m","Diamètre"),Vr(Math.PI*Math.pow(he,2),"m²","Surface")].join("<br>"));const ee=[],se=[0,45,90,135,180,225,270,315];se.forEach(oe=>{const re=N.calculatePointOnCircle(oe),xe=R(re,"#2563EB");ee.push(xe),E.push(xe),x(xe,N,()=>Vr(he,"m","Rayon")),xe.on("mousedown",ye=>{if(!e.value)return;vt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;ne&&N._clearSections();const Ue=Ce=>{le&&(N.resizeFromControlPoint(Ce.latlng),ee.forEach((qe,Re)=>{const rt=N.calculatePointOnCircle(se[Re]);qe.setLatLng(rt)}),te.setLatLng(N.getLatLng()),xe.measureDiv&&(xe.measureDiv.innerHTML=Vr(N.getRadius(),"m","Rayon")))},Ie=()=>{le=!1,e.value&&(e.value.off("mousemove",Ue),document.removeEventListener("mouseup",Ie),e.value.dragging.enable(),N.updateProperties(),ne&&N._initSections&&setTimeout(()=>{N._initSections()},100),o.value=null,Ds(()=>{o.value=N}),Ve(N,"Circle"))};e.value.on("mousemove",Ue),document.addEventListener("mouseup",Ie)})}),te.on("mousedown",oe=>{if(!e.value)return;vt.DomEvent.stopPropagation(oe),e.value.dragging.disable();let re=!0;const xe=N.getLatLng(),ye=oe.latlng;ne&&N._clearSections();const le=Ie=>{if(!re)return;const Ce=Ie.latlng.lng-ye.lng,qe=Ie.latlng.lat-ye.lat,Re=vt.latLng(xe.lat+qe,xe.lng+Ce);vt.Circle.prototype.setLatLng.call(N,Re),te.setLatLng(Re),ee.forEach((rt,Ze)=>{const gt=N.calculatePointOnCircle(se[Ze]);rt.setLatLng(gt)}),te.measureDiv&&(te.measureDiv.innerHTML=[Vr(N.getRadius(),"m","Rayon"),Vr(N.getRadius()*2,"m","Diamètre"),Vr(Math.PI*Math.pow(N.getRadius(),2),"m²","Surface")].join("<br>"))},Ue=()=>{re=!1,e.value&&(e.value.off("mousemove",le),document.removeEventListener("mouseup",Ue),e.value.dragging.enable(),N.updateProperties(),ne&&N._initSections&&setTimeout(()=>{N._initSections()},100),o.value=null,Ds(()=>{o.value=N}),Ve(N,"Circle"))};e.value.on("mousemove",le),document.addEventListener("mouseup",Ue)}),N.on("circle:resized",()=>{Ve(N,"Circle")}),o.value=N},ce=N=>{var xe;if(!e.value||!n.value)return;if(!(N instanceof $o)){console.warn("La couche n'est pas une instance de Rectangle");return}const Z=N;b();const he=Z.getCenter(),ne=Z.getRotatedCorners(),te=Z.getMidPoints(),ee=R(he,"#059669");E.push(ee),x(ee,Z,()=>{const{width:ye,height:le}=Z.getDimensions(),Ue=ye*le,Ie=Z.getRotation();return[Vr(ye,"m","Largeur"),Vr(le,"m","Hauteur"),Vr(Ue,"m²","Surface"),`Rotation: ${Ie.toFixed(1)}°`].join("<br>")});const se=R(vt.latLng(he.lat+(ne[0].lat-he.lat)*1.2,he.lng+(ne[0].lng-he.lng)*1.2),"#F97316");E.push(se);const Pe=vt.polyline([he,se.getLatLng()],{color:"#F97316",weight:1,opacity:.6,dashArray:"4",pmIgnore:!0});(xe=t.value)==null||xe.addLayer(Pe);const oe=ne.map(ye=>{const le=R(ye,"#DC2626");return E.push(le),x(le,Z,()=>{const{width:Ue,height:Ie}=Z.getDimensions();return[Vr(Ue,"m","Largeur"),Vr(Ie,"m","Hauteur")].join("<br>")}),le}),re=te.map((ye,le)=>{const Ue=R(ye,"#2563EB");return E.push(Ue),x(Ue,Z,()=>{const{width:Ie,height:Ce}=Z.getDimensions(),qe=le%2===0?Ie:Ce;return[Vr(qe,"m","Longueur du côté"),Vr(qe/2,"m","Distance au coin")].join("<br>")}),Ue});ee.on("mousedown",ye=>{if(!e.value)return;vt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;const Ue=Ce=>{if(!le)return;Z.moveFromCenter(Ce.latlng);const qe=Z.getRotatedCorners(),Re=Z.getMidPoints();oe.forEach((Ze,gt)=>Ze.setLatLng(qe[gt])),re.forEach((Ze,gt)=>Ze.setLatLng(Re[gt])),ee.setLatLng(Ce.latlng);const rt=vt.latLng(Ce.latlng.lat+(qe[0].lat-Ce.latlng.lat)*1.2,Ce.latlng.lng+(qe[0].lng-Ce.latlng.lng)*1.2);se.setLatLng(rt),Pe.setLatLngs([Ce.latlng,rt])},Ie=()=>{le=!1,e.value&&(e.value.off("mousemove",Ue),document.removeEventListener("mouseup",Ie),e.value.dragging.enable(),Z.updateProperties(),o.value=null,Ds(()=>{o.value=Z}))};e.value.on("mousemove",Ue),document.addEventListener("mouseup",Ie)}),se.on("mousedown",ye=>{if(!e.value)return;vt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!1;const Ue=ye.latlng,Ie=Z.getRotation(),Ce=Z.getCenter(),qe=Ue.lng-Ce.lng,Re=Ue.lat-Ce.lat,rt=Math.atan2(Re,qe)*180/Math.PI;E.forEach(_t=>{_t!==se&&(_t.setStyle({opacity:0,fillOpacity:0}),_t.measureDiv&&(_t.measureDiv.style.display="none"))});const Ze=Hu(_t=>{le||(le=!0);const $t=_t.latlng.lng-Ce.lng,tn=_t.latlng.lat-Ce.lat;let Yt=Math.atan2(tn,$t)*180/Math.PI-rt,Qt=(Ie+Yt)%360;Qt<0&&(Qt+=360),Z.setRotation(Qt,!1),se.setLatLng(_t.latlng),Pe.setLatLngs([Ce,_t.latlng])},16),gt=()=>{e.value&&(e.value.off("mousemove",Ze),document.removeEventListener("mouseup",gt),e.value.dragging.enable(),le&&Z.finalizeRotation(),o.value=null,Ds(()=>{o.value=Z,b(),ce(Z)}))};e.value.on("mousemove",Ze),document.addEventListener("mouseup",gt)}),Z.on("coordinates:updated",ye=>{const{corners:le,center:Ue}=ye,Ie=Z.getMidPoints();oe.forEach((qe,Re)=>qe.setLatLng(le[Re])),re.forEach((qe,Re)=>qe.setLatLng(Ie[Re])),ee.setLatLng(Ue);const Ce=vt.latLng(Ue.lat+(le[0].lat-Ue.lat)*1.2,Ue.lng+(le[0].lng-Ue.lng)*1.2);se.setLatLng(Ce),Pe.setLatLngs([Ue,Ce])})},H=N=>{if(!e.value||!n.value)return;b();const Z=N.getLatLngs();if(!Z||Z.length===0){console.warn("Pas de points pour la ligne");return}let he=null;if(N instanceof Lo){const ne=N.getCenter();he=R(ne,"#059669"),E.push(he),x(he,N,()=>{const te=N.getLength()||0;return Vr(te,"m","Longueur totale")}),he.on("mousedown",te=>{if(!e.value)return;vt.DomEvent.stopPropagation(te),e.value.dragging.disable();let ee=!0;const se=N.getLatLngs().map(ye=>vt.latLng(ye.lat,ye.lng)),Pe=te.latlng;N instanceof Lo&&(N.off("move:end"),N.off("vertex:moved"),N.off("latlngs:updated"),N.off("properties:updated")),E.forEach((ye,le)=>{le>0&&(ye.setStyle({opacity:0,fillOpacity:0}),ye.measureDiv&&(ye.measureDiv.style.display="none"))});const re=Hu(ye=>{if(!ee)return;const le=ye.latlng.lng-Pe.lng,Ue=ye.latlng.lat-Pe.lat,Ie=se.map(Ce=>vt.latLng(Ce.lat+Ue,Ce.lng+le));vt.Polyline.prototype.setLatLngs.call(N,Ie),he==null||he.setLatLng(ye.latlng)},16),xe=()=>{if(ee=!1,!!e.value){if(e.value.off("mousemove",re),document.removeEventListener("mouseup",xe),e.value.dragging.enable(),N instanceof Lo){const ye=()=>{b(),H(N)};N.on("move:end",ye),N.on("vertex:moved",ye),N.on("latlngs:updated",ye),N.on("properties:updated",ye),N.updateProperties(),Ve(N,"Line")}b(),H(N)}};e.value.on("mousemove",re),document.addEventListener("mouseup",xe)})}if(Z.forEach((ne,te)=>{const ee=R(ne,"#DC2626");E.push(ee),x(ee,N,()=>{if(N instanceof Lo){const se=N.getLength()||0,Pe=N.getLengthToVertex(te);return[Vr(Pe,"m","Distance depuis le début"),Vr(se,"m","Longueur totale")].join("<br>")}return""}),ee.on("mousedown",se=>{if(!e.value)return;vt.DomEvent.stopPropagation(se),e.value.dragging.disable();let Pe=!0;N instanceof Lo&&(N.off("move:end"),N.off("vertex:moved"),N.off("latlngs:updated"),N.off("properties:updated")),E.forEach((xe,ye)=>{ye!==te+1&&(xe.setStyle({opacity:0,fillOpacity:0}),xe.measureDiv&&(xe.measureDiv.style.display="none"))});const oe=Hu(xe=>{if(!Pe)return;const ye=N.getLatLngs();ye[te]=xe.latlng,vt.Polyline.prototype.setLatLngs.call(N,ye),ee.setLatLng(xe.latlng)},16),re=()=>{if(Pe=!1,!!e.value){if(e.value.off("mousemove",oe),document.removeEventListener("mouseup",re),e.value.dragging.enable(),N instanceof Lo){const xe=()=>{b(),H(N)};N.on("move:end",xe),N.on("vertex:moved",xe),N.on("latlngs:updated",xe),N.on("properties:updated",xe),N.updateProperties(),Ve(N,"Line")}b(),H(N)}};e.value.on("mousemove",oe),document.addEventListener("mouseup",re)})}),Z.length>=2)for(let ne=0;ne<Z.length-1;ne++){const te=Z[ne],ee=Z[ne+1],se=vt.latLng((te.lat+ee.lat)/2,(te.lng+ee.lng)/2),Pe=R(se,"#2563EB");E.push(Pe),x(Pe,N,()=>{if(N instanceof Lo){const oe=N.getSegmentLengthAt(ne),re=N.getLength()||0,xe=N.getLengthToVertex(ne)+oe/2;return[Vr(oe,"m","Longueur du segment"),Vr(oe/2,"m","Demi-segment"),Vr(xe,"m","Distance depuis le début"),Vr(re,"m","Longueur totale")].join("<br>")}return""})}if(N instanceof Lo){const ne=()=>{b(),H(N)};N.on("move:start",()=>{E.forEach((te,ee)=>{ee>0&&(te.setStyle({opacity:0,fillOpacity:0}),te.measureDiv&&(te.measureDiv.style.display="none"))})}),N.on("move:end",ne),N.on("vertex:moved",ne),N.on("latlngs:updated",ne),N.on("properties:updated",ne),E.cleanup=()=>{N.off("move:start",()=>{}),N.off("move:end",ne),N.off("vertex:moved",ne),N.off("latlngs:updated",ne),N.off("properties:updated",ne)}}},D=N=>{if(!e.value||!n.value)return;b();const Z=N.getLatLngs()[0],he=Z.map(re=>[re.lng,re.lat]);he.push(he[0]);const ne=Pl([he]),te=pu(ne),ee=Z.reduce((re,xe,ye)=>{const le=Z[(ye+1)%Z.length];return re+xe.distanceTo(le)},0);let se;if(typeof N.getCenter=="function")try{se=N.getCenter()}catch(re){console.warn("Erreur lors de la récupération du centre du polygone via getCenter(), utilisation de la méthode alternative",re);const xe=Df(ne);se=vt.latLng(xe.geometry.coordinates[1],xe.geometry.coordinates[0])}else{const re=Df(ne);se=vt.latLng(re.geometry.coordinates[1],re.geometry.coordinates[0])}const Pe=R(se,"#059669");E.push(Pe),x(Pe,N,()=>[Vr(ee,"m","Périmètre"),Vr(te,"m²","Surface")].join("<br>")),Pe.on("mousedown",re=>{if(!e.value)return;vt.DomEvent.stopPropagation(re),e.value.dragging.disable();let xe=!0;const ye=re.latlng,le=[...Z];E.forEach((qe,Re)=>{Re>0&&qe.setStyle({opacity:0,fillOpacity:0})});const Ue=Hu(qe=>{if(!xe)return;const Re=qe.latlng.lng-ye.lng,rt=qe.latlng.lat-ye.lat,Ze=le.map(gt=>vt.latLng(gt.lat+rt,gt.lng+Re));vt.Polygon.prototype.setLatLngs.call(N,[Ze]),Pe.setLatLng(qe.latlng)},16),Ie=qe=>{xe&&Ue(qe)},Ce=()=>{if(xe=!1,!!e.value){if(e.value.off("mousemove",Ie),document.removeEventListener("mouseup",Ce),e.value.dragging.enable(),N.properties){const qe=N.getLatLngs()[0],Re=qe.map(Ze=>[Ze.lng,Ze.lat]);Re.push(Re[0]);const rt=Pl([Re]);N.properties.area=pu(rt),N.properties.perimeter=qe.reduce((Ze,gt,_t)=>{const $t=qe[(_t+1)%qe.length];return Ze+gt.distanceTo($t)},0),N.properties.surface=N.properties.area}b(),D(N),o.value=null,Ds(()=>{o.value=N})}};e.value.on("mousemove",Ie),document.addEventListener("mouseup",Ce)}),Z.forEach((re,xe)=>{const ye=R(re,"#DC2626");E.push(ye),x(ye,N,()=>{const le=Z[(xe-1+Z.length)%Z.length],Ue=Z[(xe+1)%Z.length],Ie=re.distanceTo(le),Ce=re.distanceTo(Ue);return[Vr(Ie,"m","Distance au point précédent"),Vr(Ce,"m","Distance au point suivant"),Vr(ee,"m","Périmètre total"),Vr(te,"m²","Surface")].join("<br>")}),ye.on("mousedown",le=>{if(vt.DomEvent.stopPropagation(le),!e.value)return;e.value.dragging.disable();let Ue=!0;Pe&&(Pe.setStyle({opacity:0,fillOpacity:0}),Pe.measureDiv&&(Pe.measureDiv.style.display="none"));const Ie=Hu(Re=>{if(!Ue)return;Z[xe]=Re.latlng,vt.Polygon.prototype.setLatLngs.call(N,[Z]),ye.setLatLng(Re.latlng);const rt=E.slice(Z.length+1),Ze=(xe-1+Z.length)%Z.length,gt=rt[Ze];if(gt){const $t=Z[Ze],tn=Z[xe],Qe=vt.latLng(($t.lat+tn.lat)/2,($t.lng+tn.lng)/2);gt.setLatLng(Qe)}const _t=rt[xe];if(_t){const $t=Z[xe],tn=Z[(xe+1)%Z.length],Qe=vt.latLng(($t.lat+tn.lat)/2,($t.lng+tn.lng)/2);_t.setLatLng(Qe)}},16),Ce=Re=>{Ue&&Ie(Re)},qe=()=>{if(Ue=!1,!!e.value){if(e.value.off("mousemove",Ce),document.removeEventListener("mouseup",qe),e.value.dragging.enable(),N.properties){const Re=N.getLatLngs()[0].map(Ze=>[Ze.lng,Ze.lat]);Re.push(Re[0]);const rt=Pl([Re]);N.properties.area=pu(rt),N.properties.perimeter=Z.reduce((Ze,gt,_t)=>{const $t=Z[(_t+1)%Z.length];return Ze+gt.distanceTo($t)},0),N.properties.surface=N.properties.area}b(),D(N),o.value=null,Ds(()=>{o.value=N})}};e.value.on("mousemove",Ce),document.addEventListener("mouseup",qe)})}),(()=>{const re=N.getLatLngs()[0];E.slice(re.length+1).forEach(ye=>{t.value&&t.value.removeLayer(ye)}),E=E.slice(0,re.length+1);const xe=new Array(re.length);for(let ye=0;ye<re.length;ye++){const le=re[ye],Ue=re[(ye+1)%re.length];xe[ye]=O(le,Ue)}xe.forEach((ye,le)=>{const Ue=R(ye,"#2563EB");E.push(Ue),x(Ue,N,()=>{const Ie=re[le],Ce=re[(le+1)%re.length],qe=Ie.distanceTo(Ce);return[Vr(qe,"m","Longueur du segment"),Vr(ee,"m","Périmètre total"),Vr(te,"m²","Surface")].join("<br>")}),Ue.on("mousedown",Ie=>{if(!e.value)return;vt.DomEvent.stopPropagation(Ie),e.value.dragging.disable();let Ce=!0;const qe=le;Pe&&(Pe.setStyle({opacity:0,fillOpacity:0}),Pe.measureDiv&&(Pe.measureDiv.style.display="none"));const Re=[...N.getLatLngs()[0]];Re.splice((qe+1)%Re.length,0,ye),N.setLatLngs([Re]),b(),D(N);const rt=qe+1,Ze=1+rt,gt=rt<E.length-1?E[Ze]:null;if(gt){const _t=tn=>{if(!Ce)return;const Qe=N.getLatLngs()[0];Qe[rt]=tn.latlng,N.setLatLngs([Qe]),gt.setLatLng(tn.latlng);const Yt=E.slice(1+Qe.length),Qt=(rt-1+Qe.length)%Qe.length,Zt=rt;if(Yt[Qt]){const wt=Qe[Qt],He=Qe[rt],Kt=vt.latLng((wt.lat+He.lat)/2,(wt.lng+He.lng)/2);Yt[Qt].setLatLng(Kt)}if(Yt[Zt]){const wt=Qe[rt],He=Qe[(rt+1)%Qe.length],Kt=vt.latLng((wt.lat+He.lat)/2,(wt.lng+He.lng)/2);Yt[Zt].setLatLng(Kt)}},$t=()=>{if(Ce=!1,!!e.value){if(e.value.off("mousemove",_t),document.removeEventListener("mouseup",$t),e.value.dragging.enable(),N.properties){const tn=N.getLatLngs()[0].map(Yt=>[Yt.lng,Yt.lat]);tn.push(tn[0]);const Qe=Pl([tn]);N.properties.area=pu(Qe),N.properties.perimeter=N.getLatLngs()[0].reduce((Yt,Qt,Zt,wt)=>{const He=wt[(Zt+1)%wt.length];return Yt+Qt.distanceTo(He)},0)}b(),D(N),o.value=null,Ds(()=>{o.value=N})}};e.value.on("mousemove",_t),document.addEventListener("mouseup",$t)}else e.value.dragging.enable(),b(),D(N)})})})()},V=N=>{if(!e.value||!n.value)return;b();const Z=N.getCenter(),he=N.getStartAngle(),ne=N.getStopAngle(),te=N.getOpeningAngle(),ee=N.calculatePointOnArc(he),se=N.calculatePointOnArc(ne),Pe=R(ee,"#DC2626"),oe=R(se,"#DC2626");E.push(Pe,oe);const re=R(Z,"#059669");E.push(re);let xe=null;if(te>5){const ye=N.calculateMidpointPosition();xe=R(ye,"#2563EB"),E.push(xe),xe.on("mousedown",le=>{if(!e.value||!xe)return;vt.DomEvent.stopPropagation(le),e.value.dragging.disable();let Ue=!0;const Ie=qe=>{if(!Ue||!xe)return;const Re=Z.distanceTo(qe.latlng);N.setRadius(Re);const rt=N.calculatePointOnArc(he),Ze=N.calculatePointOnArc(ne),gt=N.calculateMidpointPosition();Pe.setLatLng(rt),oe.setLatLng(Ze),xe.setLatLng(gt),N.updateProperties();const _t=xe;_t!=null&&_t.measureDiv&&(_t.measureDiv.innerHTML=Vr(Re,"m","Rayon"))},Ce=()=>{Ue=!1,e.value&&(e.value.off("mousemove",Ie),document.removeEventListener("mouseup",Ce),e.value.dragging.enable(),N.updateProperties(),o.value=null,Ds(()=>{o.value=N}),Ve(N,"Semicircle"))};e.value.on("mousemove",Ie),document.addEventListener("mouseup",Ce)})}[Pe,oe].forEach((ye,le)=>{ye.on("mousedown",Ue=>{if(!e.value)return;vt.DomEvent.stopPropagation(Ue),e.value.dragging.disable();let Ie=!0;const Ce=Re=>{if(!Ie||!e.value)return;const rt=Re.latlng.lng-Z.lng,Ze=Re.latlng.lat-Z.lat,gt=N.getRadius(),_t=Math.sqrt(rt*rt+Ze*Ze),$t=gt/(_t*111319.9*Math.cos(Z.lat*Math.PI/180)),tn=Z.lng+rt*$t,Qe=Z.lat+Ze*$t,Yt=(Math.atan2(Qe-Z.lat,tn-Z.lng)*180/Math.PI+360)%360;le===0?N.setAngles(Yt,N.getStopAngle()):N.setAngles(N.getStartAngle(),Yt);const Qt=N.getStartAngle(),Zt=N.getStopAngle(),wt=N.getOpeningAngle(),He=N.calculatePointOnArc(Qt),Kt=N.calculatePointOnArc(Zt);if(Pe.setLatLng(He),oe.setLatLng(Kt),xe&&wt>5){const on=N.calculateMidpointPosition();xe.setLatLng(on),xe.setStyle({opacity:1,fillOpacity:1})}else xe&&xe.setStyle({opacity:0,fillOpacity:0});N.updateProperties(),o.value=N},qe=()=>{Ie=!1,e.value&&(e.value.off("mousemove",Ce),document.removeEventListener("mouseup",qe),e.value.dragging.enable(),N.updateProperties(),o.value=null,Ds(()=>{o.value=N}),Ve(N,"Semicircle"),V(N))};e.value.on("mousemove",Ce),document.addEventListener("mouseup",qe)})}),re.on("mousedown",ye=>{if(!e.value)return;vt.DomEvent.stopPropagation(ye),e.value.dragging.disable();let le=!0;const Ue=Ce=>{if(!le)return;N.setCenter(Ce.latlng),re.setLatLng(Ce.latlng);const qe=N.getStartAngle(),Re=N.getStopAngle(),rt=N.getOpeningAngle(),Ze=N.calculatePointOnArc(qe),gt=N.calculatePointOnArc(Re);if(Pe.setLatLng(Ze),oe.setLatLng(gt),xe&&rt>5){const _t=N.calculateMidpointPosition();xe.setLatLng(_t),xe.setStyle({opacity:1,fillOpacity:1})}else xe&&xe.setStyle({opacity:0,fillOpacity:0});N.updateProperties(),o.value=N},Ie=()=>{le=!1,e.value&&(e.value.off("mousemove",Ue),document.removeEventListener("mouseup",Ie),e.value.dragging.enable(),N.updateProperties(),o.value=null,Ds(()=>{o.value=N}),Ve(N,"Semicircle"))};e.value.on("mousemove",Ue),document.addEventListener("mouseup",Ie)})},z=N=>{var Z;if(!(!e.value||!r.value)){console.log("[generateTempControlPoints] Génération des points temporaires pour",{layerType:N.constructor.name,properties:N.properties}),r.value.clearLayers();try{if(N instanceof yu){const he=(Z=N.getBounds)==null?void 0:Z.call(N).getCenter();if(he){const ne=vt.circleMarker(he,{radius:0,className:"text-hint-marker",pmIgnore:!0});r.value.addLayer(ne)}}else if(N instanceof $o)N.generateHelperPoints(e.value);else if(N instanceof Zc||N instanceof wu||N instanceof eh){if("getLatLng"in N&&typeof N.getLatLng=="function"){const he=N.getLatLng();if(he){const ne=vt.circleMarker(he,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ne)}}}else if(N instanceof zh||N instanceof vt.Polygon){let he=[];if("getLatLngs"in N){const te=N.getLatLngs();if(Array.isArray(te)&&te.length>0){const ee=te[0];Array.isArray(ee)?he=ee:ee instanceof vt.LatLng&&(he=te)}}let ne=null;if(N instanceof zh&&typeof N.getCenter=="function")ne=N.getCenter();else if(he.length>0){const te=he.map(Pe=>[Pe.lng,Pe.lat]);te.push(te[0]);const ee=Pl([te]),se=Df(ee);ne=vt.latLng(se.geometry.coordinates[1],se.geometry.coordinates[0])}if(ne){const te=vt.circleMarker(ne,{radius:5,color:"#059669",fillColor:"#059669",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(te)}he.forEach(te=>{if(te){const ee=vt.circleMarker(te,{radius:5,color:"#DC2626",fillColor:"#DC2626",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(ee)}});for(let te=0;te<he.length;te++){const ee=he[te],se=he[(te+1)%he.length];if(ee&&se){const Pe=vt.latLng((ee.lat+se.lat)/2,(ee.lng+se.lng)/2),oe=vt.circleMarker(Pe,{radius:5,color:"#2563EB",fillColor:"#2563EB",fillOpacity:.7,weight:2,className:"temp-control-point",pmIgnore:!0});r.value.addLayer(oe)}}}console.log("[generateTempControlPoints] Points temporaires générés",{count:r.value.getLayers().length})}catch(he){console.error("[generateTempControlPoints] Erreur lors de la génération des points temporaires:",he)}}},U=N=>{if(!e.value||!n.value||!N.getBounds)return;const Z=N;b(),Z.on("edit:start",()=>{b()}),Z.on("edit:end",()=>{U(Z)});const he=Z.getBounds(),ne=he.getCenter(),te=Z.properties.rotation||0,ee=le=>{if(te===0)return le;const Ue=te*Math.PI/180,Ie=Math.cos(Ue),Ce=Math.sin(Ue),qe=le.lng-ne.lng,Re=le.lat-ne.lat,rt=qe*Ie-Re*Ce,Ze=qe*Ce+Re*Ie;return vt.latLng(ne.lat+Ze,ne.lng+rt)},se=[he.getNorthWest(),he.getNorthEast(),he.getSouthEast(),he.getSouthWest()].map(le=>ee(le)),Pe=Z.getMidPoints().map(le=>ee(le)),oe=R(ne,"#059669");oe.addTo(e.value),E.push(oe),x(oe,Z,()=>{const{width:le,height:Ue}=Z.getDimensions(),Ie=le*Ue;return[Vr(le,"m","Largeur"),Vr(Ue,"m","Hauteur"),Vr(Ie,"m²","Surface"),`Rotation: ${te.toFixed(1)}°`].join("<br>")});const re=se.map((le,Ue)=>{const Ie=R(le,"#DC2626");return Ie.addTo(e.value),E.push(Ie),x(Ie,Z,()=>{const{width:Ce,height:qe}=Z.getDimensions();return[Vr(Ce,"m","Largeur"),Vr(qe,"m","Hauteur")].join("<br>")}),Ie.on("mousedown",Ce=>{if(!e.value)return;vt.DomEvent.stopPropagation(Ce),e.value.dragging.disable();const qe=(Ue+2)%4,Re=se[qe];Z.startResize();const rt=Hu(_t=>{const $t=vt.latLngBounds(Re,_t.latlng);Z.updateResizePreview($t)},16),Ze=_t=>rt(_t),gt=()=>{if(!e.value)return;e.value.off("mousemove",Ze),document.removeEventListener("mouseup",gt),e.value.dragging.enable();const _t=vt.latLngBounds(Re,Ie.getLatLng());Z.endResize(_t),o.value=null,Ds(()=>{o.value=Z})};e.value.on("mousemove",Ze),document.addEventListener("mouseup",gt)}),Ie}),xe=Pe.map((le,Ue)=>{const Ie=R(le,"#2563EB");return Ie.addTo(e.value),E.push(Ie),x(Ie,Z,()=>{const{width:Ce,height:qe}=Z.getDimensions(),Re=Ue%2===0?Ce:qe;return[Vr(Re,"m","Longueur du côté"),Vr(Re/2,"m","Distance au coin"),`Rotation: ${te.toFixed(1)}°`].join("<br>")}),Ie.on("mousedown",Ce=>{if(!e.value)return;vt.DomEvent.stopPropagation(Ce),e.value.dragging.disable(),Z.startResize();const qe=Hu(Ze=>{const gt=Z.getBounds();let _t;switch(Ue){case 0:_t=vt.latLngBounds(vt.latLng(Ze.latlng.lat,gt.getWest()),vt.latLng(gt.getSouth(),gt.getEast()));break;case 1:_t=vt.latLngBounds(vt.latLng(gt.getNorth(),gt.getWest()),vt.latLng(gt.getSouth(),Ze.latlng.lng));break;case 2:_t=vt.latLngBounds(vt.latLng(gt.getNorth(),gt.getWest()),vt.latLng(Ze.latlng.lat,gt.getEast()));break;case 3:_t=vt.latLngBounds(vt.latLng(gt.getNorth(),Ze.latlng.lng),vt.latLng(gt.getSouth(),gt.getEast()));break;default:return}Z.updateResizePreview(_t)},16),Re=Ze=>qe(Ze),rt=()=>{if(!e.value)return;e.value.off("mousemove",Re),document.removeEventListener("mouseup",rt),e.value.dragging.enable();const Ze=Z.getBounds();let gt;switch(Ue){case 0:gt=vt.latLngBounds(vt.latLng(Ie.getLatLng().lat,Ze.getWest()),vt.latLng(Ze.getSouth(),Ze.getEast()));break;case 1:gt=vt.latLngBounds(vt.latLng(Ze.getNorth(),Ze.getWest()),vt.latLng(Ze.getSouth(),Ie.getLatLng().lng));break;case 2:gt=vt.latLngBounds(vt.latLng(Ze.getNorth(),Ze.getWest()),vt.latLng(Ie.getLatLng().lat,Ze.getEast()));break;case 3:gt=vt.latLngBounds(vt.latLng(Ze.getNorth(),Ie.getLatLng().lng),vt.latLng(Ze.getSouth(),Ze.getEast()));break;default:return}Z.endResize(gt),o.value=null,Ds(()=>{o.value=Z})};e.value.on("mousemove",Re),document.addEventListener("mouseup",rt)}),Ie});oe.on("mousedown",le=>{if(!e.value)return;vt.DomEvent.stopPropagation(le),e.value.dragging.disable();const Ue=Z.getBounds().getCenter(),Ie=le.latlng;Z.startResize();const Ce=Hu(rt=>{const Ze=rt.latlng.lng-Ie.lng,gt=rt.latlng.lat-Ie.lat,_t=vt.latLng(Ue.lat+gt,Ue.lng+Ze),$t=Z.getBounds(),tn=$t.getEast()-$t.getWest(),Qe=$t.getNorth()-$t.getSouth(),Yt=vt.latLngBounds(vt.latLng(_t.lat-Qe/2,_t.lng-tn/2),vt.latLng(_t.lat+Qe/2,_t.lng+tn/2));Z.updateResizePreview(Yt)},16),qe=rt=>Ce(rt),Re=()=>{if(!e.value)return;e.value.off("mousemove",qe),document.removeEventListener("mouseup",Re),e.value.dragging.enable();const rt=Z.getBounds(),Ze=rt.getEast()-rt.getWest(),gt=rt.getNorth()-rt.getSouth(),_t=oe.getLatLng(),$t=vt.latLngBounds(vt.latLng(_t.lat-gt/2,_t.lng-Ze/2),vt.latLng(_t.lat+gt/2,_t.lng+Ze/2));Z.endResize($t),o.value=null,Ds(()=>{o.value=Z})};e.value.on("mousemove",qe),document.addEventListener("mouseup",Re)}),Z.on("resize:update",le=>{const Ue=le.bounds,Ie=Ue.getCenter(),Ce=[Ue.getNorthWest(),Ue.getNorthEast(),Ue.getSouthEast(),Ue.getSouthWest()].map(Re=>ee(Re));re.forEach((Re,rt)=>{Re.setLatLng(Ce[rt])}),oe.setLatLng(Ie);const qe=[vt.latLng((Ce[0].lat+Ce[1].lat)/2,(Ce[0].lng+Ce[1].lng)/2),vt.latLng((Ce[1].lat+Ce[2].lat)/2,(Ce[1].lng+Ce[2].lng)/2),vt.latLng((Ce[2].lat+Ce[3].lat)/2,(Ce[2].lng+Ce[3].lng)/2),vt.latLng((Ce[3].lat+Ce[0].lat)/2,(Ce[3].lng+Ce[0].lng)/2)].map(Re=>ee(Re));xe.forEach((Re,rt)=>{Re.setLatLng(qe[rt])})});const ye=()=>{Z.off("edit:start"),Z.off("edit:end"),Z.off("resize:update")};E.cleanup=ye},G=N=>{console.log("Nombre total de couches:",N.length);const Z=N.filter(se=>{var re;if(!se)return!1;let Pe=0,oe={width:0,height:0};if(se instanceof vt.Circle){Pe=Math.PI*Math.pow(se.getRadius(),2);const xe=se.getRadius();console.log(`
Forme détectée: Circle`),console.log(`- Surface propre: ${Pe.toFixed(2)} m²`),console.log(`- Rayon: ${xe.toFixed(2)} m`),console.log("- Angle: Cercle complet (360°)")}else if(se instanceof $o||se instanceof vt.Rectangle){const xe=se.getBounds(),ye=xe.getSouthWest(),le=xe.getNorthEast(),Ue=El([[ye.lng,ye.lat],[le.lng,ye.lat]]),Ie=El([[ye.lng,ye.lat],[ye.lng,le.lat]]);oe.width=Vc(Ue,{units:"meters"}),oe.height=Vc(Ie,{units:"meters"}),Pe=oe.width*oe.height,console.log(`
Forme détectée: Rectangle`),console.log(`- Surface propre: ${Pe.toFixed(2)} m²`),console.log(`- Largeur: ${oe.width.toFixed(2)} m`),console.log(`- Hauteur: ${oe.height.toFixed(2)} m`)}else if(((re=se.properties)==null?void 0:re.type)==="Semicircle"){const xe=se.getStartAngle(),ye=se.getStopAngle(),le=(ye-xe+360)%360,Ue=se.getRadius();Pe=Math.PI*Math.pow(Ue,2)*le/360,console.log(`
Forme détectée: Semicircle`),console.log(`- Surface propre: ${Pe.toFixed(2)} m²`),console.log(`- Rayon: ${Ue.toFixed(2)} m`),console.log(`- Angle de début: ${xe.toFixed(2)}°`),console.log(`- Angle de fin: ${ye.toFixed(2)}°`),console.log(`- Angle d'ouverture: ${le.toFixed(2)}°`)}return Pe>0});if(Z.length===0)return 0;const he=new Set,ne=[];for(const se of Z)if(!he.has(se)){const Pe=Ae(Z,se);Pe.length>0&&(ne.push(Pe),Pe.forEach(oe=>he.add(oe)))}console.log(`
Nombre de groupes de formes connectées: ${ne.length}`);const te=ne.map((se,Pe)=>{console.log(`
Calcul pour le groupe ${Pe+1} (${se.length} formes):`);const oe=se.map(Ue=>{var Ie,Ce,qe;try{let Re;if(Ue instanceof vt.Circle){const rt=Ue.getLatLng(),Ze=Ue.getRadius();Re=Rk([rt.lng,rt.lat],Ze/1e3,{units:"kilometers",steps:256});const gt=pu(Re),_t=((Ie=Ue.properties)==null?void 0:Ie.surface)||0;return console.log(`
Conversion Cercle -> GeoJSON`),console.log(`- Rayon: ${Ze.toFixed(2)}m`),console.log(`- Surface propriété: ${_t.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${gt.toFixed(2)}m²`),Re}else if(Ue instanceof $o||Ue instanceof vt.Rectangle){const rt=Ue.getBounds(),Ze=rt.getSouthWest(),gt=rt.getNorthEast(),_t=vt.latLng(gt.lat,Ze.lng),$t=vt.latLng(Ze.lat,gt.lng),tn=[[Ze.lng,Ze.lat],[$t.lng,$t.lat],[gt.lng,gt.lat],[_t.lng,_t.lat],[Ze.lng,Ze.lat]];Re=Pl([tn]);const Qe=pu(Re),Yt=El([[Ze.lng,Ze.lat],[gt.lng,Ze.lat]]),Qt=El([[Ze.lng,Ze.lat],[Ze.lng,gt.lat]]),Zt=Vc(Yt,{units:"meters"}),wt=Vc(Qt,{units:"meters"}),He=Zt*wt;return console.log(`
Conversion Rectangle -> GeoJSON`),console.log(`- Largeur: ${Zt.toFixed(2)}m`),console.log(`- Hauteur: ${wt.toFixed(2)}m`),console.log(`- Surface théorique: ${He.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${Qe.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(He-Qe).toFixed(2)}m² (${(Math.abs(He-Qe)/He*100).toFixed(2)}%)`),Re}else if(((Ce=Ue.properties)==null?void 0:Ce.type)==="Semicircle"){const rt=Ue.getCenter(),Ze=Ue.getRadius(),gt=Ue.getStartAngle(),_t=Ue.getStopAngle(),$t=[],tn=64;$t.push([rt.lng,rt.lat]);for(let Qt=0;Qt<=tn;Qt++){const wt=(gt+(_t-gt+360)%360*Qt/tn)*Math.PI/180,He=Ze*Math.cos(wt),on=Ze*Math.sin(wt)/111319.9,Bn=He/(111319.9*Math.cos(rt.lat*Math.PI/180));$t.push([rt.lng+Bn,rt.lat+on])}$t.push([rt.lng,rt.lat]),Re=Pl([$t]);const Qe=pu(Re),Yt=((qe=Ue.properties)==null?void 0:qe.surface)||0;return console.log(`
Conversion Semicircle -> GeoJSON`),console.log(`- Rayon: ${Ze.toFixed(2)}m`),console.log(`- Surface propriété: ${Yt.toFixed(2)}m²`),console.log(`- Surface GeoJSON: ${Qe.toFixed(2)}m²`),console.log(`- Différence: ${Math.abs(Yt-Qe).toFixed(2)}m² (${(Math.abs(Yt-Qe)/Yt*100).toFixed(2)}%)`),Re}return null}catch(Re){return console.error("[useMapDrawing] Erreur lors de la conversion en GeoJSON:",Re),null}}).filter(Ue=>Ue!==null);if(oe.length===0)return 0;const re=oe.map(Ue=>{const Ie=pu(Ue);return console.log(`Surface individuelle: ${Ie.toFixed(2)}m²`),Ie});let xe=0;for(let Ue=0;Ue<oe.length;Ue++)for(let Ie=Ue+1;Ie<oe.length;Ie++)try{const Ce=bk([oe[Ue],oe[Ie]]),qe=t8(Ce);if(qe){const Re=pu(qe);xe+=Re,console.log(`Intersection entre formes ${Ue+1} et ${Ie+1}: ${Re.toFixed(2)}m²`)}}catch(Ce){console.error(`Erreur lors du calcul d'intersection entre les formes ${Ue+1} et ${Ie+1}:`,Ce)}const ye=re.reduce((Ue,Ie)=>Ue+Ie,0),le=ye-xe;return console.log(`
Calcul de la surface d'irrigation pour le groupe ${Pe+1}:`),console.log(`- Surface totale (somme): ${ye.toFixed(2)}m²`),console.log(`- Surface d'intersection: ${xe.toFixed(2)}m²`),console.log(`- Surface d'irrigation finale: ${le.toFixed(2)}m²`),le}),ee=Math.max(...te);return console.log(`
Surface d'irrigation maximale parmi les groupes: ${ee.toFixed(2)}m²`),ee},ue=()=>{h.value&&(e.value.removeLayer(h.value),h.value=null)},ie=(N,Z)=>{if(!e.value)return;ue();const he=Z?Ae(N,Z):N;if(h.value||(h.value=vt.layerGroup().addTo(e.value)),he.forEach(ne=>{var ee;const te=(ee=ne.properties)==null?void 0:ee.type;if(te==="Circle"||te==="Semicircle"){const se=ne.getLatLng(),Pe=ne.getRadius(),oe=vt.circle(se,{radius:Pe,fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:vt.canvas({padding:.5})}),re=vt.circle(se,{radius:Pe,fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:vt.canvas({padding:.5})});h.value&&(h.value.addLayer(re),h.value.addLayer(oe))}else if(te==="Rectangle"||te==="Polygon"){const se=ne.getLatLngs(),Pe=vt.polygon(se,{fillColor:"#3B82F6",fillOpacity:.1,stroke:!0,color:"#3B82F6",weight:1,opacity:.8,dashArray:"5, 5",interactive:!1,renderer:vt.canvas({padding:.5})}),oe=vt.polygon(se,{fillColor:"#3B82F6",fillOpacity:.05,stroke:!1,interactive:!1,renderer:vt.canvas({padding:.5})});h.value&&(h.value.addLayer(oe),h.value.addLayer(Pe))}}),Z&&he.length>1&&e.value){const ne=vt.latLngBounds([]);he.forEach(se=>{se.getBounds?ne.extend(se.getBounds()):se.getLatLng&&ne.extend(se.getLatLng())});const te=ne.getCenter(),ee=vt.tooltip({permanent:!0,direction:"center",className:"connected-group-tooltip"}).setContent("<div>Groupe connecté</div>").setLatLng(te);h.value&&h.value.addLayer(vt.marker(te,{opacity:0,interactive:!1}).bindTooltip(ee).openTooltip())}},Ae=(N,Z)=>{if(!Z)return[];const he=new Set,ne=[Z],te=[Z];for(Z._leaflet_id!==void 0&&he.add(Z._leaflet_id);ne.length>0;){const ee=ne.shift();for(const se of N){if(se===ee||he.has(se._leaflet_id))continue;Me(ee,se)&&(te.push(se),ne.push(se),he.add(se._leaflet_id))}}return te},Me=(N,Z)=>{let he=null,ne=null;if(N.getBounds&&typeof N.getBounds=="function")he=N.getBounds();else if(N.getLatLng&&N.getRadius){const te=N.getLatLng(),ee=N.getRadius();he=vt.latLngBounds([te.lat-ee/111e3,te.lng-ee/(111e3*Math.cos(te.lat*Math.PI/180))],[te.lat+ee/111e3,te.lng+ee/(111e3*Math.cos(te.lat*Math.PI/180))])}if(Z.getBounds&&typeof Z.getBounds=="function")ne=Z.getBounds();else if(Z.getLatLng&&Z.getRadius){const te=Z.getLatLng(),ee=Z.getRadius();ne=vt.latLngBounds([te.lat-ee/111e3,te.lng-ee/(111e3*Math.cos(te.lat*Math.PI/180))],[te.lat+ee/111e3,te.lng+ee/(111e3*Math.cos(te.lat*Math.PI/180))])}return!(!he||!ne||!he.intersects(ne))},st=(N,Z)=>{var ne;const he=Ae(N,Z);return he.length===1&&(ne=Z.properties)!=null&&ne.surface?Z.properties.surface:G(he)},X=N=>{var ne,te,ee,se,Pe,oe,re,xe,ye,le,Ue;const Z=N.layer;(ne=n.value)==null||ne.addLayer(Z);let he="unknown";if(Z instanceof vt.Circle?he=i.value==="Semicircle"?"Semicircle":"Circle":Z instanceof vt.Rectangle?he="Rectangle":Z instanceof vt.Polygon?he="Polygon":Z instanceof vt.Polyline&&!(Z instanceof vt.Polygon)&&(he="Line"),Z.properties=$(Z,he),o.value=Z,console.log("[useMapDrawing] Input layer:",{type:he,instanceof:{Circle:Z instanceof vt.Circle,Rectangle:Z instanceof vt.Rectangle,Polygon:Z instanceof vt.Polygon,Polyline:Z instanceof vt.Polyline},options:Z.options,properties:Z.properties}),window.dispatchEvent(new CustomEvent("shape:created",{detail:{shape:Z,type:he,properties:Z.properties}})),Z.on("mouseover",()=>{console.log("[mouseover] Survol de la forme",{type:he,isSelected:o.value===Z}),(!o.value||o.value!==Z)&&z(Z)}),Z.on("mouseout",()=>{var Ie;console.log("[mouseout] Sortie de la forme",{type:he,isSelected:o.value===Z}),(!o.value||o.value!==Z)&&((Ie=r.value)==null||Ie.clearLayers())}),he==="Semicircle"){const Ie=Z.getLatLng(),Ce=Z.getRadius();(te=n.value)==null||te.removeLayer(Z);const qe=new wu(Ie,Ce);qe.properties=$(qe,"Semicircle"),(ee=n.value)==null||ee.addLayer(qe),o.value=qe,V(qe)}else if(he==="Circle"){(se=n.value)==null||se.removeLayer(Z);const Ie=new Zc(Z.getLatLng(),{radius:Z.getRadius(),...Z.options});Ie.properties={...$(Ie,"Circle"),type:"Circle"},Object.defineProperty(Ie,"name",{value:Ie.properties.name,writable:!0,enumerable:!0,configurable:!0}),console.log("[useMapDrawing] Création du cercle personnalisé:",{propertyDescriptor:Object.getOwnPropertyDescriptor(Ie,"name"),directName:Ie.name,propertiesName:Ie.properties.name,nameIsEnumerable:Object.keys(Ie).includes("name"),allProperties:Object.keys(Ie.properties),allKeys:Object.keys(Ie)}),(Pe=n.value)==null||Pe.addLayer(Ie),o.value=Ie,K(Ie)}else if(he==="Rectangle"){(oe=n.value)==null||oe.removeLayer(Z);const Ie=new $o(Z.getBounds(),{...Z.options});Ie.updateProperties(),(re=n.value)==null||re.addLayer(Ie),o.value=Ie,ce(Ie)}else if(Z instanceof vt.Polygon){const Ie=Z.getLatLngs()[0],Ce=new zh([Ie],{...Z.options});Ce.updateProperties(),(xe=n.value)==null||xe.removeLayer(Z),(ye=n.value)==null||ye.addLayer(Ce),o.value=Ce,D(Ce)}else if(Z instanceof Lo)H(Z);else if(Z instanceof vt.Polyline&&!(Z instanceof vt.Polygon)){const Ie=Z.getLatLngs(),Ce=new Lo(Ie,{...Z.options});Ce.updateProperties(),(le=n.value)==null||le.removeLayer(Z),(Ue=n.value)==null||Ue.addLayer(Ce),o.value=Ce,H(Ce)}Uo("Cliquez sur la forme pour afficher les points de contrôle")},Ee=()=>{e.value&&(e.value.off("pm:create"),e.value.on("pm:create",X))};return{map:e,featureGroup:n,controlPointsGroup:t,tempControlPointsGroup:r,currentTool:i,selectedShape:o,isDrawing:l,initMap:I,setDrawingTool:ge,updateShapeStyle:Se,updateShapeProperties:De,updateTextFixedSize:Q,adjustView:W,clearActiveControlPoints:b,calculateTotalCoverageArea:G,showCoverageOverlay:ie,hideCoverageOverlay:ue,calculateConnectedCoverageArea:st,getConnectedShapes:Ae}}function l7(){const{isEnabled:e,startMeasure:n}=Xh(),t=un(null),r=un(""),i=un("Hybride"),o=un(null),l=n("createBaseMaps","useMapState"),h={Hybride:vt.layerGroup([vt.tileLayer("/osm_tiles/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:19,tileSize:256,zoomOffset:0,bounds:vt.latLngBounds(vt.latLng(41.333,-5.566),vt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6}),vt.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:20,tileSize:256,zoomOffset:0,bounds:vt.latLngBounds(vt.latLng(41.333,-5.566),vt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0,opacity:.6})]),Cadastre:vt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=CADASTRALPARCELS.PARCELLAIRE_EXPRESS&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Cadastre - Carte © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:vt.latLngBounds(vt.latLng(41.333,-5.566),vt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0}),IGN:vt.tileLayer("https://data.geopf.fr/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&STYLE=normal&FORMAT=image/png&TILEMATRIXSET=PM&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:"Carte IGN © IGN/Geoportail",maxZoom:19,updateWhenZooming:!1,updateWhenIdle:!0,noWrap:!0,keepBuffer:4,maxNativeZoom:18,tileSize:256,zoomOffset:0,bounds:vt.latLngBounds(vt.latLng(41.333,-5.566),vt.latLng(51.089,9.555)),crossOrigin:!0,detectRetina:!0})};l();const g=St.createPerformanceTracker(E=>{St.measure("initMap:setOptions",()=>{t.value=E,E.options.zoomSnap=.25,E.options.zoomDelta=.25,E.options.wheelPxPerZoomLevel=100,E.options.zoomAnimation=!0,E.options.fadeAnimation=!0,E.options.markerZoomAnimation=!0,E.options.minZoom=2,E.options.maxZoom=19,E.options.scrollWheelZoom=!0,E.options.doubleClickZoom=!0;const b=vt.latLngBounds(vt.latLng(-90,-180),vt.latLng(90,180));E.setMaxBounds(b),E.options.maxBoundsViscosity=1,E.options.trackResize=!0;let R=null,$=E.getZoom();E.on("zoomstart",()=>{R&&clearTimeout(R),E.options.zoomAnimation=!1,E.options.markerZoomAnimation=!1,$=E.getZoom()}),E.on("zoom",()=>{const I=E.getZoom();I<$-2&&E.invalidateSize({animate:!1,pan:!1}),$=I}),E.on("zoomend",()=>{R&&clearTimeout(R),R=setTimeout(()=>{setTimeout(()=>{E.options.zoomAnimation=!0,E.options.markerZoomAnimation=!0,E.invalidateSize({animate:!1,pan:!1});const I=E.getBounds(),W=E.options.maxBounds;W&&!I.intersects(W)&&E.panInsideBounds(W,{animate:!1})},250)},250)});const Q=E._zoomAnimation;Q&&(E._zoomAnimation=function(I){try{this._animatingZoom||Q.call(this,I)}catch{console.warn("Animation de zoom interrompue, restauration de la vue..."),this._resetView(this.getCenter(),this.getZoom())}})},"useMapState"),St.measure("initMap:addInitialLayer",()=>{E&&E.whenReady(()=>{h[i.value]&&(o.value=h[i.value],o.value.addTo(E))})},"useMapState"),E.on("baselayerchange",b=>{const R=n("baselayerchange","useMapState",{layer:b.name});i.value=b.name,o.value=b.layer,R()}),e.value&&(E.on("movestart",()=>{n("mapMove","useMapState",{startCenter:E.getCenter()})}),E.on("moveend",()=>{n("mapMoveEnd","useMapState",{endCenter:E.getCenter()})()}),E.on("tileloadstart",()=>{n("tileLoad","useMapState")}),E.on("tileload",()=>{n("tileLoadEnd","useMapState")()}))},"initMap","useMapState"),v=St.createAsyncPerformanceTracker(async E=>{if(!(!t.value||!h[E]))try{if(i.value===E)return;const b=t.value,R={zoomAnimation:b.options.zoomAnimation,fadeAnimation:b.options.fadeAnimation,markerZoomAnimation:b.options.markerZoomAnimation};b.options.zoomAnimation=!1,b.options.fadeAnimation=!1,b.options.markerZoomAnimation=!1;const $=b.getCenter(),Q=b.getZoom(),I=h[E];if(I instanceof vt.LayerGroup?I.eachLayer(W=>{W.setOpacity&&W.setOpacity(0)}):I.setOpacity&&I.setOpacity(0),b&&typeof b.addLayer=="function")try{b.addLayer(I)}catch(W){console.warn("Erreur lors de l'ajout de la couche:",W),typeof I.addTo=="function"&&I.addTo(b)}await new Promise(W=>{if(I instanceof vt.LayerGroup){const ge=I.getLayers();Promise.all(ge.map(Se=>new Promise(De=>{Se.isLoading&&Se.isLoading()?Se.once("load",()=>De()):De()}))).then(()=>W())}else I.isLoading&&I.isLoading()?I.once("load",()=>W()):setTimeout(W,100)}),await new Promise(W=>{let ge=0;const Se=setInterval(()=>{var De;if(ge+=.1,o.value instanceof vt.LayerGroup)o.value.eachLayer(Ye=>{const Ve=Ye.options&&typeof Ye.options.opacity=="number"?Ye.options.opacity:1;Ye.setOpacity(Math.max(0,Ve*(1-ge)))});else if((De=o.value)!=null&&De.setOpacity){const Ye=o.value.options&&typeof o.value.options.opacity=="number"?o.value.options.opacity:1;o.value.setOpacity(Math.max(0,Ye*(1-ge)))}if(I instanceof vt.LayerGroup)I.eachLayer(Ye=>{const Ve=Ye.options&&typeof Ye.options.opacity=="number"?Ye.options.opacity:1;Ye.setOpacity(Math.min(Ve,Ve*ge))});else if(I.setOpacity){const Ye=I.options&&typeof I.options.opacity=="number"?I.options.opacity:1;I.setOpacity(Math.min(Ye,Ye*ge))}if(ge>=1){if(clearInterval(Se),o.value&&b&&typeof b.removeLayer=="function")try{b.removeLayer(o.value)}catch(Ye){console.warn("Erreur lors de la suppression de la couche active:",Ye)}o.value=I,i.value=E,W()}},50)});try{b.setView($,Q,{animate:!1,duration:0,noMoveStart:!0})}catch(W){console.warn("Erreur lors de la réinitialisation de la vue:",W)}try{b.invalidateSize({animate:!1,pan:!1})}catch(W){console.warn("Erreur lors de l'invalidation de la taille:",W)}await new Promise(W=>setTimeout(W,300)),E!=="Cadastre"&&setTimeout(()=>{try{b.options.fadeAnimation=R.fadeAnimation,setTimeout(()=>{try{b.options.zoomAnimation=R.zoomAnimation,b.options.markerZoomAnimation=R.markerZoomAnimation}catch(W){console.warn("Erreur lors de la restauration des animations:",W)}},500)}catch(W){console.warn("Erreur lors de la restauration des animations:",W)}},500)}catch(b){if(console.error("Erreur lors du changement de carte de base:",b),t.value)try{const R=t.value;R.options.zoomAnimation=!0,R.options.fadeAnimation=!0,R.options.markerZoomAnimation=!0,R.invalidateSize({animate:!1,pan:!1})}catch(R){console.error("Erreur lors de la restauration après échec:",R)}}},"changeBaseMap","useMapState"),_=St.createAsyncPerformanceTracker(async()=>{if(!(!t.value||!r.value))try{const E=await St.measureAsync("searchLocation:fetchData",async()=>await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r.value)}`),"useMapState"),b=await St.measureAsync("searchLocation:parseResponse",async()=>await E.json(),"useMapState");b&&b.length>0&&St.measure("searchLocation:updateView",()=>{const{lat:R,lon:$}=b[0];t.value.setView([R,$],13,{animate:i.value!=="Cadastre"})},"useMapState")}catch(E){console.error("Erreur lors de la recherche de localisation:",E)}},"searchLocation","useMapState");return{map:t,searchQuery:r,currentBaseMap:i,baseMaps:h,initMap:g,searchLocation:_,changeBaseMap:v,cleanup:()=>{const E=n("cleanup","useMapState");t.value&&(t.value.remove(),t.value=null),o.value&&(o.value=null),E()},isPerformanceEnabled:e}}const Lm=Np("irrigation",{state:()=>({plans:[],currentPlan:null,loading:!1,error:null,autoSaveInterval:null,unsavedChanges:!1,planHistory:[],performanceMonitor:Xh()}),getters:{getPlanById:e=>n=>e.plans.find(t=>t.id===n),hasUnsavedChanges:e=>e.unsavedChanges,getCurrentPlanHistory:e=>e.planHistory},actions:{async fetchPlans(){var t,r;const e=this.performanceMonitor.startMeasure("fetchPlans","IrrigationStore"),n=Ga();this.loading=!0;try{let i="/plans/";const o={};n.isSalarie?o.salarie=(t=n.user)==null?void 0:t.id:n.isVisiteur&&(o.visiteur=(r=n.user)==null?void 0:r.id);const l=await this.performanceMonitor.measureAsync("fetchPlans_apiCall",()=>Xn.get(i,{params:o}),"IrrigationStore");this.plans=l.data}catch(i){throw this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchPlansWithDetails(){var t,r;const e=this.performanceMonitor.startMeasure("fetchPlansWithDetails","IrrigationStore"),n=Ga();this.loading=!0;try{let i="/plans/";const o={include_details:!0};n.isSalarie?o.salarie=(t=n.user)==null?void 0:t.id:n.isVisiteur&&(o.visiteur=(r=n.user)==null?void 0:r.id);const l=await this.performanceMonitor.measureAsync("fetchPlansWithDetails_apiCall",()=>Xn.get(i,{params:o}),"IrrigationStore"),h=this.performanceMonitor.measure("fetchPlansWithDetails_processResponse",()=>l.data.map(g=>({...g,entreprise:typeof g.entreprise=="object"?g.entreprise:null,salarie:typeof g.salarie=="object"?g.salarie:null,visiteur:typeof g.visiteur=="object"?g.visiteur:null})),"IrrigationStore");return this.plans=h,{data:h}}catch(i){throw console.error("[IrrigationStore] Error fetching plans:",i),this.error="Erreur lors du chargement des plans",i}finally{this.loading=!1,e()}},async fetchClientPlans(e){this.loading=!0;try{return(await Ed.getVisiteurPlans(e)).data}catch(n){throw this.error="Erreur lors du chargement des plans du client",n}finally{this.loading=!1}},async createPlan(e){var r;const n=this.performanceMonitor.startMeasure("createPlan","IrrigationStore");this.clearCurrentPlan(),this.loading=!0;const t=Rf();try{const i=Ga();((r=i.user)==null?void 0:r.user_type)==="visiteur"&&(e={...e,visiteur:i.user.id,salarie:i.user.salarie,entreprise:i.user.entreprise});const o=this.performanceMonitor.measure("createPlan_formatData",()=>({...e,entreprise:e.entreprise?typeof e.entreprise=="object"&&e.entreprise&&"id"in e.entreprise?e.entreprise.id:Number(e.entreprise):null,salarie:e.salarie?typeof e.salarie=="object"&&e.salarie&&"id"in e.salarie?e.salarie.id:Number(e.salarie):null,visiteur:e.visiteur?typeof e.visiteur=="object"&&e.visiteur&&"id"in e.visiteur?e.visiteur.id:Number(e.visiteur):null}),"IrrigationStore"),l=await this.performanceMonitor.measureAsync("createPlan_apiCall",()=>Ed.createPlan(o),"IrrigationStore");return this.plans.push(l.data),t.success(`Le plan "${l.data.nom}" a été créé avec succès`),l.data}catch(i){const o=i instanceof Error?i.message:String(i);throw console.error("Error creating plan:",o),this.error=o,t.error(`Erreur lors de la création du plan : ${o}`),i}finally{this.loading=!1,n()}},async createPlanForClient(e,n){this.clearCurrentPlan(),this.loading=!0;try{const t={...e,visiteur:n},r=await Ed.createPlanForVisiteur(t);return this.plans.push(r.data),r.data}catch(t){const r=t instanceof Error?t.message:String(t);throw console.error("Error creating plan for client:",r),this.error="Erreur lors de la création du plan pour le client",t}finally{this.loading=!1}},startAutoSave(){this.autoSaveInterval||(this.autoSaveInterval=setInterval(async()=>{this.unsavedChanges&&this.currentPlan&&await this.savePlan(this.currentPlan.id)},3e4))},stopAutoSave(){this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},async savePlan(e){const n=this.performanceMonitor.startMeasure("savePlan","IrrigationStore");if(!this.unsavedChanges){console.log("[IrrigationStore][savePlan] Aucun changement à sauvegarder"),n();return}this.loading=!0;try{const t=await this.performanceMonitor.measureAsync("savePlan_apiCall",()=>{var r;return Xn.patch(`/plans/${e}/`,{...this.currentPlan,version:((r=this.currentPlan)==null?void 0:r.version)||1})},"IrrigationStore");return this.performanceMonitor.measure("savePlan_updateState",()=>{var i;const r=this.plans.findIndex(o=>o.id===e);r!==-1&&(this.plans[r]=t.data),((i=this.currentPlan)==null?void 0:i.id)===e&&(this.currentPlan=t.data)},"IrrigationStore"),this.unsavedChanges=!1,t.data}catch(t){throw console.error("[IrrigationStore][savePlan] ERREUR:",t),this.error="Erreur lors de la sauvegarde du plan",t}finally{this.loading=!1,n()}},async updatePlanDetails(e,n){const t=this.performanceMonitor.startMeasure("updatePlanDetails","IrrigationStore"),r=Rf();try{const i=await this.performanceMonitor.measureAsync("updatePlanDetails_apiCall",()=>{const{visiteur_id:o,salarie_id:l,entreprise_id:h,...g}=n,v={...g};return o!==void 0&&(v.visiteur_id=o),l!==void 0&&(v.salarie_id=l),h!==void 0&&(v.entreprise_id=h),Xn.patch(`/plans/${e}/`,v)},"IrrigationStore");return this.performanceMonitor.measure("updatePlanDetails_updateState",()=>{this.currentPlan&&this.currentPlan.id===e&&(this.currentPlan={...this.currentPlan,...i.data});const o=this.plans.findIndex(l=>l.id===e);o!==-1&&(this.plans[o]={...this.plans[o],...i.data})},"IrrigationStore"),i.data}catch(i){throw console.error("Erreur lors de la mise à jour du plan:",i),r.error(`Erreur lors de la mise à jour du plan : ${i instanceof Error?i.message:String(i)}`),i}finally{t()}},async fetchPlanHistory(e){this.loading=!0;try{const n=await Xn.get(`/plans/${e}/historique/`);return this.planHistory=n.data,n.data}catch(n){throw this.error="Erreur lors de la récupération de l'historique",n}finally{this.loading=!1}},async restorePlanVersion(e,n){var t;this.loading=!0;try{const r=await Xn.post(`/plans/${e}/restaurer/`,{version_id:n});((t=this.currentPlan)==null?void 0:t.id)===e&&(this.currentPlan=r.data);const i=this.plans.findIndex(o=>o.id===e);return i!==-1&&(this.plans[i]=r.data),r.data}catch(r){throw this.error="Erreur lors de la restauration de la version",r}finally{this.loading=!1}},setCurrentPlan(e){this.currentPlan=e,this.startAutoSave()},clearCurrentPlan(){this.currentPlan=null,this.unsavedChanges=!1,this.autoSaveInterval&&(clearInterval(this.autoSaveInterval),this.autoSaveInterval=null)},markUnsavedChanges(){this.unsavedChanges=!0},async deletePlan(e){var t;this.loading=!0;const n=Rf();try{const r=this.plans.find(i=>i.id===e);await Ed.deletePlan(e),this.plans=this.plans.filter(i=>i.id!==e),((t=this.currentPlan)==null?void 0:t.id)===e&&this.clearCurrentPlan(),n.success(`Le plan "${(r==null?void 0:r.nom)||""}" a été supprimé avec succès`)}catch(r){throw this.error="Erreur lors de la suppression du plan",n.error(`Erreur lors de la suppression du plan : ${r instanceof Error?r.message:String(r)}`),r}finally{this.loading=!1}}}}),u7={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},c7={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},h7={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},f7={key:0,class:"mb-4"},d7={key:0,class:"animate-pulse"},p7=["value"],g7={key:1,class:"mb-4"},m7={key:0,class:"animate-pulse"},v7=["disabled"],y7={value:null},_7=["value"],b7={key:2,class:"mb-4"},w7={key:0,class:"animate-pulse"},x7=["disabled"],L7={value:null},S7=["value"],C7={class:"mb-4"},P7={class:"mb-6"},E7={class:"flex justify-end space-x-3"},A7=["disabled"],M7={key:0},k7={key:1},Lb=Pa({__name:"NewPlanModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","created","salarieSelected","visiteurSelected"],setup(e,{expose:n,emit:t}){function r(V){return V?typeof V=="object"?V.id:V:null}function i(V){if(V===null)throw new Error("Invalid ID");return V}const o=e,l=t,h=Ga(),g=Lm(),v=xb(),_=un(!1),x=un(null),E=un([]),b=un([]),R=un([]),$=un(null),Q=un(null),I=un(!1),W=un(!1),ge=un(!1),Se=un({nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),De=Rr(()=>{var V,z,U;return((V=h.user)==null?void 0:V.user_type)==="admin"?Se.value.nom.trim()&&Se.value.entreprise&&Se.value.salarie&&Se.value.visiteur:((z=h.user)==null?void 0:z.user_type)==="entreprise"?Se.value.nom.trim()&&Se.value.salarie&&Se.value.visiteur:((U=h.user)==null?void 0:U.user_type)==="salarie"?Se.value.nom.trim()&&Se.value.visiteur:Se.value.nom.trim()});Co(()=>Se.value.entreprise,async V=>{if(!o.modelValue)return;Se.value.salarie=null,Se.value.visiteur=null,b.value=[];const z=r(V);console.log("[NewPlanModal] Entreprise sélectionnée:",z),z?await Ye(z):E.value=[]}),Co(()=>Se.value.salarie,async V=>{if(!o.modelValue)return;Se.value.visiteur=null;const z=r(V);z?await Ve(z):b.value=[]}),Co(()=>o.modelValue,V=>{var z,U,G;V?((z=h.user)==null?void 0:z.user_type)==="admin"?H():((U=h.user)==null?void 0:U.user_type)==="entreprise"?Ye(h.user.id):((G=h.user)==null?void 0:G.user_type)==="salarie"&&Ve(h.user.id):(Se.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},$.value=null,Q.value=null,b.value=[],E.value=[],R.value=[],x.value=null)});async function Ye(V){I.value=!0;try{console.log("[NewPlanModal] Chargement des salaries pour entreprise:",V);const z=await $a.getUsers({role:"SALARIE",entreprise:V});console.log("[NewPlanModal] Réponse salaries:",z.data),E.value=z.data}catch(z){console.error("[NewPlanModal] Error loading salaries:",z),E.value=[]}finally{I.value=!1}}async function Ve(V){W.value=!0;try{const z=await $a.getUsers({role:"VISITEUR",salarie:V});b.value=z.data}catch(z){console.error("[NewPlanModal] Error loading visiteurs:",z),b.value=[]}finally{W.value=!1}}async function O(V){o.modelValue&&($.value=V,Se.value.salarie=V.id,await Ve(V.id),l("salarieSelected",V))}function K(V){o.modelValue&&(Q.value=V,Se.value.visiteur=V.id,l("visiteurSelected",V))}function ce(){l("update:modelValue",!1),Se.value={nom:"",description:"",entreprise:null,salarie:null,visiteur:null},$.value=null,Q.value=null,b.value=[],x.value=null}async function H(){ge.value=!0;try{const V=await h.fetchEnterprises();R.value=V}catch(V){console.error("[NewPlanModal] Error loading entreprises:",V),R.value=[]}finally{ge.value=!1}}async function D(){var V,z;x.value=null,_.value=!0;try{const U={nom:Se.value.nom.trim(),description:Se.value.description.trim()},G=h.user;if(!G)throw new Error("User not found");if(G.user_type==="admin"){if(!Se.value.entreprise||!Se.value.salarie||!Se.value.visiteur)throw new Error("Missing required fields");U.entreprise=i(r(Se.value.entreprise)),U.salarie=i(r(Se.value.salarie)),U.visiteur=Se.value.visiteur}else if(G.user_type==="entreprise"){if(!Se.value.salarie||!Se.value.visiteur)throw new Error("Missing required fields");U.entreprise=G.id,U.salarie=i(r(Se.value.salarie)),U.visiteur=Se.value.visiteur}else if(G.user_type==="salarie"){if(!G.entreprise||!Se.value.visiteur)throw new Error("Missing required fields");U.entreprise=G.entreprise.id,U.salarie=G.id,U.visiteur=Se.value.visiteur}else if(G.user_type==="visiteur"){if(!G.entreprise||!G.salarie)throw new Error("Missing required fields");U.entreprise=G.entreprise.id,U.salarie=G.salarie.id,U.visiteur=G.id}console.log("Données du plan à créer:",U),g.clearCurrentPlan(),v.setCurrentPlan(null);const ue=await g.createPlan(U);l("created",ue.id),ce()}catch(U){console.error("[NewPlanModal] Error creating plan:",U),console.error("Response data:",(V=U.response)==null?void 0:V.data);let G="Une erreur est survenue lors de la création du plan";(z=U.response)!=null&&z.data&&(typeof U.response.data=="object"?G=Object.entries(U.response.data).map(([ue,ie])=>Array.isArray(ie)?`${ue}: ${ie.join(", ")}`:`${ue}: ${ie}`).join(`
`):typeof U.response.data=="string"&&(G=U.response.data)),x.value=G}finally{_.value=!1}}return n({salaries:E,visiteurs:b,selectedSalarie:$,selectedVisiteur:Q,loadSalaries:Ye,loadVisiteurs:Ve,selectSalarie:O,selectVisiteur:K}),(V,z)=>{var U,G,ue,ie;return V.modelValue?(Xe(),tt("div",u7,[M("div",c7,[M("div",{class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},[z[6]||(z[6]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Créer un nouveau plan",-1)),M("button",{onClick:ce,class:"text-gray-400 hover:text-gray-500"},z[5]||(z[5]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("div",h7,[Kn(h).isAdmin?(Xe(),tt("div",f7,[z[9]||(z[9]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Entreprise",-1)),ge.value?(Xe(),tt("div",d7,z[7]||(z[7]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Xe(),tt("select",{key:1,"onUpdate:modelValue":z[0]||(z[0]=Ae=>Se.value.entreprise=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},[z[8]||(z[8]=M("option",{value:null},"Sélectionnez une entreprise",-1)),(Xe(!0),tt(Un,null,kr(R.value,Ae=>(Xe(),tt("option",{key:Ae.id,value:Ae.id},Ht(Kn(al)(Ae)),9,p7))),128))],512)),[[Hs,Se.value.entreprise]])])):yn("",!0),((U=Kn(h).user)==null?void 0:U.user_type)==="admin"||((G=Kn(h).user)==null?void 0:G.user_type)==="entreprise"?(Xe(),tt("div",g7,[z[11]||(z[11]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Salarie",-1)),I.value?(Xe(),tt("div",m7,z[10]||(z[10]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Xe(),tt("select",{key:1,id:"edit-salarie","onUpdate:modelValue":z[1]||(z[1]=Ae=>Se.value.salarie=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:Kn(h).isAdmin&&!Se.value.entreprise},[M("option",y7,Ht(E.value.length?"Sélectionnez un salarie":"Aucun salarie disponible"),1),(Xe(!0),tt(Un,null,kr(E.value,Ae=>(Xe(),tt("option",{key:Ae.id,value:Ae.id},Ht(Kn(al)(Ae)),9,_7))),128))],8,v7)),[[Hs,Se.value.salarie]])])):yn("",!0),((ue=Kn(h).user)==null?void 0:ue.user_type)!=="visiteur"?(Xe(),tt("div",b7,[z[13]||(z[13]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Visiteur",-1)),W.value?(Xe(),tt("div",w7,z[12]||(z[12]=[M("div",{class:"h-10 bg-gray-200 rounded"},null,-1)]))):Dn((Xe(),tt("select",{key:1,id:"edit-visiteur","onUpdate:modelValue":z[2]||(z[2]=Ae=>Se.value.visiteur=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!b.value.length||((ie=Kn(h).user)==null?void 0:ie.user_type)!=="salarie"&&!Se.value.salarie},[M("option",L7,Ht(b.value.length?"Sélectionnez un visiteur":"Aucun visiteur disponible"),1),(Xe(!0),tt(Un,null,kr(b.value,Ae=>(Xe(),tt("option",{key:Ae.id,value:Ae.id},Ht(Kn(al)(Ae)),9,S7))),128))],8,x7)),[[Hs,Se.value.visiteur]])])):yn("",!0),M("div",C7,[z[14]||(z[14]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du plan",-1)),Dn(M("input",{id:"edit-nom","onUpdate:modelValue":z[3]||(z[3]=Ae=>Se.value.nom=Ae),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Entrez le nom du plan"},null,512),[[Mr,Se.value.nom]])]),M("div",P7,[z[15]||(z[15]=M("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),Dn(M("textarea",{id:"edit-description","onUpdate:modelValue":z[4]||(z[4]=Ae=>Se.value.description=Ae),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Entrez une description (optionnel)"},null,512),[[Mr,Se.value.description]])]),M("div",E7,[M("button",{onClick:ce,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500"}," Annuler "),M("button",{onClick:D,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",disabled:!De.value||_.value},[_.value?(Xe(),tt("span",M7,"Création en cours...")):(Xe(),tt("span",k7,"Créer"))],8,A7)])])])])):yn("",!0)}}});function Bi(e){"@babel/helpers - typeof";return Bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Bi(e)}var ua=Uint8Array,ul=Uint16Array,Sm=Int32Array,Vp=new ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Gp=new ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fg=new ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sb=function(e,n){for(var t=new ul(31),r=0;r<31;++r)t[r]=n+=1<<e[r-1];for(var i=new Sm(t[30]),r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return{b:t,r:i}},Cb=Sb(Vp,2),Pb=Cb.b,zg=Cb.r;Pb[28]=258,zg[258]=28;var Eb=Sb(Gp,0),T7=Eb.b,Ay=Eb.r,jg=new ul(32768);for(var rs=0;rs<32768;++rs){var cc=(rs&43690)>>1|(rs&21845)<<1;cc=(cc&52428)>>2|(cc&13107)<<2,cc=(cc&61680)>>4|(cc&3855)<<4,jg[rs]=((cc&65280)>>8|(cc&255)<<8)>>1}var Pu=function(e,n,t){for(var r=e.length,i=0,o=new ul(n);i<r;++i)e[i]&&++o[e[i]-1];var l=new ul(n);for(i=1;i<n;++i)l[i]=l[i-1]+o[i-1]<<1;var h;if(t){h=new ul(1<<n);var g=15-n;for(i=0;i<r;++i)if(e[i])for(var v=i<<4|e[i],_=n-e[i],x=l[e[i]-1]++<<_,E=x|(1<<_)-1;x<=E;++x)h[jg[x]>>g]=v}else for(h=new ul(r),i=0;i<r;++i)e[i]&&(h[i]=jg[l[e[i]-1]++]>>15-e[i]);return h},Cc=new ua(288);for(var rs=0;rs<144;++rs)Cc[rs]=8;for(var rs=144;rs<256;++rs)Cc[rs]=9;for(var rs=256;rs<280;++rs)Cc[rs]=7;for(var rs=280;rs<288;++rs)Cc[rs]=8;var Zf=new ua(32);for(var rs=0;rs<32;++rs)Zf[rs]=5;var B7=Pu(Cc,9,0),N7=Pu(Cc,9,1),R7=Pu(Zf,5,0),D7=Pu(Zf,5,1),G0=function(e){for(var n=e[0],t=1;t<e.length;++t)e[t]>n&&(n=e[t]);return n},Hl=function(e,n,t){var r=n/8|0;return(e[r]|e[r+1]<<8)>>(n&7)&t},H0=function(e,n){var t=n/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(n&7)},Cm=function(e){return(e+7)/8|0},Ab=function(e,n,t){return(t==null||t>e.length)&&(t=e.length),new ua(e.subarray(n,t))},O7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zl=function(e,n,t){var r=new Error(n||O7[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Zl),!t)throw r;return r},I7=function(e,n,t,r){var i=e.length,o=0;if(!i||n.f&&!n.l)return t||new ua(0);var l=!t,h=l||n.i!=2,g=n.i;l&&(t=new ua(i*3));var v=function(Pe){var oe=t.length;if(Pe>oe){var re=new ua(Math.max(oe*2,Pe));re.set(t),t=re}},_=n.f||0,x=n.p||0,E=n.b||0,b=n.l,R=n.d,$=n.m,Q=n.n,I=i*8;do{if(!b){_=Hl(e,x,1);var W=Hl(e,x+1,3);if(x+=3,W)if(W==1)b=N7,R=D7,$=9,Q=5;else if(W==2){var Ye=Hl(e,x,31)+257,Ve=Hl(e,x+10,15)+4,O=Ye+Hl(e,x+5,31)+1;x+=14;for(var K=new ua(O),ce=new ua(19),H=0;H<Ve;++H)ce[Fg[H]]=Hl(e,x+H*3,7);x+=Ve*3;for(var D=G0(ce),V=(1<<D)-1,z=Pu(ce,D,1),H=0;H<O;){var U=z[Hl(e,x,V)];x+=U&15;var ge=U>>4;if(ge<16)K[H++]=ge;else{var G=0,ue=0;for(ge==16?(ue=3+Hl(e,x,3),x+=2,G=K[H-1]):ge==17?(ue=3+Hl(e,x,7),x+=3):ge==18&&(ue=11+Hl(e,x,127),x+=7);ue--;)K[H++]=G}}var ie=K.subarray(0,Ye),Ae=K.subarray(Ye);$=G0(ie),Q=G0(Ae),b=Pu(ie,$,1),R=Pu(Ae,Q,1)}else Zl(1);else{var ge=Cm(x)+4,Se=e[ge-4]|e[ge-3]<<8,De=ge+Se;if(De>i){g&&Zl(0);break}h&&v(E+Se),t.set(e.subarray(ge,De),E),n.b=E+=Se,n.p=x=De*8,n.f=_;continue}if(x>I){g&&Zl(0);break}}h&&v(E+131072);for(var Me=(1<<$)-1,st=(1<<Q)-1,X=x;;X=x){var G=b[H0(e,x)&Me],Ee=G>>4;if(x+=G&15,x>I){g&&Zl(0);break}if(G||Zl(2),Ee<256)t[E++]=Ee;else if(Ee==256){X=x,b=null;break}else{var N=Ee-254;if(Ee>264){var H=Ee-257,Z=Vp[H];N=Hl(e,x,(1<<Z)-1)+Pb[H],x+=Z}var he=R[H0(e,x)&st],ne=he>>4;he||Zl(3),x+=he&15;var Ae=T7[ne];if(ne>3){var Z=Gp[ne];Ae+=H0(e,x)&(1<<Z)-1,x+=Z}if(x>I){g&&Zl(0);break}h&&v(E+131072);var te=E+N;if(E<Ae){var ee=o-Ae,se=Math.min(Ae,te);for(ee+E<0&&Zl(3);E<se;++E)t[E]=r[ee+E]}for(;E<te;++E)t[E]=t[E-Ae]}}n.l=b,n.p=X,n.b=E,n.f=_,b&&(_=1,n.m=$,n.d=R,n.n=Q)}while(!_);return E!=t.length&&l?Ab(t,0,E):t.subarray(0,E)},Wu=function(e,n,t){t<<=n&7;var r=n/8|0;e[r]|=t,e[r+1]|=t>>8},mf=function(e,n,t){t<<=n&7;var r=n/8|0;e[r]|=t,e[r+1]|=t>>8,e[r+2]|=t>>16},W0=function(e,n){for(var t=[],r=0;r<e.length;++r)e[r]&&t.push({s:r,f:e[r]});var i=t.length,o=t.slice();if(!i)return{t:kb,l:0};if(i==1){var l=new ua(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(De,Ye){return De.f-Ye.f}),t.push({s:-1,f:25001});var h=t[0],g=t[1],v=0,_=1,x=2;for(t[0]={s:-1,f:h.f+g.f,l:h,r:g};_!=i-1;)h=t[t[v].f<t[x].f?v++:x++],g=t[v!=_&&t[v].f<t[x].f?v++:x++],t[_++]={s:-1,f:h.f+g.f,l:h,r:g};for(var E=o[0].s,r=1;r<i;++r)o[r].s>E&&(E=o[r].s);var b=new ul(E+1),R=Ug(t[_-1],b,0);if(R>n){var r=0,$=0,Q=R-n,I=1<<Q;for(o.sort(function(Ye,Ve){return b[Ve.s]-b[Ye.s]||Ye.f-Ve.f});r<i;++r){var W=o[r].s;if(b[W]>n)$+=I-(1<<R-b[W]),b[W]=n;else break}for($>>=Q;$>0;){var ge=o[r].s;b[ge]<n?$-=1<<n-b[ge]++-1:++r}for(;r>=0&&$;--r){var Se=o[r].s;b[Se]==n&&(--b[Se],++$)}R=n}return{t:new ua(b),l:R}},Ug=function(e,n,t){return e.s==-1?Math.max(Ug(e.l,n,t+1),Ug(e.r,n,t+1)):n[e.s]=t},My=function(e){for(var n=e.length;n&&!e[--n];);for(var t=new ul(++n),r=0,i=e[0],o=1,l=function(g){t[r++]=g},h=1;h<=n;++h)if(e[h]==i&&h!=n)++o;else{if(!i&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(i),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(i);o=1,i=e[h]}return{c:t.subarray(0,r),n}},vf=function(e,n){for(var t=0,r=0;r<n.length;++r)t+=e[r]*n[r];return t},Mb=function(e,n,t){var r=t.length,i=Cm(n+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var o=0;o<r;++o)e[i+o+4]=t[o];return(i+4+r)*8},ky=function(e,n,t,r,i,o,l,h,g,v,_){Wu(n,_++,t),++i[256];for(var x=W0(i,15),E=x.t,b=x.l,R=W0(o,15),$=R.t,Q=R.l,I=My(E),W=I.c,ge=I.n,Se=My($),De=Se.c,Ye=Se.n,Ve=new ul(19),O=0;O<W.length;++O)++Ve[W[O]&31];for(var O=0;O<De.length;++O)++Ve[De[O]&31];for(var K=W0(Ve,7),ce=K.t,H=K.l,D=19;D>4&&!ce[Fg[D-1]];--D);var V=v+5<<3,z=vf(i,Cc)+vf(o,Zf)+l,U=vf(i,E)+vf(o,$)+l+14+3*D+vf(Ve,ce)+2*Ve[16]+3*Ve[17]+7*Ve[18];if(g>=0&&V<=z&&V<=U)return Mb(n,_,e.subarray(g,g+v));var G,ue,ie,Ae;if(Wu(n,_,1+(U<z)),_+=2,U<z){G=Pu(E,b,0),ue=E,ie=Pu($,Q,0),Ae=$;var Me=Pu(ce,H,0);Wu(n,_,ge-257),Wu(n,_+5,Ye-1),Wu(n,_+10,D-4),_+=14;for(var O=0;O<D;++O)Wu(n,_+3*O,ce[Fg[O]]);_+=3*D;for(var st=[W,De],X=0;X<2;++X)for(var Ee=st[X],O=0;O<Ee.length;++O){var N=Ee[O]&31;Wu(n,_,Me[N]),_+=ce[N],N>15&&(Wu(n,_,Ee[O]>>5&127),_+=Ee[O]>>12)}}else G=B7,ue=Cc,ie=R7,Ae=Zf;for(var O=0;O<h;++O){var Z=r[O];if(Z>255){var N=Z>>18&31;mf(n,_,G[N+257]),_+=ue[N+257],N>7&&(Wu(n,_,Z>>23&31),_+=Vp[N]);var he=Z&31;mf(n,_,ie[he]),_+=Ae[he],he>3&&(mf(n,_,Z>>5&8191),_+=Gp[he])}else mf(n,_,G[Z]),_+=ue[Z]}return mf(n,_,G[256]),_+ue[256]},F7=new Sm([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kb=new ua(0),z7=function(e,n,t,r,i,o){var l=o.z||e.length,h=new ua(r+l+5*(1+Math.ceil(l/7e3))+i),g=h.subarray(r,h.length-i),v=o.l,_=(o.r||0)&7;if(n){_&&(g[0]=o.r>>3);for(var x=F7[n-1],E=x>>13,b=x&8191,R=(1<<t)-1,$=o.p||new ul(32768),Q=o.h||new ul(R+1),I=Math.ceil(t/3),W=2*I,ge=function(xe){return(e[xe]^e[xe+1]<<I^e[xe+2]<<W)&R},Se=new Sm(25e3),De=new ul(288),Ye=new ul(32),Ve=0,O=0,K=o.i||0,ce=0,H=o.w||0,D=0;K+2<l;++K){var V=ge(K),z=K&32767,U=Q[V];if($[z]=U,Q[V]=z,H<=K){var G=l-K;if((Ve>7e3||ce>24576)&&(G>423||!v)){_=ky(e,g,0,Se,De,Ye,O,ce,D,K-D,_),ce=Ve=O=0,D=K;for(var ue=0;ue<286;++ue)De[ue]=0;for(var ue=0;ue<30;++ue)Ye[ue]=0}var ie=2,Ae=0,Me=b,st=z-U&32767;if(G>2&&V==ge(K-st))for(var X=Math.min(E,G)-1,Ee=Math.min(32767,K),N=Math.min(258,G);st<=Ee&&--Me&&z!=U;){if(e[K+ie]==e[K+ie-st]){for(var Z=0;Z<N&&e[K+Z]==e[K+Z-st];++Z);if(Z>ie){if(ie=Z,Ae=st,Z>X)break;for(var he=Math.min(st,Z-2),ne=0,ue=0;ue<he;++ue){var te=K-st+ue&32767,ee=$[te],se=te-ee&32767;se>ne&&(ne=se,U=te)}}}z=U,U=$[z],st+=z-U&32767}if(Ae){Se[ce++]=268435456|zg[ie]<<18|Ay[Ae];var Pe=zg[ie]&31,oe=Ay[Ae]&31;O+=Vp[Pe]+Gp[oe],++De[257+Pe],++Ye[oe],H=K+ie,++Ve}else Se[ce++]=e[K],++De[e[K]]}}for(K=Math.max(K,H);K<l;++K)Se[ce++]=e[K],++De[e[K]];_=ky(e,g,v,Se,De,Ye,O,ce,D,K-D,_),v||(o.r=_&7|g[_/8|0]<<3,_-=7,o.h=Q,o.p=$,o.i=K,o.w=H)}else{for(var K=o.w||0;K<l+v;K+=65535){var re=K+65535;re>=l&&(g[_/8|0]=v,re=l),_=Mb(g,_+1,e.subarray(K,re))}o.i=l}return Ab(h,0,r+Cm(_)+i)},Tb=function(){var e=1,n=0;return{p:function(t){for(var r=e,i=n,o=t.length|0,l=0;l!=o;){for(var h=Math.min(l+2655,o);l<h;++l)i+=r+=t[l];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}e=r,n=i},d:function(){return e%=65521,n%=65521,(e&255)<<24|(e&65280)<<8|(n&255)<<8|n>>8}}},j7=function(e,n,t,r,i){if(!i&&(i={l:1},n.dictionary)){var o=n.dictionary.subarray(-32768),l=new ua(o.length+e.length);l.set(o),l.set(e,o.length),e=l,i.w=o.length}return z7(e,n.level==null?6:n.level,n.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+n.mem,t,r,i)},Bb=function(e,n,t){for(;t;++n)e[n]=t,t>>>=8},U7=function(e,n){var t=n.level,r=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=r<<6|(n.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,n.dictionary){var i=Tb();i.p(n.dictionary),Bb(e,2,i.d())}},$7=function(e,n){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Zl(6,"invalid zlib data"),(e[1]>>5&1)==1&&Zl(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function $g(e,n){n||(n={});var t=Tb();t.p(e);var r=j7(e,n,n.dictionary?6:2,4);return U7(r,n),Bb(r,r.length-4,t.d()),r}function q7(e,n){return I7(e.subarray($7(e),-4),{i:2},n,n)}var V7=typeof TextDecoder<"u"&&new TextDecoder,G7=0;try{V7.decode(kb,{stream:!0}),G7=1}catch{}var dr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Z0(){dr.console&&typeof dr.console.log=="function"&&dr.console.log.apply(dr.console,arguments)}var qi={log:Z0,warn:function(e){dr.console&&(typeof dr.console.warn=="function"?dr.console.warn.apply(dr.console,arguments):Z0.call(null,arguments))},error:function(e){dr.console&&(typeof dr.console.error=="function"?dr.console.error.apply(dr.console,arguments):Z0(e))}};function K0(e,n,t){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){Hc(r.response,n,t)},r.onerror=function(){qi.error("could not download file")},r.send()}function Ty(e){var n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function kd(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var Of,qg,Hc=dr.saveAs||((typeof window>"u"?"undefined":Bi(window))!=="object"||window!==dr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,n,t){var r=dr.URL||dr.webkitURL,i=document.createElement("a");n=n||e.name||"download",i.download=n,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?Ty(i.href)?K0(e,n,t):kd(i,i.target="_blank"):kd(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){kd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,t){if(n=n||e.name||"download",typeof e=="string")if(Ty(e))K0(e,n,t);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){kd(r)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:Bi(o)!=="object"&&(qi.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,t),n)}:function(e,n,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return K0(e,n,t);var i=e.type==="application/octet-stream",o=/constructor/i.test(dr.HTMLElement)||dr.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&o)&&(typeof FileReader>"u"?"undefined":Bi(FileReader))==="object"){var h=new FileReader;h.onloadend=function(){var _=h.result;_=l?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=_:location=_,r=null},h.readAsDataURL(e)}else{var g=dr.URL||dr.webkitURL,v=g.createObjectURL(e);r?r.location=v:location.href=v,r=null,setTimeout(function(){g.revokeObjectURL(v)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Nb(e){var n;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(h){return[parseInt(h[1]),parseInt(h[2]),parseInt(h[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}}],r=0;r<t.length;r++){var i=t[r].re,o=t[r].process,l=i.exec(e);l&&(n=o(l),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var h=this.r.toString(16),g=this.g.toString(16),v=this.b.toString(16);return h.length==1&&(h="0"+h),g.length==1&&(g="0"+g),v.length==1&&(v="0"+v),"#"+h+g+v}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function J0(e,n){var t=e[0],r=e[1],i=e[2],o=e[3];t=na(t,r,i,o,n[0],7,-680876936),o=na(o,t,r,i,n[1],12,-389564586),i=na(i,o,t,r,n[2],17,606105819),r=na(r,i,o,t,n[3],22,-1044525330),t=na(t,r,i,o,n[4],7,-176418897),o=na(o,t,r,i,n[5],12,1200080426),i=na(i,o,t,r,n[6],17,-1473231341),r=na(r,i,o,t,n[7],22,-45705983),t=na(t,r,i,o,n[8],7,1770035416),o=na(o,t,r,i,n[9],12,-1958414417),i=na(i,o,t,r,n[10],17,-42063),r=na(r,i,o,t,n[11],22,-1990404162),t=na(t,r,i,o,n[12],7,1804603682),o=na(o,t,r,i,n[13],12,-40341101),i=na(i,o,t,r,n[14],17,-1502002290),t=ra(t,r=na(r,i,o,t,n[15],22,1236535329),i,o,n[1],5,-165796510),o=ra(o,t,r,i,n[6],9,-1069501632),i=ra(i,o,t,r,n[11],14,643717713),r=ra(r,i,o,t,n[0],20,-373897302),t=ra(t,r,i,o,n[5],5,-701558691),o=ra(o,t,r,i,n[10],9,38016083),i=ra(i,o,t,r,n[15],14,-660478335),r=ra(r,i,o,t,n[4],20,-405537848),t=ra(t,r,i,o,n[9],5,568446438),o=ra(o,t,r,i,n[14],9,-1019803690),i=ra(i,o,t,r,n[3],14,-187363961),r=ra(r,i,o,t,n[8],20,1163531501),t=ra(t,r,i,o,n[13],5,-1444681467),o=ra(o,t,r,i,n[2],9,-51403784),i=ra(i,o,t,r,n[7],14,1735328473),t=ia(t,r=ra(r,i,o,t,n[12],20,-1926607734),i,o,n[5],4,-378558),o=ia(o,t,r,i,n[8],11,-2022574463),i=ia(i,o,t,r,n[11],16,1839030562),r=ia(r,i,o,t,n[14],23,-35309556),t=ia(t,r,i,o,n[1],4,-1530992060),o=ia(o,t,r,i,n[4],11,1272893353),i=ia(i,o,t,r,n[7],16,-155497632),r=ia(r,i,o,t,n[10],23,-1094730640),t=ia(t,r,i,o,n[13],4,681279174),o=ia(o,t,r,i,n[0],11,-358537222),i=ia(i,o,t,r,n[3],16,-722521979),r=ia(r,i,o,t,n[6],23,76029189),t=ia(t,r,i,o,n[9],4,-640364487),o=ia(o,t,r,i,n[12],11,-421815835),i=ia(i,o,t,r,n[15],16,530742520),t=sa(t,r=ia(r,i,o,t,n[2],23,-995338651),i,o,n[0],6,-198630844),o=sa(o,t,r,i,n[7],10,1126891415),i=sa(i,o,t,r,n[14],15,-1416354905),r=sa(r,i,o,t,n[5],21,-57434055),t=sa(t,r,i,o,n[12],6,1700485571),o=sa(o,t,r,i,n[3],10,-1894986606),i=sa(i,o,t,r,n[10],15,-1051523),r=sa(r,i,o,t,n[1],21,-2054922799),t=sa(t,r,i,o,n[8],6,1873313359),o=sa(o,t,r,i,n[15],10,-30611744),i=sa(i,o,t,r,n[6],15,-1560198380),r=sa(r,i,o,t,n[13],21,1309151649),t=sa(t,r,i,o,n[4],6,-145523070),o=sa(o,t,r,i,n[11],10,-1120210379),i=sa(i,o,t,r,n[2],15,718787259),r=sa(r,i,o,t,n[9],21,-343485551),e[0]=yc(t,e[0]),e[1]=yc(r,e[1]),e[2]=yc(i,e[2]),e[3]=yc(o,e[3])}function Hp(e,n,t,r,i,o){return n=yc(yc(n,e),yc(r,o)),yc(n<<i|n>>>32-i,t)}function na(e,n,t,r,i,o,l){return Hp(n&t|~n&r,e,n,i,o,l)}function ra(e,n,t,r,i,o,l){return Hp(n&r|t&~r,e,n,i,o,l)}function ia(e,n,t,r,i,o,l){return Hp(n^t^r,e,n,i,o,l)}function sa(e,n,t,r,i,o,l){return Hp(t^(n|~r),e,n,i,o,l)}function Rb(e){var n,t=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)J0(r,H7(e.substring(n-64,n)));e=e.substring(n-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(J0(r,i),n=0;n<16;n++)i[n]=0;return i[14]=8*t,J0(r,i),r}function H7(e){var n,t=[];for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t}Of=dr.atob.bind(dr),qg=dr.btoa.bind(dr);var By="0123456789abcdef".split("");function W7(e){for(var n="",t=0;t<4;t++)n+=By[e>>8*t+4&15]+By[e>>8*t&15];return n}function Z7(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Vg(e){return Rb(e).map(Z7).join("")}var K7=function(e){for(var n=0;n<e.length;n++)e[n]=W7(e[n]);return e.join("")}(Rb("hello"))!="5d41402abc4b2a76b9719d911017c592";function yc(e,n){if(K7){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t}return e+n&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gg(e,n){var t,r,i,o;if(e!==t){for(var l=(i=e,o=1+(256/e.length>>0),new Array(o+1).join(i)),h=[],g=0;g<256;g++)h[g]=g;var v=0;for(g=0;g<256;g++){var _=h[g];v=(v+_+l.charCodeAt(g))%256,h[g]=h[v],h[v]=_}t=e,r=h}else h=r;var x=n.length,E=0,b=0,R="";for(g=0;g<x;g++)b=(b+(_=h[E=(E+1)%256]))%256,h[E]=h[b],h[b]=_,l=h[(h[E]+h[b])%256],R+=String.fromCharCode(n.charCodeAt(g)^l);return R}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ny={print:4,modify:8,copy:16,"annot-forms":32};function Nh(e,n,t,r){this.v=1,this.r=2;var i=192;e.forEach(function(h){if(Ny.perm!==void 0)throw new Error("Invalid permission: "+h);i+=Ny[h]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(n+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,l),this.P=-(1+(255^i)),this.encryptionKey=Vg(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Gg(this.encryptionKey,this.padding)}function Rh(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var n="",t=e.length,r=0;r<t;r++){var i=e.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?n+="#"+("0"+i.toString(16)).slice(-2):n+=e[r]}return n}function Ry(e){if(Bi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(t,r,i){if(i=i||!1,typeof t!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(t)||(n[t]={});var o=Math.random().toString(35);return n[t][o]=[r,!!i],o},this.unsubscribe=function(t){for(var r in n)if(n[r][t])return delete n[r][t],Object.keys(n[r]).length===0&&delete n[r],!0;return!1},this.publish=function(t){if(n.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var o in n[t]){var l=n[t][o];try{l[0].apply(e,r)}catch(h){dr.console&&qi.error("jsPDF PubSub Error",h.message,h)}l[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function vp(e){if(!(this instanceof vp))return new vp(e);var n="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&n.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function Db(e,n){this.gState=e,this.matrix=n,this.id="",this.objectNumber=-1}function Kc(e,n,t,r,i){if(!(this instanceof Kc))return new Kc(e,n,t,r,i);this.type=e==="axial"?2:3,this.coords=n,this.colors=t,Db.call(this,r,i)}function Dh(e,n,t,r,i){if(!(this instanceof Dh))return new Dh(e,n,t,r,i);this.boundingBox=e,this.xStep=n,this.yStep=t,this.stream="",this.cloneIndex=0,Db.call(this,r,i)}function fr(e){var n,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],o=arguments[3],l=[],h=1,g=16,v="S",_=null;Bi(e=e||{})==="object"&&(t=e.orientation,r=e.unit||r,i=e.format||i,o=e.compress||e.compressPdf||o,(_=e.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),h=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(n=e.precision),e.floatPrecision!==void 0&&(g=e.floatPrecision),v=e.defaultPathOperation||"S"),l=e.filters||(o===!0?["FlateEncode"]:l),r=r||"mm",t=(""+(t||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,E={},b={internal:{},__private__:{}};b.__private__.PubSub=Ry;var R="1.3",$=b.__private__.getPdfVersion=function(){return R};b.__private__.setPdfVersion=function(A){R=A};var Q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};b.__private__.getPageFormats=function(){return Q};var I=b.__private__.getPageFormat=function(A){return Q[A]};i=i||"a4";var W={COMPAT:"compat",ADVANCED:"advanced"},ge=W.COMPAT;function Se(){this.saveGraphicsState(),le(new Fn(Zt,0,0,-Zt,0,Ho()*Zt).toString()+" cm"),this.setFontSize(this.getFontSize()/Zt),v="n",ge=W.ADVANCED}function De(){this.restoreGraphicsState(),v="S",ge=W.COMPAT}var Ye=b.__private__.combineFontStyleAndFontWeight=function(A,de){if(A=="bold"&&de=="normal"||A=="bold"&&de==400||A=="normal"&&de=="italic"||A=="bold"&&de=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return de&&(A=de==400||de==="normal"?A==="italic"?"italic":"normal":de!=700&&de!=="bold"||A!=="normal"?(de==700?"bold":de)+""+A:"bold"),A};b.advancedAPI=function(A){var de=ge===W.COMPAT;return de&&Se.call(this),typeof A!="function"||(A(this),de&&De.call(this)),this},b.compatAPI=function(A){var de=ge===W.ADVANCED;return de&&De.call(this),typeof A!="function"||(A(this),de&&Se.call(this)),this},b.isAdvancedAPI=function(){return ge===W.ADVANCED};var Ve,O=function(A){if(ge!==W.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},K=b.roundToPrecision=b.__private__.roundToPrecision=function(A,de){var We=n||de;if(isNaN(A)||isNaN(We))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(We).replace(/0+$/,"")};Ve=b.hpf=b.__private__.hpf=typeof g=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return K(A,g)}:g==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return K(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return K(A,16)};var ce=b.f2=b.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return K(A,2)},H=b.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return K(A,3)},D=b.scale=b.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return ge===W.COMPAT?A*Zt:ge===W.ADVANCED?A:void 0},V=function(A){return ge===W.COMPAT?Ho()-A:ge===W.ADVANCED?A:void 0},z=function(A){return D(V(A))};b.__private__.setPrecision=b.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(n=parseInt(A,10))};var U,G="00000000000000000000000000000000",ue=b.__private__.getFileId=function(){return G},ie=b.__private__.setFileId=function(A){return G=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(ts=new Nh(_.userPermissions,_.userPassword,_.ownerPassword,G)),G};b.setFileId=function(A){return ie(A),this},b.getFileId=function(){return ue()};var Ae=b.__private__.convertDateToPDFDate=function(A){var de=A.getTimezoneOffset(),We=de<0?"+":"-",ut=Math.floor(Math.abs(de/60)),Ct=Math.abs(de%60),zt=[We,N(ut),"'",N(Ct),"'"].join("");return["D:",A.getFullYear(),N(A.getMonth()+1),N(A.getDate()),N(A.getHours()),N(A.getMinutes()),N(A.getSeconds()),zt].join("")},Me=b.__private__.convertPDFDateToDate=function(A){var de=parseInt(A.substr(2,4),10),We=parseInt(A.substr(6,2),10)-1,ut=parseInt(A.substr(8,2),10),Ct=parseInt(A.substr(10,2),10),zt=parseInt(A.substr(12,2),10),ln=parseInt(A.substr(14,2),10);return new Date(de,We,ut,Ct,zt,ln,0)},st=b.__private__.setCreationDate=function(A){var de;if(A===void 0&&(A=new Date),A instanceof Date)de=Ae(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");de=A}return U=de},X=b.__private__.getCreationDate=function(A){var de=U;return A==="jsDate"&&(de=Me(U)),de};b.setCreationDate=function(A){return st(A),this},b.getCreationDate=function(A){return X(A)};var Ee,N=b.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},Z=b.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},he=0,ne=[],te=[],ee=0,se=[],Pe=[],oe=!1,re=te,xe=function(){he=0,ee=0,te=[],ne=[],se=[],fi=kt(),ei=kt()};b.__private__.setCustomOutputDestination=function(A){oe=!0,re=A};var ye=function(A){oe||(re=A)};b.__private__.resetCustomOutputDestination=function(){oe=!1,re=te};var le=b.__private__.out=function(A){return A=A.toString(),ee+=A.length+1,re.push(A),re},Ue=b.__private__.write=function(A){return le(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},Ie=b.__private__.getArrayBuffer=function(A){for(var de=A.length,We=new ArrayBuffer(de),ut=new Uint8Array(We);de--;)ut[de]=A.charCodeAt(de);return We},Ce=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];b.__private__.getStandardFonts=function(){return Ce};var qe=e.fontSize||16;b.__private__.setFontSize=b.setFontSize=function(A){return qe=ge===W.ADVANCED?A/Zt:A,this};var Re,rt=b.__private__.getFontSize=b.getFontSize=function(){return ge===W.COMPAT?qe:qe*Zt},Ze=e.R2L||!1;b.__private__.setR2L=b.setR2L=function(A){return Ze=A,this},b.__private__.getR2L=b.getR2L=function(){return Ze};var gt,_t=b.__private__.setZoomMode=function(A){var de=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))Re=A;else if(isNaN(A)){if(de.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');Re=A}else Re=parseInt(A,10)};b.__private__.getZoomMode=function(){return Re};var $t,tn=b.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');gt=A};b.__private__.getPageMode=function(){return gt};var Qe=b.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');$t=A};b.__private__.getLayoutMode=function(){return $t},b.__private__.setDisplayMode=b.setDisplayMode=function(A,de,We){return _t(A),Qe(de),tn(We),this};var Yt={title:"",subject:"",author:"",keywords:"",creator:""};b.__private__.getDocumentProperty=function(A){if(Object.keys(Yt).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Yt[A]},b.__private__.getDocumentProperties=function(){return Yt},b.__private__.setDocumentProperties=b.setProperties=b.setDocumentProperties=function(A){for(var de in Yt)Yt.hasOwnProperty(de)&&A[de]&&(Yt[de]=A[de]);return this},b.__private__.setDocumentProperty=function(A,de){if(Object.keys(Yt).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Yt[A]=de};var Qt,Zt,wt,He,Kt,on={},Bn={},kn=[],et={},On={},Nn={},mn={},Pn=null,zr=0,Gn=[],Dt=new Ry(b),xr=e.hotfixes||[],lr={},hi={},Ri=[],Fn=function A(de,We,ut,Ct,zt,ln){if(!(this instanceof A))return new A(de,We,ut,Ct,zt,ln);isNaN(de)&&(de=1),isNaN(We)&&(We=0),isNaN(ut)&&(ut=0),isNaN(Ct)&&(Ct=1),isNaN(zt)&&(zt=0),isNaN(ln)&&(ln=0),this._matrix=[de,We,ut,Ct,zt,ln]};Object.defineProperty(Fn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(Fn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(Fn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(Fn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(Fn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(Fn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(Fn.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(Fn.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(Fn.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(Fn.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(Fn.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(Fn.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(Fn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Fn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Fn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Fn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Fn.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ve).join(A)},Fn.prototype.multiply=function(A){var de=A.sx*this.sx+A.shy*this.shx,We=A.sx*this.shy+A.shy*this.sy,ut=A.shx*this.sx+A.sy*this.shx,Ct=A.shx*this.shy+A.sy*this.sy,zt=A.tx*this.sx+A.ty*this.shx+this.tx,ln=A.tx*this.shy+A.ty*this.sy+this.ty;return new Fn(de,We,ut,Ct,zt,ln)},Fn.prototype.decompose=function(){var A=this.sx,de=this.shy,We=this.shx,ut=this.sy,Ct=this.tx,zt=this.ty,ln=Math.sqrt(A*A+de*de),Ln=(A/=ln)*We+(de/=ln)*ut;We-=A*Ln,ut-=de*Ln;var En=Math.sqrt(We*We+ut*ut);return Ln/=En,A*(ut/=En)<de*(We/=En)&&(A=-A,de=-de,Ln=-Ln,ln=-ln),{scale:new Fn(ln,0,0,En,0,0),translate:new Fn(1,0,0,1,Ct,zt),rotate:new Fn(A,de,-de,A,0,0),skew:new Fn(1,0,Ln,1,0,0)}},Fn.prototype.toString=function(A){return this.join(" ")},Fn.prototype.inversed=function(){var A=this.sx,de=this.shy,We=this.shx,ut=this.sy,Ct=this.tx,zt=this.ty,ln=1/(A*ut-de*We),Ln=ut*ln,En=-de*ln,Hn=-We*ln,nr=A*ln;return new Fn(Ln,En,Hn,nr,-Ln*Ct-Hn*zt,-En*Ct-nr*zt)},Fn.prototype.applyToPoint=function(A){var de=A.x*this.sx+A.y*this.shx+this.tx,We=A.x*this.shy+A.y*this.sy+this.ty;return new as(de,We)},Fn.prototype.applyToRectangle=function(A){var de=this.applyToPoint(A),We=this.applyToPoint(new as(A.x+A.w,A.y+A.h));return new mo(de.x,de.y,We.x-de.x,We.y-de.y)},Fn.prototype.clone=function(){var A=this.sx,de=this.shy,We=this.shx,ut=this.sy,Ct=this.tx,zt=this.ty;return new Fn(A,de,We,ut,Ct,zt)},b.Matrix=Fn;var xi=b.matrixMult=function(A,de){return de.multiply(A)},Lr=new Fn(1,0,0,1,0,0);b.unitMatrix=b.identityMatrix=Lr;var Gr=function(A,de){if(!On[A]){var We=(de instanceof Kc?"Sh":"P")+(Object.keys(et).length+1).toString(10);de.id=We,On[A]=We,et[We]=de,Dt.publish("addPattern",de)}};b.ShadingPattern=Kc,b.TilingPattern=Dh,b.addShadingPattern=function(A,de){return O("addShadingPattern()"),Gr(A,de),this},b.beginTilingPattern=function(A){O("beginTilingPattern()"),vo(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},b.endTilingPattern=function(A,de){O("endTilingPattern()"),de.stream=Pe[Ee].join(`
`),Gr(A,de),Dt.publish("endTilingPattern",de),Ri.pop().restore()};var Qn=b.__private__.newObject=function(){var A=kt();return Ei(A,!0),A},kt=b.__private__.newObjectDeferred=function(){return he++,ne[he]=function(){return ee},he},Ei=function(A,de){return de=typeof de=="boolean"&&de,ne[A]=ee,de&&le(A+" 0 obj"),A},Ai=b.__private__.newAdditionalObject=function(){var A={objId:kt(),content:""};return se.push(A),A},fi=kt(),ei=kt(),Di=b.__private__.decodeColorString=function(A){var de=A.split(" ");if(de.length!==2||de[1]!=="g"&&de[1]!=="G")de.length===5&&(de[4]==="k"||de[4]==="K")&&(de=[(1-de[0])*(1-de[3]),(1-de[1])*(1-de[3]),(1-de[2])*(1-de[3]),"r"]);else{var We=parseFloat(de[0]);de=[We,We,We,"r"]}for(var ut="#",Ct=0;Ct<3;Ct++)ut+=("0"+Math.floor(255*parseFloat(de[Ct])).toString(16)).slice(-2);return ut},Qi=b.__private__.encodeColorString=function(A){var de;typeof A=="string"&&(A={ch1:A});var We=A.ch1,ut=A.ch2,Ct=A.ch3,zt=A.ch4,ln=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof We=="string"&&We.charAt(0)!=="#"){var Ln=new Nb(We);if(Ln.ok)We=Ln.toHex();else if(!/^\d*\.?\d*$/.test(We))throw new Error('Invalid color "'+We+'" passed to jsPDF.encodeColorString.')}if(typeof We=="string"&&/^#[0-9A-Fa-f]{3}$/.test(We)&&(We="#"+We[1]+We[1]+We[2]+We[2]+We[3]+We[3]),typeof We=="string"&&/^#[0-9A-Fa-f]{6}$/.test(We)){var En=parseInt(We.substr(1),16);We=En>>16&255,ut=En>>8&255,Ct=255&En}if(ut===void 0||zt===void 0&&We===ut&&ut===Ct)if(typeof We=="string")de=We+" "+ln[0];else switch(A.precision){case 2:de=ce(We/255)+" "+ln[0];break;case 3:default:de=H(We/255)+" "+ln[0]}else if(zt===void 0||Bi(zt)==="object"){if(zt&&!isNaN(zt.a)&&zt.a===0)return de=["1.","1.","1.",ln[1]].join(" ");if(typeof We=="string")de=[We,ut,Ct,ln[1]].join(" ");else switch(A.precision){case 2:de=[ce(We/255),ce(ut/255),ce(Ct/255),ln[1]].join(" ");break;default:case 3:de=[H(We/255),H(ut/255),H(Ct/255),ln[1]].join(" ")}}else if(typeof We=="string")de=[We,ut,Ct,zt,ln[2]].join(" ");else switch(A.precision){case 2:de=[ce(We),ce(ut),ce(Ct),ce(zt),ln[2]].join(" ");break;case 3:default:de=[H(We),H(ut),H(Ct),H(zt),ln[2]].join(" ")}return de},Yn=b.__private__.getFilters=function(){return l},Mi=b.__private__.putStream=function(A){var de=(A=A||{}).data||"",We=A.filters||Yn(),ut=A.alreadyAppliedFilters||[],Ct=A.addLength1||!1,zt=de.length,ln=A.objectId,Ln=function(ji){return ji};if(_!==null&&ln===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Ln=ts.encryptor(ln,0));var En={};We===!0&&(We=["FlateEncode"]);var Hn=A.additionalKeyValues||[],nr=(En=fr.API.processDataByFilters!==void 0?fr.API.processDataByFilters(de,We):{data:de,reverseChain:[]}).reverseChain+(Array.isArray(ut)?ut.join(" "):ut.toString());if(En.data.length!==0&&(Hn.push({key:"Length",value:En.data.length}),Ct===!0&&Hn.push({key:"Length1",value:zt})),nr.length!=0)if(nr.split("/").length-1==1)Hn.push({key:"Filter",value:nr});else{Hn.push({key:"Filter",value:"["+nr+"]"});for(var mr=0;mr<Hn.length;mr+=1)if(Hn[mr].key==="DecodeParms"){for(var gi=[],qr=0;qr<En.reverseChain.split("/").length-1;qr+=1)gi.push("null");gi.push(Hn[mr].value),Hn[mr].value="["+gi.join(" ")+"]"}}le("<<");for(var Jr=0;Jr<Hn.length;Jr++)le("/"+Hn[Jr].key+" "+Hn[Jr].value);le(">>"),En.data.length!==0&&(le("stream"),le(Ln(En.data)),le("endstream"))},Xs=b.__private__.putPage=function(A){var de=A.number,We=A.data,ut=A.objId,Ct=A.contentsObjId;Ei(ut,!0),le("<</Type /Page"),le("/Parent "+A.rootDictionaryObjId+" 0 R"),le("/Resources "+A.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(Ve(A.mediaBox.bottomLeftX))+" "+parseFloat(Ve(A.mediaBox.bottomLeftY))+" "+Ve(A.mediaBox.topRightX)+" "+Ve(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&le("/CropBox ["+Ve(A.cropBox.bottomLeftX)+" "+Ve(A.cropBox.bottomLeftY)+" "+Ve(A.cropBox.topRightX)+" "+Ve(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&le("/BleedBox ["+Ve(A.bleedBox.bottomLeftX)+" "+Ve(A.bleedBox.bottomLeftY)+" "+Ve(A.bleedBox.topRightX)+" "+Ve(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&le("/TrimBox ["+Ve(A.trimBox.bottomLeftX)+" "+Ve(A.trimBox.bottomLeftY)+" "+Ve(A.trimBox.topRightX)+" "+Ve(A.trimBox.topRightY)+"]"),A.artBox!==null&&le("/ArtBox ["+Ve(A.artBox.bottomLeftX)+" "+Ve(A.artBox.bottomLeftY)+" "+Ve(A.artBox.topRightX)+" "+Ve(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&le("/UserUnit "+A.userUnit),Dt.publish("putPage",{objId:ut,pageContext:Gn[de],pageNumber:de,page:We}),le("/Contents "+Ct+" 0 R"),le(">>"),le("endobj");var zt=We.join(`
`);return ge===W.ADVANCED&&(zt+=`
Q`),Ei(Ct,!0),Mi({data:zt,filters:Yn(),objectId:Ct}),le("endobj"),ut},Ps=b.__private__.putPages=function(){var A,de,We=[];for(A=1;A<=zr;A++)Gn[A].objId=kt(),Gn[A].contentsObjId=kt();for(A=1;A<=zr;A++)We.push(Xs({number:A,data:Pe[A],objId:Gn[A].objId,contentsObjId:Gn[A].contentsObjId,mediaBox:Gn[A].mediaBox,cropBox:Gn[A].cropBox,bleedBox:Gn[A].bleedBox,trimBox:Gn[A].trimBox,artBox:Gn[A].artBox,userUnit:Gn[A].userUnit,rootDictionaryObjId:fi,resourceDictionaryObjId:ei}));Ei(fi,!0),le("<</Type /Pages");var ut="/Kids [";for(de=0;de<zr;de++)ut+=We[de]+" 0 R ";le(ut+"]"),le("/Count "+zr),le(">>"),le("endobj"),Dt.publish("postPutPages")},Tr=function(A){Dt.publish("putFont",{font:A,out:le,newObject:Qn,putStream:Mi}),A.isAlreadyPutted!==!0&&(A.objectNumber=Qn(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Rh(A.postScriptName)),le("/Subtype /Type1"),typeof A.encoding=="string"&&le("/Encoding /"+A.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},Cn=function(){for(var A in on)on.hasOwnProperty(A)&&(x===!1||x===!0&&E.hasOwnProperty(A))&&Tr(on[A])},di=function(A){A.objectNumber=Qn();var de=[];de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Form"}),de.push({key:"BBox",value:"["+[Ve(A.x),Ve(A.y),Ve(A.x+A.width),Ve(A.y+A.height)].join(" ")+"]"}),de.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var We=A.pages[1].join(`
`);Mi({data:We,additionalKeyValues:de,objectId:A.objectNumber}),le("endobj")},Dr=function(){for(var A in lr)lr.hasOwnProperty(A)&&di(lr[A])},si=function(A,de){var We,ut=[],Ct=1/(de-1);for(We=0;We<1;We+=Ct)ut.push(We);if(ut.push(1),A[0].offset!=0){var zt={offset:0,color:A[0].color};A.unshift(zt)}if(A[A.length-1].offset!=1){var ln={offset:1,color:A[A.length-1].color};A.push(ln)}for(var Ln="",En=0,Hn=0;Hn<ut.length;Hn++){for(We=ut[Hn];We>A[En+1].offset;)En++;var nr=A[En].offset,mr=(We-nr)/(A[En+1].offset-nr),gi=A[En].color,qr=A[En+1].color;Ln+=Z(Math.round((1-mr)*gi[0]+mr*qr[0]).toString(16))+Z(Math.round((1-mr)*gi[1]+mr*qr[1]).toString(16))+Z(Math.round((1-mr)*gi[2]+mr*qr[2]).toString(16))}return Ln.trim()},mi=function(A,de){de||(de=21);var We=Qn(),ut=si(A.colors,de),Ct=[];Ct.push({key:"FunctionType",value:"0"}),Ct.push({key:"Domain",value:"[0.0 1.0]"}),Ct.push({key:"Size",value:"["+de+"]"}),Ct.push({key:"BitsPerSample",value:"8"}),Ct.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ct.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Mi({data:ut,additionalKeyValues:Ct,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:We}),le("endobj"),A.objectNumber=Qn(),le("<< /ShadingType "+A.type),le("/ColorSpace /DeviceRGB");var zt="/Coords ["+Ve(parseFloat(A.coords[0]))+" "+Ve(parseFloat(A.coords[1]))+" ";A.type===2?zt+=Ve(parseFloat(A.coords[2]))+" "+Ve(parseFloat(A.coords[3])):zt+=Ve(parseFloat(A.coords[2]))+" "+Ve(parseFloat(A.coords[3]))+" "+Ve(parseFloat(A.coords[4]))+" "+Ve(parseFloat(A.coords[5])),le(zt+="]"),A.matrix&&le("/Matrix ["+A.matrix.toString()+"]"),le("/Function "+We+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},Es=function(A,de){var We=kt(),ut=Qn();de.push({resourcesOid:We,objectOid:ut}),A.objectNumber=ut;var Ct=[];Ct.push({key:"Type",value:"/Pattern"}),Ct.push({key:"PatternType",value:"1"}),Ct.push({key:"PaintType",value:"1"}),Ct.push({key:"TilingType",value:"1"}),Ct.push({key:"BBox",value:"["+A.boundingBox.map(Ve).join(" ")+"]"}),Ct.push({key:"XStep",value:Ve(A.xStep)}),Ct.push({key:"YStep",value:Ve(A.yStep)}),Ct.push({key:"Resources",value:We+" 0 R"}),A.matrix&&Ct.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),Mi({data:A.stream,additionalKeyValues:Ct,objectId:A.objectNumber}),le("endobj")},is=function(A){var de;for(de in et)et.hasOwnProperty(de)&&(et[de]instanceof Kc?mi(et[de]):et[de]instanceof Dh&&Es(et[de],A))},pr=function(A){for(var de in A.objectNumber=Qn(),le("<<"),A)switch(de){case"opacity":le("/ca "+ce(A[de]));break;case"stroke-opacity":le("/CA "+ce(A[de]))}le(">>"),le("endobj")},fo=function(){var A;for(A in Nn)Nn.hasOwnProperty(A)&&pr(Nn[A])},ti=function(){for(var A in le("/XObject <<"),lr)lr.hasOwnProperty(A)&&lr[A].objectNumber>=0&&le("/"+A+" "+lr[A].objectNumber+" 0 R");Dt.publish("putXobjectDict"),le(">>")},ki=function(){ts.oid=Qn(),le("<<"),le("/Filter /Standard"),le("/V "+ts.v),le("/R "+ts.r),le("/U <"+ts.toHexString(ts.U)+">"),le("/O <"+ts.toHexString(ts.O)+">"),le("/P "+ts.P),le(">>"),le("endobj")},Br=function(){for(var A in le("/Font <<"),on)on.hasOwnProperty(A)&&(x===!1||x===!0&&E.hasOwnProperty(A))&&le("/"+A+" "+on[A].objectNumber+" 0 R");le(">>")},_n=function(){if(Object.keys(et).length>0){for(var A in le("/Shading <<"),et)et.hasOwnProperty(A)&&et[A]instanceof Kc&&et[A].objectNumber>=0&&le("/"+A+" "+et[A].objectNumber+" 0 R");Dt.publish("putShadingPatternDict"),le(">>")}},Xt=function(A){if(Object.keys(et).length>0){for(var de in le("/Pattern <<"),et)et.hasOwnProperty(de)&&et[de]instanceof b.TilingPattern&&et[de].objectNumber>=0&&et[de].objectNumber<A&&le("/"+de+" "+et[de].objectNumber+" 0 R");Dt.publish("putTilingPatternDict"),le(">>")}},Tn=function(){if(Object.keys(Nn).length>0){var A;for(A in le("/ExtGState <<"),Nn)Nn.hasOwnProperty(A)&&Nn[A].objectNumber>=0&&le("/"+A+" "+Nn[A].objectNumber+" 0 R");Dt.publish("putGStateDict"),le(">>")}},In=function(A){Ei(A.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Br(),_n(),Xt(A.objectOid),Tn(),ti(),le(">>"),le("endobj")},Oi=function(){var A=[];Cn(),fo(),Dr(),is(A),Dt.publish("putResources"),A.forEach(In),In({resourcesOid:ei,objectOid:Number.MAX_SAFE_INTEGER}),Dt.publish("postPutResources")},es=function(){Dt.publish("putAdditionalObjects");for(var A=0;A<se.length;A++){var de=se[A];Ei(de.objId,!0),le(de.content),le("endobj")}Dt.publish("postPutAdditionalObjects")},ss=function(A){Bn[A.fontName]=Bn[A.fontName]||{},Bn[A.fontName][A.fontStyle]=A.id},ps=function(A,de,We,ut,Ct){var zt={id:"F"+(Object.keys(on).length+1).toString(10),postScriptName:A,fontName:de,fontStyle:We,encoding:ut,isStandardFont:Ct||!1,metadata:{}};return Dt.publish("addFont",{font:zt,instance:this}),on[zt.id]=zt,ss(zt),zt.id},tr=function(A){for(var de=0,We=Ce.length;de<We;de++){var ut=ps.call(this,A[de][0],A[de][1],A[de][2],Ce[de][3],!0);x===!1&&(E[ut]=!0);var Ct=A[de][0].split("-");ss({id:ut,fontName:Ct[0],fontStyle:Ct[1]||""})}Dt.publish("addFonts",{fonts:on,dictionary:Bn})},pn=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(ut){var de=ut.stack||"";~de.indexOf(" at ")&&(de=de.split(" at ")[1]);var We="Error in function "+de.split(`
`)[0].split("<")[0]+": "+ut.message;if(!dr.console)throw new Error(We);dr.console.error(We,ut),dr.alert&&alert(We)}},A.foo.bar=A,A.foo},pi=function(A,de){var We,ut,Ct,zt,ln,Ln,En,Hn,nr;if(Ct=(de=de||{}).sourceEncoding||"Unicode",ln=de.outputEncoding,(de.autoencode||ln)&&on[Qt].metadata&&on[Qt].metadata[Ct]&&on[Qt].metadata[Ct].encoding&&(zt=on[Qt].metadata[Ct].encoding,!ln&&on[Qt].encoding&&(ln=on[Qt].encoding),!ln&&zt.codePages&&(ln=zt.codePages[0]),typeof ln=="string"&&(ln=zt[ln]),ln)){for(En=!1,Ln=[],We=0,ut=A.length;We<ut;We++)(Hn=ln[A.charCodeAt(We)])?Ln.push(String.fromCharCode(Hn)):Ln.push(A[We]),Ln[We].charCodeAt(0)>>8&&(En=!0);A=Ln.join("")}for(We=A.length;En===void 0&&We!==0;)A.charCodeAt(We-1)>>8&&(En=!0),We--;if(!En)return A;for(Ln=de.noBOM?[]:[254,255],We=0,ut=A.length;We<ut;We++){if((nr=(Hn=A.charCodeAt(We))>>8)>>8)throw new Error("Character at position "+We+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ln.push(nr),Ln.push(Hn-(nr<<8))}return String.fromCharCode.apply(void 0,Ln)},$r=b.__private__.pdfEscape=b.pdfEscape=function(A,de){return pi(A,de).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},oi=b.__private__.beginPage=function(A){Pe[++zr]=[],Gn[zr]={objId:0,contentsObjId:0,userUnit:Number(h),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},oo(zr),ye(Pe[Ee])},Qs=function(A,de){var We,ut,Ct;switch(t=de||t,typeof A=="string"&&(We=I(A.toLowerCase()),Array.isArray(We)&&(ut=We[0],Ct=We[1])),Array.isArray(A)&&(ut=A[0]*Zt,Ct=A[1]*Zt),isNaN(ut)&&(ut=i[0],Ct=i[1]),(ut>14400||Ct>14400)&&(qi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ut=Math.min(14400,ut),Ct=Math.min(14400,Ct)),i=[ut,Ct],t.substr(0,1)){case"l":Ct>ut&&(i=[Ct,ut]);break;case"p":ut>Ct&&(i=[Ct,ut])}oi(i),Ja(fl),le(yi),Qa!==0&&le(Qa+" J"),Zr!==0&&le(Zr+" j"),Dt.publish("addPage",{pageNumber:zr})},Ao=function(A){A>0&&A<=zr&&(Pe.splice(A,1),Gn.splice(A,1),zr--,Ee>zr&&(Ee=zr),this.setPage(Ee))},oo=function(A){A>0&&A<=zr&&(Ee=A)},vi=b.__private__.getNumberOfPages=b.getNumberOfPages=function(){return Pe.length-1},As=function(A,de,We){var ut,Ct=void 0;return We=We||{},A=A!==void 0?A:on[Qt].fontName,de=de!==void 0?de:on[Qt].fontStyle,ut=A.toLowerCase(),Bn[ut]!==void 0&&Bn[ut][de]!==void 0?Ct=Bn[ut][de]:Bn[A]!==void 0&&Bn[A][de]!==void 0?Ct=Bn[A][de]:We.disableWarning===!1&&qi.warn("Unable to look up font label for font '"+A+"', '"+de+"'. Refer to getFontList() for available fonts."),Ct||We.noFallback||(Ct=Bn.times[de])==null&&(Ct=Bn.times.normal),Ct},ao=b.__private__.putInfo=function(){var A=Qn(),de=function(ut){return ut};for(var We in _!==null&&(de=ts.encryptor(A,0)),le("<<"),le("/Producer ("+$r(de("jsPDF "+fr.version))+")"),Yt)Yt.hasOwnProperty(We)&&Yt[We]&&le("/"+We.substr(0,1).toUpperCase()+We.substr(1)+" ("+$r(de(Yt[We]))+")");le("/CreationDate ("+$r(de(U))+")"),le(">>"),le("endobj")},os=b.__private__.putCatalog=function(A){var de=(A=A||{}).rootDictionaryObjId||fi;switch(Qn(),le("<<"),le("/Type /Catalog"),le("/Pages "+de+" 0 R"),Re||(Re="fullwidth"),Re){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var We=""+Re;We.substr(We.length-1)==="%"&&(Re=parseInt(Re)/100),typeof Re=="number"&&le("/OpenAction [3 0 R /XYZ null null "+ce(Re)+"]")}switch($t||($t="continuous"),$t){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}gt&&le("/PageMode /"+gt),Dt.publish("putCatalog"),le(">>"),le("endobj")},Ea=b.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(he+1)),le("/Root "+he+" 0 R"),le("/Info "+(he-1)+" 0 R"),_!==null&&le("/Encrypt "+ts.oid+" 0 R"),le("/ID [ <"+G+"> <"+G+"> ]"),le(">>")},jr=b.__private__.putHeader=function(){le("%PDF-"+R),le("%ºß¬à")},lo=b.__private__.putXRef=function(){var A="0000000000";le("xref"),le("0 "+(he+1)),le("0000000000 65535 f ");for(var de=1;de<=he;de++)typeof ne[de]=="function"?le((A+ne[de]()).slice(-10)+" 00000 n "):ne[de]!==void 0?le((A+ne[de]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},Li=b.__private__.buildDocument=function(){xe(),ye(te),Dt.publish("buildDocument"),jr(),Ps(),es(),Oi(),_!==null&&ki(),ao(),os();var A=ee;return lo(),Ea(),le("startxref"),le(""+A),le("%%EOF"),ye(Pe[Ee]),te.join(`
`)},Vo=b.__private__.getBlob=function(A){return new Blob([Ie(A)],{type:"application/pdf"})},ca=b.output=b.__private__.output=pn(function(A,de){switch(typeof(de=de||{})=="string"?de={filename:de}:de.filename=de.filename||"generated.pdf",A){case void 0:return Li();case"save":b.save(de.filename);break;case"arraybuffer":return Ie(Li());case"blob":return Vo(Li());case"bloburi":case"bloburl":if(dr.URL!==void 0&&typeof dr.URL.createObjectURL=="function")return dr.URL&&dr.URL.createObjectURL(Vo(Li()))||void 0;qi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var We="",ut=Li();try{We=qg(ut)}catch{We=qg(unescape(encodeURIComponent(ut)))}return"data:application/pdf;filename="+de.filename+";base64,"+We;case"pdfobjectnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var Ct="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",zt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';de.pdfObjectUrl&&(Ct=de.pdfObjectUrl,zt="");var ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ct+'"'+zt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(de)+");<\/script></body></html>",Ln=dr.open();return Ln!==null&&Ln.document.write(ln),Ln}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var En='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(de.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+de.filename+'" width="500px" height="400px" /></body></html>',Hn=dr.open();if(Hn!==null){Hn.document.write(En);var nr=this;Hn.document.documentElement.querySelector("#pdfViewer").onload=function(){Hn.document.title=de.filename,Hn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(nr.output("bloburl"))}}return Hn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(dr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",de)+'"></iframe></body></html>',gi=dr.open();if(gi!==null&&(gi.document.write(mr),gi.document.title=de.filename),gi||typeof safari>"u")return gi;break;case"datauri":case"dataurl":return dr.document.location.href=this.output("datauristring",de);default:return null}}),Wa=function(A){return Array.isArray(xr)===!0&&xr.indexOf(A)>-1};switch(r){case"pt":Zt=1;break;case"mm":Zt=72/25.4;break;case"cm":Zt=72/2.54;break;case"in":Zt=72;break;case"px":Zt=Wa("px_scaling")==1?.75:96/72;break;case"pc":case"em":Zt=12;break;case"ex":Zt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Zt=r}var ts=null;st(),ie();var ru=function(A){return _!==null?ts.encryptor(A,0):function(de){return de}},hl=b.__private__.getPageInfo=b.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Gn[A].objId,pageNumber:A,pageContext:Gn[A]}},ir=b.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var de in Gn)if(Gn[de].objId===A)break;return hl(de)},ur=b.__private__.getCurrentPageInfo=b.getCurrentPageInfo=function(){return{objId:Gn[Ee].objId,pageNumber:Ee,pageContext:Gn[Ee]}};b.addPage=function(){return Qs.apply(this,arguments),this},b.setPage=function(){return oo.apply(this,arguments),ye.call(this,Pe[Ee]),this},b.insertPage=function(A){return this.addPage(),this.movePage(Ee,A),this},b.movePage=function(A,de){var We,ut;if(A>de){We=Pe[A],ut=Gn[A];for(var Ct=A;Ct>de;Ct--)Pe[Ct]=Pe[Ct-1],Gn[Ct]=Gn[Ct-1];Pe[de]=We,Gn[de]=ut,this.setPage(de)}else if(A<de){We=Pe[A],ut=Gn[A];for(var zt=A;zt<de;zt++)Pe[zt]=Pe[zt+1],Gn[zt]=Gn[zt+1];Pe[de]=We,Gn[de]=ut,this.setPage(de)}return this},b.deletePage=function(){return Ao.apply(this,arguments),this},b.__private__.text=b.text=function(A,de,We,ut,Ct){var zt,ln,Ln,En,Hn,nr,mr,gi,qr,Jr=(ut=ut||{}).scope||this;if(typeof A=="number"&&typeof de=="number"&&(typeof We=="string"||Array.isArray(We))){var ji=We;We=de,de=A,A=ji}if(arguments[3]instanceof Fn?(O("The transform parameter of text() with a Matrix value"),qr=Ct):(Ln=arguments[4],En=arguments[5],Bi(mr=arguments[3])==="object"&&mr!==null||(typeof Ln=="string"&&(En=Ln,Ln=null),typeof mr=="string"&&(En=mr,mr=null),typeof mr=="number"&&(Ln=mr,mr=null),ut={flags:mr,angle:Ln,align:En})),isNaN(de)||isNaN(We)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return Jr;var Hi="",to=!1,vr=typeof ut.lineHeightFactor=="number"?ut.lineHeightFactor:Ka,gs=Jr.internal.scaleFactor;function Ra(Xr){return Xr=Xr.split("	").join(Array(ut.TabLen||9).join(" ")),$r(Xr,mr)}function Ms(Xr){for(var ni,Ui=Xr.concat(),li=[],io=Ui.length;io--;)typeof(ni=Ui.shift())=="string"?li.push(ni):Array.isArray(Xr)&&(ni.length===1||ni[1]===void 0&&ni[2]===void 0)?li.push(ni[0]):li.push([ni[0],ni[1],ni[2]]);return li}function gl(Xr,ni){var Ui;if(typeof Xr=="string")Ui=ni(Xr)[0];else if(Array.isArray(Xr)){for(var li,io,zs=Xr.concat(),co=[],Ol=zs.length;Ol--;)typeof(li=zs.shift())=="string"?co.push(ni(li)[0]):Array.isArray(li)&&typeof li[0]=="string"&&(io=ni(li[0],li[1],li[2]),co.push([io[0],io[1],io[2]]));Ui=co}return Ui}var ko=!1,Dl=!0;if(typeof A=="string")ko=!0;else if(Array.isArray(A)){var da=A.concat();ln=[];for(var pa,Wi=da.length;Wi--;)(typeof(pa=da.shift())!="string"||Array.isArray(pa)&&typeof pa[0]!="string")&&(Dl=!1);ko=Dl}if(ko===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var To=qe/Jr.internal.scaleFactor,no=To*(vr-1);switch(ut.baseline){case"bottom":We-=no;break;case"top":We+=To-no;break;case"hanging":We+=To-2*no;break;case"middle":We+=To/2-no}if((nr=ut.maxWidth||0)>0&&(typeof A=="string"?A=Jr.splitTextToSize(A,nr):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(Xr,ni){return Xr.concat(Jr.splitTextToSize(ni,nr))},[]))),zt={text:A,x:de,y:We,options:ut,mutex:{pdfEscape:$r,activeFontKey:Qt,fonts:on,activeFontSize:qe}},Dt.publish("preProcessText",zt),A=zt.text,Ln=(ut=zt.options).angle,!(qr instanceof Fn)&&Ln&&typeof Ln=="number"){Ln*=Math.PI/180,ut.rotationDirection===0&&(Ln=-Ln),ge===W.ADVANCED&&(Ln=-Ln);var Fs=Math.cos(Ln),Da=Math.sin(Ln);qr=new Fn(Fs,Da,-Da,Fs,0,0)}else Ln&&Ln instanceof Fn&&(qr=Ln);ge!==W.ADVANCED||qr||(qr=Lr),(Hn=ut.charSpace||Xa)!==void 0&&(Hi+=Ve(D(Hn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gi=ut.horizontalScale)!==void 0&&(Hi+=Ve(100*gi)+` Tz
`),ut.lang;var ms=-1,ks=ut.renderingMode!==void 0?ut.renderingMode:ut.stroke,Ts=Jr.internal.getCurrentPageInfo().pageContext;switch(ks){case 0:case!1:case"fill":ms=0;break;case 1:case!0:case"stroke":ms=1;break;case 2:case"fillThenStroke":ms=2;break;case 3:case"invisible":ms=3;break;case 4:case"fillAndAddForClipping":ms=4;break;case 5:case"strokeAndAddPathForClipping":ms=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ms=6;break;case 7:case"addToPathForClipping":ms=7}var ou=Ts.usedRenderingMode!==void 0?Ts.usedRenderingMode:-1;ms!==-1?Hi+=ms+` Tr
`:ou!==-1&&(Hi+=`0 Tr
`),ms!==-1&&(Ts.usedRenderingMode=ms),En=ut.align||"left";var ns,Wo=qe*vr,vs=Jr.internal.pageSize.getWidth(),ys=on[Qt];Hn=ut.charSpace||Xa,nr=ut.maxWidth||0,mr=Object.assign({autoencode:!0,noBOM:!0},ut.flags);var Zo=[],Ko=function(Xr){return Jr.getStringUnitWidth(Xr,{font:ys,charSpace:Hn,fontSize:qe,doKerning:!1})*qe/gs};if(Object.prototype.toString.call(A)==="[object Array]"){var _s;ln=Ms(A),En!=="left"&&(ns=ln.map(Ko));var ls,Bo=0;if(En==="right"){de-=ns[0],A=[],Wi=ln.length;for(var ro=0;ro<Wi;ro++)ro===0?(ls=Wn(de),_s=Fi(We)):(ls=D(Bo-ns[ro]),_s=-Wo),A.push([ln[ro],ls,_s]),Bo=ns[ro]}else if(En==="center"){de-=ns[0]/2,A=[],Wi=ln.length;for(var bs=0;bs<Wi;bs++)bs===0?(ls=Wn(de),_s=Fi(We)):(ls=D((Bo-ns[bs])/2),_s=-Wo),A.push([ln[bs],ls,_s]),Bo=ns[bs]}else if(En==="left"){A=[],Wi=ln.length;for(var bt=0;bt<Wi;bt++)A.push(ln[bt])}else if(En==="justify"&&ys.encoding==="Identity-H"){A=[],Wi=ln.length,nr=nr!==0?nr:vs;for(var qt=0,Bt=0;Bt<Wi;Bt++)if(_s=Bt===0?Fi(We):-Wo,ls=Bt===0?Wn(de):qt,Bt<Wi-1){var wn=D((nr-ns[Bt])/(ln[Bt].split(" ").length-1)),zn=ln[Bt].split(" ");A.push([zn[0]+" ",ls,_s]),qt=0;for(var sr=1;sr<zn.length;sr++){var _i=(Ko(zn[sr-1]+" "+zn[sr])-Ko(zn[sr]))*gs+wn;sr==zn.length-1?A.push([zn[sr],_i,0]):A.push([zn[sr]+" ",_i,0]),qt-=_i}}else A.push([ln[Bt],ls,_s]);A.push(["",qt,0])}else{if(En!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],Wi=ln.length,nr=nr!==0?nr:vs,Bt=0;Bt<Wi;Bt++)_s=Bt===0?Fi(We):-Wo,ls=Bt===0?Wn(de):0,Bt<Wi-1?Zo.push(Ve(D((nr-ns[Bt])/(ln[Bt].split(" ").length-1)))):Zo.push(0),A.push([ln[Bt],ls,_s])}}var Yr=typeof ut.R2L=="boolean"?ut.R2L:Ze;Yr===!0&&(A=gl(A,function(Xr,ni,Ui){return[Xr.split("").reverse().join(""),ni,Ui]})),zt={text:A,x:de,y:We,options:ut,mutex:{pdfEscape:$r,activeFontKey:Qt,fonts:on,activeFontSize:qe}},Dt.publish("postProcessText",zt),A=zt.text,to=zt.mutex.isHex||!1;var tl=on[Qt].encoding;tl!=="WinAnsiEncoding"&&tl!=="StandardEncoding"||(A=gl(A,function(Xr,ni,Ui){return[Ra(Xr),ni,Ui]})),ln=Ms(A),A=[];for(var Bs,bi,No,Jo=0,Ro=1,Do=Array.isArray(ln[0])?Ro:Jo,Oo="",Cr=function(Xr,ni,Ui){var li="";return Ui instanceof Fn?(Ui=typeof ut.angle=="number"?xi(Ui,new Fn(1,0,0,1,Xr,ni)):xi(new Fn(1,0,0,1,Xr,ni),Ui),ge===W.ADVANCED&&(Ui=xi(new Fn(1,0,0,-1,0,0),Ui)),li=Ui.join(" ")+` Tm
`):li=Ve(Xr)+" "+Ve(ni)+` Td
`,li},yo=0;yo<ln.length;yo++){switch(Oo="",Do){case Ro:No=(to?"<":"(")+ln[yo][0]+(to?">":")"),Bs=parseFloat(ln[yo][1]),bi=parseFloat(ln[yo][2]);break;case Jo:No=(to?"<":"(")+ln[yo]+(to?">":")"),Bs=Wn(de),bi=Fi(We)}Zo!==void 0&&Zo[yo]!==void 0&&(Oo=Zo[yo]+` Tw
`),yo===0?A.push(Oo+Cr(Bs,bi,qr)+No):Do===Jo?A.push(Oo+No):Do===Ro&&A.push(Oo+Cr(Bs,bi,qr)+No)}A=Do===Jo?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var us=`BT
/`;return us+=Qt+" "+qe+` Tf
`,us+=Ve(qe*vr)+` TL
`,us+=Mo+`
`,us+=Hi,us+=A,le(us+="ET"),E[Qt]=!0,Jr};var po=b.__private__.clip=b.clip=function(A){return le(A==="evenodd"?"W*":"W"),this};b.clipEvenOdd=function(){return po("evenodd")},b.__private__.discardPath=b.discardPath=function(){return le("n"),this};var Or=b.__private__.isValidStyle=function(A){var de=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(de=!0),de};b.__private__.setDefaultPathOperation=b.setDefaultPathOperation=function(A){return Or(A)&&(v=A),this};var Nl=b.__private__.getStyle=b.getStyle=function(A){var de=v;switch(A){case"D":case"S":de="S";break;case"F":de="f";break;case"FD":case"DF":de="B";break;case"f":case"f*":case"B":case"B*":de=A}return de},Aa=b.close=function(){return le("h"),this};b.stroke=function(){return le("S"),this},b.fill=function(A){return Ma("f",A),this},b.fillEvenOdd=function(A){return Ma("f*",A),this},b.fillStroke=function(A){return Ma("B",A),this},b.fillStrokeEvenOdd=function(A){return Ma("B*",A),this};var Ma=function(A,de){Bi(de)==="object"?Rl(de,A):le(A)},go=function(A){A===null||ge===W.ADVANCED&&A===void 0||(A=Nl(A),le(A))};function ha(A,de,We,ut,Ct){var zt=new Dh(de||this.boundingBox,We||this.xStep,ut||this.yStep,this.gState,Ct||this.matrix);zt.stream=this.stream;var ln=A+"$$"+this.cloneIndex+++"$$";return Gr(ln,zt),zt}var Rl=function(A,de){var We=On[A.key],ut=et[We];if(ut instanceof Kc)le("q"),le(Za(de)),ut.gState&&b.setGState(ut.gState),le(A.matrix.toString()+" cm"),le("/"+We+" sh"),le("Q");else if(ut instanceof Dh){var Ct=new Fn(1,0,0,-1,0,Ho());A.matrix&&(Ct=Ct.multiply(A.matrix||Lr),We=ha.call(ut,A.key,A.boundingBox,A.xStep,A.yStep,Ct).id),le("q"),le("/Pattern cs"),le("/"+We+" scn"),ut.gState&&b.setGState(ut.gState),le(de),le("Q")}},Za=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},or=b.moveTo=function(A,de){return le(Ve(D(A))+" "+Ve(z(de))+" m"),this},_r=b.lineTo=function(A,de){return le(Ve(D(A))+" "+Ve(z(de))+" l"),this},fa=b.curveTo=function(A,de,We,ut,Ct,zt){return le([Ve(D(A)),Ve(z(de)),Ve(D(We)),Ve(z(ut)),Ve(D(Ct)),Ve(z(zt)),"c"].join(" ")),this};b.__private__.line=b.line=function(A,de,We,ut,Ct){if(isNaN(A)||isNaN(de)||isNaN(We)||isNaN(ut)||!Or(Ct))throw new Error("Invalid arguments passed to jsPDF.line");return ge===W.COMPAT?this.lines([[We-A,ut-de]],A,de,[1,1],Ct||"S"):this.lines([[We-A,ut-de]],A,de,[1,1]).stroke()},b.__private__.lines=b.lines=function(A,de,We,ut,Ct,zt){var ln,Ln,En,Hn,nr,mr,gi,qr,Jr,ji,Hi,to;if(typeof A=="number"&&(to=We,We=de,de=A,A=to),ut=ut||[1,1],zt=zt||!1,isNaN(de)||isNaN(We)||!Array.isArray(A)||!Array.isArray(ut)||!Or(Ct)||typeof zt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(or(de,We),ln=ut[0],Ln=ut[1],Hn=A.length,ji=de,Hi=We,En=0;En<Hn;En++)(nr=A[En]).length===2?(ji=nr[0]*ln+ji,Hi=nr[1]*Ln+Hi,_r(ji,Hi)):(mr=nr[0]*ln+ji,gi=nr[1]*Ln+Hi,qr=nr[2]*ln+ji,Jr=nr[3]*Ln+Hi,ji=nr[4]*ln+ji,Hi=nr[5]*Ln+Hi,fa(mr,gi,qr,Jr,ji,Hi));return zt&&Aa(),go(Ct),this},b.path=function(A){for(var de=0;de<A.length;de++){var We=A[de],ut=We.c;switch(We.op){case"m":or(ut[0],ut[1]);break;case"l":_r(ut[0],ut[1]);break;case"c":fa.apply(this,ut);break;case"h":Aa()}}return this},b.__private__.rect=b.rect=function(A,de,We,ut,Ct){if(isNaN(A)||isNaN(de)||isNaN(We)||isNaN(ut)||!Or(Ct))throw new Error("Invalid arguments passed to jsPDF.rect");return ge===W.COMPAT&&(ut=-ut),le([Ve(D(A)),Ve(z(de)),Ve(D(We)),Ve(D(ut)),"re"].join(" ")),go(Ct),this},b.__private__.triangle=b.triangle=function(A,de,We,ut,Ct,zt,ln){if(isNaN(A)||isNaN(de)||isNaN(We)||isNaN(ut)||isNaN(Ct)||isNaN(zt)||!Or(ln))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[We-A,ut-de],[Ct-We,zt-ut],[A-Ct,de-zt]],A,de,[1,1],ln,!0),this},b.__private__.roundedRect=b.roundedRect=function(A,de,We,ut,Ct,zt,ln){if(isNaN(A)||isNaN(de)||isNaN(We)||isNaN(ut)||isNaN(Ct)||isNaN(zt)||!Or(ln))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ln=4/3*(Math.SQRT2-1);return Ct=Math.min(Ct,.5*We),zt=Math.min(zt,.5*ut),this.lines([[We-2*Ct,0],[Ct*Ln,0,Ct,zt-zt*Ln,Ct,zt],[0,ut-2*zt],[0,zt*Ln,-Ct*Ln,zt,-Ct,zt],[2*Ct-We,0],[-Ct*Ln,0,-Ct,-zt*Ln,-Ct,-zt],[0,2*zt-ut],[0,-zt*Ln,Ct*Ln,-zt,Ct,-zt]],A+Ct,de,[1,1],ln,!0),this},b.__private__.ellipse=b.ellipse=function(A,de,We,ut,Ct){if(isNaN(A)||isNaN(de)||isNaN(We)||isNaN(ut)||!Or(Ct))throw new Error("Invalid arguments passed to jsPDF.ellipse");var zt=4/3*(Math.SQRT2-1)*We,ln=4/3*(Math.SQRT2-1)*ut;return or(A+We,de),fa(A+We,de-ln,A+zt,de-ut,A,de-ut),fa(A-zt,de-ut,A-We,de-ln,A-We,de),fa(A-We,de+ln,A-zt,de+ut,A,de+ut),fa(A+zt,de+ut,A+We,de+ln,A+We,de),go(Ct),this},b.__private__.circle=b.circle=function(A,de,We,ut){if(isNaN(A)||isNaN(de)||isNaN(We)||!Or(ut))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,de,We,We,ut)},b.setFont=function(A,de,We){return We&&(de=Ye(de,We)),Qt=As(A,de,{disableWarning:!1}),this};var iu=b.__private__.getFont=b.getFont=function(){return on[As.apply(b,arguments)]};b.__private__.getFontList=b.getFontList=function(){var A,de,We={};for(A in Bn)if(Bn.hasOwnProperty(A))for(de in We[A]=[],Bn[A])Bn[A].hasOwnProperty(de)&&We[A].push(de);return We},b.addFont=function(A,de,We,ut,Ct){var zt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&zt.indexOf(arguments[3])!==-1?Ct=arguments[3]:arguments[3]&&zt.indexOf(arguments[3])==-1&&(We=Ye(We,ut)),Ct=Ct||"Identity-H",ps.call(this,A,de,We,Ct)};var Ka,fl=e.lineWidth||.200025,ka=b.__private__.getLineWidth=b.getLineWidth=function(){return fl},Ja=b.__private__.setLineWidth=b.setLineWidth=function(A){return fl=A,le(Ve(D(A))+" w"),this};b.__private__.setLineDash=fr.API.setLineDash=fr.API.setLineDashPattern=function(A,de){if(A=A||[],de=de||0,isNaN(de)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(We){return Ve(D(We))}).join(" "),de=Ve(D(de)),le("["+A+"] "+de+" d"),this};var dl=b.__private__.getLineHeight=b.getLineHeight=function(){return qe*Ka};b.__private__.getLineHeight=b.getLineHeight=function(){return qe*Ka};var Sr=b.__private__.setLineHeightFactor=b.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Ka=A),this},Ii=b.__private__.getLineHeightFactor=b.getLineHeightFactor=function(){return Ka};Sr(e.lineHeight);var Wn=b.__private__.getHorizontalCoordinate=function(A){return D(A)},Fi=b.__private__.getVerticalCoordinate=function(A){return ge===W.ADVANCED?A:Gn[Ee].mediaBox.topRightY-Gn[Ee].mediaBox.bottomLeftY-D(A)},Ta=b.__private__.getHorizontalCoordinateString=b.getHorizontalCoordinateString=function(A){return Ve(Wn(A))},Go=b.__private__.getVerticalCoordinateString=b.getVerticalCoordinateString=function(A){return Ve(Fi(A))},yi=e.strokeColor||"0 G";b.__private__.getStrokeColor=b.getDrawColor=function(){return Di(yi)},b.__private__.setStrokeColor=b.setDrawColor=function(A,de,We,ut){return yi=Qi({ch1:A,ch2:de,ch3:We,ch4:ut,pdfColorType:"draw",precision:2}),le(yi),this};var pl=e.fillColor||"0 g";b.__private__.getFillColor=b.getFillColor=function(){return Di(pl)},b.__private__.setFillColor=b.setFillColor=function(A,de,We,ut){return pl=Qi({ch1:A,ch2:de,ch3:We,ch4:ut,pdfColorType:"fill",precision:2}),le(pl),this};var Mo=e.textColor||"0 g",Ya=b.__private__.getTextColor=b.getTextColor=function(){return Di(Mo)};b.__private__.setTextColor=b.setTextColor=function(A,de,We,ut){return Mo=Qi({ch1:A,ch2:de,ch3:We,ch4:ut,pdfColorType:"text",precision:3}),this};var Xa=e.charSpace,uo=b.__private__.getCharSpace=b.getCharSpace=function(){return parseFloat(Xa||0)};b.__private__.setCharSpace=b.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xa=A,this};var Qa=0;b.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},b.__private__.setLineCap=b.setLineCap=function(A){var de=b.CapJoinStyles[A];if(de===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qa=de,le(de+" J"),this};var Zr=0;b.__private__.setLineJoin=b.setLineJoin=function(A){var de=b.CapJoinStyles[A];if(de===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zr=de,le(de+" j"),this},b.__private__.setLineMiterLimit=b.__private__.setMiterLimit=b.setLineMiterLimit=b.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(Ve(D(A))+" M"),this},b.GState=vp,b.setGState=function(A){(A=typeof A=="string"?Nn[mn[A]]:su(null,A)).equals(Pn)||(le("/"+A.id+" gs"),Pn=A)};var su=function(A,de){if(!A||!mn[A]){var We=!1;for(var ut in Nn)if(Nn.hasOwnProperty(ut)&&Nn[ut].equals(de)){We=!0;break}if(We)de=Nn[ut];else{var Ct="GS"+(Object.keys(Nn).length+1).toString(10);Nn[Ct]=de,de.id=Ct}return A&&(mn[A]=de.id),Dt.publish("addGState",de),de}};b.addGState=function(A,de){return su(A,de),this},b.saveGraphicsState=function(){return le("q"),kn.push({key:Qt,size:qe,color:Mo}),this},b.restoreGraphicsState=function(){le("Q");var A=kn.pop();return Qt=A.key,qe=A.size,Mo=A.color,Pn=null,this},b.setCurrentTransformationMatrix=function(A){return le(A.toString()+" cm"),this},b.comment=function(A){return le("#"+A),this};var as=function(A,de){var We=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return We},set:function(zt){isNaN(zt)||(We=parseFloat(zt))}});var ut=de||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ut},set:function(zt){isNaN(zt)||(ut=parseFloat(zt))}});var Ct="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ct},set:function(zt){Ct=zt.toString()}}),this},mo=function(A,de,We,ut){as.call(this,A,de),this.type="rect";var Ct=We||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ct},set:function(ln){isNaN(ln)||(Ct=parseFloat(ln))}});var zt=ut||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return zt},set:function(ln){isNaN(ln)||(zt=parseFloat(ln))}}),this},el=function(){this.page=zr,this.currentPage=Ee,this.pages=Pe.slice(0),this.pagesContext=Gn.slice(0),this.x=wt,this.y=He,this.matrix=Kt,this.width=Kr(Ee),this.height=Ho(Ee),this.outputDestination=re,this.id="",this.objectNumber=-1};el.prototype.restore=function(){zr=this.page,Ee=this.currentPage,Gn=this.pagesContext,Pe=this.pages,wt=this.x,He=this.y,Kt=this.matrix,eo(Ee,this.width),zi(Ee,this.height),re=this.outputDestination};var vo=function(A,de,We,ut,Ct){Ri.push(new el),zr=Ee=0,Pe=[],wt=A,He=de,Kt=Ct,oi([We,ut])},Ba=function(A){if(hi[A])Ri.pop().restore();else{var de=new el,We="Xo"+(Object.keys(lr).length+1).toString(10);de.id=We,hi[A]=We,lr[We]=de,Dt.publish("addFormObject",de),Ri.pop().restore()}};for(var Na in b.beginFormObject=function(A,de,We,ut,Ct){return vo(A,de,We,ut,Ct),this},b.endFormObject=function(A){return Ba(A),this},b.doFormObject=function(A,de){var We=lr[hi[A]];return le("q"),le(de.toString()+" cm"),le("/"+We.id+" Do"),le("Q"),this},b.getFormObject=function(A){var de=lr[hi[A]];return{x:de.x,y:de.y,width:de.width,height:de.height,matrix:de.matrix}},b.save=function(A,de){return A=A||"generated.pdf",(de=de||{}).returnPromise=de.returnPromise||!1,de.returnPromise===!1?(Hc(Vo(Li()),A),typeof Hc.unload=="function"&&dr.setTimeout&&setTimeout(Hc.unload,911),this):new Promise(function(We,ut){try{var Ct=Hc(Vo(Li()),A);typeof Hc.unload=="function"&&dr.setTimeout&&setTimeout(Hc.unload,911),We(Ct)}catch(zt){ut(zt.message)}})},fr.API)fr.API.hasOwnProperty(Na)&&(Na==="events"&&fr.API.events.length?function(A,de){var We,ut,Ct;for(Ct=de.length-1;Ct!==-1;Ct--)We=de[Ct][0],ut=de[Ct][1],A.subscribe.apply(A,[We].concat(typeof ut=="function"?[ut]:ut))}(Dt,fr.API.events):b[Na]=fr.API[Na]);var Kr=b.getPageWidth=function(A){return(Gn[A=A||Ee].mediaBox.topRightX-Gn[A].mediaBox.bottomLeftX)/Zt},eo=b.setPageWidth=function(A,de){Gn[A].mediaBox.topRightX=de*Zt+Gn[A].mediaBox.bottomLeftX},Ho=b.getPageHeight=function(A){return(Gn[A=A||Ee].mediaBox.topRightY-Gn[A].mediaBox.bottomLeftY)/Zt},zi=b.setPageHeight=function(A,de){Gn[A].mediaBox.topRightY=de*Zt+Gn[A].mediaBox.bottomLeftY};return b.internal={pdfEscape:$r,getStyle:Nl,getFont:iu,getFontSize:rt,getCharSpace:uo,getTextColor:Ya,getLineHeight:dl,getLineHeightFactor:Ii,getLineWidth:ka,write:Ue,getHorizontalCoordinate:Wn,getVerticalCoordinate:Fi,getCoordinateString:Ta,getVerticalCoordinateString:Go,collections:{},newObject:Qn,newAdditionalObject:Ai,newObjectDeferred:kt,newObjectDeferredBegin:Ei,getFilters:Yn,putStream:Mi,events:Dt,scaleFactor:Zt,pageSize:{getWidth:function(){return Kr(Ee)},setWidth:function(A){eo(Ee,A)},getHeight:function(){return Ho(Ee)},setHeight:function(A){zi(Ee,A)}},encryptionOptions:_,encryption:ts,getEncryptor:ru,output:ca,getNumberOfPages:vi,pages:Pe,out:le,f2:ce,f3:H,getPageInfo:hl,getPageInfoByObjId:ir,getCurrentPageInfo:ur,getPDFVersion:$,Point:as,Rectangle:mo,Matrix:Fn,hasHotfix:Wa},Object.defineProperty(b.internal.pageSize,"width",{get:function(){return Kr(Ee)},set:function(A){eo(Ee,A)},enumerable:!0,configurable:!0}),Object.defineProperty(b.internal.pageSize,"height",{get:function(){return Ho(Ee)},set:function(A){zi(Ee,A)},enumerable:!0,configurable:!0}),tr.call(b,Ce),Qt="F1",Qs(i,t),Dt.publish("initialized"),b}Nh.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Nh.prototype.toHexString=function(e){return e.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Nh.prototype.hexToBytes=function(e){for(var n=[],t=0;t<e.length;t+=2)n.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return n.join("")},Nh.prototype.processOwnerPassword=function(e,n){return Gg(Vg(n).substr(0,5),e)},Nh.prototype.encryptor=function(e,n){var t=Vg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&n,n>>8&255)).substr(0,10);return function(r){return Gg(t,r)}},vp.prototype.equals=function(e){var n,t="id,objectNumber,equals";if(!e||Bi(e)!==Bi(this))return!1;var r=0;for(n in this)if(!(t.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!e.hasOwnProperty(n)||this[n]!==e[n])return!1;r++}for(n in e)e.hasOwnProperty(n)&&t.indexOf(n)<0&&r--;return r===0},fr.API={events:[]},fr.version="2.5.2";var Os=fr.API,Pm=1,ch=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mh=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},br=function(e){return e.toFixed(2)},hc=function(e){return e.toFixed(5)};Os.__acroform__={};var Ha=function(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e},Dy=function(e){return e*Pm},gu=function(e){var n=new Ib,t=jn.internal.getHeight(e)||0,r=jn.internal.getWidth(e)||0;return n.BBox=[0,0,Number(br(r)),Number(br(t))],n},J7=Os.__acroform__.setBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<n},Y7=Os.__acroform__.clearBit=function(e,n){if(e=e||0,n=n||0,isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<n)},X7=Os.__acroform__.getBit=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<n?1:0},Ws=Os.__acroform__.getBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return X7(e,n-1)},Zs=Os.__acroform__.setBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return J7(e,n-1)},Ks=Os.__acroform__.clearBitForPdf=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Y7(e,n-1)},Q7=Os.__acroform__.calculateCoordinates=function(e,n){var t=n.internal.getHorizontalCoordinate,r=n.internal.getVerticalCoordinate,i=e[0],o=e[1],l=e[2],h=e[3],g={};return g.lowerLeft_X=t(i)||0,g.lowerLeft_Y=r(o+h)||0,g.upperRight_X=t(i+l)||0,g.upperRight_Y=r(o)||0,[Number(br(g.lowerLeft_X)),Number(br(g.lowerLeft_Y)),Number(br(g.upperRight_X)),Number(br(g.upperRight_Y))]},eN=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var n=[],t=e._V||e.DV,r=Hg(e,t),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(e.scope.__private__.encodeColorString(e.color)),n.push("/"+i+" "+br(r.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(r.text),n.push("ET"),n.push("Q"),n.push("EMC");var o=gu(e);return o.scope=e.scope,o.stream=n.join(`
`),o}},Hg=function(e,n){var t=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(n=(n=n.substr(0,1)=="("?n.substr(1):n).substr(n.length-1)==")"?n.substr(0,n.length-1):n).split(" ");i=e.multiline?i.map(function(H){return H.split(`
`)}):i.map(function(H){return[H]});var o=t,l=jn.internal.getHeight(e)||0;l=l<0?-l:l;var h=jn.internal.getWidth(e)||0;h=h<0?-h:h;var g=function(H,D,V){if(H+1<i.length){var z=D+" "+i[H+1][0];return Td(z,e,V).width<=h-4}return!1};o++;e:for(;o>0;){n="",o--;var v,_,x=Td("3",e,o).height,E=e.multiline?l-o:(l-x)/2,b=E+=2,R=0,$=0,Q=0;if(o<=0){n=`(...) Tj
`,n+="% Width of Text: "+Td(n,e,o=12).width+", FieldWidth:"+h+`
`;break}for(var I="",W=0,ge=0;ge<i.length;ge++)if(i.hasOwnProperty(ge)){var Se=!1;if(i[ge].length!==1&&Q!==i[ge].length-1){if((x+2)*(W+2)+2>l)continue e;I+=i[ge][Q],Se=!0,$=ge,ge--}else{I=(I+=i[ge][Q]+" ").substr(I.length-1)==" "?I.substr(0,I.length-1):I;var De=parseInt(ge),Ye=g(De,I,o),Ve=ge>=i.length-1;if(Ye&&!Ve){I+=" ",Q=0;continue}if(Ye||Ve){if(Ve)$=De;else if(e.multiline&&(x+2)*(W+2)+2>l)continue e}else{if(!e.multiline||(x+2)*(W+2)+2>l)continue e;$=De}}for(var O="",K=R;K<=$;K++){var ce=i[K];if(e.multiline){if(K===$){O+=ce[Q]+" ",Q=(Q+1)%ce.length;continue}if(K===R){O+=ce[ce.length-1]+" ";continue}}O+=ce[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,_=Td(O,e,o).width,e.textAlign){case"right":v=h-_-2;break;case"center":v=(h-_)/2;break;case"left":default:v=2}n+=br(v)+" "+br(b)+` Td
`,n+="("+ch(O)+`) Tj
`,n+=-br(v)+` 0 Td
`,b=-(o+2),_=0,R=Se?$:$+1,W++,I=""}break}return r.text=n,r.fontSize=o,r},Td=function(e,n,t){var r=n.scope.internal.getFont(n.fontName,n.fontStyle),i=n.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:n.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:i}},tN={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},nN=function(e,n){var t={type:"reference",object:e};n.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&n.internal.getPageInfo(e.page).pageContext.annotations.push(t)},rN=function(e,n){for(var t in e)if(e.hasOwnProperty(t)){var r=t,i=e[t];n.internal.newObjectDeferredBegin(i.objId,!0),Bi(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[r]}},iN=function(e,n){if(n.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(tu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(tN)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Pm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Fb,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.objId=void 0,o.hasAnnotation&&nN(o,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(r,i){var o=!r;for(var l in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(l)){var h=r[l],g=[],v=h.Rect;if(h.Rect&&(h.Rect=Q7(h.Rect,i)),i.internal.newObjectDeferredBegin(h.objId,!0),h.DA=jn.createDefaultAppearanceStream(h),Bi(h)==="object"&&typeof h.getKeyValueListForStream=="function"&&(g=h.getKeyValueListForStream()),h.Rect=v,h.hasAppearanceStream&&!h.appearanceStreamContent){var _=eN(h);g.push({key:"AP",value:"<</N "+_+">>"}),i.internal.acroformPlugin.xForms.push(_)}if(h.appearanceStreamContent){var x="";for(var E in h.appearanceStreamContent)if(h.appearanceStreamContent.hasOwnProperty(E)){var b=h.appearanceStreamContent[E];if(x+="/"+E+" ",x+="<<",Object.keys(b).length>=1||Array.isArray(b)){for(var l in b)if(b.hasOwnProperty(l)){var R=b[l];typeof R=="function"&&(R=R.call(i,h)),x+="/"+l+" "+R+" ",i.internal.acroformPlugin.xForms.indexOf(R)>=0||i.internal.acroformPlugin.xForms.push(R)}}else typeof(R=b)=="function"&&(R=R.call(i,h)),x+="/"+l+" "+R,i.internal.acroformPlugin.xForms.indexOf(R)>=0||i.internal.acroformPlugin.xForms.push(R);x+=">>"}g.push({key:"AP",value:`<<
`+x+">>"})}i.internal.putStream({additionalKeyValues:g,objectId:h.objId}),i.internal.out("endobj")}o&&rN(i.internal.acroformPlugin.xForms,i)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},Ob=Os.__acroform__.arrayToPdfArray=function(e,n,t){var r=function(l){return l};if(Array.isArray(e)){for(var i="[",o=0;o<e.length;o++)switch(o!==0&&(i+=" "),Bi(e[o])){case"boolean":case"number":case"object":i+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(n!==void 0&&t&&(r=t.internal.getEncryptor(n)),i+="("+ch(r(e[o].toString()))+")"):i+=e[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Y0=function(e,n,t){var r=function(i){return i};return n!==void 0&&t&&(r=t.internal.getEncryptor(n)),(e=e||"").toString(),e="("+ch(r(e))+")"},Lu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Lu.prototype.toString=function(){return this.objId+" 0 R"},Lu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Lu.prototype.getKeyValueListForStream=function(){var e=[],n=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in n)if(Object.getOwnPropertyDescriptor(this,n[t]).configurable===!1){var r=n[t],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:Ob(i,this.objId,this.scope)}):i instanceof Lu?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:r,value:i}))}return e};var Ib=function(){Lu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Ha(Ib,Lu);var Fb=function(){Lu.call(this);var e,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ch(t(e))+")"}},set:function(t){e=t}})};Ha(Fb,Lu);var tu=function e(){Lu.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute F supplied.');n=I}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ws(n,3)},set:function(I){I?this.F=Zs(n,3):this.F=Ks(n,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(I){if(isNaN(I))throw new Error('Invalid value "'+I+'" for attribute Ff supplied.');t=I}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(I){r=I!==void 0?I:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(I){r[0]=I}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(I){r[1]=I}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(I){r[2]=I}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(I){r[3]=I}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(I){switch(I){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=I;break;default:throw new Error('Invalid value "'+I+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof yp)return;o="FieldObject"+e.FieldNum++}var I=function(W){return W};return this.scope&&(I=this.scope.internal.getEncryptor(this.objId)),"("+ch(I(o))+")"},set:function(I){o=I.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(I){o=I}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(I){l=I}});var h="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return h},set:function(I){h=I}});var g=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return g},set:function(I){g=I}});var v=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return v===void 0?50/Pm:v},set:function(I){v=I}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(I){_=I}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof yp||this instanceof ih))return Y0(x,this.objId,this.scope)},set:function(I){I=I.toString(),x=I}});var E=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof So?E:Y0(E,this.objId,this.scope)},set:function(I){I=I.toString(),E=this instanceof So?I:I.substr(0,1)==="("?Mh(I.substr(1,I.length-2)):Mh(I)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof So?Mh(E.substr(1,E.length-1)):E},set:function(I){I=I.toString(),E=this instanceof So?"/"+I:I}});var b=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(b)return b},set:function(I){this.V=I}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof So?b:Y0(b,this.objId,this.scope)},set:function(I){I=I.toString(),b=this instanceof So?I:I.substr(0,1)==="("?Mh(I.substr(1,I.length-2)):Mh(I)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof So?Mh(b.substr(1,b.length-1)):b},set:function(I){I=I.toString(),b=this instanceof So?"/"+I:I}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var R,$=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return $},set:function(I){I=!!I,$=I}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(R)return R},set:function(I){R=I}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,1)},set:function(I){I?this.Ff=Zs(this.Ff,1):this.Ff=Ks(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,2)},set:function(I){I?this.Ff=Zs(this.Ff,2):this.Ff=Ks(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,3)},set:function(I){I?this.Ff=Zs(this.Ff,3):this.Ff=Ks(this.Ff,3)}});var Q=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(Q!==null)return Q},set:function(I){if([0,1,2].indexOf(I)===-1)throw new Error('Invalid value "'+I+'" for attribute Q supplied.');Q=I}}),Object.defineProperty(this,"textAlign",{get:function(){var I;switch(Q){case 0:default:I="left";break;case 1:I="center";break;case 2:I="right"}return I},configurable:!0,enumerable:!0,set:function(I){switch(I){case"right":case 2:Q=2;break;case"center":case 1:Q=1;break;case"left":case 0:default:Q=0}}})};Ha(tu,Lu);var jh=function(){tu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Ob(n,this.objId,this.scope)},set:function(t){var r,i;i=[],typeof(r=t)=="string"&&(i=function(o,l,h){h||(h=1);for(var g,v=[];g=l.exec(o);)v.push(g[h]);return v}(r,/\((.*?)\)/g)),n=i}}),this.getOptions=function(){return n},this.setOptions=function(t){n=t,this.sort&&n.sort()},this.addOption=function(t){t=(t=t||"").toString(),n.push(t),this.sort&&n.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();n.indexOf(t)!==-1&&(n.splice(n.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,18)},set:function(t){t?this.Ff=Zs(this.Ff,18):this.Ff=Ks(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Zs(this.Ff,19):this.Ff=Ks(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,20)},set:function(t){t?(this.Ff=Zs(this.Ff,20),n.sort()):this.Ff=Ks(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,22)},set:function(t){t?this.Ff=Zs(this.Ff,22):this.Ff=Ks(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,23)},set:function(t){t?this.Ff=Zs(this.Ff,23):this.Ff=Ks(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,27)},set:function(t){t?this.Ff=Zs(this.Ff,27):this.Ff=Ks(this.Ff,27)}}),this.hasAppearanceStream=!1};Ha(jh,tu);var Uh=function(){jh.call(this),this.fontName="helvetica",this.combo=!1};Ha(Uh,jh);var $h=function(){Uh.call(this),this.combo=!0};Ha($h,Uh);var Wd=function(){$h.call(this),this.edit=!0};Ha(Wd,$h);var So=function(){tu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,15)},set:function(t){t?this.Ff=Zs(this.Ff,15):this.Ff=Ks(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,16)},set:function(t){t?this.Ff=Zs(this.Ff,16):this.Ff=Ks(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,17)},set:function(t){t?this.Ff=Zs(this.Ff,17):this.Ff=Ks(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,26)},set:function(t){t?this.Ff=Zs(this.Ff,26):this.Ff=Ks(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var r,i=[];for(r in i.push("<<"),n)i.push("/"+r+" ("+ch(t(n[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(t){Bi(t)==="object"&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){typeof t=="string"&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Ha(So,tu);var Zd=function(){So.call(this),this.pushButton=!0};Ha(Zd,So);var qh=function(){So.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n!==void 0?n:[]}})};Ha(qh,So);var yp=function(){var e,n;tu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(i){n=i}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(h){return h};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,l=[];for(o in l.push("<<"),r)l.push("/"+o+" ("+ch(i(r[o]))+")");return l.push(">>"),l.join(`
`)},set:function(i){Bi(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(i){t="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=jn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ha(yp,tu),qh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var t=this.Kids[n];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},qh.prototype.createOption=function(e){var n=new yp;return n.Parent=this,n.optionName=e,this.Kids.push(n),sN.call(this.scope,n),n};var Kd=function(){So.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=jn.CheckBox.createAppearanceStream()};Ha(Kd,So);var ih=function(){tu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,13)},set:function(n){n?this.Ff=Zs(this.Ff,13):this.Ff=Ks(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,21)},set:function(n){n?this.Ff=Zs(this.Ff,21):this.Ff=Ks(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,23)},set:function(n){n?this.Ff=Zs(this.Ff,23):this.Ff=Ks(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,24)},set:function(n){n?this.Ff=Zs(this.Ff,24):this.Ff=Ks(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,25)},set:function(n){n?this.Ff=Zs(this.Ff,25):this.Ff=Ks(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,26)},set:function(n){n?this.Ff=Zs(this.Ff,26):this.Ff=Ks(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){Number.isInteger(n)&&(e=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ha(ih,tu);var Jd=function(){ih.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,14)},set:function(e){e?this.Ff=Zs(this.Ff,14):this.Ff=Ks(this.Ff,14)}}),this.password=!0};Ha(Jd,ih);var jn={CheckBox:{createAppearanceStream:function(){return{N:{On:jn.CheckBox.YesNormal},D:{On:jn.CheckBox.YesPushDown,Off:jn.CheckBox.OffPushDown}}},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),o=Hg(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+br(jn.internal.getWidth(e))+" "+br(jn.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+br(o.fontSize)+" Tf "+i),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),n.stream=t.join(`
`),n},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],o=jn.internal.getHeight(e),l=jn.internal.getWidth(e),h=Hg(e,e.caption);return i.push("1 g"),i.push("0 0 "+br(l)+" "+br(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+br(l-1)+" "+br(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+t+" "+br(h.fontSize)+" Tf "+r),i.push(h.text),i.push("ET"),i.push("Q"),n.stream=i.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+br(jn.internal.getWidth(e))+" "+br(jn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}},RadioButton:{Circle:{createAppearanceStream:function(e){var n={D:{Off:jn.RadioButton.Circle.OffPushDown},N:{}};return n.N[e]=jn.RadioButton.Circle.YesNormal,n.D[e]=jn.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=[],r=jn.internal.getWidth(e)<=jn.internal.getHeight(e)?jn.internal.getWidth(e)/4:jn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=jn.internal.Bezier_C,o=Number((r*i).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+hc(jn.internal.getWidth(e)/2)+" "+hc(jn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],r=jn.internal.getWidth(e)<=jn.internal.getHeight(e)?jn.internal.getWidth(e)/4:jn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*jn.internal.Bezier_C).toFixed(5)),l=Number((r*jn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hc(jn.internal.getWidth(e)/2)+" "+hc(jn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+hc(jn.internal.getWidth(e)/2)+" "+hc(jn.internal.getHeight(e)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),t.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),t.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),t.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[],r=jn.internal.getWidth(e)<=jn.internal.getHeight(e)?jn.internal.getWidth(e)/4:jn.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),o=Number((i*jn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+hc(jn.internal.getWidth(e)/2)+" "+hc(jn.internal.getHeight(e)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),n.stream=t.join(`
`),n}},Cross:{createAppearanceStream:function(e){var n={D:{Off:jn.RadioButton.Cross.OffPushDown},N:{}};return n.N[e]=jn.RadioButton.Cross.YesNormal,n.D[e]=jn.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(e){var n=gu(e);n.scope=e.scope;var t=[],r=jn.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+br(jn.internal.getWidth(e)-2)+" "+br(jn.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(br(r.x1.x)+" "+br(r.x1.y)+" m"),t.push(br(r.x2.x)+" "+br(r.x2.y)+" l"),t.push(br(r.x4.x)+" "+br(r.x4.y)+" m"),t.push(br(r.x3.x)+" "+br(r.x3.y)+" l"),t.push("s"),t.push("Q"),n.stream=t.join(`
`),n},YesPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=jn.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+br(jn.internal.getWidth(e))+" "+br(jn.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+br(jn.internal.getWidth(e)-2)+" "+br(jn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(br(t.x1.x)+" "+br(t.x1.y)+" m"),r.push(br(t.x2.x)+" "+br(t.x2.y)+" l"),r.push(br(t.x4.x)+" "+br(t.x4.y)+" m"),r.push(br(t.x3.x)+" "+br(t.x3.y)+" l"),r.push("s"),r.push("Q"),n.stream=r.join(`
`),n},OffPushDown:function(e){var n=gu(e);n.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+br(jn.internal.getWidth(e))+" "+br(jn.internal.getHeight(e))+" re"),t.push("f"),n.stream=t.join(`
`),n}}},createDefaultAppearanceStream:function(e){var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+n+" "+e.fontSize+" Tf "+t}};jn.internal={Bezier_C:.551915024494,calculateCross:function(e){var n=jn.internal.getWidth(e),t=jn.internal.getHeight(e),r=Math.min(n,t);return{x1:{x:(n-r)/2,y:(t-r)/2+r},x2:{x:(n-r)/2+r,y:(t-r)/2},x3:{x:(n-r)/2,y:(t-r)/2},x4:{x:(n-r)/2+r,y:(t-r)/2+r}}}},jn.internal.getWidth=function(e){var n=0;return Bi(e)==="object"&&(n=Dy(e.Rect[2])),n},jn.internal.getHeight=function(e){var n=0;return Bi(e)==="object"&&(n=Dy(e.Rect[3])),n};var sN=Os.addField=function(e){if(iN(this,e),!(e instanceof tu))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=e).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Os.AcroFormChoiceField=jh,Os.AcroFormListBox=Uh,Os.AcroFormComboBox=$h,Os.AcroFormEditBox=Wd,Os.AcroFormButton=So,Os.AcroFormPushButton=Zd,Os.AcroFormRadioButton=qh,Os.AcroFormCheckBox=Kd,Os.AcroFormTextField=ih,Os.AcroFormPasswordField=Jd,Os.AcroFormAppearance=jn,Os.AcroForm={ChoiceField:jh,ListBox:Uh,ComboBox:$h,EditBox:Wd,Button:So,PushButton:Zd,RadioButton:qh,CheckBox:Kd,TextField:ih,PasswordField:Jd,Appearance:jn},fr.AcroForm={ChoiceField:jh,ListBox:Uh,ComboBox:$h,EditBox:Wd,Button:So,PushButton:Zd,RadioButton:qh,CheckBox:Kd,TextField:ih,PasswordField:Jd,Appearance:jn};fr.AcroForm;function zb(e){return e.reduce(function(n,t,r){return n[t]=r,n},{})}(function(e){e.__addimage__={};var n="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(H,D){var V,z,U,G,ue,ie=n;if((D=D||n)==="RGBA"||H.data!==void 0&&H.data instanceof Uint8ClampedArray&&"height"in H&&"width"in H)return"RGBA";if(Ye(H))for(ue in t)for(U=t[ue],V=0;V<U.length;V+=1){for(G=!0,z=0;z<U[V].length;z+=1)if(U[V][z]!==void 0&&U[V][z]!==H[z]){G=!1;break}if(G===!0){ie=ue;break}}else for(ue in t)for(U=t[ue],V=0;V<U.length;V+=1){for(G=!0,z=0;z<U[V].length;z+=1)if(U[V][z]!==void 0&&U[V][z]!==H.charCodeAt(z)){G=!1;break}if(G===!0){ie=ue;break}}return ie===n&&D!==n&&(ie=D),ie},i=function H(D){for(var V=this.internal.write,z=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:D.width}),G.push({key:"Height",value:D.height}),D.colorSpace===Q.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===Q.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)){for(var ue="",ie=0,Ae=D.transparency.length;ie<Ae;ie++)ue+=D.transparency[ie]+" "+D.transparency[ie]+" ";G.push({key:"Mask",value:"["+ue+"]"})}D.sMask!==void 0&&G.push({key:"SMask",value:D.objectId+1+" 0 R"});var Me=D.filter!==void 0?["/"+D.filter]:void 0;if(z({data:D.data,additionalKeyValues:G,alreadyAppliedFilters:Me,objectId:D.objectId}),V("endobj"),"sMask"in D&&D.sMask!==void 0){var st="/Predictor "+D.predictor+" /Colors 1 /BitsPerComponent "+D.bitsPerComponent+" /Columns "+D.width,X={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:D.bitsPerComponent,decodeParameters:st,data:D.sMask};"filter"in D&&(X.filter=D.filter),H.call(this,X)}if(D.colorSpace===Q.INDEXED){var Ee=this.internal.newObject();z({data:O(new Uint8Array(D.palette)),objectId:Ee}),V("endobj")}},o=function(){var H=this.internal.collections.addImage_images;for(var D in H)i.call(this,H[D])},l=function(){var H,D=this.internal.collections.addImage_images,V=this.internal.write;for(var z in D)V("/I"+(H=D[z]).index,H.objectId,"0","R")},h=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},g=function(){var H=this.internal.collections.addImage_images;return h.call(this),H},v=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(H){return typeof e["process"+H.toUpperCase()]=="function"},x=function(H){return Bi(H)==="object"&&H.nodeType===1},E=function(H,D){if(H.nodeName==="IMG"&&H.hasAttribute("src")){var V=""+H.getAttribute("src");if(V.indexOf("data:image/")===0)return Of(unescape(V).split("base64,").pop());var z=e.loadFile(V,!0);if(z!==void 0)return z}if(H.nodeName==="CANVAS"){if(H.width===0||H.height===0)throw new Error("Given canvas must have data. Canvas width: "+H.width+", height: "+H.height);var U;switch(D){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;case"JPEG":case"JPG":default:U="image/jpeg"}return Of(H.toDataURL(U,1).split("base64,").pop())}},b=function(H){var D=this.internal.collections.addImage_images;if(D){for(var V in D)if(H===D[V].alias)return D[V]}},R=function(H,D,V){return H||D||(H=-96,D=-96),H<0&&(H=-1*V.width*72/H/this.internal.scaleFactor),D<0&&(D=-1*V.height*72/D/this.internal.scaleFactor),H===0&&(H=D*V.width/V.height),D===0&&(D=H*V.height/V.width),[H,D]},$=function(H,D,V,z,U,G){var ue=R.call(this,V,z,U),ie=this.internal.getCoordinateString,Ae=this.internal.getVerticalCoordinateString,Me=g.call(this);if(V=ue[0],z=ue[1],Me[U.index]=U,G){G*=Math.PI/180;var st=Math.cos(G),X=Math.sin(G),Ee=function(Z){return Z.toFixed(4)},N=[Ee(st),Ee(X),Ee(-1*X),Ee(st),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,ie(H),Ae(D+z),"cm"].join(" ")),this.internal.write(N.join(" ")),this.internal.write([ie(V),"0","0",ie(z),"0","0","cm"].join(" "))):this.internal.write([ie(V),"0","0",ie(z),ie(H),Ae(D+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},Q=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},W=e.__addimage__.sHashCode=function(H){var D,V,z=0;if(typeof H=="string")for(V=H.length,D=0;D<V;D++)z=(z<<5)-z+H.charCodeAt(D),z|=0;else if(Ye(H))for(V=H.byteLength/2,D=0;D<V;D++)z=(z<<5)-z+H[D],z|=0;return z},ge=e.__addimage__.validateStringAsBase64=function(H){(H=H||"").toString().trim();var D=!0;return H.length===0&&(D=!1),H.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(H.substr(0,H.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(H.substr(-2))===!1&&(D=!1),D},Se=e.__addimage__.extractImageFromDataUrl=function(H){var D=(H=H||"").split("base64,"),V=null;if(D.length===2){var z=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(D[0]);Array.isArray(z)&&(V={mimeType:z[1],charset:z[2],data:D[1]})}return V},De=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(H){return De()&&H instanceof ArrayBuffer};var Ye=e.__addimage__.isArrayBufferView=function(H){return De()&&typeof Uint32Array<"u"&&(H instanceof Int8Array||H instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&H instanceof Uint8ClampedArray||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array)},Ve=e.__addimage__.binaryStringToUint8Array=function(H){for(var D=H.length,V=new Uint8Array(D),z=0;z<D;z++)V[z]=H.charCodeAt(z);return V},O=e.__addimage__.arrayBufferToBinaryString=function(H){for(var D="",V=Ye(H)?H:new Uint8Array(H),z=0;z<V.length;z+=8192)D+=String.fromCharCode.apply(null,V.subarray(z,z+8192));return D};e.addImage=function(){var H,D,V,z,U,G,ue,ie,Ae;if(typeof arguments[1]=="number"?(D=n,V=arguments[1],z=arguments[2],U=arguments[3],G=arguments[4],ue=arguments[5],ie=arguments[6],Ae=arguments[7]):(D=arguments[1],V=arguments[2],z=arguments[3],U=arguments[4],G=arguments[5],ue=arguments[6],ie=arguments[7],Ae=arguments[8]),Bi(H=arguments[0])==="object"&&!x(H)&&"imageData"in H){var Me=H;H=Me.imageData,D=Me.format||D||n,V=Me.x||V||0,z=Me.y||z||0,U=Me.w||Me.width||U,G=Me.h||Me.height||G,ue=Me.alias||ue,ie=Me.compression||ie,Ae=Me.rotation||Me.angle||Ae}var st=this.internal.getFilters();if(ie===void 0&&st.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(V)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var X=K.call(this,H,D,ue,ie);return $.call(this,V,z,U,G,X,Ae),this};var K=function(H,D,V,z){var U,G,ue;if(typeof H=="string"&&r(H)===n){H=unescape(H);var ie=ce(H,!1);(ie!==""||(ie=e.loadFile(H,!0))!==void 0)&&(H=ie)}if(x(H)&&(H=E(H,D)),D=r(H,D),!_(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((ue=V)==null||ue.length===0)&&(V=function(Ae){return typeof Ae=="string"||Ye(Ae)?W(Ae):Ye(Ae.data)?W(Ae.data):null}(H)),(U=b.call(this,V))||(De()&&(H instanceof Uint8Array||D==="RGBA"||(G=H,H=Ve(H))),U=this["process"+D.toUpperCase()](H,v.call(this),V,function(Ae){return Ae&&typeof Ae=="string"&&(Ae=Ae.toUpperCase()),Ae in e.image_compression?Ae:I.NONE}(z),G)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},ce=e.__addimage__.convertBase64ToBinaryString=function(H,D){var V;D=typeof D!="boolean"||D;var z,U="";if(typeof H=="string"){z=(V=Se(H))!==null?V.data:H;try{U=Of(z)}catch(G){if(D)throw ge(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};e.getImageProperties=function(H){var D,V,z="";if(x(H)&&(H=E(H)),typeof H=="string"&&r(H)===n&&((z=ce(H,!1))===""&&(z=e.loadFile(H)||""),H=z),V=r(H),!_(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(!De()||H instanceof Uint8Array||(H=Ve(H)),!(D=this["process"+V.toUpperCase()](H)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=V,D}})(fr.API),function(e){var n=function(t){if(t!==void 0&&t!="")return!0};fr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var r,i,o,l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString,g=this.internal.getPageInfoByObjId(t.objId),v=t.pageContext.annotations,_=!1,x=0;x<v.length&&!_;x++)switch((r=v[x]).type){case"link":(n(r.options.url)||n(r.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var E=0;E<v.length;E++){r=v[E];var b=this.internal.pdfEscape,R=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var $=this.internal.newAdditionalObject(),Q=this.internal.newAdditionalObject(),I=this.internal.getEncryptor($.objId),W=r.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+l(r.bounds.x)+" "+h(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w)+" "+h(r.bounds.y)+"] ")+"/Contents ("+b(I(r.contents))+")",o+=" /Popup "+Q.objId+" 0 R",o+=" /P "+g.objId+" 0 R",o+=" /T ("+b(I(W))+") >>",$.content=o;var ge=$.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+l(r.bounds.x+30)+" "+h(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w+30)+" "+h(r.bounds.y)+"] ")+" /Parent "+ge,r.open&&(o+=" /Open true"),o+=" >>",Q.content=o,this.internal.write($.objId,"0 R",Q.objId,"0 R");break;case"freetext":i="/Rect ["+l(r.bounds.x)+" "+h(r.bounds.y)+" "+l(r.bounds.x+r.bounds.w)+" "+h(r.bounds.y+r.bounds.h)+"] ";var Se=r.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+b(R(r.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Se+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(r.options.name){var De=this.annotations._nameMap[r.options.name];r.options.pageNumber=De.page,r.options.top=De.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",o="",r.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+b(R(r.options.url))+") >>";else if(r.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,o+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var Ye=h(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),o+=" /XYZ "+r.options.left+" "+Ye+" "+r.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},e.link=function(t,r,i,o,l){var h=this.internal.getCurrentPageInfo(),g=this.internal.getCoordinateString,v=this.internal.getVerticalCoordinateString;h.pageContext.annotations.push({finalBounds:{x:g(t),y:v(r),w:g(t+i),h:v(r+o)},options:l,type:"link"})},e.textWithLink=function(t,r,i,o){var l,h,g=this.getTextWidth(t),v=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){h=o.maxWidth;var _=this.splitTextToSize(t,h).length;l=Math.ceil(v*_)}else h=g,l=v;return this.text(t,r,i,o),i+=.2*v,o.align==="center"&&(r-=g/2),o.align==="right"&&(r-=g),this.link(r,i-v,h,l,o),g},e.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}}(fr.API),function(e){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function($){return n[$.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function($){return typeof $=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test($)},h=e.__arabicParser__.isArabicEndLetter=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length<=2},g=e.__arabicParser__.isArabicAlfLetter=function($){return l($)&&i.indexOf($.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=1};var v=e.__arabicParser__.arabicLetterHasFinalForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length>=3};var _=e.__arabicParser__.arabicLetterHasMedialForm=function($){return l($)&&o($)&&n[$.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function($){var Q=0,I=t,W="",ge=0;for(Q=0;Q<$.length;Q+=1)I[$.charCodeAt(Q)]!==void 0?(ge++,typeof(I=I[$.charCodeAt(Q)])=="number"&&(W+=String.fromCharCode(I),I=t,ge=0),Q===$.length-1&&(I=t,W+=$.charAt(Q-(ge-1)),Q-=ge-1,ge=0)):(I=t,W+=$.charAt(Q-ge),Q-=ge,ge=0);return W};e.__arabicParser__.isArabicDiacritic=function($){return $!==void 0&&r[$.charCodeAt(0)]!==void 0};var E=e.__arabicParser__.getCorrectForm=function($,Q,I){return l($)?o($)===!1?-1:!v($)||!l(Q)&&!l(I)||!l(I)&&h(Q)||h($)&&!l(Q)||h($)&&g(Q)||h($)&&h(Q)?0:_($)&&l(Q)&&!h(Q)&&l(I)&&v(I)?3:h($)||!l(I)?1:2:-1},b=function($){var Q=0,I=0,W=0,ge="",Se="",De="",Ye=($=$||"").split("\\s+"),Ve=[];for(Q=0;Q<Ye.length;Q+=1){for(Ve.push(""),I=0;I<Ye[Q].length;I+=1)ge=Ye[Q][I],Se=Ye[Q][I-1],De=Ye[Q][I+1],l(ge)?(W=E(ge,Se,De),Ve[Q]+=W!==-1?String.fromCharCode(n[ge.charCodeAt(0)][W]):ge):Ve[Q]+=ge;Ve[Q]=x(Ve[Q])}return Ve.join(" ")},R=e.__arabicParser__.processArabic=e.processArabic=function(){var $,Q=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,I=[];if(Array.isArray(Q)){var W=0;for(I=[],W=0;W<Q.length;W+=1)Array.isArray(Q[W])?I.push([b(Q[W][0]),Q[W][1],Q[W][2]]):I.push([b(Q[W])]);$=I}else $=b(Q);return typeof arguments[0]=="string"?$:(arguments[0].text=$,arguments[0])};e.events.push(["preProcessText",R])}(fr.API),fr.API.autoPrint=function(e){var n;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})}return this},function(e){var n=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(h){t=h}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(h){r=isNaN(h)||Number.isInteger(h)===!1||h<0?150:h,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(h){i=isNaN(h)||Number.isInteger(h)===!1||h<0?300:h,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(h){o=h}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(h){l=h}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(t,r){var i;if((t=t||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(fr.API),function(e){var n={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var g=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return g},set:function($){g=$}});var v=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return v},set:function($){v=$}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function($){_=$}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function($){x=$}});var E=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return E},set:function($){E=$}});var b=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return b},set:function($){b=$}});var R=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return R},set:function($){R=$}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(g){return r.call(this),this.internal.__cell__.headerFunction=typeof g=="function"?g:void 0,this},e.getTextDimensions=function(g,v){r.call(this);var _=(v=v||{}).fontSize||this.getFontSize(),x=v.font||this.getFont(),E=v.scaleFactor||this.internal.scaleFactor,b=0,R=0,$=0,Q=this;if(!Array.isArray(g)&&typeof g!="string"){if(typeof g!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");g=String(g)}var I=v.maxWidth;I>0?typeof g=="string"?g=this.splitTextToSize(g,I):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(ge,Se){return ge.concat(Q.splitTextToSize(Se,I))},[])):g=Array.isArray(g)?g:[g];for(var W=0;W<g.length;W++)b<($=this.getStringUnitWidth(g[W],{font:x})*_)&&(b=$);return b!==0&&(R=g.length),{w:b/=E,h:Math.max((R*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/E,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var g=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new o(g.left,g.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var g;g=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var v=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,x=this.internal.__cell__.margins||n,E=this.internal.__cell__.tableHeaderRow,b=this.internal.__cell__.printHeaders;return v.lineNumber!==void 0&&(v.lineNumber===g.lineNumber?(g.x=(v.x||0)+(v.width||0),g.y=v.y||0):v.y+v.height+g.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),g.y=x.top,b&&E&&(this.printHeaderRow(g.lineNumber,!0),g.y+=E[0].height)):g.y=v.y+v.height||g.y),g.text[0]!==void 0&&(this.rect(g.x,g.y,g.width,g.height,t===!0?"FD":void 0),g.align==="right"?this.text(g.text,g.x+g.width-_,g.y+_,{align:"right",baseline:"top"}):g.align==="center"?this.text(g.text,g.x+g.width/2,g.y+_,{align:"center",baseline:"top",maxWidth:g.width-_-_}):this.text(g.text,g.x+_,g.y+_,{align:"left",baseline:"top",maxWidth:g.width-_-_})),this.internal.__cell__.lastCell=g,this};e.table=function(g,v,_,x,E){if(r.call(this),!_)throw new Error("No data for PDF table.");var b,R,$,Q,I=[],W=[],ge=[],Se={},De={},Ye=[],Ve=[],O=(E=E||{}).autoSize||!1,K=E.printHeaders!==!1,ce=E.css&&E.css["font-size"]!==void 0?16*E.css["font-size"]:E.fontSize||12,H=E.margins||Object.assign({width:this.getPageWidth()},n),D=typeof E.padding=="number"?E.padding:3,V=E.headerBackgroundColor||"#c8c8c8",z=E.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=K,this.internal.__cell__.margins=H,this.internal.__cell__.table_font_size=ce,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=z,this.setFontSize(ce),x==null)W=I=Object.keys(_[0]),ge=I.map(function(){return"left"});else if(Array.isArray(x)&&Bi(x[0])==="object")for(I=x.map(function(Me){return Me.name}),W=x.map(function(Me){return Me.prompt||Me.name||""}),ge=x.map(function(Me){return Me.align||"left"}),b=0;b<x.length;b+=1)De[x[b].name]=x[b].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(W=I=x,ge=I.map(function(){return"left"}));if(O||Array.isArray(x)&&typeof x[0]=="string")for(b=0;b<I.length;b+=1){for(Se[Q=I[b]]=_.map(function(Me){return Me[Q]}),this.setFont(void 0,"bold"),Ye.push(this.getTextDimensions(W[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),R=Se[Q],this.setFont(void 0,"normal"),$=0;$<R.length;$+=1)Ye.push(this.getTextDimensions(R[$],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);De[Q]=Math.max.apply(null,Ye)+D+D,Ye=[]}if(K){var U={};for(b=0;b<I.length;b+=1)U[I[b]]={},U[I[b]].text=W[b],U[I[b]].align=ge[b];var G=h.call(this,U,De);Ve=I.map(function(Me){return new o(g,v,De[Me],G,U[Me].text,void 0,U[Me].align)}),this.setTableHeaderRow(Ve),this.printHeaderRow(1,!1)}var ue=x.reduce(function(Me,st){return Me[st.name]=st.align,Me},{});for(b=0;b<_.length;b+=1){"rowStart"in E&&E.rowStart instanceof Function&&E.rowStart({row:b,data:_[b]},this);var ie=h.call(this,_[b],De);for($=0;$<I.length;$+=1){var Ae=_[b][I[$]];"cellStart"in E&&E.cellStart instanceof Function&&E.cellStart({row:b,col:$,data:Ae},this),l.call(this,new o(g,v,De[I[$]],ie,Ae,b+2,ue[I[$]]))}}return this.internal.__cell__.table_x=g,this.internal.__cell__.table_y=v,this};var h=function(g,v){var _=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,E=this.internal.scaleFactor;return Object.keys(g).map(function(b){var R=g[b];return this.splitTextToSize(R.hasOwnProperty("text")?R.text:R,v[b]-_-_)},this).map(function(b){return this.getLineHeightFactor()*b.length*x/E+_+_},this).reduce(function(b,R){return Math.max(b,R)},0)};e.setTableHeaderRow=function(g){r.call(this),this.internal.__cell__.tableHeaderRow=g},e.printHeaderRow=function(g,v){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var E=[],b=0;b<this.internal.__cell__.tableHeaderRow.length;b+=1){_=this.internal.__cell__.tableHeaderRow[b].clone(),v&&(_.y=this.internal.__cell__.margins.top||0,E.push(_)),_.lineNumber=g;var R=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,_),this.setTextColor(R)}E.length>0&&this.setTableHeaderRow(E),this.setFont(void 0,"normal"),t=!1}}(fr.API);var jb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ub=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wg=zb(Ub),$b=[100,200,300,400,500,600,700,800,900],oN=zb($b);function Zg(e){var n=e.family.replace(/"|'/g,"").toLowerCase(),t=function(o){return jb[o=o||"normal"]?o:"normal"}(e.style),r=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(o){return typeof Wg[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:n,style:t,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:n,style:[i,t,r].join(" ")}}}function Oy(e,n,t,r){var i;for(i=t;i>=0&&i<n.length;i+=r)if(e[n[i]])return e[n[i]];for(i=t;i>=0&&i<n.length;i-=r)if(e[n[i]])return e[n[i]]}var aN={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Iy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Fy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function lN(e,n,t){for(var r=(t=t||{}).defaultFontFamily||"times",i=Object.assign({},aN,t.genericFontFamilies||{}),o=null,l=null,h=0;h<n.length;++h)if(i[(o=Zg(n[h])).family]&&(o.family=i[o.family]),e.hasOwnProperty(o.family)){l=e[o.family];break}if(!(l=l||e[r]))throw new Error("Could not find a font-family for the rule '"+Fy(o)+"' and default family '"+r+"'.");if(l=function(g,v){if(v[g])return v[g];var _=Wg[g],x=_<=Wg.normal?-1:1,E=Oy(v,Ub,_,x);if(!E)throw new Error("Could not find a matching font-stretch value for "+g);return E}(o.stretch,l),l=function(g,v){if(v[g])return v[g];for(var _=jb[g],x=0;x<_.length;++x)if(v[_[x]])return v[_[x]];throw new Error("Could not find a matching font-style for "+g)}(o.style,l),!(l=function(g,v){if(v[g])return v[g];if(g===400&&v[500])return v[500];if(g===500&&v[400])return v[400];var _=oN[g],x=Oy(v,$b,_,g<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+g);return x}(o.weight,l)))throw new Error("Failed to resolve a font for the rule '"+Fy(o)+"'.");return l}function zy(e){return e.trimLeft()}function uN(e,n){for(var t=0;t<e.length;){if(e.charAt(t)===n)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function cN(e){var n=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return n===null?null:[n[0],e.substring(n[0].length)]}var Bd,jy,Uy,X0=["times"];(function(e){var n,t,r,i,o,l,h,g,v,_=function(X){return X=X||{},this.isStrokeTransparent=X.isStrokeTransparent||!1,this.strokeOpacity=X.strokeOpacity||1,this.strokeStyle=X.strokeStyle||"#000000",this.fillStyle=X.fillStyle||"#000000",this.isFillTransparent=X.isFillTransparent||!1,this.fillOpacity=X.fillOpacity||1,this.font=X.font||"10px sans-serif",this.textBaseline=X.textBaseline||"alphabetic",this.textAlign=X.textAlign||"left",this.lineWidth=X.lineWidth||1,this.lineJoin=X.lineJoin||"miter",this.lineCap=X.lineCap||"butt",this.path=X.path||[],this.transform=X.transform!==void 0?X.transform.clone():new g,this.globalCompositeOperation=X.globalCompositeOperation||"normal",this.globalAlpha=X.globalAlpha||1,this.clip_path=X.clip_path||[],this.currentPoint=X.currentPoint||new l,this.miterLimit=X.miterLimit||10,this.lastPoint=X.lastPoint||new l,this.lineDashOffset=X.lineDashOffset||0,this.lineDash=X.lineDash||[],this.margin=X.margin||[0,0,0,0],this.prevPageLastElemOffset=X.prevPageLastElemOffset||0,this.ignoreClearRect=typeof X.ignoreClearRect!="boolean"||X.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),n=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,l=this.internal.Point,h=this.internal.Rectangle,g=this.internal.Matrix,v=new _}]);var x=function(X){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=X;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var N=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return N},set:function(ye){N=!!ye}});var Z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Z},set:function(ye){Z=!!ye}});var he=0;Object.defineProperty(this,"posX",{get:function(){return he},set:function(ye){isNaN(ye)||(he=ye)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(ye){isNaN(ye)||(ne=ye)}}),Object.defineProperty(this,"margin",{get:function(){return v.margin},set:function(ye){var le;typeof ye=="number"?le=[ye,ye,ye,ye]:((le=new Array(4))[0]=ye[0],le[1]=ye.length>=2?ye[1]:le[0],le[2]=ye.length>=3?ye[2]:le[0],le[3]=ye.length>=4?ye[3]:le[1]),v.margin=le}});var te=!1;Object.defineProperty(this,"autoPaging",{get:function(){return te},set:function(ye){te=ye}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(ye){ee=ye}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(ye){se=ye}}),Object.defineProperty(this,"ctx",{get:function(){return v},set:function(ye){ye instanceof _&&(v=ye)}}),Object.defineProperty(this,"path",{get:function(){return v.path},set:function(ye){v.path=ye}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(ye){Pe=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var le;le=E(ye),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var le=E(ye);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var oe=null;function re(ye,le){if(oe===null){var Ue=function(Ie){var Ce=[];return Object.keys(Ie).forEach(function(qe){Ie[qe].forEach(function(Re){var rt=null;switch(Re){case"bold":rt={family:qe,weight:"bold"};break;case"italic":rt={family:qe,style:"italic"};break;case"bolditalic":rt={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":rt={family:qe}}rt!==null&&(rt.ref={name:qe,style:Re},Ce.push(rt))})}),Ce}(ye.getFontList());oe=function(Ie){for(var Ce={},qe=0;qe<Ie.length;++qe){var Re=Zg(Ie[qe]),rt=Re.family,Ze=Re.stretch,gt=Re.style,_t=Re.weight;Ce[rt]=Ce[rt]||{},Ce[rt][Ze]=Ce[rt][Ze]||{},Ce[rt][Ze][gt]=Ce[rt][Ze][gt]||{},Ce[rt][Ze][gt][_t]=Re}return Ce}(Ue.concat(le))}return oe}var xe=null;Object.defineProperty(this,"fontFaces",{get:function(){return xe},set:function(ye){oe=null,xe=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var le;if(this.ctx.font=ye,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var Ue=le[1],Ie=(le[2],le[3]),Ce=le[4],qe=(le[5],le[6]),Re=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ce)[2];Ce=Math.floor(Re==="px"?parseFloat(Ce)*this.pdf.internal.scaleFactor:Re==="em"?parseFloat(Ce)*this.pdf.getFontSize():parseFloat(Ce)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ce);var rt=function(Yt){var Qt,Zt,wt=[],He=Yt.trim();if(He==="")return X0;if(He in Iy)return[Iy[He]];for(;He!=="";){switch(Zt=null,Qt=(He=zy(He)).charAt(0)){case'"':case"'":Zt=uN(He.substring(1),Qt);break;default:Zt=cN(He)}if(Zt===null||(wt.push(Zt[0]),(He=zy(Zt[1]))!==""&&He.charAt(0)!==","))return X0;He=He.replace(/^,/,"")}return wt}(qe);if(this.fontFaces){var Ze=lN(re(this.pdf,this.fontFaces),rt.map(function(Yt){return{family:Yt,stretch:"normal",weight:Ie,style:Ue}}));this.pdf.setFont(Ze.ref.name,Ze.ref.style)}else{var gt="";(Ie==="bold"||parseInt(Ie,10)>=700||Ue==="bold")&&(gt="bold"),Ue==="italic"&&(gt+="italic"),gt.length===0&&(gt="normal");for(var _t="",$t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},tn=0;tn<rt.length;tn++){if(this.pdf.internal.getFont(rt[tn],gt,{noFallback:!0,disableWarning:!0})!==void 0){_t=rt[tn];break}if(gt==="bolditalic"&&this.pdf.internal.getFont(rt[tn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_t=rt[tn],gt="bold";else if(this.pdf.internal.getFont(rt[tn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_t=rt[tn],gt="normal";break}}if(_t===""){for(var Qe=0;Qe<rt.length;Qe++)if($t[rt[Qe]]){_t=$t[rt[Qe]];break}}_t=_t===""?"Times":_t,this.pdf.setFont(_t,gt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,st.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,st.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};x.prototype.setLineDash=function(X){this.lineDash=X},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){Se.call(this,"fill",!1)},x.prototype.stroke=function(){Se.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw qi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var N=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"mt",x:N.x,y:N.y}),this.ctx.lastPoint=new l(X,Ee)},x.prototype.closePath=function(){var X=new l(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&Bi(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){X=new l(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(X.x,X.y)},x.prototype.lineTo=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw qi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var N=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"lt",x:N.x,y:N.y}),this.ctx.lastPoint=new l(N.x,N.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Se.call(this,null,!0)},x.prototype.quadraticCurveTo=function(X,Ee,N,Z){if(isNaN(N)||isNaN(Z)||isNaN(X)||isNaN(Ee))throw qi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var he=this.ctx.transform.applyToPoint(new l(N,Z)),ne=this.ctx.transform.applyToPoint(new l(X,Ee));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:he.x,y:he.y}),this.ctx.lastPoint=new l(he.x,he.y)},x.prototype.bezierCurveTo=function(X,Ee,N,Z,he,ne){if(isNaN(he)||isNaN(ne)||isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z))throw qi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var te=this.ctx.transform.applyToPoint(new l(he,ne)),ee=this.ctx.transform.applyToPoint(new l(X,Ee)),se=this.ctx.transform.applyToPoint(new l(N,Z));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:se.x,y2:se.y,x:te.x,y:te.y}),this.ctx.lastPoint=new l(te.x,te.y)},x.prototype.arc=function(X,Ee,N,Z,he,ne){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z)||isNaN(he))throw qi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var te=this.ctx.transform.applyToPoint(new l(X,Ee));X=te.x,Ee=te.y;var ee=this.ctx.transform.applyToPoint(new l(0,N)),se=this.ctx.transform.applyToPoint(new l(0,0));N=Math.sqrt(Math.pow(ee.x-se.x,2)+Math.pow(ee.y-se.y,2))}Math.abs(he-Z)>=2*Math.PI&&(Z=0,he=2*Math.PI),this.path.push({type:"arc",x:X,y:Ee,radius:N,startAngle:Z,endAngle:he,counterclockwise:ne})},x.prototype.arcTo=function(X,Ee,N,Z,he){throw new Error("arcTo not implemented.")},x.prototype.rect=function(X,Ee,N,Z){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z))throw qi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(X,Ee),this.lineTo(X+N,Ee),this.lineTo(X+N,Ee+Z),this.lineTo(X,Ee+Z),this.lineTo(X,Ee),this.lineTo(X+N,Ee),this.lineTo(X,Ee)},x.prototype.fillRect=function(X,Ee,N,Z){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z))throw qi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!b.call(this)){var he={};this.lineCap!=="butt"&&(he.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(he.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(X,Ee,N,Z),this.fill(),he.hasOwnProperty("lineCap")&&(this.lineCap=he.lineCap),he.hasOwnProperty("lineJoin")&&(this.lineJoin=he.lineJoin)}},x.prototype.strokeRect=function(X,Ee,N,Z){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z))throw qi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");R.call(this)||(this.beginPath(),this.rect(X,Ee,N,Z),this.stroke())},x.prototype.clearRect=function(X,Ee,N,Z){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z))throw qi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(X,Ee,N,Z))},x.prototype.save=function(X){X=typeof X!="boolean"||X;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),X){this.ctx.fontSize=this.pdf.internal.getFontSize();var Z=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Z}},x.prototype.restore=function(X){X=typeof X!="boolean"||X;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),X&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var E=function(X){var Ee,N,Z,he;if(X.isCanvasGradient===!0&&(X=X.getColor()),!X)return{r:0,g:0,b:0,a:0,style:X};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(X))Ee=0,N=0,Z=0,he=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(X);if(ne!==null)Ee=parseInt(ne[1]),N=parseInt(ne[2]),Z=parseInt(ne[3]),he=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(X))!==null)Ee=parseInt(ne[1]),N=parseInt(ne[2]),Z=parseInt(ne[3]),he=parseFloat(ne[4]);else{if(he=1,typeof X=="string"&&X.charAt(0)!=="#"){var te=new Nb(X);X=te.ok?te.toHex():"#000000"}X.length===4?(Ee=X.substring(1,2),Ee+=Ee,N=X.substring(2,3),N+=N,Z=X.substring(3,4),Z+=Z):(Ee=X.substring(1,3),N=X.substring(3,5),Z=X.substring(5,7)),Ee=parseInt(Ee,16),N=parseInt(N,16),Z=parseInt(Z,16)}}return{r:Ee,g:N,b:Z,a:he,style:X}},b=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},R=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(X,Ee,N,Z){if(isNaN(Ee)||isNaN(N)||typeof X!="string")throw qi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Z=isNaN(Z)?void 0:Z,!b.call(this)){var he=ie(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;D.call(this,{text:X,x:Ee,y:N,scale:ne,angle:he,align:this.textAlign,maxWidth:Z})}},x.prototype.strokeText=function(X,Ee,N,Z){if(isNaN(Ee)||isNaN(N)||typeof X!="string")throw qi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!R.call(this)){Z=isNaN(Z)?void 0:Z;var he=ie(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;D.call(this,{text:X,x:Ee,y:N,scale:ne,renderingMode:"stroke",angle:he,align:this.textAlign,maxWidth:Z})}},x.prototype.measureText=function(X){if(typeof X!="string")throw qi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,N=this.pdf.internal.scaleFactor,Z=Ee.internal.getFontSize(),he=Ee.getStringUnitWidth(X)*Z/Ee.internal.scaleFactor,ne=function(te){var ee=(te=te||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new ne({width:he*=Math.round(96*N/72*1e4)/1e4})},x.prototype.scale=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw qi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var N=new g(X,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(N)},x.prototype.rotate=function(X){if(isNaN(X))throw qi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new g(Math.cos(X),Math.sin(X),-Math.sin(X),Math.cos(X),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},x.prototype.translate=function(X,Ee){if(isNaN(X)||isNaN(Ee))throw qi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var N=new g(1,0,0,1,X,Ee);this.ctx.transform=this.ctx.transform.multiply(N)},x.prototype.transform=function(X,Ee,N,Z,he,ne){if(isNaN(X)||isNaN(Ee)||isNaN(N)||isNaN(Z)||isNaN(he)||isNaN(ne))throw qi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var te=new g(X,Ee,N,Z,he,ne);this.ctx.transform=this.ctx.transform.multiply(te)},x.prototype.setTransform=function(X,Ee,N,Z,he,ne){X=isNaN(X)?1:X,Ee=isNaN(Ee)?0:Ee,N=isNaN(N)?0:N,Z=isNaN(Z)?1:Z,he=isNaN(he)?0:he,ne=isNaN(ne)?0:ne,this.ctx.transform=new g(X,Ee,N,Z,he,ne)};var $=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(X,Ee,N,Z,he,ne,te,ee,se){var Pe=this.pdf.getImageProperties(X),oe=1,re=1,xe=1,ye=1;Z!==void 0&&ee!==void 0&&(xe=ee/Z,ye=se/he,oe=Pe.width/Z*ee/Z,re=Pe.height/he*se/he),ne===void 0&&(ne=Ee,te=N,Ee=0,N=0),Z!==void 0&&ee===void 0&&(ee=Z,se=he),Z===void 0&&ee===void 0&&(ee=Pe.width,se=Pe.height);for(var le,Ue=this.ctx.transform.decompose(),Ie=ie(Ue.rotate.shx),Ce=new g,qe=(Ce=(Ce=(Ce=Ce.multiply(Ue.translate)).multiply(Ue.skew)).multiply(Ue.scale)).applyToRectangle(new h(ne-Ee*xe,te-N*ye,Z*oe,he*re)),Re=Q.call(this,qe),rt=[],Ze=0;Ze<Re.length;Ze+=1)rt.indexOf(Re[Ze])===-1&&rt.push(Re[Ze]);if(ge(rt),this.autoPaging)for(var gt=rt[0],_t=rt[rt.length-1],$t=gt;$t<_t+1;$t++){this.pdf.setPage($t);var tn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qe=$t===1?this.posY+this.margin[0]:this.margin[0],Yt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Zt=$t===1?0:Yt+($t-2)*Qt;if(this.ctx.clip_path.length!==0){var wt=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=W(le,this.posX+this.margin[3],-Zt+Qe+this.ctx.prevPageLastElemOffset),De.call(this,"fill",!0),this.path=wt}var He=JSON.parse(JSON.stringify(qe));He=W([He],this.posX+this.margin[3],-Zt+Qe+this.ctx.prevPageLastElemOffset)[0];var Kt=($t>gt||$t<_t)&&$.call(this);Kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tn,Qt,null).clip().discardPath()),this.pdf.addImage(X,"JPEG",He.x,He.y,He.w,He.h,null,null,Ie),Kt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(X,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,Ie)};var Q=function(X,Ee,N){var Z=[];Ee=Ee||this.pdf.internal.pageSize.width,N=N||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var he=this.posY+this.ctx.prevPageLastElemOffset;switch(X.type){default:case"mt":case"lt":Z.push(Math.floor((X.y+he)/N)+1);break;case"arc":Z.push(Math.floor((X.y+he-X.radius)/N)+1),Z.push(Math.floor((X.y+he+X.radius)/N)+1);break;case"qct":var ne=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x,X.y);Z.push(Math.floor((ne.y+he)/N)+1),Z.push(Math.floor((ne.y+ne.h+he)/N)+1);break;case"bct":var te=Me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x2,X.y2,X.x,X.y);Z.push(Math.floor((te.y+he)/N)+1),Z.push(Math.floor((te.y+te.h+he)/N)+1);break;case"rect":Z.push(Math.floor((X.y+he)/N)+1),Z.push(Math.floor((X.y+X.h+he)/N)+1)}for(var ee=0;ee<Z.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<Z[ee];)I.call(this);return Z},I=function(){var X=this.fillStyle,Ee=this.strokeStyle,N=this.font,Z=this.lineCap,he=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=X,this.strokeStyle=Ee,this.font=N,this.lineCap=Z,this.lineWidth=he,this.lineJoin=ne},W=function(X,Ee,N){for(var Z=0;Z<X.length;Z++)switch(X[Z].type){case"bct":X[Z].x2+=Ee,X[Z].y2+=N;case"qct":X[Z].x1+=Ee,X[Z].y1+=N;case"mt":case"lt":case"arc":default:X[Z].x+=Ee,X[Z].y+=N}return X},ge=function(X){return X.sort(function(Ee,N){return Ee-N})},Se=function(X,Ee){for(var N,Z,he=this.fillStyle,ne=this.strokeStyle,te=this.lineCap,ee=this.lineWidth,se=Math.abs(ee*this.ctx.transform.scaleX),Pe=this.lineJoin,oe=JSON.parse(JSON.stringify(this.path)),re=JSON.parse(JSON.stringify(this.path)),xe=[],ye=0;ye<re.length;ye++)if(re[ye].x!==void 0)for(var le=Q.call(this,re[ye]),Ue=0;Ue<le.length;Ue+=1)xe.indexOf(le[Ue])===-1&&xe.push(le[Ue]);for(var Ie=0;Ie<xe.length;Ie++)for(;this.pdf.internal.getNumberOfPages()<xe[Ie];)I.call(this);if(ge(xe),this.autoPaging)for(var Ce=xe[0],qe=xe[xe.length-1],Re=Ce;Re<qe+1;Re++){this.pdf.setPage(Re),this.fillStyle=he,this.strokeStyle=ne,this.lineCap=te,this.lineWidth=se,this.lineJoin=Pe;var rt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ze=Re===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],$t=Re===1?0:gt+(Re-2)*_t;if(this.ctx.clip_path.length!==0){var tn=this.path;N=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=W(N,this.posX+this.margin[3],-$t+Ze+this.ctx.prevPageLastElemOffset),De.call(this,X,!0),this.path=tn}if(Z=JSON.parse(JSON.stringify(oe)),this.path=W(Z,this.posX+this.margin[3],-$t+Ze+this.ctx.prevPageLastElemOffset),Ee===!1||Re===0){var Qe=(Re>Ce||Re<qe)&&$.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],rt,_t,null).clip().discardPath()),De.call(this,X,Ee),Qe&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=se,De.call(this,X,Ee),this.lineWidth=ee;this.path=oe},De=function(X,Ee){if((X!=="stroke"||Ee||!R.call(this))&&(X==="stroke"||Ee||!b.call(this))){for(var N,Z,he=[],ne=this.path,te=0;te<ne.length;te++){var ee=ne[te];switch(ee.type){case"begin":he.push({begin:!0});break;case"close":he.push({close:!0});break;case"mt":he.push({start:ee,deltas:[],abs:[]});break;case"lt":var se=he.length;if(ne[te-1]&&!isNaN(ne[te-1].x)&&(N=[ee.x-ne[te-1].x,ee.y-ne[te-1].y],se>0)){for(;se>=0;se--)if(he[se-1].close!==!0&&he[se-1].begin!==!0){he[se-1].deltas.push(N),he[se-1].abs.push(ee);break}}break;case"bct":N=[ee.x1-ne[te-1].x,ee.y1-ne[te-1].y,ee.x2-ne[te-1].x,ee.y2-ne[te-1].y,ee.x-ne[te-1].x,ee.y-ne[te-1].y],he[he.length-1].deltas.push(N);break;case"qct":var Pe=ne[te-1].x+2/3*(ee.x1-ne[te-1].x),oe=ne[te-1].y+2/3*(ee.y1-ne[te-1].y),re=ee.x+2/3*(ee.x1-ee.x),xe=ee.y+2/3*(ee.y1-ee.y),ye=ee.x,le=ee.y;N=[Pe-ne[te-1].x,oe-ne[te-1].y,re-ne[te-1].x,xe-ne[te-1].y,ye-ne[te-1].x,le-ne[te-1].y],he[he.length-1].deltas.push(N);break;case"arc":he.push({deltas:[],abs:[],arc:!0}),Array.isArray(he[he.length-1].abs)&&he[he.length-1].abs.push(ee)}}Z=Ee?null:X==="stroke"?"stroke":"fill";for(var Ue=!1,Ie=0;Ie<he.length;Ie++)if(he[Ie].arc)for(var Ce=he[Ie].abs,qe=0;qe<Ce.length;qe++){var Re=Ce[qe];Re.type==="arc"?O.call(this,Re.x,Re.y,Re.radius,Re.startAngle,Re.endAngle,Re.counterclockwise,void 0,Ee,!Ue):V.call(this,Re.x,Re.y),Ue=!0}else if(he[Ie].close===!0)this.pdf.internal.out("h"),Ue=!1;else if(he[Ie].begin!==!0){var rt=he[Ie].start.x,Ze=he[Ie].start.y;z.call(this,he[Ie].deltas,rt,Ze),Ue=!0}Z&&K.call(this,Z),Ee&&ce.call(this)}},Ye=function(X){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,N=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return X-N;case"top":return X+Ee-N;case"hanging":return X+Ee-2*N;case"middle":return X+Ee/2-N;case"ideographic":return X;case"alphabetic":default:return X}},Ve=function(X){return X+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var X=function(){};return X.colorStops=[],X.addColorStop=function(Ee,N){this.colorStops.push([Ee,N])},X.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},X.isCanvasGradient=!0,X},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(X,Ee,N,Z,he,ne,te,ee,se){for(var Pe=G.call(this,N,Z,he,ne),oe=0;oe<Pe.length;oe++){var re=Pe[oe];oe===0&&(se?H.call(this,re.x1+X,re.y1+Ee):V.call(this,re.x1+X,re.y1+Ee)),U.call(this,X,Ee,re.x2,re.y2,re.x3,re.y3,re.x4,re.y4)}ee?ce.call(this):K.call(this,te)},K=function(X){switch(X){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ce=function(){this.pdf.clip(),this.pdf.discardPath()},H=function(X,Ee){this.pdf.internal.out(t(X)+" "+r(Ee)+" m")},D=function(X){var Ee;switch(X.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;case"left":case"start":default:Ee="left"}var N=this.pdf.getTextDimensions(X.text),Z=Ye.call(this,X.y),he=Ve.call(this,Z)-N.h,ne=this.ctx.transform.applyToPoint(new l(X.x,Z)),te=this.ctx.transform.decompose(),ee=new g;ee=(ee=(ee=ee.multiply(te.translate)).multiply(te.skew)).multiply(te.scale);for(var se,Pe,oe,re=this.ctx.transform.applyToRectangle(new h(X.x,Z,N.w,N.h)),xe=ee.applyToRectangle(new h(X.x,he,N.w,N.h)),ye=Q.call(this,xe),le=[],Ue=0;Ue<ye.length;Ue+=1)le.indexOf(ye[Ue])===-1&&le.push(ye[Ue]);if(ge(le),this.autoPaging)for(var Ie=le[0],Ce=le[le.length-1],qe=Ie;qe<Ce+1;qe++){this.pdf.setPage(qe);var Re=qe===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[2],gt=Ze-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],$t=_t-this.margin[3],tn=qe===1?0:rt+(qe-2)*gt;if(this.ctx.clip_path.length!==0){var Qe=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=W(se,this.posX+this.margin[3],-1*tn+Re),De.call(this,"fill",!0),this.path=Qe}var Yt=W([JSON.parse(JSON.stringify(xe))],this.posX+this.margin[3],-tn+Re+this.ctx.prevPageLastElemOffset)[0];X.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*X.scale),oe=this.lineWidth,this.lineWidth=oe*X.scale);var Qt=this.autoPaging!=="text";if(Qt||Yt.y+Yt.h<=Ze){if(Qt||Yt.y>=Re&&Yt.x<=_t){var Zt=Qt?X.text:this.pdf.splitTextToSize(X.text,X.maxWidth||_t-Yt.x)[0],wt=W([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-tn+Re+this.ctx.prevPageLastElemOffset)[0],He=Qt&&(qe>Ie||qe<Ce)&&$.call(this);He&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$t,gt,null).clip().discardPath()),this.pdf.text(Zt,wt.x,wt.y,{angle:X.angle,align:Ee,renderingMode:X.renderingMode}),He&&this.pdf.restoreGraphicsState()}}else Yt.y<Ze&&(this.ctx.prevPageLastElemOffset+=Ze-Yt.y);X.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=oe)}else X.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*X.scale),oe=this.lineWidth,this.lineWidth=oe*X.scale),this.pdf.text(X.text,ne.x+this.posX,ne.y+this.posY,{angle:X.angle,align:Ee,renderingMode:X.renderingMode,maxWidth:X.maxWidth}),X.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=oe)},V=function(X,Ee,N,Z){N=N||0,Z=Z||0,this.pdf.internal.out(t(X+N)+" "+r(Ee+Z)+" l")},z=function(X,Ee,N){return this.pdf.lines(X,Ee,N,null,null)},U=function(X,Ee,N,Z,he,ne,te,ee){this.pdf.internal.out([n(i(N+X)),n(o(Z+Ee)),n(i(he+X)),n(o(ne+Ee)),n(i(te+X)),n(o(ee+Ee)),"c"].join(" "))},G=function(X,Ee,N,Z){for(var he=2*Math.PI,ne=Math.PI/2;Ee>N;)Ee-=he;var te=Math.abs(N-Ee);te<he&&Z&&(te=he-te);for(var ee=[],se=Z?-1:1,Pe=Ee;te>1e-5;){var oe=Pe+se*Math.min(te,ne);ee.push(ue.call(this,X,Pe,oe)),te-=Math.abs(oe-Pe),Pe=oe}return ee},ue=function(X,Ee,N){var Z=(N-Ee)/2,he=X*Math.cos(Z),ne=X*Math.sin(Z),te=he,ee=-ne,se=te*te+ee*ee,Pe=se+te*he+ee*ne,oe=4/3*(Math.sqrt(2*se*Pe)-Pe)/(te*ne-ee*he),re=te-oe*ee,xe=ee+oe*te,ye=re,le=-xe,Ue=Z+Ee,Ie=Math.cos(Ue),Ce=Math.sin(Ue);return{x1:X*Math.cos(Ee),y1:X*Math.sin(Ee),x2:re*Ie-xe*Ce,y2:re*Ce+xe*Ie,x3:ye*Ie-le*Ce,y3:ye*Ce+le*Ie,x4:X*Math.cos(N),y4:X*Math.sin(N)}},ie=function(X){return 180*X/Math.PI},Ae=function(X,Ee,N,Z,he,ne){var te=X+.5*(N-X),ee=Ee+.5*(Z-Ee),se=he+.5*(N-he),Pe=ne+.5*(Z-ne),oe=Math.min(X,he,te,se),re=Math.max(X,he,te,se),xe=Math.min(Ee,ne,ee,Pe),ye=Math.max(Ee,ne,ee,Pe);return new h(oe,xe,re-oe,ye-xe)},Me=function(X,Ee,N,Z,he,ne,te,ee){var se,Pe,oe,re,xe,ye,le,Ue,Ie,Ce,qe,Re,rt,Ze,gt=N-X,_t=Z-Ee,$t=he-N,tn=ne-Z,Qe=te-he,Yt=ee-ne;for(Pe=0;Pe<41;Pe++)Ie=(le=(oe=X+(se=Pe/40)*gt)+se*((xe=N+se*$t)-oe))+se*(xe+se*(he+se*Qe-xe)-le),Ce=(Ue=(re=Ee+se*_t)+se*((ye=Z+se*tn)-re))+se*(ye+se*(ne+se*Yt-ye)-Ue),Pe==0?(qe=Ie,Re=Ce,rt=Ie,Ze=Ce):(qe=Math.min(qe,Ie),Re=Math.min(Re,Ce),rt=Math.max(rt,Ie),Ze=Math.max(Ze,Ce));return new h(Math.round(qe),Math.round(Re),Math.round(rt-qe),Math.round(Ze-Re))},st=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var X,Ee,N=(X=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:X,lineDashOffset:Ee}));this.prevLineDash!==N&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=N)}}})(fr.API),function(e){var n=function(o){var l,h,g,v,_,x,E,b,R,$;for(h=[],g=0,v=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;v>g;g+=4)(_=(o.charCodeAt(g)<<24)+(o.charCodeAt(g+1)<<16)+(o.charCodeAt(g+2)<<8)+o.charCodeAt(g+3))!==0?(x=(_=((_=((_=((_=(_-($=_%85))/85)-(R=_%85))/85)-(b=_%85))/85)-(E=_%85))/85)%85,h.push(x+33,E+33,b+33,R+33,$+33)):h.push(122);return function(Q,I){for(var W=I;W>0;W--)Q.pop()}(h,l.length),String.fromCharCode.apply(String,h)+"~>"},t=function(o){var l,h,g,v,_,x=String,E="length",b=255,R="charCodeAt",$="slice",Q="replace";for(o[$](-2),o=o[$](0,-2)[Q](/\s/g,"")[Q]("z","!!!!!"),g=[],v=0,_=(o+=l="uuuuu"[$](o[E]%5||5))[E];_>v;v+=5)h=52200625*(o[R](v)-33)+614125*(o[R](v+1)-33)+7225*(o[R](v+2)-33)+85*(o[R](v+3)-33)+(o[R](v+4)-33),g.push(b&h>>24,b&h>>16,b&h>>8,b&h);return function(I,W){for(var ge=W;ge>0;ge--)I.pop()}(g,l[E]),x.fromCharCode.apply(x,g)},r=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var h="",g=0;g<o.length;g+=2)h+=String.fromCharCode("0x"+(o[g]+o[g+1]));return h},i=function(o){for(var l=new Uint8Array(o.length),h=o.length;h--;)l[h]=o.charCodeAt(h);return o=(l=$g(l)).reduce(function(g,v){return g+String.fromCharCode(v)},"")};e.processDataByFilters=function(o,l){var h=0,g=o||"",v=[];for(typeof(l=l||[])=="string"&&(l=[l]),h=0;h<l.length;h+=1)switch(l[h]){case"ASCII85Decode":case"/ASCII85Decode":g=t(g),v.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":g=n(g),v.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":g=r(g),v.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":g=g.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",v.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":g=i(g),v.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[h]+'" is not implemented')}return{data:g,reverseChain:v.reverse().join(" ")}}}(fr.API),function(e){e.loadFile=function(n,t,r){return function(i,o,l){o=o!==!1,l=typeof l=="function"?l:function(){};var h=void 0;try{h=function(g,v,_){var x=new XMLHttpRequest,E=0,b=function(R){var $=R.length,Q=[],I=String.fromCharCode;for(E=0;E<$;E+=1)Q.push(I(255&R.charCodeAt(E)));return Q.join("")};if(x.open("GET",g,!v),x.overrideMimeType("text/plain; charset=x-user-defined"),v===!1&&(x.onload=function(){x.status===200?_(b(this.responseText)):_(void 0)}),x.send(null),v&&x.status===200)return b(x.responseText)}(i,o,l)}catch{}return h}(n,t,r)},e.loadImageFile=e.loadFile}(fr.API),function(e){function n(){return(dr.html2canvas?Promise.resolve(dr.html2canvas):Qc(()=>import("./html2canvas.esm.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(dr.DOMPurify?Promise.resolve(dr.DOMPurify):Qc(()=>import("./purify.es.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var h=Bi(l);return h==="undefined"?"undefined":h==="string"||l instanceof String?"string":h==="number"||l instanceof Number?"number":h==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":h==="object"?"object":"unknown"},i=function(l,h){var g=document.createElement(l);for(var v in h.className&&(g.className=h.className),h.innerHTML&&h.dompurify&&(g.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)g.style[v]=h.style[v];return g},o=function l(h){var g=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),v=l.convert(Promise.resolve(),g);return v=(v=v.setProgress(1,l,1,[l])).set(h)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,h){return l.__proto__=h||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,h){return this.then(function(){switch(h=h||function(g){switch(r(g)){case"string":return"string";case"element":return g.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l)){case"string":return this.then(t).then(function(g){return this.set({src:i("div",{innerHTML:l,dompurify:g})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=function g(v,_){for(var x=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),E=v.firstChild;E;E=E.nextSibling)_!==!0&&E.nodeType===1&&E.nodeName==="SCRIPT"||x.appendChild(g(E,_));return v.nodeType===1&&(v.nodeName==="CANVAS"?(x.width=v.width,x.height=v.height,x.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(x.value=v.value),x.addEventListener("load",function(){x.scrollTop=v.scrollTop,x.scrollLeft=v.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var g=Object.assign({},this.opt.html2canvas);return delete g.onrendered,h(this.prop.container,g)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(n).then(function(h){var g=this.opt.jsPDF,v=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,g.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,g.context2d.posX=this.opt.x,g.context2d.posY=this.opt.y,g.context2d.margin=this.opt.margin,g.context2d.fontFaces=v,v)for(var E=0;E<v.length;++E){var b=v[E],R=b.src.find(function($){return $.format==="truetype"});R&&g.addFont(R.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,g.context2d.save(!0),h(this.prop.container,x)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,h,g){return(g=g||"pdf").toLowerCase()==="img"||g.toLowerCase()==="image"?this.outputImg(l,h):this.outputPdf(l,h)},o.prototype.outputPdf=function(l,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,h)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var h=Object.keys(l||{}).map(function(g){if(g in o.template.prop)return function(){this.prop[g]=l[g]};switch(g){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[g]=l[g]}}},this);return this.then(function(){return this.thenList(h)})},o.prototype.get=function(l,h){return this.then(function(){var g=l in o.template.prop?this.prop[l]:this.opt[l];return h?h(g):g})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function h(g,v){return Math.floor(g*v/72*96)}return this.then(function(){(l=l||fr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:h(l.inner.width,l.k),height:h(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,h,g,v){return l!=null&&(this.progress.val=l),h!=null&&(this.progress.state=h),g!=null&&(this.progress.n=g),v!=null&&(this.progress.stack=v),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,h,g,v){return this.setProgress(l?this.progress.val+l:null,h||null,g?this.progress.n+g:null,v?this.progress.stack.concat(v):null)},o.prototype.then=function(l,h){var g=this;return this.thenCore(l,h,function(v,_){return g.updateProgress(null,null,1,[v]),Promise.prototype.then.call(this,function(x){return g.updateProgress(null,v),x}).then(v,_).then(function(x){return g.updateProgress(1),x})})},o.prototype.thenCore=function(l,h,g){g=g||Promise.prototype.then,l&&(l=l.bind(this)),h&&(h=h.bind(this));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),_=g.call(v,l,h);return o.convert(_,this.__proto__)},o.prototype.thenExternal=function(l,h){return Promise.prototype.then.call(this,l,h)},o.prototype.thenList=function(l){var h=this;return l.forEach(function(g){h=h.thenCore(g)}),h},o.prototype.catch=function(l){l&&(l=l.bind(this));var h=Promise.prototype.catch.call(this,l);return o.convert(h,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,fr.getPageSize=function(l,h,g){if(Bi(l)==="object"){var v=l;l=v.orientation,h=v.unit||h,g=v.format||g}h=h||"mm",g=g||"a4",l=(""+(l||"P")).toLowerCase();var _,x=(""+g).toLowerCase(),E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+h}var b,R=0,$=0;if(E.hasOwnProperty(x))R=E[x][1]/_,$=E[x][0]/_;else try{R=g[1],$=g[0]}catch{throw new Error("Invalid format: "+g)}if(l==="p"||l==="portrait")l="p",$>R&&(b=$,$=R,R=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",R>$&&(b=$,$=R,R=b)}return{width:$,height:R,unit:h,k:_,orientation:l}},e.html=function(l,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Zg):null;var g=new o(h);return h.worker?g:g.from(l).doCallback()}}(fr.API),fr.API.addJS=function(e){return Uy=e,this.internal.events.subscribe("postPutResources",function(){Bd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Bd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Uy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Bd!==void 0&&jy!==void 0&&this.internal.out("/Names <</JavaScript "+Bd+" 0 R>>")}),this},function(e){var n;e.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),o=0;o<i.length;o++){var l=i[o],h=r.exec(l);if(h!=null){var g=h[1];t.internal.newObjectDeferredBegin(g,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var v=this.internal.pages.length,_=[];for(o=0;o<v;o++){var x=t.internal.newObject();_.push(x);var E=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+E.objId+" 0 R /XYZ null null null]>> endobj")}var b=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<_.length;o++)t.internal.write("(page_"+(o+1)+")"+_[o]+" 0 R");t.internal.write(" ] >>","endobj"),n=t.internal.newObject(),t.internal.write("<< /Dests "+b+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,i,o){var l={title:i,options:o,children:[]};return r==null&&(r=this.root),r.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<r.children.length;o++){var l=r.children[o];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(r)),o>0&&this.line("/Prev "+this.makeRef(r.children[o-1])),o<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[o+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var h=this.count=this.count_r({count:0},l);if(h>0&&this.line("/Count "+h),l.options&&l.options.pageNumber){var g=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+g.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var v=0;v<r.children.length;v++)this.renderItems(r.children[v])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,i){for(var o=0;o<i.children.length;o++)r.count++,this.count_r(r,i.children[o]);return r.count}}])}(fr.API),function(e){var n=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,r,i,o,l,h){var g,v=this.decode.DCT_DECODE,_=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(g=function(x){for(var E,b=256*x.charCodeAt(4)+x.charCodeAt(5),R=x.length,$={width:0,height:0,numcomponents:1},Q=4;Q<R;Q+=2){if(Q+=b,n.indexOf(x.charCodeAt(Q+1))!==-1){E=256*x.charCodeAt(Q+5)+x.charCodeAt(Q+6),$={width:256*x.charCodeAt(Q+7)+x.charCodeAt(Q+8),height:E,numcomponents:x.charCodeAt(Q+9)};break}b=256*x.charCodeAt(Q+2)+x.charCodeAt(Q+3)}return $}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:h=this.color_spaces.DEVICE_GRAY;break;case 4:h=this.color_spaces.DEVICE_CMYK;break;case 3:h=this.color_spaces.DEVICE_RGB}_={data:t,width:g.width,height:g.height,colorSpace:h,bitsPerComponent:8,filter:v,index:r,alias:i}}return _}}(fr.API);var kh,Nd,$y,qy,Vy,hN=function(){var e,n,t;function r(o){var l,h,g,v,_,x,E,b,R,$,Q,I,W,ge;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(l=this.readUInt32(),R=(function(){var Se,De;for(De=[],Se=0;Se<4;++Se)De.push(String.fromCharCode(this.data[this.pos++]));return De}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),v=this.readUInt16()||100,x.delay=1e3*_/v,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(R==="fdAT"&&(this.pos+=4,l-=4),o=(x!=null?x.data:void 0)||this.imgData,I=0;0<=l?I<l:I>l;0<=l?++I:--I)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(g=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>g)throw new Error("More transparent colors than palette size");if(($=g-this.transparency.indexed.length)>0)for(W=0;0<=$?W<$:W>$;0<=$?++W:--W)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":E=(Q=this.read(l)).indexOf(0),b=String.fromCharCode.apply(String,Q.slice(0,E)),this.text[b]=String.fromCharCode.apply(String,Q.slice(E+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(ge=this.colorType)===4||ge===6,h=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*h,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(o){var l,h;for(h=[],l=0;0<=o?l<o:l>o;0<=o?++l:--l)h.push(this.data[this.pos++]);return h},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(o){var l=this.pixelBitlength/8,h=new Uint8Array(this.width*this.height*l),g=0,v=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function _(x,E,b,R){var $,Q,I,W,ge,Se,De,Ye,Ve,O,K,ce,H,D,V,z,U,G,ue,ie,Ae,Me=Math.ceil((v.width-x)/b),st=Math.ceil((v.height-E)/R),X=v.width==Me&&v.height==st;for(D=l*Me,ce=X?h:new Uint8Array(D*st),Se=o.length,H=0,Q=0;H<st&&g<Se;){switch(o[g++]){case 0:for(W=U=0;U<D;W=U+=1)ce[Q++]=o[g++];break;case 1:for(W=G=0;G<D;W=G+=1)$=o[g++],ge=W<l?0:ce[Q-l],ce[Q++]=($+ge)%256;break;case 2:for(W=ue=0;ue<D;W=ue+=1)$=o[g++],I=(W-W%l)/l,V=H&&ce[(H-1)*D+I*l+W%l],ce[Q++]=(V+$)%256;break;case 3:for(W=ie=0;ie<D;W=ie+=1)$=o[g++],I=(W-W%l)/l,ge=W<l?0:ce[Q-l],V=H&&ce[(H-1)*D+I*l+W%l],ce[Q++]=($+Math.floor((ge+V)/2))%256;break;case 4:for(W=Ae=0;Ae<D;W=Ae+=1)$=o[g++],I=(W-W%l)/l,ge=W<l?0:ce[Q-l],H===0?V=z=0:(V=ce[(H-1)*D+I*l+W%l],z=I&&ce[(H-1)*D+(I-1)*l+W%l]),De=ge+V-z,Ye=Math.abs(De-ge),O=Math.abs(De-V),K=Math.abs(De-z),Ve=Ye<=O&&Ye<=K?ge:O<=K?V:z,ce[Q++]=($+Ve)%256;break;default:throw new Error("Invalid filter algorithm: "+o[g-1])}if(!X){var Ee=((E+H*R)*v.width+x)*l,N=H*D;for(W=0;W<Me;W+=1){for(var Z=0;Z<l;Z+=1)h[Ee++]=ce[N++];Ee+=(b-1)*l}}H++}}return o=q7(o),v.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),h},r.prototype.decodePalette=function(){var o,l,h,g,v,_,x,E,b;for(h=this.palette,_=this.transparency.indexed||[],v=new Uint8Array((_.length||0)+h.length),g=0,o=0,l=x=0,E=h.length;x<E;l=x+=3)v[g++]=h[l],v[g++]=h[l+1],v[g++]=h[l+2],v[g++]=(b=_[o++])!=null?b:255;return v},r.prototype.copyToImageData=function(o,l){var h,g,v,_,x,E,b,R,$,Q,I;if(g=this.colors,$=null,h=this.hasAlphaChannel,this.palette.length&&($=(I=this._decodedPalette)!=null?I:this._decodedPalette=this.decodePalette(),g=4,h=!0),R=(v=o.data||o).length,x=$||l,_=E=0,g===1)for(;_<R;)b=$?4*l[_/4]:E,Q=x[b++],v[_++]=Q,v[_++]=Q,v[_++]=Q,v[_++]=h?x[b++]:255,E=b;else for(;_<R;)b=$?4*l[_/4]:E,v[_++]=x[b++],v[_++]=x[b++],v[_++]=x[b++],v[_++]=h?x[b++]:255,E=b},r.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(dr)==="[object Window]"){try{n=dr.document.createElement("canvas"),t=n.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(o){var l;if(i()===!0)return t.width=o.width,t.height=o.height,t.clearRect(0,0,o.width,o.height),t.putImageData(o,0,0),(l=new Image).src=n.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(o){var l,h,g,v,_,x,E,b;if(this.animation){for(b=[],h=_=0,x=(E=this.animation.frames).length;_<x;h=++_)l=E[h],g=o.createImageData(l.width,l.height),v=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(g,v),l.imageData=g,b.push(l.image=e(g));return b}},r.prototype.renderFrame=function(o,l){var h,g,v;return h=(g=this.animation.frames)[l],v=g[l-1],l===0&&o.clearRect(0,0,this.width,this.height),(v!=null?v.disposeOp:void 0)===1?o.clearRect(v.xOffset,v.yOffset,v.width,v.height):(v!=null?v.disposeOp:void 0)===2&&o.putImageData(v.imageData,v.xOffset,v.yOffset),h.blendOp===0&&o.clearRect(h.xOffset,h.yOffset,h.width,h.height),o.drawImage(h.image,h.xOffset,h.yOffset)},r.prototype.animate=function(o){var l,h,g,v,_,x,E=this;return h=0,x=this.animation,v=x.numFrames,g=x.frames,_=x.numPlays,(l=function(){var b,R;if(b=h++%v,R=g[b],E.renderFrame(o,b),v>1&&h/v<_)return E.animation._timeout=setTimeout(l,R.delay)})()},r.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},r.prototype.render=function(o){var l,h;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,l=o.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(h=l.createImageData(this.width,this.height),this.copyToImageData(h,this.decodePixels()),l.putImageData(h,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function fN(e){var n=0;if(e[n++]!==71||e[n++]!==73||e[n++]!==70||e[n++]!==56||(e[n++]+1&253)!=56||e[n++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[n++]|e[n++]<<8,r=e[n++]|e[n++]<<8,i=e[n++],o=i>>7,l=1<<(7&i)+1;e[n++],e[n++];var h=null,g=null;o&&(h=n,g=l,n+=3*l);var v=!0,_=[],x=0,E=null,b=0,R=null;for(this.width=t,this.height=r;v&&n<e.length;)switch(e[n++]){case 33:switch(e[n++]){case 255:if(e[n]!==11||e[n+1]==78&&e[n+2]==69&&e[n+3]==84&&e[n+4]==83&&e[n+5]==67&&e[n+6]==65&&e[n+7]==80&&e[n+8]==69&&e[n+9]==50&&e[n+10]==46&&e[n+11]==48&&e[n+12]==3&&e[n+13]==1&&e[n+16]==0)n+=14,R=e[n++]|e[n++]<<8,n++;else for(n+=12;;){if(!((H=e[n++])>=0))throw Error("Invalid block size");if(H===0)break;n+=H}break;case 249:if(e[n++]!==4||e[n+4]!==0)throw new Error("Invalid graphics extension block.");var $=e[n++];x=e[n++]|e[n++]<<8,E=e[n++],!(1&$)&&(E=null),b=$>>2&7,n++;break;case 254:for(;;){if(!((H=e[n++])>=0))throw Error("Invalid block size");if(H===0)break;n+=H}break;default:throw new Error("Unknown graphic control label: 0x"+e[n-1].toString(16))}break;case 44:var Q=e[n++]|e[n++]<<8,I=e[n++]|e[n++]<<8,W=e[n++]|e[n++]<<8,ge=e[n++]|e[n++]<<8,Se=e[n++],De=Se>>6&1,Ye=1<<(7&Se)+1,Ve=h,O=g,K=!1;Se>>7&&(K=!0,Ve=n,O=Ye,n+=3*Ye);var ce=n;for(n++;;){var H;if(!((H=e[n++])>=0))throw Error("Invalid block size");if(H===0)break;n+=H}_.push({x:Q,y:I,width:W,height:ge,has_local_palette:K,palette_offset:Ve,palette_size:O,data_offset:ce,data_length:n-ce,transparent_index:E,interlaced:!!De,delay:x,disposal:b});break;case 59:v=!1;break;default:throw new Error("Unknown gif block: 0x"+e[n-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return R},this.frameInfo=function(D){if(D<0||D>=_.length)throw new Error("Frame index out of range.");return _[D]},this.decodeAndBlitFrameBGRA=function(D,V){var z=this.frameInfo(D),U=z.width*z.height,G=new Uint8Array(U);Gy(e,z.data_offset,G,U);var ue=z.palette_offset,ie=z.transparent_index;ie===null&&(ie=256);var Ae=z.width,Me=t-Ae,st=Ae,X=4*(z.y*t+z.x),Ee=4*((z.y+z.height)*t+z.x),N=X,Z=4*Me;z.interlaced===!0&&(Z+=4*t*7);for(var he=8,ne=0,te=G.length;ne<te;++ne){var ee=G[ne];if(st===0&&(st=Ae,(N+=Z)>=Ee&&(Z=4*Me+4*t*(he-1),N=X+(Ae+Me)*(he<<1),he>>=1)),ee===ie)N+=4;else{var se=e[ue+3*ee],Pe=e[ue+3*ee+1],oe=e[ue+3*ee+2];V[N++]=oe,V[N++]=Pe,V[N++]=se,V[N++]=255}--st}},this.decodeAndBlitFrameRGBA=function(D,V){var z=this.frameInfo(D),U=z.width*z.height,G=new Uint8Array(U);Gy(e,z.data_offset,G,U);var ue=z.palette_offset,ie=z.transparent_index;ie===null&&(ie=256);var Ae=z.width,Me=t-Ae,st=Ae,X=4*(z.y*t+z.x),Ee=4*((z.y+z.height)*t+z.x),N=X,Z=4*Me;z.interlaced===!0&&(Z+=4*t*7);for(var he=8,ne=0,te=G.length;ne<te;++ne){var ee=G[ne];if(st===0&&(st=Ae,(N+=Z)>=Ee&&(Z=4*Me+4*t*(he-1),N=X+(Ae+Me)*(he<<1),he>>=1)),ee===ie)N+=4;else{var se=e[ue+3*ee],Pe=e[ue+3*ee+1],oe=e[ue+3*ee+2];V[N++]=se,V[N++]=Pe,V[N++]=oe,V[N++]=255}--st}}}function Gy(e,n,t,r){for(var i=e[n++],o=1<<i,l=o+1,h=l+1,g=i+1,v=(1<<g)-1,_=0,x=0,E=0,b=e[n++],R=new Int32Array(4096),$=null;;){for(;_<16&&b!==0;)x|=e[n++]<<_,_+=8,b===1?b=e[n++]:--b;if(_<g)break;var Q=x&v;if(x>>=g,_-=g,Q!==o){if(Q===l)break;for(var I=Q<h?Q:$,W=0,ge=I;ge>o;)ge=R[ge]>>8,++W;var Se=ge;if(E+W+(I!==Q?1:0)>r)return void qi.log("Warning, gif stream longer than expected.");t[E++]=Se;var De=E+=W;for(I!==Q&&(t[E++]=Se),ge=I;W--;)ge=R[ge],t[--De]=255&ge,ge>>=8;$!==null&&h<4096&&(R[h++]=$<<8|Se,h>=v+1&&g<12&&(++g,v=v<<1|1)),$=Q}else h=l+1,v=(1<<(g=i+1))-1,$=null}return E!==r&&qi.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Q0(e){var n,t,r,i,o,l=Math.floor,h=new Array(64),g=new Array(64),v=new Array(64),_=new Array(64),x=new Array(65535),E=new Array(65535),b=new Array(64),R=new Array(64),$=[],Q=0,I=7,W=new Array(64),ge=new Array(64),Se=new Array(64),De=new Array(256),Ye=new Array(2048),Ve=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],K=[0,1,2,3,4,5,6,7,8,9,10,11],ce=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(X,Ee){for(var N=0,Z=0,he=new Array,ne=1;ne<=16;ne++){for(var te=1;te<=X[ne];te++)he[Ee[Z]]=[],he[Ee[Z]][0]=N,he[Ee[Z]][1]=ne,Z++,N++;N*=2}return he}function ue(X){for(var Ee=X[0],N=X[1]-1;N>=0;)Ee&1<<N&&(Q|=1<<I),N--,--I<0&&(Q==255?(ie(255),ie(0)):ie(Q),I=7,Q=0)}function ie(X){$.push(X)}function Ae(X){ie(X>>8&255),ie(255&X)}function Me(X,Ee,N,Z,he){for(var ne,te=he[0],ee=he[240],se=function(Ce,qe){var Re,rt,Ze,gt,_t,$t,tn,Qe,Yt,Qt,Zt=0;for(Yt=0;Yt<8;++Yt){Re=Ce[Zt],rt=Ce[Zt+1],Ze=Ce[Zt+2],gt=Ce[Zt+3],_t=Ce[Zt+4],$t=Ce[Zt+5],tn=Ce[Zt+6];var wt=Re+(Qe=Ce[Zt+7]),He=Re-Qe,Kt=rt+tn,on=rt-tn,Bn=Ze+$t,kn=Ze-$t,et=gt+_t,On=gt-_t,Nn=wt+et,mn=wt-et,Pn=Kt+Bn,zr=Kt-Bn;Ce[Zt]=Nn+Pn,Ce[Zt+4]=Nn-Pn;var Gn=.707106781*(zr+mn);Ce[Zt+2]=mn+Gn,Ce[Zt+6]=mn-Gn;var Dt=.382683433*((Nn=On+kn)-(zr=on+He)),xr=.5411961*Nn+Dt,lr=1.306562965*zr+Dt,hi=.707106781*(Pn=kn+on),Ri=He+hi,Fn=He-hi;Ce[Zt+5]=Fn+xr,Ce[Zt+3]=Fn-xr,Ce[Zt+1]=Ri+lr,Ce[Zt+7]=Ri-lr,Zt+=8}for(Zt=0,Yt=0;Yt<8;++Yt){Re=Ce[Zt],rt=Ce[Zt+8],Ze=Ce[Zt+16],gt=Ce[Zt+24],_t=Ce[Zt+32],$t=Ce[Zt+40],tn=Ce[Zt+48];var xi=Re+(Qe=Ce[Zt+56]),Lr=Re-Qe,Gr=rt+tn,Qn=rt-tn,kt=Ze+$t,Ei=Ze-$t,Ai=gt+_t,fi=gt-_t,ei=xi+Ai,Di=xi-Ai,Qi=Gr+kt,Yn=Gr-kt;Ce[Zt]=ei+Qi,Ce[Zt+32]=ei-Qi;var Mi=.707106781*(Yn+Di);Ce[Zt+16]=Di+Mi,Ce[Zt+48]=Di-Mi;var Xs=.382683433*((ei=fi+Ei)-(Yn=Qn+Lr)),Ps=.5411961*ei+Xs,Tr=1.306562965*Yn+Xs,Cn=.707106781*(Qi=Ei+Qn),di=Lr+Cn,Dr=Lr-Cn;Ce[Zt+40]=Dr+Ps,Ce[Zt+24]=Dr-Ps,Ce[Zt+8]=di+Tr,Ce[Zt+56]=di-Tr,Zt++}for(Yt=0;Yt<64;++Yt)Qt=Ce[Yt]*qe[Yt],b[Yt]=Qt>0?Qt+.5|0:Qt-.5|0;return b}(X,Ee),Pe=0;Pe<64;++Pe)R[Ve[Pe]]=se[Pe];var oe=R[0]-N;N=R[0],oe==0?ue(Z[0]):(ue(Z[E[ne=32767+oe]]),ue(x[ne]));for(var re=63;re>0&&R[re]==0;)re--;if(re==0)return ue(te),N;for(var xe,ye=1;ye<=re;){for(var le=ye;R[ye]==0&&ye<=re;)++ye;var Ue=ye-le;if(Ue>=16){xe=Ue>>4;for(var Ie=1;Ie<=xe;++Ie)ue(ee);Ue&=15}ne=32767+R[ye],ue(he[(Ue<<4)+E[ne]]),ue(x[ne]),ye++}return re!=63&&ue(te),N}function st(X){X=Math.min(Math.max(X,1),100),o!=X&&(function(Ee){for(var N=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Z=0;Z<64;Z++){var he=l((N[Z]*Ee+50)/100);he=Math.min(Math.max(he,1),255),h[Ve[Z]]=he}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],te=0;te<64;te++){var ee=l((ne[te]*Ee+50)/100);ee=Math.min(Math.max(ee,1),255),g[Ve[te]]=ee}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,oe=0;oe<8;oe++)for(var re=0;re<8;re++)v[Pe]=1/(h[Ve[Pe]]*se[oe]*se[re]*8),_[Pe]=1/(g[Ve[Pe]]*se[oe]*se[re]*8),Pe++}(X<50?Math.floor(5e3/X):Math.floor(200-2*X)),o=X)}this.encode=function(X,Ee){Ee&&st(Ee),$=new Array,Q=0,I=7,Ae(65496),Ae(65504),Ae(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),Ae(1),Ae(1),ie(0),ie(0),function(){Ae(65499),Ae(132),ie(0);for(var rt=0;rt<64;rt++)ie(h[rt]);ie(1);for(var Ze=0;Ze<64;Ze++)ie(g[Ze])}(),function(rt,Ze){Ae(65472),Ae(17),ie(8),Ae(Ze),Ae(rt),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)}(X.width,X.height),function(){Ae(65476),Ae(418),ie(0);for(var rt=0;rt<16;rt++)ie(O[rt+1]);for(var Ze=0;Ze<=11;Ze++)ie(K[Ze]);ie(16);for(var gt=0;gt<16;gt++)ie(ce[gt+1]);for(var _t=0;_t<=161;_t++)ie(H[_t]);ie(1);for(var $t=0;$t<16;$t++)ie(D[$t+1]);for(var tn=0;tn<=11;tn++)ie(V[tn]);ie(17);for(var Qe=0;Qe<16;Qe++)ie(z[Qe+1]);for(var Yt=0;Yt<=161;Yt++)ie(U[Yt])}(),Ae(65498),Ae(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var N=0,Z=0,he=0;Q=0,I=7,this.encode.displayName="_encode_";for(var ne,te,ee,se,Pe,oe,re,xe,ye,le=X.data,Ue=X.width,Ie=X.height,Ce=4*Ue,qe=0;qe<Ie;){for(ne=0;ne<Ce;){for(Pe=Ce*qe+ne,re=-1,xe=0,ye=0;ye<64;ye++)oe=Pe+(xe=ye>>3)*Ce+(re=4*(7&ye)),qe+xe>=Ie&&(oe-=Ce*(qe+1+xe-Ie)),ne+re>=Ce&&(oe-=ne+re-Ce+4),te=le[oe++],ee=le[oe++],se=le[oe++],W[ye]=(Ye[te]+Ye[ee+256>>0]+Ye[se+512>>0]>>16)-128,ge[ye]=(Ye[te+768>>0]+Ye[ee+1024>>0]+Ye[se+1280>>0]>>16)-128,Se[ye]=(Ye[te+1280>>0]+Ye[ee+1536>>0]+Ye[se+1792>>0]>>16)-128;N=Me(W,v,N,n,r),Z=Me(ge,_,Z,t,i),he=Me(Se,_,he,t,i),ne+=32}qe+=8}if(I>=0){var Re=[];Re[1]=I+1,Re[0]=(1<<I+1)-1,ue(Re)}return Ae(65497),new Uint8Array($)},e=e||50,function(){for(var X=String.fromCharCode,Ee=0;Ee<256;Ee++)De[Ee]=X(Ee)}(),n=G(O,K),t=G(D,V),r=G(ce,H),i=G(z,U),function(){for(var X=1,Ee=2,N=1;N<=15;N++){for(var Z=X;Z<Ee;Z++)E[32767+Z]=N,x[32767+Z]=[],x[32767+Z][1]=N,x[32767+Z][0]=Z;for(var he=-(Ee-1);he<=-X;he++)E[32767+he]=N,x[32767+he]=[],x[32767+he][1]=N,x[32767+he][0]=Ee-1+he;X<<=1,Ee<<=1}}(),function(){for(var X=0;X<256;X++)Ye[X]=19595*X,Ye[X+256>>0]=38470*X,Ye[X+512>>0]=7471*X+32768,Ye[X+768>>0]=-11059*X,Ye[X+1024>>0]=-21709*X,Ye[X+1280>>0]=32768*X+8421375,Ye[X+1536>>0]=-27439*X,Ye[X+1792>>0]=-5329*X}(),st(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wl(e,n){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Hy(e){function n(O){if(!O)throw Error("assert :P")}function t(O,K,ce){for(var H=0;4>H;H++)if(O[K+H]!=ce.charCodeAt(H))return!0;return!1}function r(O,K,ce,H,D){for(var V=0;V<D;V++)O[K+V]=ce[H+V]}function i(O,K,ce,H){for(var D=0;D<H;D++)O[K+D]=ce}function o(O){return new Int32Array(O)}function l(O,K){for(var ce=[],H=0;H<O;H++)ce.push(new K);return ce}function h(O,K){var ce=[];return function H(D,V,z){for(var U=z[V],G=0;G<U&&(D.push(z.length>V+1?[]:new K),!(z.length<V+1));G++)H(D[G],V+1,z)}(ce,0,O),ce}var g=function(){var O=this;function K(m,C){for(var B=1<<C-1>>>0;m&B;)B>>>=1;return B?(m&B-1)+B:m}function ce(m,C,B,Y,pe){n(!(Y%B));do m[C+(Y-=B)]=pe;while(0<Y)}function H(m,C,B,Y,pe){if(n(2328>=pe),512>=pe)var be=o(512);else if((be=o(pe))==null)return 0;return function(Le,ke,Be,Ge,ht,Ot){var It,Lt,Vt=ke,Ut=1<<Be,ft=o(16),yt=o(16);for(n(ht!=0),n(Ge!=null),n(Le!=null),n(0<Be),Lt=0;Lt<ht;++Lt){if(15<Ge[Lt])return 0;++ft[Ge[Lt]]}if(ft[0]==ht)return 0;for(yt[1]=0,It=1;15>It;++It){if(ft[It]>1<<It)return 0;yt[It+1]=yt[It]+ft[It]}for(Lt=0;Lt<ht;++Lt)It=Ge[Lt],0<Ge[Lt]&&(Ot[yt[It]++]=Lt);if(yt[15]==1)return(Ge=new D).g=0,Ge.value=Ot[0],ce(Le,Vt,1,Ut,Ge),Ut;var Jt,cn=-1,en=Ut-1,xn=0,bn=1,qn=1,a=1<<Be;for(Lt=0,It=1,ht=2;It<=Be;++It,ht<<=1){if(bn+=qn<<=1,0>(qn-=ft[It]))return 0;for(;0<ft[It];--ft[It])(Ge=new D).g=It,Ge.value=Ot[Lt++],ce(Le,Vt+xn,ht,a,Ge),xn=K(xn,It)}for(It=Be+1,ht=2;15>=It;++It,ht<<=1){if(bn+=qn<<=1,0>(qn-=ft[It]))return 0;for(;0<ft[It];--ft[It]){if(Ge=new D,(xn&en)!=cn){for(Vt+=a,Jt=1<<(cn=It)-Be;15>cn&&!(0>=(Jt-=ft[cn]));)++cn,Jt<<=1;Ut+=a=1<<(Jt=cn-Be),Le[ke+(cn=xn&en)].g=Jt+Be,Le[ke+cn].value=Vt-ke-cn}Ge.g=It-Be,Ge.value=Ot[Lt++],ce(Le,Vt+(xn>>Be),ht,a,Ge),xn=K(xn,It)}}return bn!=2*yt[15]-1?0:Ut}(m,C,B,Y,pe,be)}function D(){this.value=this.g=0}function V(){this.value=this.g=0}function z(){this.G=l(5,D),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Wi,V)}function U(m,C,B,Y){n(m!=null),n(C!=null),n(2147483648>Y),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=C,m.pa=B,m.Jd=C,m.Yc=B+Y,m.Zc=4<=Y?B+Y-4+1:B,ne(m)}function G(m,C){for(var B=0;0<C--;)B|=ee(m,128)<<C;return B}function ue(m,C){var B=G(m,C);return te(m)?-B:B}function ie(m,C,B,Y){var pe,be=0;for(n(m!=null),n(C!=null),n(4294967288>Y),m.Sb=Y,m.Ra=0,m.u=0,m.h=0,4<Y&&(Y=4),pe=0;pe<Y;++pe)be+=C[B+pe]<<8*pe;m.Ra=be,m.bb=Y,m.oa=C,m.pa=B}function Ae(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Fs-8>>>0,++m.bb,m.u-=8;N(m)&&(m.h=1,m.u=0)}function Me(m,C){if(n(0<=C),!m.h&&C<=no){var B=Ee(m)&To[C];return m.u+=C,Ae(m),B}return m.h=1,m.u=0}function st(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function X(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Ee(m){return m.Ra>>>(m.u&Fs-1)>>>0}function N(m){return n(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Fs}function Z(m,C){m.u=C,m.h=N(m)}function he(m){m.u>=Da&&(n(m.u>=Da),Ae(m))}function ne(m){n(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(n(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function te(m){return G(m,1)}function ee(m,C){var B=m.Ca;0>m.b&&ne(m);var Y=m.b,pe=B*C>>>8,be=(m.I>>>Y>pe)+0;for(be?(B-=pe,m.I-=pe+1<<Y>>>0):B=pe+1,Y=B,pe=0;256<=Y;)pe+=8,Y>>=8;return Y=7^pe+ms[Y],m.b-=Y,m.Ca=(B<<Y)-1,be}function se(m,C,B){m[C+0]=B>>24&255,m[C+1]=B>>16&255,m[C+2]=B>>8&255,m[C+3]=B>>0&255}function Pe(m,C){return m[C+0]<<0|m[C+1]<<8}function oe(m,C){return Pe(m,C)|m[C+2]<<16}function re(m,C){return Pe(m,C)|Pe(m,C+2)<<16}function xe(m,C){var B=1<<C;return n(m!=null),n(0<C),m.X=o(B),m.X==null?0:(m.Mb=32-C,m.Xa=C,1)}function ye(m,C){n(m!=null),n(C!=null),n(m.Xa==C.Xa),r(C.X,0,m.X,0,1<<C.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Ue(m,C,B,Y){n(B!=null),n(Y!=null);var pe=B[0],be=Y[0];return pe==0&&(pe=(m*be+C/2)/C),be==0&&(be=(C*pe+m/2)/m),0>=pe||0>=be?0:(B[0]=pe,Y[0]=be,1)}function Ie(m,C){return m+(1<<C)-1>>>C}function Ce(m,C){return((4278255360&m)+(4278255360&C)>>>0&4278255360)+((16711935&m)+(16711935&C)>>>0&16711935)>>>0}function qe(m,C){O[C]=function(B,Y,pe,be,Le,ke,Be){var Ge;for(Ge=0;Ge<Le;++Ge){var ht=O[m](ke[Be+Ge-1],pe,be+Ge);ke[Be+Ge]=Ce(B[Y+Ge],ht)}}}function Re(){this.ud=this.hd=this.jd=0}function rt(m,C){return((4278124286&(m^C))>>>1)+(m&C)>>>0}function Ze(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function gt(m,C){return Ze(m+(m-C+.5>>1))}function _t(m,C,B){return Math.abs(C-B)-Math.abs(m-B)}function $t(m,C,B,Y,pe,be,Le){for(Y=be[Le-1],B=0;B<pe;++B)be[Le+B]=Y=Ce(m[C+B],Y)}function tn(m,C,B,Y,pe){var be;for(be=0;be<B;++be){var Le=m[C+be],ke=Le>>8&255,Be=16711935&(Be=(Be=16711935&Le)+((ke<<16)+ke));Y[pe+be]=(4278255360&Le)+Be>>>0}}function Qe(m,C){C.jd=m>>0&255,C.hd=m>>8&255,C.ud=m>>16&255}function Yt(m,C,B,Y,pe,be){var Le;for(Le=0;Le<Y;++Le){var ke=C[B+Le],Be=ke>>>8,Ge=ke,ht=255&(ht=(ht=ke>>>16)+((m.jd<<24>>24)*(Be<<24>>24)>>>5));Ge=255&(Ge=(Ge=Ge+((m.hd<<24>>24)*(Be<<24>>24)>>>5))+((m.ud<<24>>24)*(ht<<24>>24)>>>5)),pe[be+Le]=(4278255360&ke)+(ht<<16)+Ge}}function Qt(m,C,B,Y,pe){O[C]=function(be,Le,ke,Be,Ge,ht,Ot,It,Lt){for(Be=Ot;Be<It;++Be)for(Ot=0;Ot<Lt;++Ot)Ge[ht++]=pe(ke[Y(be[Le++])])},O[m]=function(be,Le,ke,Be,Ge,ht,Ot){var It=8>>be.b,Lt=be.Ea,Vt=be.K[0],Ut=be.w;if(8>It)for(be=(1<<be.b)-1,Ut=(1<<It)-1;Le<ke;++Le){var ft,yt=0;for(ft=0;ft<Lt;++ft)ft&be||(yt=Y(Be[Ge++])),ht[Ot++]=pe(Vt[yt&Ut]),yt>>=It}else O["VP8LMapColor"+B](Be,Ge,Vt,Ut,ht,Ot,Le,ke,Lt)}}function Zt(m,C,B,Y,pe){for(B=C+B;C<B;){var be=m[C++];Y[pe++]=be>>16&255,Y[pe++]=be>>8&255,Y[pe++]=be>>0&255}}function wt(m,C,B,Y,pe){for(B=C+B;C<B;){var be=m[C++];Y[pe++]=be>>16&255,Y[pe++]=be>>8&255,Y[pe++]=be>>0&255,Y[pe++]=be>>24&255}}function He(m,C,B,Y,pe){for(B=C+B;C<B;){var be=(Le=m[C++])>>16&240|Le>>12&15,Le=Le>>0&240|Le>>28&15;Y[pe++]=be,Y[pe++]=Le}}function Kt(m,C,B,Y,pe){for(B=C+B;C<B;){var be=(Le=m[C++])>>16&248|Le>>13&7,Le=Le>>5&224|Le>>3&31;Y[pe++]=be,Y[pe++]=Le}}function on(m,C,B,Y,pe){for(B=C+B;C<B;){var be=m[C++];Y[pe++]=be>>0&255,Y[pe++]=be>>8&255,Y[pe++]=be>>16&255}}function Bn(m,C,B,Y,pe,be){if(be==0)for(B=C+B;C<B;)se(Y,((be=m[C++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),pe+=32;else r(Y,pe,m,C,B)}function kn(m,C){O[C][0]=O[m+"0"],O[C][1]=O[m+"1"],O[C][2]=O[m+"2"],O[C][3]=O[m+"3"],O[C][4]=O[m+"4"],O[C][5]=O[m+"5"],O[C][6]=O[m+"6"],O[C][7]=O[m+"7"],O[C][8]=O[m+"8"],O[C][9]=O[m+"9"],O[C][10]=O[m+"10"],O[C][11]=O[m+"11"],O[C][12]=O[m+"12"],O[C][13]=O[m+"13"],O[C][14]=O[m+"0"],O[C][15]=O[m+"0"]}function et(m){return m==cs||m==hs||m==bo||m==s}function On(){this.eb=[],this.size=this.A=this.fb=0}function Nn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function mn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new On,this.f.kb=new Nn,this.sd=null}function Pn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function zr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Gn(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Dt(m,C){var B=m.T,Y=C.ba.f.RGBA,pe=Y.eb,be=Y.fb+m.ka*Y.A,Le=xs[C.ba.S],ke=m.y,Be=m.O,Ge=m.f,ht=m.N,Ot=m.ea,It=m.W,Lt=C.cc,Vt=C.dc,Ut=C.Mc,ft=C.Nc,yt=m.ka,Jt=m.ka+m.T,cn=m.U,en=cn+1>>1;for(yt==0?Le(ke,Be,null,null,Ge,ht,Ot,It,Ge,ht,Ot,It,pe,be,null,null,cn):(Le(C.ec,C.fc,ke,Be,Lt,Vt,Ut,ft,Ge,ht,Ot,It,pe,be-Y.A,pe,be,cn),++B);yt+2<Jt;yt+=2)Lt=Ge,Vt=ht,Ut=Ot,ft=It,ht+=m.Rc,It+=m.Rc,be+=2*Y.A,Le(ke,(Be+=2*m.fa)-m.fa,ke,Be,Lt,Vt,Ut,ft,Ge,ht,Ot,It,pe,be-Y.A,pe,be,cn);return Be+=m.fa,m.j+Jt<m.o?(r(C.ec,C.fc,ke,Be,cn),r(C.cc,C.dc,Ge,ht,en),r(C.Mc,C.Nc,Ot,It,en),B--):1&Jt||Le(ke,Be,null,null,Ge,ht,Ot,It,Ge,ht,Ot,It,pe,be+Y.A,null,null,cn),B}function xr(m,C,B){var Y=m.F,pe=[m.J];if(Y!=null){var be=m.U,Le=C.ba.S,ke=Le==_o||Le==bo;C=C.ba.f.RGBA;var Be=[0],Ge=m.ka;Be[0]=m.T,m.Kb&&(Ge==0?--Be[0]:(--Ge,pe[0]-=m.width),m.j+m.ka+m.T==m.o&&(Be[0]=m.o-m.j-Ge));var ht=C.eb;Ge=C.fb+Ge*C.A,m=ni(Y,pe[0],m.width,be,Be,ht,Ge+(ke?0:3),C.A),n(B==Be),m&&et(Le)&&us(ht,Ge,ke,be,Be,C.A)}return 0}function lr(m){var C=m.ma,B=C.ba.S,Y=11>B,pe=B==er||B==Xo||B==_o||B==Ns||B==12||et(B);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!Dl(C.Oa,m,pe?11:12))return 0;if(pe&&et(B)&&ln(),m.da)alert("todo:use_scaling");else{if(Y){if(C.Ib=Gn,m.Kb){if(B=m.U+1>>1,C.memory=o(m.U+2*B),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+m.U,C.Mc=C.cc,C.Nc=C.dc+B,C.Ib=Dt,ln()}}else alert("todo:EmitYUV");pe&&(C.Jb=xr,Y&&Ct())}if(Y&&!au){for(m=0;256>m;++m)nc[m]=89858*(m-128)+ga>>tc,rc[m]=-22014*(m-128)+ga,ef[m]=-45773*(m-128),nl[m]=113618*(m-128)+ga>>tc;for(m=Bu;m<kc;++m)C=76283*(m-16)+ga>>tc,ic[m-Bu]=vr(C,255),fh[m-Bu]=vr(C+8>>4,15);au=1}return 1}function hi(m){var C=m.ma,B=m.U,Y=m.T;return n(!(1&m.ka)),0>=B||0>=Y?0:(B=C.Ib(m,C),C.Jb!=null&&C.Jb(m,C,B),C.Dc+=B,1)}function Ri(m){m.ma.memory=null}function Fn(m,C,B,Y){return Me(m,8)!=47?0:(C[0]=Me(m,14)+1,B[0]=Me(m,14)+1,Y[0]=Me(m,1),Me(m,3)!=0?0:!m.h)}function xi(m,C){if(4>m)return m+1;var B=m-2>>1;return(2+(1&m)<<B)+Me(C,B)+1}function Lr(m,C){return 120<C?C-120:1<=(B=((B=ot[C-1])>>4)*m+(8-(15&B)))?B:1;var B}function Gr(m,C,B){var Y=Ee(B),pe=m[C+=255&Y].g-8;return 0<pe&&(Z(B,B.u+8),Y=Ee(B),C+=m[C].value,C+=Y&(1<<pe)-1),Z(B,B.u+m[C].g),m[C].value}function Qn(m,C,B){return B.g+=m.g,B.value+=m.value<<C>>>0,n(8>=B.g),m.g}function kt(m,C,B){var Y=m.xc;return n((C=Y==0?0:m.vc[m.md*(B>>Y)+(C>>Y)])<m.Wb),m.Ya[C]}function Ei(m,C,B,Y){var pe=m.ab,be=m.c*C,Le=m.C;C=Le+C;var ke=B,Be=Y;for(Y=m.Ta,B=m.Ua;0<pe--;){var Ge=m.gc[pe],ht=Le,Ot=C,It=ke,Lt=Be,Vt=(Be=Y,ke=B,Ge.Ea);switch(n(ht<Ot),n(Ot<=Ge.nc),Ge.hc){case 2:ou(It,Lt,(Ot-ht)*Vt,Be,ke);break;case 0:var Ut=ht,ft=Ot,yt=Be,Jt=ke,cn=(a=Ge).Ea;Ut==0&&(ks(It,Lt,null,null,1,yt,Jt),$t(It,Lt+1,0,0,cn-1,yt,Jt+1),Lt+=cn,Jt+=cn,++Ut);for(var en=1<<a.b,xn=en-1,bn=Ie(cn,a.b),qn=a.K,a=a.w+(Ut>>a.b)*bn;Ut<ft;){var c=qn,p=a,y=1;for(Ts(It,Lt,yt,Jt-cn,1,yt,Jt);y<cn;){var S=(y&~xn)+en;S>cn&&(S=cn),(0,Zo[c[p++]>>8&15])(It,Lt+ +y,yt,Jt+y-cn,S-y,yt,Jt+y),y=S}Lt+=cn,Jt+=cn,++Ut&xn||(a+=bn)}Ot!=Ge.nc&&r(Be,ke-Vt,Be,ke+(Ot-ht-1)*Vt,Vt);break;case 1:for(Vt=It,ft=Lt,cn=(It=Ge.Ea)-(Jt=It&~(yt=(Lt=1<<Ge.b)-1)),Ut=Ie(It,Ge.b),en=Ge.K,Ge=Ge.w+(ht>>Ge.b)*Ut;ht<Ot;){for(xn=en,bn=Ge,qn=new Re,a=ft+Jt,c=ft+It;ft<a;)Qe(xn[bn++],qn),Ko(qn,Vt,ft,Lt,Be,ke),ft+=Lt,ke+=Lt;ft<c&&(Qe(xn[bn++],qn),Ko(qn,Vt,ft,cn,Be,ke),ft+=cn,ke+=cn),++ht&yt||(Ge+=Ut)}break;case 3:if(It==Be&&Lt==ke&&0<Ge.b){for(ft=Be,It=Vt=ke+(Ot-ht)*Vt-(Jt=(Ot-ht)*Ie(Ge.Ea,Ge.b)),Lt=Be,yt=ke,Ut=[],Jt=(cn=Jt)-1;0<=Jt;--Jt)Ut[Jt]=Lt[yt+Jt];for(Jt=cn-1;0<=Jt;--Jt)ft[It+Jt]=Ut[Jt];ns(Ge,ht,Ot,Be,Vt,Be,ke)}else ns(Ge,ht,Ot,It,Lt,Be,ke)}ke=Y,Be=B}Be!=B&&r(Y,B,ke,Be,be)}function Ai(m,C){var B=m.V,Y=m.Ba+m.c*m.C,pe=C-m.C;if(n(C<=m.l.o),n(16>=pe),0<pe){var be=m.l,Le=m.Ta,ke=m.Ua,Be=be.width;if(Ei(m,pe,B,Y),pe=ke=[ke],n((B=m.C)<(Y=C)),n(be.v<be.va),Y>be.o&&(Y=be.o),B<be.j){var Ge=be.j-B;B=be.j,pe[0]+=Ge*Be}if(B>=Y?B=0:(pe[0]+=4*be.v,be.ka=B-be.j,be.U=be.va-be.v,be.T=Y-B,B=1),B){if(ke=ke[0],11>(B=m.ca).S){var ht=B.f.RGBA,Ot=(Y=B.S,pe=be.U,be=be.T,Ge=ht.eb,ht.A),It=be;for(ht=ht.fb+m.Ma*ht.A;0<It--;){var Lt=Le,Vt=ke,Ut=pe,ft=Ge,yt=ht;switch(Y){case js:_s(Lt,Vt,Ut,ft,yt);break;case er:ls(Lt,Vt,Ut,ft,yt);break;case cs:ls(Lt,Vt,Ut,ft,yt),us(ft,yt,0,Ut,1,0);break;case Yo:bs(Lt,Vt,Ut,ft,yt);break;case Xo:Bn(Lt,Vt,Ut,ft,yt,1);break;case hs:Bn(Lt,Vt,Ut,ft,yt,1),us(ft,yt,0,Ut,1,0);break;case _o:Bn(Lt,Vt,Ut,ft,yt,0);break;case bo:Bn(Lt,Vt,Ut,ft,yt,0),us(ft,yt,1,Ut,1,0);break;case Ns:Bo(Lt,Vt,Ut,ft,yt);break;case s:Bo(Lt,Vt,Ut,ft,yt),Xr(ft,yt,Ut,1,0);break;case ku:ro(Lt,Vt,Ut,ft,yt);break;default:n(0)}ke+=Be,ht+=Ot}m.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");n(m.Ma<=B.height)}}m.C=C,n(m.C<=m.i)}function fi(m){var C;if(0<m.ua)return 0;for(C=0;C<m.Wb;++C){var B=m.Ya[C].G,Y=m.Ya[C].H;if(0<B[1][Y[1]+0].g||0<B[2][Y[2]+0].g||0<B[3][Y[3]+0].g)return 0}return 1}function ei(m,C,B,Y,pe,be){if(m.Z!=0){var Le=m.qd,ke=m.rd;for(n(Hr[m.Z]!=null);C<B;++C)Hr[m.Z](Le,ke,Y,pe,Y,pe,be),Le=Y,ke=pe,pe+=be;m.qd=Le,m.rd=ke}}function Di(m,C){var B=m.l.ma,Y=B.Z==0||B.Z==1?m.l.j:m.C;if(Y=m.C<Y?Y:m.C,n(C<=m.l.o),C>Y){var pe=m.l.width,be=B.ca,Le=B.tb+pe*Y,ke=m.V,Be=m.Ba+m.c*Y,Ge=m.gc;n(m.ab==1),n(Ge[0].hc==3),vs(Ge[0],Y,C,ke,Be,be,Le),ei(B,Y,C,be,Le,pe)}m.C=m.Ma=C}function Qi(m,C,B,Y,pe,be,Le){var ke=m.$/Y,Be=m.$%Y,Ge=m.m,ht=m.s,Ot=B+m.$,It=Ot;pe=B+Y*pe;var Lt=B+Y*be,Vt=280+ht.ua,Ut=m.Pb?ke:16777216,ft=0<ht.ua?ht.Wa:null,yt=ht.wc,Jt=Ot<Lt?kt(ht,Be,ke):null;n(m.C<be),n(Lt<=pe);var cn=!1;e:for(;;){for(;cn||Ot<Lt;){var en=0;if(ke>=Ut){var xn=Ot-B;n((Ut=m).Pb),Ut.wd=Ut.m,Ut.xd=xn,0<Ut.s.ua&&ye(Ut.s.Wa,Ut.s.vb),Ut=ke+jt}if(Be&yt||(Jt=kt(ht,Be,ke)),n(Jt!=null),Jt.Qb&&(C[Ot]=Jt.qb,cn=!0),!cn)if(he(Ge),Jt.jc){en=Ge,xn=C;var bn=Ot,qn=Jt.pd[Ee(en)&Wi-1];n(Jt.jc),256>qn.g?(Z(en,en.u+qn.g),xn[bn]=qn.value,en=0):(Z(en,en.u+qn.g-256),n(256<=qn.value),en=qn.value),en==0&&(cn=!0)}else en=Gr(Jt.G[0],Jt.H[0],Ge);if(Ge.h)break;if(cn||256>en){if(!cn)if(Jt.nd)C[Ot]=(Jt.qb|en<<8)>>>0;else{if(he(Ge),cn=Gr(Jt.G[1],Jt.H[1],Ge),he(Ge),xn=Gr(Jt.G[2],Jt.H[2],Ge),bn=Gr(Jt.G[3],Jt.H[3],Ge),Ge.h)break;C[Ot]=(bn<<24|cn<<16|en<<8|xn)>>>0}if(cn=!1,++Ot,++Be>=Y&&(Be=0,++ke,Le!=null&&ke<=be&&!(ke%16)&&Le(m,ke),ft!=null))for(;It<Ot;)en=C[It++],ft.X[(506832829*en&4294967295)>>>ft.Mb]=en}else if(280>en){if(en=xi(en-256,Ge),xn=Gr(Jt.G[4],Jt.H[4],Ge),he(Ge),xn=Lr(Y,xn=xi(xn,Ge)),Ge.h)break;if(Ot-B<xn||pe-Ot<en)break e;for(bn=0;bn<en;++bn)C[Ot+bn]=C[Ot+bn-xn];for(Ot+=en,Be+=en;Be>=Y;)Be-=Y,++ke,Le!=null&&ke<=be&&!(ke%16)&&Le(m,ke);if(n(Ot<=pe),Be&yt&&(Jt=kt(ht,Be,ke)),ft!=null)for(;It<Ot;)en=C[It++],ft.X[(506832829*en&4294967295)>>>ft.Mb]=en}else{if(!(en<Vt))break e;for(cn=en-280,n(ft!=null);It<Ot;)en=C[It++],ft.X[(506832829*en&4294967295)>>>ft.Mb]=en;en=Ot,n(!(cn>>>(xn=ft).Xa)),C[en]=xn.X[cn],cn=!0}cn||n(Ge.h==N(Ge))}if(m.Pb&&Ge.h&&Ot<pe)n(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&ye(m.s.vb,m.s.Wa);else{if(Ge.h)break e;Le!=null&&Le(m,ke>be?be:ke),m.a=0,m.$=Ot-B}return 1}return m.a=3,0}function Yn(m){n(m!=null),m.vc=null,m.yc=null,m.Ya=null;var C=m.Wa;C!=null&&(C.X=null),m.vb=null,n(m!=null)}function Mi(){var m=new Ba;return m==null?null:(m.a=0,m.xb=ml,kn("Predictor","VP8LPredictors"),kn("Predictor","VP8LPredictors_C"),kn("PredictorAdd","VP8LPredictorsAdd"),kn("PredictorAdd","VP8LPredictorsAdd_C"),ou=tn,Ko=Yt,_s=Zt,ls=wt,Bo=He,ro=Kt,bs=on,O.VP8LMapColor32b=Wo,O.VP8LMapColor8b=ys,m)}function Xs(m,C,B,Y,pe){var be=1,Le=[m],ke=[C],Be=Y.m,Ge=Y.s,ht=null,Ot=0;e:for(;;){if(B)for(;be&&Me(Be,1);){var It=Le,Lt=ke,Vt=Y,Ut=1,ft=Vt.m,yt=Vt.gc[Vt.ab],Jt=Me(ft,2);if(Vt.Oc&1<<Jt)be=0;else{switch(Vt.Oc|=1<<Jt,yt.hc=Jt,yt.Ea=It[0],yt.nc=Lt[0],yt.K=[null],++Vt.ab,n(4>=Vt.ab),Jt){case 0:case 1:yt.b=Me(ft,3)+2,Ut=Xs(Ie(yt.Ea,yt.b),Ie(yt.nc,yt.b),0,Vt,yt.K),yt.K=yt.K[0];break;case 3:var cn,en=Me(ft,8)+1,xn=16<en?0:4<en?1:2<en?2:3;if(It[0]=Ie(yt.Ea,xn),yt.b=xn,cn=Ut=Xs(en,1,0,Vt,yt.K)){var bn,qn=en,a=yt,c=1<<(8>>a.b),p=o(c);if(p==null)cn=0;else{var y=a.K[0],S=a.w;for(p[0]=a.K[0][0],bn=1;bn<1*qn;++bn)p[bn]=Ce(y[S+bn],p[bn-1]);for(;bn<4*c;++bn)p[bn]=0;a.K[0]=null,a.K[0]=p,cn=1}}Ut=cn;break;case 2:break;default:n(0)}be=Ut}}if(Le=Le[0],ke=ke[0],be&&Me(Be,1)&&!(be=1<=(Ot=Me(Be,4))&&11>=Ot)){Y.a=3;break e}var k;if(k=be)t:{var F,q,ae,ve=Y,Je=Le,$e=ke,mt=Ot,Nt=B,Wt=ve.m,gn=ve.s,vn=[null],Jn=1,Ke=0,nt=Tt[mt];n:for(;;){if(Nt&&Me(Wt,1)){var ct=Me(Wt,3)+2,Ft=Ie(Je,ct),xt=Ie($e,ct),Rt=Ft*xt;if(!Xs(Ft,xt,0,ve,vn))break n;for(vn=vn[0],gn.xc=ct,F=0;F<Rt;++F){var fe=vn[F]>>8&65535;vn[F]=fe,fe>=Jn&&(Jn=fe+1)}}if(Wt.h)break n;for(q=0;5>q;++q){var we=T[q];!q&&0<mt&&(we+=1<<mt),Ke<we&&(Ke=we)}var Oe=l(Jn*nt,D),Ne=Jn,ze=l(Ne,z);if(ze==null)var je=null;else n(65536>=Ne),je=ze;var at=o(Ke);if(je==null||at==null||Oe==null){ve.a=1;break n}var lt=Oe;for(F=ae=0;F<Jn;++F){var dt=je[F],Et=dt.G,At=dt.H,nn=0,An=1,Rn=0;for(q=0;5>q;++q){we=T[q],Et[q]=lt,At[q]=ae,!q&&0<mt&&(we+=1<<mt);i:{var Vn,Wr=we,ri=ve,Pr=at,ui=lt,qs=ae,Fl=0,zo=ri.m,Tc=Me(zo,1);if(i(Pr,0,0,Wr),Tc){var ma=Me(zo,1)+1,lu=Me(zo,1),jo=Me(zo,lu==0?1:8);Pr[jo]=1,ma==2&&(Pr[jo=Me(zo,8)]=1);var Ls=1}else{var $i=o(19),vh=Me(zo,4)+4;if(19<vh){ri.a=3;var Bc=0;break i}for(Vn=0;Vn<vh;++Vn)$i[_e[Vn]]=Me(zo,3);var Nc=void 0,Rc=void 0,yh=ri,Ir=$i,_h=Wr,ed=Pr,Nu=0,zl=yh.m,td=8,nd=l(128,D);r:for(;H(nd,0,7,Ir,19);){if(Me(zl,1)){var Oa=2+2*Me(zl,3);if((Nc=2+Me(zl,Oa))>_h)break r}else Nc=_h;for(Rc=0;Rc<_h&&Nc--;){he(zl);var rd=nd[0+(127&Ee(zl))];Z(zl,zl.u+rd.g);var jl=rd.value;if(16>jl)ed[Rc++]=jl,jl!=0&&(td=jl);else{var tf=jl==16,nf=jl-16,id=w[nf],ea=Me(zl,f[nf])+id;if(Rc+ea>_h)break r;for(var uu=tf?td:0;0<ea--;)ed[Rc++]=uu}}Nu=1;break r}Nu||(yh.a=3),Ls=Nu}(Ls=Ls&&!zo.h)&&(Fl=H(ui,qs,8,Pr,Wr)),Ls&&Fl!=0?Bc=Fl:(ri.a=3,Bc=0)}if(Bc==0)break n;if(An&&J[q]==1&&(An=lt[ae].g==0),nn+=lt[ae].g,ae+=Bc,3>=q){var Ru,bh=at[0];for(Ru=1;Ru<we;++Ru)at[Ru]>bh&&(bh=at[Ru]);Rn+=bh}}if(dt.nd=An,dt.Qb=0,An&&(dt.qb=(Et[3][At[3]+0].value<<24|Et[1][At[1]+0].value<<16|Et[2][At[2]+0].value)>>>0,nn==0&&256>Et[0][At[0]+0].value&&(dt.Qb=1,dt.qb+=Et[0][At[0]+0].value<<8)),dt.jc=!dt.Qb&&6>Rn,dt.jc){var Du,vl=dt;for(Du=0;Du<Wi;++Du){var yl=Du,Ul=vl.pd[yl],sc=vl.G[0][vl.H[0]+yl];256<=sc.value?(Ul.g=sc.g+256,Ul.value=sc.value):(Ul.g=0,Ul.value=0,yl>>=Qn(sc,8,Ul),yl>>=Qn(vl.G[1][vl.H[1]+yl],16,Ul),yl>>=Qn(vl.G[2][vl.H[2]+yl],0,Ul),Qn(vl.G[3][vl.H[3]+yl],24,Ul))}}}gn.vc=vn,gn.Wb=Jn,gn.Ya=je,gn.yc=Oe,k=1;break t}k=0}if(!(be=k)){Y.a=3;break e}if(0<Ot){if(Ge.ua=1<<Ot,!xe(Ge.Wa,Ot)){Y.a=1,be=0;break e}}else Ge.ua=0;var Dc=Y,$l=Le,Wp=ke,_l=Dc.s,wh=_l.xc;if(Dc.c=$l,Dc.i=Wp,_l.md=Ie($l,wh),_l.wc=wh==0?-1:(1<<wh)-1,B){Y.xb=Mc;break e}if((ht=o(Le*ke))==null){Y.a=1,be=0;break e}be=(be=Qi(Y,ht,0,Le,ke,ke,null))&&!Be.h;break e}return be?(pe!=null?pe[0]=ht:(n(ht==null),n(B)),Y.$=0,B||Yn(Ge)):Yn(Ge),be}function Ps(m,C){var B=m.c*m.i,Y=B+C+16*C;return n(m.c<=C),m.V=o(Y),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+B+C,1)}function Tr(m,C){var B=m.C,Y=C-B,pe=m.V,be=m.Ba+m.c*B;for(n(C<=m.l.o);0<Y;){var Le=16<Y?16:Y,ke=m.l.ma,Be=m.l.width,Ge=Be*Le,ht=ke.ca,Ot=ke.tb+Be*B,It=m.Ta,Lt=m.Ua;Ei(m,Le,pe,be),Ui(It,Lt,ht,Ot,Ge),ei(ke,B,B+Le,ht,Ot,Be),Y-=Le,pe+=Le*m.c,B+=Le}n(B==C),m.C=m.Ma=C}function Cn(){this.ub=this.yd=this.td=this.Rb=0}function di(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Dr(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function si(){this.Yb=function(){var m=[];return function C(B,Y,pe){for(var be=pe[Y],Le=0;Le<be&&(B.push(pe.length>Y+1?[]:0),!(pe.length<Y+1));Le++)C(B[Le],Y+1,pe)}(m,0,[3,11]),m}()}function mi(){this.jb=o(3),this.Wc=h([4,8],si),this.Xc=h([4,17],si)}function Es(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function is(){this.ld=this.La=this.dd=this.tc=0}function pr(){this.Na=this.la=0}function fo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ti(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ki(){this.uc=this.M=this.Nb=0,this.wa=Array(new is),this.Y=0,this.ya=Array(new ti),this.aa=0,this.l=new Xt}function Br(){this.y=o(16),this.f=o(8),this.ea=o(8)}function _n(){this.cb=this.a=0,this.sc="",this.m=new st,this.Od=new Cn,this.Kc=new di,this.ed=new Es,this.Qa=new Dr,this.Ic=this.$c=this.Aa=0,this.D=new ki,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,st),this.ia=0,this.pb=l(4,fo),this.Pa=new mi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Br),this.Hd=0,this.rb=Array(new pr),this.sb=0,this.wa=Array(new is),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ti),this.L=this.aa=0,this.gd=h([4,2],is),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Tn(){var m=new _n;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,$n||($n=ss)),m}function In(m,C,B){return m.a==0&&(m.a=C,m.sc=B,m.cb=0),0}function Oi(m,C,B){return 3<=B&&m[C+0]==157&&m[C+1]==1&&m[C+2]==42}function es(m,C){if(m==null)return 0;if(m.a=0,m.sc="OK",C==null)return In(m,2,"null VP8Io passed to VP8GetHeaders()");var B=C.data,Y=C.w,pe=C.ha;if(4>pe)return In(m,7,"Truncated header.");var be=B[Y+0]|B[Y+1]<<8|B[Y+2]<<16,Le=m.Od;if(Le.Rb=!(1&be),Le.td=be>>1&7,Le.yd=be>>4&1,Le.ub=be>>5,3<Le.td)return In(m,3,"Incorrect keyframe parameters.");if(!Le.yd)return In(m,4,"Frame not displayable.");Y+=3,pe-=3;var ke=m.Kc;if(Le.Rb){if(7>pe)return In(m,7,"cannot parse picture header");if(!Oi(B,Y,pe))return In(m,3,"Bad code word");ke.c=16383&(B[Y+4]<<8|B[Y+3]),ke.Td=B[Y+4]>>6,ke.i=16383&(B[Y+6]<<8|B[Y+5]),ke.Ud=B[Y+6]>>6,Y+=7,pe-=7,m.za=ke.c+15>>4,m.Ub=ke.i+15>>4,C.width=ke.c,C.height=ke.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,i((be=m.Pa).jb,0,255,be.jb.length),n((be=m.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,i(be.Zb,0,0,be.Zb.length),i(be.Lb,0,0,be.Lb)}if(Le.ub>pe)return In(m,7,"bad partition length");U(be=m.m,B,Y,Le.ub),Y+=Le.ub,pe-=Le.ub,Le.Rb&&(ke.Ld=te(be),ke.Kd=te(be)),ke=m.Qa;var Be,Ge=m.Pa;if(n(be!=null),n(ke!=null),ke.Cb=te(be),ke.Cb){if(ke.Bb=te(be),te(be)){for(ke.Fb=te(be),Be=0;4>Be;++Be)ke.Zb[Be]=te(be)?ue(be,7):0;for(Be=0;4>Be;++Be)ke.Lb[Be]=te(be)?ue(be,6):0}if(ke.Bb)for(Be=0;3>Be;++Be)Ge.jb[Be]=te(be)?G(be,8):255}else ke.Bb=0;if(be.Ka)return In(m,3,"cannot parse segment header");if((ke=m.ed).zd=te(be),ke.Tb=G(be,6),ke.wb=G(be,3),ke.Pc=te(be),ke.Pc&&te(be)){for(Ge=0;4>Ge;++Ge)te(be)&&(ke.vd[Ge]=ue(be,6));for(Ge=0;4>Ge;++Ge)te(be)&&(ke.od[Ge]=ue(be,6))}if(m.L=ke.Tb==0?0:ke.zd?1:2,be.Ka)return In(m,3,"cannot parse filter header");var ht=pe;if(pe=Be=Y,Y=Be+ht,ke=ht,m.Xb=(1<<G(m.m,2))-1,ht<3*(Ge=m.Xb))B=7;else{for(Be+=3*Ge,ke-=3*Ge,ht=0;ht<Ge;++ht){var Ot=B[pe+0]|B[pe+1]<<8|B[pe+2]<<16;Ot>ke&&(Ot=ke),U(m.Jc[+ht],B,Be,Ot),Be+=Ot,ke-=Ot,pe+=3}U(m.Jc[+Ge],B,Be,ke),B=Be<Y?0:5}if(B!=0)return In(m,B,"cannot parse partitions");for(B=G(Be=m.m,7),pe=te(Be)?ue(Be,4):0,Y=te(Be)?ue(Be,4):0,ke=te(Be)?ue(Be,4):0,Ge=te(Be)?ue(Be,4):0,Be=te(Be)?ue(Be,4):0,ht=m.Qa,Ot=0;4>Ot;++Ot){if(ht.Cb){var It=ht.Zb[Ot];ht.Fb||(It+=B)}else{if(0<Ot){m.pb[Ot]=m.pb[0];continue}It=B}var Lt=m.pb[Ot];Lt.Sc[0]=rn[vr(It+pe,127)],Lt.Sc[1]=Sn[vr(It+0,127)],Lt.Eb[0]=2*rn[vr(It+Y,127)],Lt.Eb[1]=101581*Sn[vr(It+ke,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=rn[vr(It+Ge,117)],Lt.Qc[1]=Sn[vr(It+Be,127)],Lt.lc=It+Be}if(!Le.Rb)return In(m,4,"Not a key frame.");for(te(be),Le=m.Pa,B=0;4>B;++B){for(pe=0;8>pe;++pe)for(Y=0;3>Y;++Y)for(ke=0;11>ke;++ke)Ge=ee(be,Us[B][pe][Y][ke])?G(be,8):fs[B][pe][Y][ke],Le.Wc[B][pe].Yb[Y][ke]=Ge;for(pe=0;17>pe;++pe)Le.Xc[B][pe]=Le.Wc[B][Tu[pe]]}return m.kc=te(be),m.kc&&(m.Bd=G(be,8)),m.cb=1}function ss(m,C,B,Y,pe,be,Le){var ke=C[pe].Yb[B];for(B=0;16>pe;++pe){if(!ee(m,ke[B+0]))return pe;for(;!ee(m,ke[B+1]);)if(ke=C[++pe].Yb[0],B=0,pe==16)return 16;var Be=C[pe+1].Yb;if(ee(m,ke[B+2])){var Ge=m,ht=0;if(ee(Ge,(It=ke)[(Ot=B)+3]))if(ee(Ge,It[Ot+6])){for(ke=0,Ot=2*(ht=ee(Ge,It[Ot+8]))+(It=ee(Ge,It[Ot+9+ht])),ht=0,It=gr[Ot];It[ke];++ke)ht+=ht+ee(Ge,It[ke]);ht+=3+(8<<Ot)}else ee(Ge,It[Ot+7])?(ht=7+2*ee(Ge,165),ht+=ee(Ge,145)):ht=5+ee(Ge,159);else ht=ee(Ge,It[Ot+4])?3+ee(Ge,It[Ot+5]):2;ke=Be[2]}else ht=1,ke=Be[1];Be=Le+Ki[pe],0>(Ge=m).b&&ne(Ge);var Ot,It=Ge.b,Lt=(Ot=Ge.Ca>>1)-(Ge.I>>It)>>31;--Ge.b,Ge.Ca+=Lt,Ge.Ca|=1,Ge.I-=(Ot+1&Lt)<<It,be[Be]=((ht^Lt)-Lt)*Y[(0<pe)+0]}return 16}function ps(m){var C=m.rb[m.sb-1];C.la=0,C.Na=0,i(m.zc,0,0,m.zc.length),m.ja=0}function tr(m,C){if(m==null)return 0;if(C==null)return In(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!es(m,C))return 0;if(n(m.cb),C.ac==null||C.ac(C)){C.ob&&(m.L=0);var B=Qo[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=C.v-B>>4,m.zb=C.j-B>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=C.o+15+B>>4,m.Hb=C.va+15+B>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var Y=m.ed;for(B=0;4>B;++B){var pe;if(m.Qa.Cb){var be=m.Qa.Lb[B];m.Qa.Fb||(be+=Y.Tb)}else be=Y.Tb;for(pe=0;1>=pe;++pe){var Le=m.gd[B][pe],ke=be;if(Y.Pc&&(ke+=Y.vd[0],pe&&(ke+=Y.od[0])),0<(ke=0>ke?0:63<ke?63:ke)){var Be=ke;0<Y.wb&&(Be=4<Y.wb?Be>>2:Be>>1)>9-Y.wb&&(Be=9-Y.wb),1>Be&&(Be=1),Le.dd=Be,Le.tc=2*ke+Be,Le.ld=40<=ke?2:15<=ke?1:0}else Le.tc=0;Le.La=pe}}}B=0}else In(m,6,"Frame setup failed"),B=m.a;if(B=B==0){if(B){m.$c=0,0<m.Aa||(m.Ic=gh);e:{B=m.Ic,Y=4*(Be=m.za);var Ge=32*Be,ht=Be+1,Ot=0<m.L?Be*(0<m.Aa?2:1):0,It=(m.Aa==2?2:1)*Be;if((Le=Y+832+(pe=3*(16*B+Qo[m.L])/2*Ge)+(be=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=Le)B=0;else{if(Le>m.Vb){if(m.Vb=0,m.Ec=o(Le),m.Fc=0,m.Ec==null){B=In(m,1,"no memory during frame initialization.");break e}m.Vb=Le}Le=m.Ec,ke=m.Fc,m.Ac=Le,m.Bc=ke,ke+=Y,m.Gd=l(Ge,Br),m.Hd=0,m.rb=l(ht+1,pr),m.sb=1,m.wa=Ot?l(Ot,is):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=Be),n(!0),m.oc=Le,m.pc=ke,ke+=832,m.ya=l(It,ti),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=Be),m.R=16*Be,m.B=8*Be,Be=(Ge=Qo[m.L])*m.R,Ge=Ge/2*m.B,m.sa=Le,m.ta=ke+Be,m.qa=m.sa,m.ra=m.ta+16*B*m.R+Ge,m.Ha=m.qa,m.Ia=m.ra+8*B*m.B+Ge,m.$c=0,ke+=pe,m.mb=be?Le:null,m.nb=be?ke:null,n(ke+be<=m.Fc+m.Vb),ps(m),i(m.Ac,m.Bc,0,Y),B=1}}if(B){if(C.ka=0,C.y=m.sa,C.O=m.ta,C.f=m.qa,C.N=m.ra,C.ea=m.Ha,C.Vd=m.Ia,C.fa=m.R,C.Rc=m.B,C.F=null,C.J=0,!Ol){for(B=-255;255>=B;++B)li[255+B]=0>B?-B:B;for(B=-1020;1020>=B;++B)io[1020+B]=-128>B?-128:127<B?127:B;for(B=-112;112>=B;++B)zs[112+B]=-16>B?-16:15<B?15:B;for(B=-255;510>=B;++B)co[255+B]=0>B?0:255<B?255:B;Ol=1}bt=ao,qt=Ao,wn=oo,zn=vi,sr=As,Bt=Qs,_i=pl,Yr=Mo,tl=uo,Bs=Qa,bi=Ya,No=Xa,Jo=Zr,Ro=su,Do=Ii,Oo=Wn,Cr=Fi,yo=Ta,wo[0]=Or,wo[1]=Ea,wo[2]=ur,wo[3]=po,wo[4]=Nl,wo[5]=Ma,wo[6]=Aa,wo[7]=go,wo[8]=Rl,wo[9]=ha,Fo[0]=Wa,Fo[1]=lo,Fo[2]=Li,Fo[3]=Vo,Fo[4]=ts,Fo[5]=ru,Fo[6]=hl,ho[0]=fa,ho[1]=jr,ho[2]=Za,ho[3]=or,ho[4]=Ka,ho[5]=iu,ho[6]=fl,B=1}else B=0}B&&(B=function(Lt,Vt){for(Lt.M=0;Lt.M<Lt.Va;++Lt.M){var Ut,ft=Lt.Jc[Lt.M&Lt.Xb],yt=Lt.m,Jt=Lt;for(Ut=0;Ut<Jt.za;++Ut){var cn=yt,en=Jt,xn=en.Ac,bn=en.Bc+4*Ut,qn=en.zc,a=en.ya[en.aa+Ut];if(en.Qa.Bb?a.$b=ee(cn,en.Pa.jb[0])?2+ee(cn,en.Pa.jb[2]):ee(cn,en.Pa.jb[1]):a.$b=0,en.kc&&(a.Ad=ee(cn,en.Bd)),a.Za=!ee(cn,145)+0,a.Za){var c=a.Ob,p=0;for(en=0;4>en;++en){var y,S=qn[0+en];for(y=0;4>y;++y){S=wi[xn[bn+y]][S];for(var k=Ti[ee(cn,S[0])];0<k;)k=Ti[2*k+ee(cn,S[k])];S=-k,xn[bn+y]=S}r(c,p,xn,bn,4),p+=4,qn[0+en]=S}}else S=ee(cn,156)?ee(cn,128)?1:3:ee(cn,163)?2:0,a.Ob[0]=S,i(xn,bn,S,4),i(qn,0,S,4);a.Dd=ee(cn,142)?ee(cn,114)?ee(cn,183)?1:3:2:0}if(Jt.m.Ka)return In(Lt,7,"Premature end-of-partition0 encountered.");for(;Lt.ja<Lt.za;++Lt.ja){if(Jt=ft,cn=(yt=Lt).rb[yt.sb-1],xn=yt.rb[yt.sb+yt.ja],Ut=yt.ya[yt.aa+yt.ja],bn=yt.kc?Ut.Ad:0)cn.la=xn.la=0,Ut.Za||(cn.Na=xn.Na=0),Ut.Hc=0,Ut.Gc=0,Ut.ia=0;else{var F,q;if(cn=xn,xn=Jt,bn=yt.Pa.Xc,qn=yt.ya[yt.aa+yt.ja],a=yt.pb[qn.$b],en=qn.ad,c=0,p=yt.rb[yt.sb-1],S=y=0,i(en,c,0,384),qn.Za)var ae=0,ve=bn[3];else{k=o(16);var Je=cn.Na+p.Na;if(Je=$n(xn,bn[1],Je,a.Eb,0,k,0),cn.Na=p.Na=(0<Je)+0,1<Je)bt(k,0,en,c);else{var $e=k[0]+3>>3;for(k=0;256>k;k+=16)en[c+k]=$e}ae=1,ve=bn[0]}var mt=15&cn.la,Nt=15&p.la;for(k=0;4>k;++k){var Wt=1&Nt;for($e=q=0;4>$e;++$e)mt=mt>>1|(Wt=(Je=$n(xn,ve,Je=Wt+(1&mt),a.Sc,ae,en,c))>ae)<<7,q=q<<2|(3<Je?3:1<Je?2:en[c+0]!=0),c+=16;mt>>=4,Nt=Nt>>1|Wt<<7,y=(y<<8|q)>>>0}for(ve=mt,ae=Nt>>4,F=0;4>F;F+=2){for(q=0,mt=cn.la>>4+F,Nt=p.la>>4+F,k=0;2>k;++k){for(Wt=1&Nt,$e=0;2>$e;++$e)Je=Wt+(1&mt),mt=mt>>1|(Wt=0<(Je=$n(xn,bn[2],Je,a.Qc,0,en,c)))<<3,q=q<<2|(3<Je?3:1<Je?2:en[c+0]!=0),c+=16;mt>>=2,Nt=Nt>>1|Wt<<5}S|=q<<4*F,ve|=mt<<4<<F,ae|=(240&Nt)<<F}cn.la=ve,p.la=ae,qn.Hc=y,qn.Gc=S,qn.ia=43690&S?0:a.ia,bn=!(y|S)}if(0<yt.L&&(yt.wa[yt.Y+yt.ja]=yt.gd[Ut.$b][Ut.Za],yt.wa[yt.Y+yt.ja].La|=!bn),Jt.Ka)return In(Lt,7,"Premature end-of-file encountered.")}if(ps(Lt),yt=Vt,Jt=1,Ut=(ft=Lt).D,cn=0<ft.L&&ft.M>=ft.zb&&ft.M<=ft.Va,ft.Aa==0)e:{if(Ut.M=ft.M,Ut.uc=cn,gl(ft,Ut),Jt=1,Ut=(q=ft.D).Nb,cn=(S=Qo[ft.L])*ft.R,xn=S/2*ft.B,k=16*Ut*ft.R,$e=8*Ut*ft.B,bn=ft.sa,qn=ft.ta-cn+k,a=ft.qa,en=ft.ra-xn+$e,c=ft.Ha,p=ft.Ia-xn+$e,Nt=(mt=q.M)==0,y=mt>=ft.Va-1,ft.Aa==2&&gl(ft,q),q.uc)for(Wt=(Je=ft).D.M,n(Je.D.uc),q=Je.yb;q<Je.Hb;++q){ae=q,ve=Wt;var gn=(vn=(we=Je).D).Nb;F=we.R;var vn=vn.wa[vn.Y+ae],Jn=we.sa,Ke=we.ta+16*gn*F+16*ae,nt=vn.dd,ct=vn.tc;if(ct!=0)if(n(3<=ct),we.L==1)0<ae&&Oo(Jn,Ke,F,ct+4),vn.La&&yo(Jn,Ke,F,ct),0<ve&&Do(Jn,Ke,F,ct+4),vn.La&&Cr(Jn,Ke,F,ct);else{var Ft=we.B,xt=we.qa,Rt=we.ra+8*gn*Ft+8*ae,fe=we.Ha,we=we.Ia+8*gn*Ft+8*ae;gn=vn.ld,0<ae&&(Yr(Jn,Ke,F,ct+4,nt,gn),Bs(xt,Rt,fe,we,Ft,ct+4,nt,gn)),vn.La&&(No(Jn,Ke,F,ct,nt,gn),Ro(xt,Rt,fe,we,Ft,ct,nt,gn)),0<ve&&(_i(Jn,Ke,F,ct+4,nt,gn),tl(xt,Rt,fe,we,Ft,ct+4,nt,gn)),vn.La&&(bi(Jn,Ke,F,ct,nt,gn),Jo(xt,Rt,fe,we,Ft,ct,nt,gn))}}if(ft.ia&&alert("todo:DitherRow"),yt.put!=null){if(q=16*mt,mt=16*(mt+1),Nt?(yt.y=ft.sa,yt.O=ft.ta+k,yt.f=ft.qa,yt.N=ft.ra+$e,yt.ea=ft.Ha,yt.W=ft.Ia+$e):(q-=S,yt.y=bn,yt.O=qn,yt.f=a,yt.N=en,yt.ea=c,yt.W=p),y||(mt-=S),mt>yt.o&&(mt=yt.o),yt.F=null,yt.J=null,ft.Fa!=null&&0<ft.Fa.length&&q<mt&&(yt.J=zi(ft,yt,q,mt-q),yt.F=ft.mb,yt.F==null&&yt.F.length==0)){Jt=In(ft,3,"Could not decode alpha data.");break e}q<yt.j&&(S=yt.j-q,q=yt.j,n(!(1&S)),yt.O+=ft.R*S,yt.N+=ft.B*(S>>1),yt.W+=ft.B*(S>>1),yt.F!=null&&(yt.J+=yt.width*S)),q<mt&&(yt.O+=yt.v,yt.N+=yt.v>>1,yt.W+=yt.v>>1,yt.F!=null&&(yt.J+=yt.v),yt.ka=q-yt.j,yt.U=yt.va-yt.v,yt.T=mt-q,Jt=yt.put(yt))}Ut+1!=ft.Ic||y||(r(ft.sa,ft.ta-cn,bn,qn+16*ft.R,cn),r(ft.qa,ft.ra-xn,a,en+8*ft.B,xn),r(ft.Ha,ft.Ia-xn,c,p+8*ft.B,xn))}if(!Jt)return In(Lt,6,"Output aborted.")}return 1}(m,C)),C.bc!=null&&C.bc(C),B&=1}return B?(m.cb=0,B):0}function pn(m,C,B,Y,pe){pe=m[C+B+32*Y]+(pe>>3),m[C+B+32*Y]=-256&pe?0>pe?0:255:pe}function pi(m,C,B,Y,pe,be){pn(m,C,0,B,Y+pe),pn(m,C,1,B,Y+be),pn(m,C,2,B,Y-be),pn(m,C,3,B,Y-pe)}function $r(m){return(20091*m>>16)+m}function oi(m,C,B,Y){var pe,be=0,Le=o(16);for(pe=0;4>pe;++pe){var ke=m[C+0]+m[C+8],Be=m[C+0]-m[C+8],Ge=(35468*m[C+4]>>16)-$r(m[C+12]),ht=$r(m[C+4])+(35468*m[C+12]>>16);Le[be+0]=ke+ht,Le[be+1]=Be+Ge,Le[be+2]=Be-Ge,Le[be+3]=ke-ht,be+=4,C++}for(pe=be=0;4>pe;++pe)ke=(m=Le[be+0]+4)+Le[be+8],Be=m-Le[be+8],Ge=(35468*Le[be+4]>>16)-$r(Le[be+12]),pn(B,Y,0,0,ke+(ht=$r(Le[be+4])+(35468*Le[be+12]>>16))),pn(B,Y,1,0,Be+Ge),pn(B,Y,2,0,Be-Ge),pn(B,Y,3,0,ke-ht),be++,Y+=32}function Qs(m,C,B,Y){var pe=m[C+0]+4,be=35468*m[C+4]>>16,Le=$r(m[C+4]),ke=35468*m[C+1]>>16;pi(B,Y,0,pe+Le,m=$r(m[C+1]),ke),pi(B,Y,1,pe+be,m,ke),pi(B,Y,2,pe-be,m,ke),pi(B,Y,3,pe-Le,m,ke)}function Ao(m,C,B,Y,pe){oi(m,C,B,Y),pe&&oi(m,C+16,B,Y+4)}function oo(m,C,B,Y){qt(m,C+0,B,Y,1),qt(m,C+32,B,Y+128,1)}function vi(m,C,B,Y){var pe;for(m=m[C+0]+4,pe=0;4>pe;++pe)for(C=0;4>C;++C)pn(B,Y,C,pe,m)}function As(m,C,B,Y){m[C+0]&&zn(m,C+0,B,Y),m[C+16]&&zn(m,C+16,B,Y+4),m[C+32]&&zn(m,C+32,B,Y+128),m[C+48]&&zn(m,C+48,B,Y+128+4)}function ao(m,C,B,Y){var pe,be=o(16);for(pe=0;4>pe;++pe){var Le=m[C+0+pe]+m[C+12+pe],ke=m[C+4+pe]+m[C+8+pe],Be=m[C+4+pe]-m[C+8+pe],Ge=m[C+0+pe]-m[C+12+pe];be[0+pe]=Le+ke,be[8+pe]=Le-ke,be[4+pe]=Ge+Be,be[12+pe]=Ge-Be}for(pe=0;4>pe;++pe)Le=(m=be[0+4*pe]+3)+be[3+4*pe],ke=be[1+4*pe]+be[2+4*pe],Be=be[1+4*pe]-be[2+4*pe],Ge=m-be[3+4*pe],B[Y+0]=Le+ke>>3,B[Y+16]=Ge+Be>>3,B[Y+32]=Le-ke>>3,B[Y+48]=Ge-Be>>3,Y+=64}function os(m,C,B){var Y,pe=C-32,be=ai,Le=255-m[pe-1];for(Y=0;Y<B;++Y){var ke,Be=be,Ge=Le+m[C-1];for(ke=0;ke<B;++ke)m[C+ke]=Be[Ge+m[pe+ke]];C+=32}}function Ea(m,C){os(m,C,4)}function jr(m,C){os(m,C,8)}function lo(m,C){os(m,C,16)}function Li(m,C){var B;for(B=0;16>B;++B)r(m,C+32*B,m,C-32,16)}function Vo(m,C){var B;for(B=16;0<B;--B)i(m,C,m[C-1],16),C+=32}function ca(m,C,B){var Y;for(Y=0;16>Y;++Y)i(C,B+32*Y,m,16)}function Wa(m,C){var B,Y=16;for(B=0;16>B;++B)Y+=m[C-1+32*B]+m[C+B-32];ca(Y>>5,m,C)}function ts(m,C){var B,Y=8;for(B=0;16>B;++B)Y+=m[C-1+32*B];ca(Y>>4,m,C)}function ru(m,C){var B,Y=8;for(B=0;16>B;++B)Y+=m[C+B-32];ca(Y>>4,m,C)}function hl(m,C){ca(128,m,C)}function ir(m,C,B){return m+2*C+B+2>>2}function ur(m,C){var B,Y=C-32;for(Y=new Uint8Array([ir(m[Y-1],m[Y+0],m[Y+1]),ir(m[Y+0],m[Y+1],m[Y+2]),ir(m[Y+1],m[Y+2],m[Y+3]),ir(m[Y+2],m[Y+3],m[Y+4])]),B=0;4>B;++B)r(m,C+32*B,Y,0,Y.length)}function po(m,C){var B=m[C-1],Y=m[C-1+32],pe=m[C-1+64],be=m[C-1+96];se(m,C+0,16843009*ir(m[C-1-32],B,Y)),se(m,C+32,16843009*ir(B,Y,pe)),se(m,C+64,16843009*ir(Y,pe,be)),se(m,C+96,16843009*ir(pe,be,be))}function Or(m,C){var B,Y=4;for(B=0;4>B;++B)Y+=m[C+B-32]+m[C-1+32*B];for(Y>>=3,B=0;4>B;++B)i(m,C+32*B,Y,4)}function Nl(m,C){var B=m[C-1+0],Y=m[C-1+32],pe=m[C-1+64],be=m[C-1-32],Le=m[C+0-32],ke=m[C+1-32],Be=m[C+2-32],Ge=m[C+3-32];m[C+0+96]=ir(Y,pe,m[C-1+96]),m[C+1+96]=m[C+0+64]=ir(B,Y,pe),m[C+2+96]=m[C+1+64]=m[C+0+32]=ir(be,B,Y),m[C+3+96]=m[C+2+64]=m[C+1+32]=m[C+0+0]=ir(Le,be,B),m[C+3+64]=m[C+2+32]=m[C+1+0]=ir(ke,Le,be),m[C+3+32]=m[C+2+0]=ir(Be,ke,Le),m[C+3+0]=ir(Ge,Be,ke)}function Aa(m,C){var B=m[C+1-32],Y=m[C+2-32],pe=m[C+3-32],be=m[C+4-32],Le=m[C+5-32],ke=m[C+6-32],Be=m[C+7-32];m[C+0+0]=ir(m[C+0-32],B,Y),m[C+1+0]=m[C+0+32]=ir(B,Y,pe),m[C+2+0]=m[C+1+32]=m[C+0+64]=ir(Y,pe,be),m[C+3+0]=m[C+2+32]=m[C+1+64]=m[C+0+96]=ir(pe,be,Le),m[C+3+32]=m[C+2+64]=m[C+1+96]=ir(be,Le,ke),m[C+3+64]=m[C+2+96]=ir(Le,ke,Be),m[C+3+96]=ir(ke,Be,Be)}function Ma(m,C){var B=m[C-1+0],Y=m[C-1+32],pe=m[C-1+64],be=m[C-1-32],Le=m[C+0-32],ke=m[C+1-32],Be=m[C+2-32],Ge=m[C+3-32];m[C+0+0]=m[C+1+64]=be+Le+1>>1,m[C+1+0]=m[C+2+64]=Le+ke+1>>1,m[C+2+0]=m[C+3+64]=ke+Be+1>>1,m[C+3+0]=Be+Ge+1>>1,m[C+0+96]=ir(pe,Y,B),m[C+0+64]=ir(Y,B,be),m[C+0+32]=m[C+1+96]=ir(B,be,Le),m[C+1+32]=m[C+2+96]=ir(be,Le,ke),m[C+2+32]=m[C+3+96]=ir(Le,ke,Be),m[C+3+32]=ir(ke,Be,Ge)}function go(m,C){var B=m[C+0-32],Y=m[C+1-32],pe=m[C+2-32],be=m[C+3-32],Le=m[C+4-32],ke=m[C+5-32],Be=m[C+6-32],Ge=m[C+7-32];m[C+0+0]=B+Y+1>>1,m[C+1+0]=m[C+0+64]=Y+pe+1>>1,m[C+2+0]=m[C+1+64]=pe+be+1>>1,m[C+3+0]=m[C+2+64]=be+Le+1>>1,m[C+0+32]=ir(B,Y,pe),m[C+1+32]=m[C+0+96]=ir(Y,pe,be),m[C+2+32]=m[C+1+96]=ir(pe,be,Le),m[C+3+32]=m[C+2+96]=ir(be,Le,ke),m[C+3+64]=ir(Le,ke,Be),m[C+3+96]=ir(ke,Be,Ge)}function ha(m,C){var B=m[C-1+0],Y=m[C-1+32],pe=m[C-1+64],be=m[C-1+96];m[C+0+0]=B+Y+1>>1,m[C+2+0]=m[C+0+32]=Y+pe+1>>1,m[C+2+32]=m[C+0+64]=pe+be+1>>1,m[C+1+0]=ir(B,Y,pe),m[C+3+0]=m[C+1+32]=ir(Y,pe,be),m[C+3+32]=m[C+1+64]=ir(pe,be,be),m[C+3+64]=m[C+2+64]=m[C+0+96]=m[C+1+96]=m[C+2+96]=m[C+3+96]=be}function Rl(m,C){var B=m[C-1+0],Y=m[C-1+32],pe=m[C-1+64],be=m[C-1+96],Le=m[C-1-32],ke=m[C+0-32],Be=m[C+1-32],Ge=m[C+2-32];m[C+0+0]=m[C+2+32]=B+Le+1>>1,m[C+0+32]=m[C+2+64]=Y+B+1>>1,m[C+0+64]=m[C+2+96]=pe+Y+1>>1,m[C+0+96]=be+pe+1>>1,m[C+3+0]=ir(ke,Be,Ge),m[C+2+0]=ir(Le,ke,Be),m[C+1+0]=m[C+3+32]=ir(B,Le,ke),m[C+1+32]=m[C+3+64]=ir(Y,B,Le),m[C+1+64]=m[C+3+96]=ir(pe,Y,B),m[C+1+96]=ir(be,pe,Y)}function Za(m,C){var B;for(B=0;8>B;++B)r(m,C+32*B,m,C-32,8)}function or(m,C){var B;for(B=0;8>B;++B)i(m,C,m[C-1],8),C+=32}function _r(m,C,B){var Y;for(Y=0;8>Y;++Y)i(C,B+32*Y,m,8)}function fa(m,C){var B,Y=8;for(B=0;8>B;++B)Y+=m[C+B-32]+m[C-1+32*B];_r(Y>>4,m,C)}function iu(m,C){var B,Y=4;for(B=0;8>B;++B)Y+=m[C+B-32];_r(Y>>3,m,C)}function Ka(m,C){var B,Y=4;for(B=0;8>B;++B)Y+=m[C-1+32*B];_r(Y>>3,m,C)}function fl(m,C){_r(128,m,C)}function ka(m,C,B){var Y=m[C-B],pe=m[C+0],be=3*(pe-Y)+Io[1020+m[C-2*B]-m[C+B]],Le=Zi[112+(be+4>>3)];m[C-B]=ai[255+Y+Zi[112+(be+3>>3)]],m[C+0]=ai[255+pe-Le]}function Ja(m,C,B,Y){var pe=m[C+0],be=m[C+B];return ws[255+m[C-2*B]-m[C-B]]>Y||ws[255+be-pe]>Y}function dl(m,C,B,Y){return 4*ws[255+m[C-B]-m[C+0]]+ws[255+m[C-2*B]-m[C+B]]<=Y}function Sr(m,C,B,Y,pe){var be=m[C-3*B],Le=m[C-2*B],ke=m[C-B],Be=m[C+0],Ge=m[C+B],ht=m[C+2*B],Ot=m[C+3*B];return 4*ws[255+ke-Be]+ws[255+Le-Ge]>Y?0:ws[255+m[C-4*B]-be]<=pe&&ws[255+be-Le]<=pe&&ws[255+Le-ke]<=pe&&ws[255+Ot-ht]<=pe&&ws[255+ht-Ge]<=pe&&ws[255+Ge-Be]<=pe}function Ii(m,C,B,Y){var pe=2*Y+1;for(Y=0;16>Y;++Y)dl(m,C+Y,B,pe)&&ka(m,C+Y,B)}function Wn(m,C,B,Y){var pe=2*Y+1;for(Y=0;16>Y;++Y)dl(m,C+Y*B,1,pe)&&ka(m,C+Y*B,1)}function Fi(m,C,B,Y){var pe;for(pe=3;0<pe;--pe)Ii(m,C+=4*B,B,Y)}function Ta(m,C,B,Y){var pe;for(pe=3;0<pe;--pe)Wn(m,C+=4,B,Y)}function Go(m,C,B,Y,pe,be,Le,ke){for(be=2*be+1;0<pe--;){if(Sr(m,C,B,be,Le))if(Ja(m,C,B,ke))ka(m,C,B);else{var Be=m,Ge=C,ht=B,Ot=Be[Ge-2*ht],It=Be[Ge-ht],Lt=Be[Ge+0],Vt=Be[Ge+ht],Ut=Be[Ge+2*ht],ft=27*(Jt=Io[1020+3*(Lt-It)+Io[1020+Ot-Vt]])+63>>7,yt=18*Jt+63>>7,Jt=9*Jt+63>>7;Be[Ge-3*ht]=ai[255+Be[Ge-3*ht]+Jt],Be[Ge-2*ht]=ai[255+Ot+yt],Be[Ge-ht]=ai[255+It+ft],Be[Ge+0]=ai[255+Lt-ft],Be[Ge+ht]=ai[255+Vt-yt],Be[Ge+2*ht]=ai[255+Ut-Jt]}C+=Y}}function yi(m,C,B,Y,pe,be,Le,ke){for(be=2*be+1;0<pe--;){if(Sr(m,C,B,be,Le))if(Ja(m,C,B,ke))ka(m,C,B);else{var Be=m,Ge=C,ht=B,Ot=Be[Ge-ht],It=Be[Ge+0],Lt=Be[Ge+ht],Vt=Zi[112+((Ut=3*(It-Ot))+4>>3)],Ut=Zi[112+(Ut+3>>3)],ft=Vt+1>>1;Be[Ge-2*ht]=ai[255+Be[Ge-2*ht]+ft],Be[Ge-ht]=ai[255+Ot+Ut],Be[Ge+0]=ai[255+It-Vt],Be[Ge+ht]=ai[255+Lt-ft]}C+=Y}}function pl(m,C,B,Y,pe,be){Go(m,C,B,1,16,Y,pe,be)}function Mo(m,C,B,Y,pe,be){Go(m,C,1,B,16,Y,pe,be)}function Ya(m,C,B,Y,pe,be){var Le;for(Le=3;0<Le;--Le)yi(m,C+=4*B,B,1,16,Y,pe,be)}function Xa(m,C,B,Y,pe,be){var Le;for(Le=3;0<Le;--Le)yi(m,C+=4,1,B,16,Y,pe,be)}function uo(m,C,B,Y,pe,be,Le,ke){Go(m,C,pe,1,8,be,Le,ke),Go(B,Y,pe,1,8,be,Le,ke)}function Qa(m,C,B,Y,pe,be,Le,ke){Go(m,C,1,pe,8,be,Le,ke),Go(B,Y,1,pe,8,be,Le,ke)}function Zr(m,C,B,Y,pe,be,Le,ke){yi(m,C+4*pe,pe,1,8,be,Le,ke),yi(B,Y+4*pe,pe,1,8,be,Le,ke)}function su(m,C,B,Y,pe,be,Le,ke){yi(m,C+4,1,pe,8,be,Le,ke),yi(B,Y+4,1,pe,8,be,Le,ke)}function as(){this.ba=new mn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new zr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mo(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function el(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vo(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new D}function Ba(){this.xb=this.a=0,this.l=new Xt,this.ca=new mn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new X,this.Pb=0,this.wd=new X,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vo,this.ab=0,this.gc=l(4,el),this.Oc=0}function Na(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Kr(m,C,B,Y,pe,be,Le){for(m=m==null?0:m[C+0],C=0;C<Le;++C)pe[be+C]=m+B[Y+C]&255,m=pe[be+C]}function eo(m,C,B,Y,pe,be,Le){var ke;if(m==null)Kr(null,null,B,Y,pe,be,Le);else for(ke=0;ke<Le;++ke)pe[be+ke]=m[C+ke]+B[Y+ke]&255}function Ho(m,C,B,Y,pe,be,Le){if(m==null)Kr(null,null,B,Y,pe,be,Le);else{var ke,Be=m[C+0],Ge=Be,ht=Be;for(ke=0;ke<Le;++ke)Ge=ht+(Be=m[C+ke])-Ge,ht=B[Y+ke]+(-256&Ge?0>Ge?0:255:Ge)&255,Ge=Be,pe[be+ke]=ht}}function zi(m,C,B,Y){var pe=C.width,be=C.o;if(n(m!=null&&C!=null),0>B||0>=Y||B+Y>be)return null;if(!m.Cc){if(m.ga==null){var Le;if(m.ga=new Na,(Le=m.ga==null)||(Le=C.width*C.o,n(m.Gb.length==0),m.Gb=o(Le),m.Uc=0,m.Gb==null?Le=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,Le=1),Le=!Le),!Le){Le=m.ga;var ke=m.Fa,Be=m.P,Ge=m.qc,ht=m.mb,Ot=m.nb,It=Be+1,Lt=Ge-1,Vt=Le.l;if(n(ke!=null&&ht!=null&&C!=null),Hr[0]=null,Hr[1]=Kr,Hr[2]=eo,Hr[3]=Ho,Le.ca=ht,Le.tb=Ot,Le.c=C.width,Le.i=C.height,n(0<Le.c&&0<Le.i),1>=Ge)C=0;else if(Le.$a=ke[Be+0]>>0&3,Le.Z=ke[Be+0]>>2&3,Le.Lc=ke[Be+0]>>4&3,Be=ke[Be+0]>>6&3,0>Le.$a||1<Le.$a||4<=Le.Z||1<Le.Lc||Be)C=0;else if(Vt.put=hi,Vt.ac=lr,Vt.bc=Ri,Vt.ma=Le,Vt.width=C.width,Vt.height=C.height,Vt.Da=C.Da,Vt.v=C.v,Vt.va=C.va,Vt.j=C.j,Vt.o=C.o,Le.$a)e:{n(Le.$a==1),C=Mi();t:for(;;){if(C==null){C=0;break e}if(n(Le!=null),Le.mc=C,C.c=Le.c,C.i=Le.i,C.l=Le.l,C.l.ma=Le,C.l.width=Le.c,C.l.height=Le.i,C.a=0,ie(C.m,ke,It,Lt),!Xs(Le.c,Le.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&fi(C.s)?(Le.ic=1,ke=C.c*C.i,C.Ta=null,C.Ua=0,C.V=o(ke),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(Le.ic=0,C=Ps(C,Le.c)),!C))break t;C=1;break e}Le.mc=null,C=0}else C=Lt>=Le.c*Le.i;Le=!C}if(Le)return null;m.ga.Lc!=1?m.Ga=0:Y=be-B}n(m.ga!=null),n(B+Y<=be);e:{if(C=(ke=m.ga).c,be=ke.l.o,ke.$a==0){if(It=m.rc,Lt=m.Vc,Vt=m.Fa,Be=m.P+1+B*C,Ge=m.mb,ht=m.nb+B*C,n(Be<=m.P+m.qc),ke.Z!=0)for(n(Hr[ke.Z]!=null),Le=0;Le<Y;++Le)Hr[ke.Z](It,Lt,Vt,Be,Ge,ht,C),It=Ge,Lt=ht,ht+=C,Be+=C;else for(Le=0;Le<Y;++Le)r(Ge,ht,Vt,Be,C),It=Ge,Lt=ht,ht+=C,Be+=C;m.rc=It,m.Vc=Lt}else{if(n(ke.mc!=null),C=B+Y,n((Le=ke.mc)!=null),n(C<=Le.i),Le.C>=C)C=1;else if(ke.ic||Ct(),ke.ic){ke=Le.V,It=Le.Ba,Lt=Le.c;var Ut=Le.i,ft=(Vt=1,Be=Le.$/Lt,Ge=Le.$%Lt,ht=Le.m,Ot=Le.s,Le.$),yt=Lt*Ut,Jt=Lt*C,cn=Ot.wc,en=ft<Jt?kt(Ot,Ge,Be):null;n(ft<=yt),n(C<=Ut),n(fi(Ot));t:for(;;){for(;!ht.h&&ft<Jt;){if(Ge&cn||(en=kt(Ot,Ge,Be)),n(en!=null),he(ht),256>(Ut=Gr(en.G[0],en.H[0],ht)))ke[It+ft]=Ut,++ft,++Ge>=Lt&&(Ge=0,++Be<=C&&!(Be%16)&&Di(Le,Be));else{if(!(280>Ut)){Vt=0;break t}Ut=xi(Ut-256,ht);var xn,bn=Gr(en.G[4],en.H[4],ht);if(he(ht),!(ft>=(bn=Lr(Lt,bn=xi(bn,ht)))&&yt-ft>=Ut)){Vt=0;break t}for(xn=0;xn<Ut;++xn)ke[It+ft+xn]=ke[It+ft+xn-bn];for(ft+=Ut,Ge+=Ut;Ge>=Lt;)Ge-=Lt,++Be<=C&&!(Be%16)&&Di(Le,Be);ft<Jt&&Ge&cn&&(en=kt(Ot,Ge,Be))}n(ht.h==N(ht))}Di(Le,Be>C?C:Be);break t}!Vt||ht.h&&ft<yt?(Vt=0,Le.a=ht.h?5:3):Le.$=ft,C=Vt}else C=Qi(Le,Le.V,Le.Ba,Le.c,Le.i,C,Tr);if(!C){Y=0;break e}}B+Y>=be&&(m.Cc=1),Y=1}if(!Y)return null;if(m.Cc&&((Y=m.ga)!=null&&(Y.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+B*pe}function A(m,C,B,Y,pe,be){for(;0<pe--;){var Le,ke=m,Be=C+(B?1:0),Ge=m,ht=C+(B?0:3);for(Le=0;Le<Y;++Le){var Ot=Ge[ht+4*Le];Ot!=255&&(Ot*=32897,ke[Be+4*Le+0]=ke[Be+4*Le+0]*Ot>>23,ke[Be+4*Le+1]=ke[Be+4*Le+1]*Ot>>23,ke[Be+4*Le+2]=ke[Be+4*Le+2]*Ot>>23)}C+=be}}function de(m,C,B,Y,pe){for(;0<Y--;){var be;for(be=0;be<B;++be){var Le=m[C+2*be+0],ke=15&(Ge=m[C+2*be+1]),Be=4369*ke,Ge=(240&Ge|Ge>>4)*Be>>16;m[C+2*be+0]=(240&Le|Le>>4)*Be>>16&240|(15&Le|Le<<4)*Be>>16>>4&15,m[C+2*be+1]=240&Ge|ke}C+=pe}}function We(m,C,B,Y,pe,be,Le,ke){var Be,Ge,ht=255;for(Ge=0;Ge<pe;++Ge){for(Be=0;Be<Y;++Be){var Ot=m[C+Be];be[Le+4*Be]=Ot,ht&=Ot}C+=B,Le+=ke}return ht!=255}function ut(m,C,B,Y,pe){var be;for(be=0;be<pe;++be)B[Y+be]=m[C+be]>>8}function Ct(){us=A,Xr=de,ni=We,Ui=ut}function zt(m,C,B){O[m]=function(Y,pe,be,Le,ke,Be,Ge,ht,Ot,It,Lt,Vt,Ut,ft,yt,Jt,cn){var en,xn=cn-1>>1,bn=ke[Be+0]|Ge[ht+0]<<16,qn=Ot[It+0]|Lt[Vt+0]<<16;n(Y!=null);var a=3*bn+qn+131074>>2;for(C(Y[pe+0],255&a,a>>16,Ut,ft),be!=null&&(a=3*qn+bn+131074>>2,C(be[Le+0],255&a,a>>16,yt,Jt)),en=1;en<=xn;++en){var c=ke[Be+en]|Ge[ht+en]<<16,p=Ot[It+en]|Lt[Vt+en]<<16,y=bn+c+qn+p+524296,S=y+2*(c+qn)>>3;a=S+bn>>1,bn=(y=y+2*(bn+p)>>3)+c>>1,C(Y[pe+2*en-1],255&a,a>>16,Ut,ft+(2*en-1)*B),C(Y[pe+2*en-0],255&bn,bn>>16,Ut,ft+(2*en-0)*B),be!=null&&(a=y+qn>>1,bn=S+p>>1,C(be[Le+2*en-1],255&a,a>>16,yt,Jt+(2*en-1)*B),C(be[Le+2*en+0],255&bn,bn>>16,yt,Jt+(2*en+0)*B)),bn=c,qn=p}1&cn||(a=3*bn+qn+131074>>2,C(Y[pe+cn-1],255&a,a>>16,Ut,ft+(cn-1)*B),be!=null&&(a=3*qn+bn+131074>>2,C(be[Le+cn-1],255&a,a>>16,yt,Jt+(cn-1)*B)))}}function ln(){xs[js]=Te,xs[er]=Il,xs[Yo]=$s,xs[Xo]=ds,xs[_o]=yr,xs[Ns]=ec,xs[ku]=hh,xs[cs]=Il,xs[hs]=ds,xs[bo]=yr,xs[s]=ec}function Ln(m){return m&-16384?0>m?0:255:m>>Qh}function En(m,C){return Ln((19077*m>>8)+(26149*C>>8)-14234)}function Hn(m,C,B){return Ln((19077*m>>8)-(6419*C>>8)-(13320*B>>8)+8708)}function nr(m,C){return Ln((19077*m>>8)+(33050*C>>8)-17685)}function mr(m,C,B,Y,pe){Y[pe+0]=En(m,B),Y[pe+1]=Hn(m,C,B),Y[pe+2]=nr(m,C)}function gi(m,C,B,Y,pe){Y[pe+0]=nr(m,C),Y[pe+1]=Hn(m,C,B),Y[pe+2]=En(m,B)}function qr(m,C,B,Y,pe){var be=Hn(m,C,B);C=be<<3&224|nr(m,C)>>3,Y[pe+0]=248&En(m,B)|be>>5,Y[pe+1]=C}function Jr(m,C,B,Y,pe){var be=240&nr(m,C)|15;Y[pe+0]=240&En(m,B)|Hn(m,C,B)>>4,Y[pe+1]=be}function ji(m,C,B,Y,pe){Y[pe+0]=255,mr(m,C,B,Y,pe+1)}function Hi(m,C,B,Y,pe){gi(m,C,B,Y,pe),Y[pe+3]=255}function to(m,C,B,Y,pe){mr(m,C,B,Y,pe),Y[pe+3]=255}function vr(m,C){return 0>m?0:m>C?C:m}function gs(m,C,B){O[m]=function(Y,pe,be,Le,ke,Be,Ge,ht,Ot){for(var It=ht+(-2&Ot)*B;ht!=It;)C(Y[pe+0],be[Le+0],ke[Be+0],Ge,ht),C(Y[pe+1],be[Le+0],ke[Be+0],Ge,ht+B),pe+=2,++Le,++Be,ht+=2*B;1&Ot&&C(Y[pe+0],be[Le+0],ke[Be+0],Ge,ht)}}function Ra(m,C,B){return B==0?m==0?C==0?6:5:C==0?4:0:B}function Ms(m,C,B,Y,pe){switch(m>>>30){case 3:qt(C,B,Y,pe,0);break;case 2:Bt(C,B,Y,pe);break;case 1:zn(C,B,Y,pe)}}function gl(m,C){var B,Y,pe=C.M,be=C.Nb,Le=m.oc,ke=m.pc+40,Be=m.oc,Ge=m.pc+584,ht=m.oc,Ot=m.pc+600;for(B=0;16>B;++B)Le[ke+32*B-1]=129;for(B=0;8>B;++B)Be[Ge+32*B-1]=129,ht[Ot+32*B-1]=129;for(0<pe?Le[ke-1-32]=Be[Ge-1-32]=ht[Ot-1-32]=129:(i(Le,ke-32-1,127,21),i(Be,Ge-32-1,127,9),i(ht,Ot-32-1,127,9)),Y=0;Y<m.za;++Y){var It=C.ya[C.aa+Y];if(0<Y){for(B=-1;16>B;++B)r(Le,ke+32*B-4,Le,ke+32*B+12,4);for(B=-1;8>B;++B)r(Be,Ge+32*B-4,Be,Ge+32*B+4,4),r(ht,Ot+32*B-4,ht,Ot+32*B+4,4)}var Lt=m.Gd,Vt=m.Hd+Y,Ut=It.ad,ft=It.Hc;if(0<pe&&(r(Le,ke-32,Lt[Vt].y,0,16),r(Be,Ge-32,Lt[Vt].f,0,8),r(ht,Ot-32,Lt[Vt].ea,0,8)),It.Za){var yt=Le,Jt=ke-32+16;for(0<pe&&(Y>=m.za-1?i(yt,Jt,Lt[Vt].y[15],4):r(yt,Jt,Lt[Vt+1].y,0,4)),B=0;4>B;B++)yt[Jt+128+B]=yt[Jt+256+B]=yt[Jt+384+B]=yt[Jt+0+B];for(B=0;16>B;++B,ft<<=2)yt=Le,Jt=ke+dh[B],wo[It.Ob[B]](yt,Jt),Ms(ft,Ut,16*+B,yt,Jt)}else if(yt=Ra(Y,pe,It.Ob[0]),Fo[yt](Le,ke),ft!=0)for(B=0;16>B;++B,ft<<=2)Ms(ft,Ut,16*+B,Le,ke+dh[B]);for(B=It.Gc,yt=Ra(Y,pe,It.Dd),ho[yt](Be,Ge),ho[yt](ht,Ot),ft=Ut,yt=Be,Jt=Ge,255&(It=B>>0)&&(170&It?wn(ft,256,yt,Jt):sr(ft,256,yt,Jt)),It=ht,ft=Ot,255&(B>>=8)&&(170&B?wn(Ut,320,It,ft):sr(Ut,320,It,ft)),pe<m.Ub-1&&(r(Lt[Vt].y,0,Le,ke+480,16),r(Lt[Vt].f,0,Be,Ge+224,8),r(Lt[Vt].ea,0,ht,Ot+224,8)),B=8*be*m.B,Lt=m.sa,Vt=m.ta+16*Y+16*be*m.R,Ut=m.qa,It=m.ra+8*Y+B,ft=m.Ha,yt=m.Ia+8*Y+B,B=0;16>B;++B)r(Lt,Vt+B*m.R,Le,ke+32*B,16);for(B=0;8>B;++B)r(Ut,It+B*m.B,Be,Ge+32*B,8),r(ft,yt+B*m.B,ht,Ot+32*B,8)}}function ko(m,C,B,Y,pe,be,Le,ke,Be){var Ge=[0],ht=[0],Ot=0,It=Be!=null?Be.kd:0,Lt=Be??new mo;if(m==null||12>B)return 7;Lt.data=m,Lt.w=C,Lt.ha=B,C=[C],B=[B],Lt.gb=[Lt.gb];e:{var Vt=C,Ut=B,ft=Lt.gb;if(n(m!=null),n(Ut!=null),n(ft!=null),ft[0]=0,12<=Ut[0]&&!t(m,Vt[0],"RIFF")){if(t(m,Vt[0]+8,"WEBP")){ft=3;break e}var yt=re(m,Vt[0]+4);if(12>yt||4294967286<yt){ft=3;break e}if(It&&yt>Ut[0]-8){ft=7;break e}ft[0]=yt,Vt[0]+=12,Ut[0]-=12}ft=0}if(ft!=0)return ft;for(yt=0<Lt.gb[0],B=B[0];;){e:{var Jt=m;Ut=C,ft=B;var cn=Ge,en=ht,xn=Vt=[0];if((a=Ot=[Ot])[0]=0,8>ft[0])ft=7;else{if(!t(Jt,Ut[0],"VP8X")){if(re(Jt,Ut[0]+4)!=10){ft=3;break e}if(18>ft[0]){ft=7;break e}var bn=re(Jt,Ut[0]+8),qn=1+oe(Jt,Ut[0]+12);if(2147483648<=qn*(Jt=1+oe(Jt,Ut[0]+15))){ft=3;break e}xn!=null&&(xn[0]=bn),cn!=null&&(cn[0]=qn),en!=null&&(en[0]=Jt),Ut[0]+=18,ft[0]-=18,a[0]=1}ft=0}}if(Ot=Ot[0],Vt=Vt[0],ft!=0)return ft;if(Ut=!!(2&Vt),!yt&&Ot)return 3;if(be!=null&&(be[0]=!!(16&Vt)),Le!=null&&(Le[0]=Ut),ke!=null&&(ke[0]=0),Le=Ge[0],Vt=ht[0],Ot&&Ut&&Be==null){ft=0;break}if(4>B){ft=7;break}if(yt&&Ot||!yt&&!Ot&&!t(m,C[0],"ALPH")){B=[B],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{bn=m,ft=C,yt=B;var a=Lt.gb;cn=Lt.na,en=Lt.P,xn=Lt.Sa,qn=22,n(bn!=null),n(yt!=null),Jt=ft[0];var c=yt[0];for(n(cn!=null),n(xn!=null),cn[0]=null,en[0]=null,xn[0]=0;;){if(ft[0]=Jt,yt[0]=c,8>c){ft=7;break e}var p=re(bn,Jt+4);if(4294967286<p){ft=3;break e}var y=8+p+1&-2;if(qn+=y,0<a&&qn>a){ft=3;break e}if(!t(bn,Jt,"VP8 ")||!t(bn,Jt,"VP8L")){ft=0;break e}if(c[0]<y){ft=7;break e}t(bn,Jt,"ALPH")||(cn[0]=bn,en[0]=Jt+8,xn[0]=p),Jt+=y,c-=y}}if(B=B[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],ft!=0)break}B=[B],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(a=m,ft=C,yt=B,cn=Lt.gb[0],en=Lt.Ja,xn=Lt.xa,bn=ft[0],Jt=!t(a,bn,"VP8 "),qn=!t(a,bn,"VP8L"),n(a!=null),n(yt!=null),n(en!=null),n(xn!=null),8>yt[0])ft=7;else{if(Jt||qn){if(a=re(a,bn+4),12<=cn&&a>cn-12){ft=3;break e}if(It&&a>yt[0]-8){ft=7;break e}en[0]=a,ft[0]+=8,yt[0]-=8,xn[0]=qn}else xn[0]=5<=yt[0]&&a[bn+0]==47&&!(a[bn+4]>>5),en[0]=yt[0];ft=0}if(B=B[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],C=C[0],ft!=0)break;if(4294967286<Lt.Ja)return 3;if(ke==null||Ut||(ke[0]=Lt.xa?2:1),Le=[Le],Vt=[Vt],Lt.xa){if(5>B){ft=7;break}ke=Le,It=Vt,Ut=be,m==null||5>B?m=0:5<=B&&m[C+0]==47&&!(m[C+4]>>5)?(yt=[0],a=[0],cn=[0],ie(en=new X,m,C,B),Fn(en,yt,a,cn)?(ke!=null&&(ke[0]=yt[0]),It!=null&&(It[0]=a[0]),Ut!=null&&(Ut[0]=cn[0]),m=1):m=0):m=0}else{if(10>B){ft=7;break}ke=Vt,m==null||10>B||!Oi(m,C+3,B-3)?m=0:(It=m[C+0]|m[C+1]<<8|m[C+2]<<16,Ut=16383&(m[C+7]<<8|m[C+6]),m=16383&(m[C+9]<<8|m[C+8]),1&It||3<(It>>1&7)||!(It>>4&1)||It>>5>=Lt.Ja||!Ut||!m?m=0:(Le&&(Le[0]=Ut),ke&&(ke[0]=m),m=1))}if(!m||(Le=Le[0],Vt=Vt[0],Ot&&(Ge[0]!=Le||ht[0]!=Vt)))return 3;Be!=null&&(Be[0]=Lt,Be.offset=C-Be.w,n(4294967286>C-Be.w),n(Be.offset==Be.ha-B));break}return ft==0||ft==7&&Ot&&Be==null?(be!=null&&(be[0]|=Lt.na!=null&&0<Lt.na.length),Y!=null&&(Y[0]=Le),pe!=null&&(pe[0]=Vt),0):ft}function Dl(m,C,B){var Y=C.width,pe=C.height,be=0,Le=0,ke=Y,Be=pe;if(C.Da=m!=null&&0<m.Da,C.Da&&(ke=m.cd,Be=m.bd,be=m.v,Le=m.j,11>B||(be&=-2,Le&=-2),0>be||0>Le||0>=ke||0>=Be||be+ke>Y||Le+Be>pe))return 0;if(C.v=be,C.j=Le,C.va=be+ke,C.o=Le+Be,C.U=ke,C.T=Be,C.da=m!=null&&0<m.da,C.da){if(!Ue(ke,Be,B=[m.ib],be=[m.hb]))return 0;C.ib=B[0],C.hb=be[0]}return C.ob=m!=null&&m.ob,C.Kb=m==null||!m.Sd,C.da&&(C.ob=C.ib<3*Y/4&&C.hb<3*pe/4,C.Kb=0),1}function da(m){if(m==null)return 2;if(11>m.S){var C=m.f.RGBA;C.fb+=(m.height-1)*C.A,C.A=-C.A}else C=m.f.kb,m=m.height,C.O+=(m-1)*C.fa,C.fa=-C.fa,C.N+=(m-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(m-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(m-1)*C.lb,C.lb=-C.lb);return 0}function pa(m,C,B,Y){if(Y==null||0>=m||0>=C)return 2;if(B!=null){if(B.Da){var pe=B.cd,be=B.bd,Le=-2&B.v,ke=-2&B.j;if(0>Le||0>ke||0>=pe||0>=be||Le+pe>m||ke+be>C)return 2;m=pe,C=be}if(B.da){if(!Ue(m,C,pe=[B.ib],be=[B.hb]))return 2;m=pe[0],C=be[0]}}Y.width=m,Y.height=C;e:{var Be=Y.width,Ge=Y.height;if(m=Y.S,0>=Be||0>=Ge||!(m>=js&&13>m))m=2;else{if(0>=Y.Rd&&Y.sd==null){Le=be=pe=C=0;var ht=(ke=Be*mh[m])*Ge;if(11>m||(be=(Ge+1)/2*(C=(Be+1)/2),m==12&&(Le=(pe=Be)*Ge)),(Ge=o(ht+2*be+Le))==null){m=1;break e}Y.sd=Ge,11>m?((Be=Y.f.RGBA).eb=Ge,Be.fb=0,Be.A=ke,Be.size=ht):((Be=Y.f.kb).y=Ge,Be.O=0,Be.fa=ke,Be.Fd=ht,Be.f=Ge,Be.N=0+ht,Be.Ab=C,Be.Cd=be,Be.ea=Ge,Be.W=0+ht+be,Be.Db=C,Be.Ed=be,m==12&&(Be.F=Ge,Be.J=0+ht+2*be),Be.Tc=Le,Be.lb=pe)}if(C=1,pe=Y.S,be=Y.width,Le=Y.height,pe>=js&&13>pe)if(11>pe)m=Y.f.RGBA,C&=(ke=Math.abs(m.A))*(Le-1)+be<=m.size,C&=ke>=be*mh[pe],C&=m.eb!=null;else{m=Y.f.kb,ke=(be+1)/2,ht=(Le+1)/2,Be=Math.abs(m.fa),Ge=Math.abs(m.Ab);var Ot=Math.abs(m.Db),It=Math.abs(m.lb),Lt=It*(Le-1)+be;C&=Be*(Le-1)+be<=m.Fd,C&=Ge*(ht-1)+ke<=m.Cd,C=(C&=Ot*(ht-1)+ke<=m.Ed)&Be>=be&Ge>=ke&Ot>=ke,C&=m.y!=null,C&=m.f!=null,C&=m.ea!=null,pe==12&&(C&=It>=be,C&=Lt<=m.Tc,C&=m.F!=null)}else C=0;m=C?0:2}}return m!=0||B!=null&&B.fd&&(m=da(Y)),m}var Wi=64,To=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],no=24,Fs=32,Da=8,ms=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(m){return m},O.Predictor2=function(m,C,B){return C[B+0]},O.Predictor3=function(m,C,B){return C[B+1]},O.Predictor4=function(m,C,B){return C[B-1]},O.Predictor5=function(m,C,B){return rt(rt(m,C[B+1]),C[B+0])},O.Predictor6=function(m,C,B){return rt(m,C[B-1])},O.Predictor7=function(m,C,B){return rt(m,C[B+0])},O.Predictor8=function(m,C,B){return rt(C[B-1],C[B+0])},O.Predictor9=function(m,C,B){return rt(C[B+0],C[B+1])},O.Predictor10=function(m,C,B){return rt(rt(m,C[B-1]),rt(C[B+0],C[B+1]))},O.Predictor11=function(m,C,B){var Y=C[B+0];return 0>=_t(Y>>24&255,m>>24&255,(C=C[B-1])>>24&255)+_t(Y>>16&255,m>>16&255,C>>16&255)+_t(Y>>8&255,m>>8&255,C>>8&255)+_t(255&Y,255&m,255&C)?Y:m},O.Predictor12=function(m,C,B){var Y=C[B+0];return(Ze((m>>24&255)+(Y>>24&255)-((C=C[B-1])>>24&255))<<24|Ze((m>>16&255)+(Y>>16&255)-(C>>16&255))<<16|Ze((m>>8&255)+(Y>>8&255)-(C>>8&255))<<8|Ze((255&m)+(255&Y)-(255&C)))>>>0},O.Predictor13=function(m,C,B){var Y=C[B-1];return(gt((m=rt(m,C[B+0]))>>24&255,Y>>24&255)<<24|gt(m>>16&255,Y>>16&255)<<16|gt(m>>8&255,Y>>8&255)<<8|gt(m>>0&255,Y>>0&255))>>>0};var ks=O.PredictorAdd0;O.PredictorAdd1=$t,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var Ts=O.PredictorAdd2;Qt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),Qt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var ou,ns=O.ColorIndexInverseTransform,Wo=O.MapARGB,vs=O.VP8LColorIndexInverseTransformAlpha,ys=O.MapAlpha,Zo=O.VP8LPredictorsAdd=[];Zo.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var Ko,_s,ls,Bo,ro,bs,bt,qt,Bt,wn,zn,sr,_i,Yr,tl,Bs,bi,No,Jo,Ro,Do,Oo,Cr,yo,us,Xr,ni,Ui,li=o(511),io=o(2041),zs=o(225),co=o(767),Ol=0,Io=io,Zi=zs,ai=co,ws=li,js=0,er=1,Yo=2,Xo=3,_o=4,Ns=5,ku=6,cs=7,hs=8,bo=9,s=10,f=[2,3,7],w=[3,3,11],T=[280,256,256,256,40],J=[0,1,1,1,0],_e=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ot=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Tt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],jt=8,rn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Sn=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$n=null,gr=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ki=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ti=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],fs=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],wi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Us=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Tu=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fo=[],wo=[],ho=[],Mc=1,ml=2,Hr=[],xs=[];zt("UpsampleRgbLinePair",mr,3),zt("UpsampleBgrLinePair",gi,3),zt("UpsampleRgbaLinePair",to,4),zt("UpsampleBgraLinePair",Hi,4),zt("UpsampleArgbLinePair",ji,4),zt("UpsampleRgba4444LinePair",Jr,2),zt("UpsampleRgb565LinePair",qr,2);var Te=O.UpsampleRgbLinePair,$s=O.UpsampleBgrLinePair,Il=O.UpsampleRgbaLinePair,ds=O.UpsampleBgraLinePair,yr=O.UpsampleArgbLinePair,ec=O.UpsampleRgba4444LinePair,hh=O.UpsampleRgb565LinePair,tc=16,ga=1<<tc-1,Bu=-227,kc=482,Qh=6,au=0,nc=o(256),nl=o(256),ef=o(256),rc=o(256),ic=o(kc-Bu),fh=o(kc-Bu);gs("YuvToRgbRow",mr,3),gs("YuvToBgrRow",gi,3),gs("YuvToRgbaRow",to,4),gs("YuvToBgraRow",Hi,4),gs("YuvToArgbRow",ji,4),gs("YuvToRgba4444Row",Jr,2),gs("YuvToRgb565Row",qr,2);var dh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Qo=[0,2,8],ph=[8,7,6,4,4,2,2,2,1,1,1,1],gh=1;this.WebPDecodeRGBA=function(m,C,B,Y,pe){var be=er,Le=new as,ke=new mn;Le.ba=ke,ke.S=be,ke.width=[ke.width],ke.height=[ke.height];var Be=ke.width,Ge=ke.height,ht=new Pn;if(ht==null||m==null)var Ot=2;else n(ht!=null),Ot=ko(m,C,B,ht.width,ht.height,ht.Pd,ht.Qd,ht.format,null);if(Ot!=0?Be=0:(Be!=null&&(Be[0]=ht.width[0]),Ge!=null&&(Ge[0]=ht.height[0]),Be=1),Be){ke.width=ke.width[0],ke.height=ke.height[0],Y!=null&&(Y[0]=ke.width),pe!=null&&(pe[0]=ke.height);e:{if(Y=new Xt,(pe=new mo).data=m,pe.w=C,pe.ha=B,pe.kd=1,C=[0],n(pe!=null),((m=ko(pe.data,pe.w,pe.ha,null,null,null,C,null,pe))==0||m==7)&&C[0]&&(m=4),(C=m)==0){if(n(Le!=null),Y.data=pe.data,Y.w=pe.w+pe.offset,Y.ha=pe.ha-pe.offset,Y.put=hi,Y.ac=lr,Y.bc=Ri,Y.ma=Le,pe.xa){if((m=Mi())==null){Le=1;break e}if(function(It,Lt){var Vt=[0],Ut=[0],ft=[0];t:for(;;){if(It==null)return 0;if(Lt==null)return It.a=2,0;if(It.l=Lt,It.a=0,ie(It.m,Lt.data,Lt.w,Lt.ha),!Fn(It.m,Vt,Ut,ft)){It.a=3;break t}if(It.xb=ml,Lt.width=Vt[0],Lt.height=Ut[0],!Xs(Vt[0],Ut[0],1,It,null))break t;return 1}return n(It.a!=0),0}(m,Y)){if(Y=(C=pa(Y.width,Y.height,Le.Oa,Le.ba))==0){t:{Y=m;n:for(;;){if(Y==null){Y=0;break t}if(n(Y.s.yc!=null),n(Y.s.Ya!=null),n(0<Y.s.Wb),n((B=Y.l)!=null),n((pe=B.ma)!=null),Y.xb!=0){if(Y.ca=pe.ba,Y.tb=pe.tb,n(Y.ca!=null),!Dl(pe.Oa,B,Xo)){Y.a=2;break n}if(!Ps(Y,B.width)||B.da)break n;if((B.da||et(Y.ca.S))&&Ct(),11>Y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Y.ca.f.kb.F!=null&&Ct()),Y.Pb&&0<Y.s.ua&&Y.s.vb.X==null&&!xe(Y.s.vb,Y.s.Wa.Xa)){Y.a=1;break n}Y.xb=0}if(!Qi(Y,Y.V,Y.Ba,Y.c,Y.i,B.o,Ai))break n;pe.Dc=Y.Ma,Y=1;break t}n(Y.a!=0),Y=0}Y=!Y}Y&&(C=m.a)}else C=m.a}else{if((m=new Tn)==null){Le=1;break e}if(m.Fa=pe.na,m.P=pe.P,m.qc=pe.Sa,es(m,Y)){if((C=pa(Y.width,Y.height,Le.Oa,Le.ba))==0){if(m.Aa=0,B=Le.Oa,n((pe=m)!=null),B!=null){if(0<(Be=0>(Be=B.Md)?0:100<Be?255:255*Be/100)){for(Ge=ht=0;4>Ge;++Ge)12>(Ot=pe.pb[Ge]).lc&&(Ot.ia=Be*ph[0>Ot.lc?0:Ot.lc]>>3),ht|=Ot.ia;ht&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=B.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}tr(m,Y)||(C=m.a)}}else C=m.a}C==0&&Le.Oa!=null&&Le.Oa.fd&&(C=da(Le.ba))}Le=C}be=Le!=0?null:11>be?ke.f.RGBA.eb:ke.f.kb.y}else be=null;return be};var mh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function v(O,K){for(var ce="",H=0;H<4;H++)ce+=String.fromCharCode(O[K++]);return ce}function _(O,K){return(O[K+0]<<0|O[K+1]<<8|O[K+2]<<16)>>>0}function x(O,K){return(O[K+0]<<0|O[K+1]<<8|O[K+2]<<16|O[K+3]<<24)>>>0}new g;var E=[0],b=[0],R=[],$=new g,Q=e,I=function(O,K){var ce={},H=0,D=!1,V=0,z=0;if(ce.frames=[],!function(Ee,N,Z,he){for(var ne=0;ne<he;ne++)if(Ee[N+ne]!=Z.charCodeAt(ne))return!0;return!1}(O,K,"RIFF",4)){var U,G;for(x(O,K+=4),K+=8;K<O.length;){var ue=v(O,K),ie=x(O,K+=4);K+=4;var Ae=ie+(1&ie);switch(ue){case"VP8 ":case"VP8L":ce.frames[H]===void 0&&(ce.frames[H]={}),(X=ce.frames[H]).src_off=D?z:K-8,X.src_size=V+ie+8,H++,D&&(D=!1,V=0,z=0);break;case"VP8X":(X=ce.header={}).feature_flags=O[K];var Me=K+4;X.canvas_width=1+_(O,Me),Me+=3,X.canvas_height=1+_(O,Me),Me+=3;break;case"ALPH":D=!0,V=Ae+8,z=K-8;break;case"ANIM":(X=ce.header).bgcolor=x(O,K),Me=K+4,X.loop_count=(U=O)[(G=Me)+0]<<0|U[G+1]<<8,Me+=2;break;case"ANMF":var st,X;(X=ce.frames[H]={}).offset_x=2*_(O,K),K+=3,X.offset_y=2*_(O,K),K+=3,X.width=1+_(O,K),K+=3,X.height=1+_(O,K),K+=3,X.duration=_(O,K),K+=3,st=O[K++],X.dispose=1&st,X.blend=st>>1&1}ue!="ANMF"&&(K+=Ae)}return ce}}(Q,0);I.response=Q,I.rgbaoutput=!0,I.dataurl=!1;var W=I.header?I.header:null,ge=I.frames?I.frames:null;if(W){W.loop_counter=W.loop_count,E=[W.canvas_height],b=[W.canvas_width];for(var Se=0;Se<ge.length&&ge[Se].blend!=0;Se++);}var De=ge[0],Ye=$.WebPDecodeRGBA(Q,De.src_off,De.src_size,b,E);De.rgba=Ye,De.imgwidth=b[0],De.imgheight=E[0];for(var Ve=0;Ve<b[0]*E[0]*4;Ve++)R[Ve]=Ye[Ve];return this.width=b,this.height=E,this.data=R,this}(function(e){var n=function(){return typeof $g=="function"},t=function(E,b,R,$){var Q=4,I=l;switch($){case e.image_compression.FAST:Q=1,I=o;break;case e.image_compression.MEDIUM:Q=6,I=h;break;case e.image_compression.SLOW:Q=9,I=g}E=r(E,b,R,I);var W=$g(E,{level:Q});return e.__addimage__.arrayBufferToBinaryString(W)},r=function(E,b,R,$){for(var Q,I,W,ge=E.length/b,Se=new Uint8Array(E.length+ge),De=_(),Ye=0;Ye<ge;Ye+=1){if(W=Ye*b,Q=E.subarray(W,W+b),$)Se.set($(Q,R,I),W+Ye);else{for(var Ve,O=De.length,K=[];Ve<O;Ve+=1)K[Ve]=De[Ve](Q,R,I);var ce=x(K.concat());Se.set(K[ce],W+Ye)}I=Q}return Se},i=function(E){var b=Array.apply([],E);return b.unshift(0),b},o=function(E,b){var R,$=[],Q=E.length;$[0]=1;for(var I=0;I<Q;I+=1)R=E[I-b]||0,$[I+1]=E[I]-R+256&255;return $},l=function(E,b,R){var $,Q=[],I=E.length;Q[0]=2;for(var W=0;W<I;W+=1)$=R&&R[W]||0,Q[W+1]=E[W]-$+256&255;return Q},h=function(E,b,R){var $,Q,I=[],W=E.length;I[0]=3;for(var ge=0;ge<W;ge+=1)$=E[ge-b]||0,Q=R&&R[ge]||0,I[ge+1]=E[ge]+256-($+Q>>>1)&255;return I},g=function(E,b,R){var $,Q,I,W,ge=[],Se=E.length;ge[0]=4;for(var De=0;De<Se;De+=1)$=E[De-b]||0,Q=R&&R[De]||0,I=R&&R[De-b]||0,W=v($,Q,I),ge[De+1]=E[De]-W+256&255;return ge},v=function(E,b,R){if(E===b&&b===R)return E;var $=Math.abs(b-R),Q=Math.abs(E-R),I=Math.abs(E+b-R-R);return $<=Q&&$<=I?E:Q<=I?b:R},_=function(){return[i,o,l,h,g]},x=function(E){var b=E.map(function(R){return R.reduce(function($,Q){return $+Math.abs(Q)},0)});return b.indexOf(Math.min.apply(null,b))};e.processPNG=function(E,b,R,$){var Q,I,W,ge,Se,De,Ye,Ve,O,K,ce,H,D,V,z,U=this.decode.FLATE_DECODE,G="";if(this.__addimage__.isArrayBuffer(E)&&(E=new Uint8Array(E)),this.__addimage__.isArrayBufferView(E)){if(E=(W=new hN(E)).imgData,I=W.bits,Q=W.colorSpace,Se=W.colors,[4,6].indexOf(W.colorType)!==-1){if(W.bits===8){O=(Ve=W.pixelBitlength==32?new Uint32Array(W.decodePixels().buffer):W.pixelBitlength==16?new Uint16Array(W.decodePixels().buffer):new Uint8Array(W.decodePixels().buffer)).length,ce=new Uint8Array(O*W.colors),K=new Uint8Array(O);var ue,ie=W.pixelBitlength-W.bits;for(V=0,z=0;V<O;V++){for(D=Ve[V],ue=0;ue<ie;)ce[z++]=D>>>ue&255,ue+=W.bits;K[V]=D>>>ue&255}}if(W.bits===16){O=(Ve=new Uint32Array(W.decodePixels().buffer)).length,ce=new Uint8Array(O*(32/W.pixelBitlength)*W.colors),K=new Uint8Array(O*(32/W.pixelBitlength)),H=W.colors>1,V=0,z=0;for(var Ae=0;V<O;)D=Ve[V++],ce[z++]=D>>>0&255,H&&(ce[z++]=D>>>16&255,D=Ve[V++],ce[z++]=D>>>0&255),K[Ae++]=D>>>16&255;I=8}$!==e.image_compression.NONE&&n()?(E=t(ce,W.width*W.colors,W.colors,$),Ye=t(K,W.width,1,$)):(E=ce,Ye=K,U=void 0)}if(W.colorType===3&&(Q=this.color_spaces.INDEXED,De=W.palette,W.transparency.indexed)){var Me=W.transparency.indexed,st=0;for(V=0,O=Me.length;V<O;++V)st+=Me[V];if((st/=255)===O-1&&Me.indexOf(0)!==-1)ge=[Me.indexOf(0)];else if(st!==O){for(Ve=W.decodePixels(),K=new Uint8Array(Ve.length),V=0,O=Ve.length;V<O;V++)K[V]=Me[Ve[V]];Ye=t(K,W.width,1)}}var X=function(Ee){var N;switch(Ee){case e.image_compression.FAST:N=11;break;case e.image_compression.MEDIUM:N=13;break;case e.image_compression.SLOW:N=14;break;default:N=12}return N}($);return U===this.decode.FLATE_DECODE&&(G="/Predictor "+X+" "),G+="/Colors "+Se+" /BitsPerComponent "+I+" /Columns "+W.width,(this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),(Ye&&this.__addimage__.isArrayBuffer(Ye)||this.__addimage__.isArrayBufferView(Ye))&&(Ye=this.__addimage__.arrayBufferToBinaryString(Ye)),{alias:R,data:E,index:b,filter:U,decodeParameters:G,transparency:ge,palette:De,sMask:Ye,predictor:X,width:W.width,height:W.height,bitsPerComponent:I,colorSpace:Q}}}})(fr.API),function(e){e.processGIF89A=function(n,t,r,i){var o=new fN(n),l=o.width,h=o.height,g=[];o.decodeAndBlitFrameRGBA(0,g);var v={data:g,width:l,height:h},_=new Q0(100).encode(v,100);return e.processJPEG.call(this,_,t,r,i)},e.processGIF87A=e.processGIF89A}(fr.API),Wl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var n=0;n<e;n++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:i,green:r,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wl.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,n=this.width*this.height*4;this.data=new Uint8Array(n),this[e]()}catch(t){qi.log("bit decode error:"+t)}},Wl.prototype.bit1=function(){var e,n=Math.ceil(this.width/8),t=n%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<n;i++)for(var o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+8*i*4,h=0;h<8&&8*i+h<this.width;h++){var g=this.palette[o>>7-h&1];this.data[l+4*h]=g.blue,this.data[l+4*h+1]=g.green,this.data[l+4*h+2]=g.red,this.data[l+4*h+3]=255}t!==0&&(this.pos+=4-t)}},Wl.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),n=e%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++){var o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+2*i*4,h=o>>4,g=15&o,v=this.palette[h];if(this.data[l]=v.blue,this.data[l+1]=v.green,this.data[l+2]=v.red,this.data[l+3]=255,2*i+1>=this.width)break;v=this.palette[g],this.data[l+4]=v.blue,this.data[l+4+1]=v.green,this.data[l+4+2]=v.red,this.data[l+4+3]=255}n!==0&&(this.pos+=4-n)}},Wl.prototype.bit8=function(){for(var e=this.width%4,n=this.height-1;n>=0;n--){for(var t=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;if(i<this.palette.length){var l=this.palette[i];this.data[o]=l.red,this.data[o+1]=l.green,this.data[o+2]=l.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},Wl.prototype.bit15=function(){for(var e=this.width%3,n=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&n)/n*255|0,h=(o>>5&n)/n*255|0,g=(o>>10&n)/n*255|0,v=o>>15?255:0,_=r*this.width*4+4*i;this.data[_]=g,this.data[_+1]=h,this.data[_+2]=l,this.data[_+3]=v}this.pos+=e}},Wl.prototype.bit16=function(){for(var e=this.width%3,n=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,o=0;o<this.width;o++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(l&n)/n*255|0,g=(l>>5&t)/t*255|0,v=(l>>11)/n*255|0,_=i*this.width*4+4*o;this.data[_]=v,this.data[_+1]=g,this.data[_+2]=h,this.data[_+3]=255}this.pos+=e}},Wl.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*t;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=255}this.pos+=this.width%4}},Wl.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var n=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=n*this.width*4+4*t;this.data[h]=o,this.data[h+1]=i,this.data[h+2]=r,this.data[h+3]=l}},Wl.prototype.getData=function(){return this.data},function(e){e.processBMP=function(n,t,r,i){var o=new Wl(n,!1),l=o.width,h=o.height,g={data:o.getData(),width:l,height:h},v=new Q0(100).encode(g,100);return e.processJPEG.call(this,v,t,r,i)}}(fr.API),Hy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(n,t,r,i){var o=new Hy(n),l=o.width,h=o.height,g={data:o.getData(),width:l,height:h},v=new Q0(100).encode(g,100);return e.processJPEG.call(this,v,t,r,i)}}(fr.API),fr.API.processRGBA=function(e,n,t){for(var r=e.data,i=r.length,o=new Uint8Array(i/4*3),l=new Uint8Array(i/4),h=0,g=0,v=0;v<i;v+=4){var _=r[v],x=r[v+1],E=r[v+2],b=r[v+3];o[h++]=_,o[h++]=x,o[h++]=E,l[g++]=b}var R=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:R,index:n,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},fr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kh=fr.API,Nd=kh.getCharWidthsArray=function(e,n){var t,r,i=(n=n||{}).font||this.internal.getFont(),o=n.fontSize||this.internal.getFontSize(),l=n.charSpace||this.internal.getCharSpace(),h=n.widths?n.widths:i.metadata.Unicode.widths,g=h.fof?h.fof:1,v=n.kerning?n.kerning:i.metadata.Unicode.kerning,_=v.fof?v.fof:1,x=n.doKerning!==!1,E=0,b=e.length,R=0,$=h[0]||g,Q=[];for(t=0;t<b;t++)r=e.charCodeAt(t),typeof i.metadata.widthOfString=="function"?Q.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+l*(1e3/o)||0)/1e3):(E=x&&Bi(v[r])==="object"&&!isNaN(parseInt(v[r][R],10))?v[r][R]/_:0,Q.push((h[r]||$)/g+E)),R=r;return Q},$y=kh.getStringUnitWidth=function(e,n){var t=(n=n||{}).fontSize||this.internal.getFontSize(),r=n.font||this.internal.getFont(),i=n.charSpace||this.internal.getCharSpace();return kh.processArabic&&(e=kh.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,t,i)/t:Nd.apply(this,arguments).reduce(function(o,l){return o+l},0)},qy=function(e,n,t,r){for(var i=[],o=0,l=e.length,h=0;o!==l&&h+n[o]<t;)h+=n[o],o++;i.push(e.slice(0,o));var g=o;for(h=0;o!==l;)h+n[o]>r&&(i.push(e.slice(g,o)),h=0,g=o),h+=n[o],o++;return g!==o&&i.push(e.slice(g,o)),i},Vy=function(e,n,t){t||(t={});var r,i,o,l,h,g,v,_=[],x=[_],E=t.textIndent||0,b=0,R=0,$=e.split(" "),Q=Nd.apply(this,[" ",t])[0];if(g=t.lineIndent===-1?$[0].length+2:t.lineIndent||0){var I=Array(g).join(" "),W=[];$.map(function(Se){(Se=Se.split(/\s*\n/)).length>1?W=W.concat(Se.map(function(De,Ye){return(Ye&&De.length?`
`:"")+De})):W.push(Se[0])}),$=W,g=$y.apply(this,[I,t])}for(o=0,l=$.length;o<l;o++){var ge=0;if(r=$[o],g&&r[0]==`
`&&(r=r.substr(1),ge=1),E+b+(R=(i=Nd.apply(this,[r,t])).reduce(function(Se,De){return Se+De},0))>n||ge){if(R>n){for(h=qy.apply(this,[r,i,n-(E+b),n]),_.push(h.shift()),_=[h.pop()];h.length;)x.push([h.shift()]);R=i.slice(r.length-(_[0]?_[0].length:0)).reduce(function(Se,De){return Se+De},0)}else _=[r];x.push(_),E=R+g,b=Q}else _.push(r),E+=b+R,b=Q}return v=g?function(Se,De){return(De?I:"")+Se.join(" ")}:function(Se){return Se.join(" ")},x.map(v)},kh.splitTextToSize=function(e,n,t){var r,i=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var x=this.internal.getFont(_.fontName,_.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*n/i;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=t.lineIndent;var h,g,v=[];for(h=0,g=r.length;h<g;h++)v=v.concat(Vy.apply(this,[r[h],l,o]));return v},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",t={},r={},i=0;i<n.length;i++)t[n[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=n[i];var o=function(x){return"0x"+parseInt(x,10).toString(16)},l=e.__fontmetrics__.compress=function(x){var E,b,R,$,Q=["{"];for(var I in x){if(E=x[I],isNaN(parseInt(I,10))?b="'"+I+"'":(I=parseInt(I,10),b=(b=o(I).slice(2)).slice(0,-1)+r[b.slice(-1)]),typeof E=="number")E<0?(R=o(E).slice(3),$="-"):(R=o(E).slice(2),$=""),R=$+R.slice(0,-1)+r[R.slice(-1)];else{if(Bi(E)!=="object")throw new Error("Don't know what to do with value type "+Bi(E)+".");R=l(E)}Q.push(b+R)}return Q.push("}"),Q.join("")},h=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var E,b,R,$,Q={},I=1,W=Q,ge=[],Se="",De="",Ye=x.length-1,Ve=1;Ve<Ye;Ve+=1)($=x[Ve])=="'"?E?(R=E.join(""),E=void 0):E=[]:E?E.push($):$=="{"?(ge.push([W,R]),W={},R=void 0):$=="}"?((b=ge.pop())[0][b[1]]=W,R=void 0,W=b[0]):$=="-"?I=-1:R===void 0?t.hasOwnProperty($)?(Se+=t[$],R=parseInt(Se,16)*I,I=1,Se=""):Se+=$:t.hasOwnProperty($)?(De+=t[$],W[R]=parseInt(De,16)*I,I=1,R=void 0,De=""):De+=$;return Q},g={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},v={Unicode:{Courier:g,"Courier-Bold":g,"Courier-BoldOblique":g,"Courier-Oblique":g,Helvetica:g,"Helvetica-Bold":g,"Helvetica-BoldOblique":g,"Helvetica-Oblique":g,"Times-Roman":g,"Times-Bold":g,"Times-BoldItalic":g,"Times-Italic":g}},_={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var E=x.font,b=_.Unicode[E.postScriptName];b&&(E.metadata.Unicode={},E.metadata.Unicode.widths=b.widths,E.metadata.Unicode.kerning=b.kerning);var R=v.Unicode[E.postScriptName];R&&(E.metadata.Unicode.encoding=R,E.encoding=R.codePages[0])}])}(fr.API),function(e){var n=function(t){for(var r=t.length,i=new Uint8Array(r),o=0;o<r;o++)i[o]=t.charCodeAt(o);return i};e.API.events.push(["addFont",function(t){var r=void 0,i=t.font,o=t.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(l,h){h=/^\x00\x01\x00\x00/.test(h)?n(h):n(Of(h)),l.metadata=e.API.TTFFont.open(h),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(i,r)}}])}(fr),function(e){function n(){return(dr.canvg?Promise.resolve(dr.canvg):Qc(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}fr.API.addSvgAsImage=function(t,r,i,o,l,h,g,v){if(isNaN(r)||isNaN(i))throw qi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(l))throw qi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=o,_.height=l;var x=_.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,_.width,_.height);var E={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return n().then(function(R){return R.fromString(x,t,E)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(E)}).then(function(){b.addImage(_.toDataURL("image/jpeg",1),r,i,o,l,g,v)})}}(),fr.API.putTotalPages=function(e){var n,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(n,t);return this},fr.API.viewerPreferences=function(e,n){var t;e=e||{},n=n||!1;var r,i,o,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},h=Object.keys(l),g=[],v=0,_=0,x=0;function E(R,$){var Q,I=!1;for(Q=0;Q<R.length;Q+=1)R[Q]===$&&(I=!0);return I}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||n===!0){var b=h.length;for(x=0;x<b;x+=1)t[h[x]].value=t[h[x]].defaultValue,t[h[x]].explicitSet=!1}if(Bi(e)==="object"){for(i in e)if(o=e[i],E(h,i)&&o!==void 0){if(t[i].type==="boolean"&&typeof o=="boolean")t[i].value=o;else if(t[i].type==="name"&&E(t[i].valueSet,o))t[i].value=o;else if(t[i].type==="integer"&&Number.isInteger(o))t[i].value=o;else if(t[i].type==="array"){for(v=0;v<o.length;v+=1)if(r=!0,o[v].length===1&&typeof o[v][0]=="number")g.push(String(o[v]-1));else if(o[v].length>1){for(_=0;_<o[v].length;_+=1)typeof o[v][_]!="number"&&(r=!1);r===!0&&g.push([o[v][0]-1,o[v][1]-1].join(" "))}t[i].value="["+g.join(" ")+"]"}else t[i].value=t[i].defaultValue;t[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var R,$=[];for(R in t)t[R].explicitSet===!0&&(t[R].type==="name"?$.push("/"+R+" /"+t[R].value):$.push("/"+R+" "+t[R].value));$.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+$.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(e){var n=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(r)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),h=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),g=unescape(encodeURIComponent("</x:xmpmeta>")),v=o.length+l.length+h.length+i.length+g.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+v+" >>"),this.internal.write("stream"),this.internal.write(i+o+l+h+g),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",n)),this}}(fr.API),function(e){var n=e.API,t=n.pdfEscape16=function(o,l){for(var h,g=l.metadata.Unicode.widths,v=["","0","00","000","0000"],_=[""],x=0,E=o.length;x<E;++x){if(h=l.metadata.characterToGlyph(o.charCodeAt(x)),l.metadata.glyIdsUsed.push(h),l.metadata.toUnicode[h]=o.charCodeAt(x),g.indexOf(h)==-1&&(g.push(h),g.push([parseInt(l.metadata.widthOfGlyph(h),10)])),h=="0")return _.join("");h=h.toString(16),_.push(v[4-h.length],h)}return _.join("")},r=function(o){var l,h,g,v,_,x,E;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,g=[],x=0,E=(h=Object.keys(o).sort(function(b,R){return b-R})).length;x<E;x++)l=h[x],g.length>=100&&(_+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar`,g=[]),o[l]!==void 0&&o[l]!==null&&typeof o[l].toString=="function"&&(v=("0000"+o[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),g.push("<"+l+"><"+v+">"));return g.length&&(_+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};n.events.push(["putFont",function(o){(function(l){var h=l.font,g=l.out,v=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="Identity-H"){for(var x=h.metadata.Unicode.widths,E=h.metadata.subset.encode(h.metadata.glyIdsUsed,1),b="",R=0;R<E.length;R++)b+=String.fromCharCode(E[R]);var $=v();_({data:b,addLength1:!0,objectId:$}),g("endobj");var Q=v();_({data:r(h.metadata.toUnicode),addLength1:!0,objectId:Q}),g("endobj");var I=v();g("<<"),g("/Type /FontDescriptor"),g("/FontName /"+Rh(h.fontName)),g("/FontFile2 "+$+" 0 R"),g("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),g("/Flags "+h.metadata.flags),g("/StemV "+h.metadata.stemV),g("/ItalicAngle "+h.metadata.italicAngle),g("/Ascent "+h.metadata.ascender),g("/Descent "+h.metadata.decender),g("/CapHeight "+h.metadata.capHeight),g(">>"),g("endobj");var W=v();g("<<"),g("/Type /Font"),g("/BaseFont /"+Rh(h.fontName)),g("/FontDescriptor "+I+" 0 R"),g("/W "+e.API.PDFObject.convert(x)),g("/CIDToGIDMap /Identity"),g("/DW 1000"),g("/Subtype /CIDFontType2"),g("/CIDSystemInfo"),g("<<"),g("/Supplement 0"),g("/Registry (Adobe)"),g("/Ordering ("+h.encoding+")"),g(">>"),g(">>"),g("endobj"),h.objectNumber=v(),g("<<"),g("/Type /Font"),g("/Subtype /Type0"),g("/ToUnicode "+Q+" 0 R"),g("/BaseFont /"+Rh(h.fontName)),g("/Encoding /"+h.encoding),g("/DescendantFonts ["+W+" 0 R]"),g(">>"),g("endobj"),h.isAlreadyPutted=!0}})(o)}]),n.events.push(["putFont",function(o){(function(l){var h=l.font,g=l.out,v=l.newObject,_=l.putStream;if(h.metadata instanceof e.API.TTFFont&&h.encoding==="WinAnsiEncoding"){for(var x=h.metadata.rawData,E="",b=0;b<x.length;b++)E+=String.fromCharCode(x[b]);var R=v();_({data:E,addLength1:!0,objectId:R}),g("endobj");var $=v();_({data:r(h.metadata.toUnicode),addLength1:!0,objectId:$}),g("endobj");var Q=v();g("<<"),g("/Descent "+h.metadata.decender),g("/CapHeight "+h.metadata.capHeight),g("/StemV "+h.metadata.stemV),g("/Type /FontDescriptor"),g("/FontFile2 "+R+" 0 R"),g("/Flags 96"),g("/FontBBox "+e.API.PDFObject.convert(h.metadata.bbox)),g("/FontName /"+Rh(h.fontName)),g("/ItalicAngle "+h.metadata.italicAngle),g("/Ascent "+h.metadata.ascender),g(">>"),g("endobj"),h.objectNumber=v();for(var I=0;I<h.metadata.hmtx.widths.length;I++)h.metadata.hmtx.widths[I]=parseInt(h.metadata.hmtx.widths[I]*(1e3/h.metadata.head.unitsPerEm));g("<</Subtype/TrueType/Type/Font/ToUnicode "+$+" 0 R/BaseFont/"+Rh(h.fontName)+"/FontDescriptor "+Q+" 0 R/Encoding/"+h.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(h.metadata.hmtx.widths)+">>"),g("endobj"),h.isAlreadyPutted=!0}})(o)}]);var i=function(o){var l,h=o.text||"",g=o.x,v=o.y,_=o.options||{},x=o.mutex||{},E=x.pdfEscape,b=x.activeFontKey,R=x.fonts,$=b,Q="",I=0,W="",ge=R[$].encoding;if(R[$].encoding!=="Identity-H")return{text:h,x:g,y:v,options:_,mutex:x};for(W=h,$=b,Array.isArray(h)&&(W=h[0]),I=0;I<W.length;I+=1)R[$].metadata.hasOwnProperty("cmap")&&(l=R[$].metadata.cmap.unicode.codeMap[W[I].charCodeAt(0)]),l||W[I].charCodeAt(0)<256&&R[$].metadata.hasOwnProperty("Unicode")?Q+=W[I]:Q+="";var Se="";return parseInt($.slice(1))<14||ge==="WinAnsiEncoding"?Se=E(Q,$).split("").map(function(De){return De.charCodeAt(0).toString(16)}).join(""):ge==="Identity-H"&&(Se=t(Q,R[$])),x.isHex=!0,{text:Se,x:g,y:v,options:_,mutex:x}};n.events.push(["postProcessText",function(o){var l=o.text||"",h=[],g={text:l,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(l)){var v=0;for(v=0;v<l.length;v+=1)Array.isArray(l[v])&&l[v].length===3?h.push([i(Object.assign({},g,{text:l[v][0]})).text,l[v][1],l[v][2]]):h.push(i(Object.assign({},g,{text:l[v]})).text);o.text=h}else o.text=i(Object.assign({},g,{text:l})).text}])}(fr),function(e){var n=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,r){return n.call(this),this.internal.vFS[t]=r,this},e.getFileFromVFS=function(t){return n.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(fr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var i,o,l,h,g,v,_,x=n,E=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],b=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],R={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},$={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},Q=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],I=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),W=!1,ge=0;this.__bidiEngine__={};var Se=function(H){var D=H.charCodeAt(),V=D>>8,z=$[V];return z!==void 0?x[256*z+(255&D)]:V===252||V===253?"AL":I.test(V)?"L":V===8?"R":"N"},De=function(H){for(var D,V=0;V<H.length;V++){if((D=Se(H.charAt(V)))==="L")return!1;if(D==="R")return!0}return!1},Ye=function(H,D,V,z){var U,G,ue,ie,Ae=D[z];switch(Ae){case"L":case"R":W=!1;break;case"N":case"AN":break;case"EN":W&&(Ae="AN");break;case"AL":W=!0,Ae="R";break;case"WS":Ae="N";break;case"CS":z<1||z+1>=D.length||(U=V[z-1])!=="EN"&&U!=="AN"||(G=D[z+1])!=="EN"&&G!=="AN"?Ae="N":W&&(G="AN"),Ae=G===U?G:"N";break;case"ES":Ae=(U=z>0?V[z-1]:"B")==="EN"&&z+1<D.length&&D[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&V[z-1]==="EN"){Ae="EN";break}if(W){Ae="N";break}for(ue=z+1,ie=D.length;ue<ie&&D[ue]==="ET";)ue++;Ae=ue<ie&&D[ue]==="EN"?"EN":"N";break;case"NSM":if(l&&!h){for(ie=D.length,ue=z+1;ue<ie&&D[ue]==="NSM";)ue++;if(ue<ie){var Me=H[z],st=Me>=1425&&Me<=2303||Me===64286;if(U=D[ue],st&&(U==="R"||U==="AL")){Ae="R";break}}}Ae=z<1||(U=D[z-1])==="B"?"N":V[z-1];break;case"B":W=!1,i=!0,Ae=ge;break;case"S":o=!0,Ae="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":W=!1;break;case"BN":Ae="N"}return Ae},Ve=function(H,D,V){var z=H.split("");return V&&O(z,V,{hiLevel:ge}),z.reverse(),D&&D.reverse(),z.join("")},O=function(H,D,V){var z,U,G,ue,ie,Ae=-1,Me=H.length,st=0,X=[],Ee=ge?b:E,N=[];for(W=!1,i=!1,o=!1,U=0;U<Me;U++)N[U]=Se(H[U]);for(G=0;G<Me;G++){if(ie=st,X[G]=Ye(H,N,X,G),z=240&(st=Ee[ie][R[X[G]]]),st&=15,D[G]=ue=Ee[st][5],z>0)if(z===16){for(U=Ae;U<G;U++)D[U]=1;Ae=-1}else Ae=-1;if(Ee[st][6])Ae===-1&&(Ae=G);else if(Ae>-1){for(U=Ae;U<G;U++)D[U]=ue;Ae=-1}N[G]==="B"&&(D[G]=0),V.hiLevel|=ue}o&&function(Z,he,ne){for(var te=0;te<ne;te++)if(Z[te]==="S"){he[te]=ge;for(var ee=te-1;ee>=0&&Z[ee]==="WS";ee--)he[ee]=ge}}(N,D,Me)},K=function(H,D,V,z,U){if(!(U.hiLevel<H)){if(H===1&&ge===1&&!i)return D.reverse(),void(V&&V.reverse());for(var G,ue,ie,Ae,Me=D.length,st=0;st<Me;){if(z[st]>=H){for(ie=st+1;ie<Me&&z[ie]>=H;)ie++;for(Ae=st,ue=ie-1;Ae<ue;Ae++,ue--)G=D[Ae],D[Ae]=D[ue],D[ue]=G,V&&(G=V[Ae],V[Ae]=V[ue],V[ue]=G);st=ie}st++}}},ce=function(H,D,V){var z=H.split(""),U={hiLevel:ge};return V||(V=[]),O(z,V,U),function(G,ue,ie){if(ie.hiLevel!==0&&_)for(var Ae,Me=0;Me<G.length;Me++)ue[Me]===1&&(Ae=Q.indexOf(G[Me]))>=0&&(G[Me]=Q[Ae+1])}(z,V,U),K(2,z,D,V,U),K(1,z,D,V,U),z.join("")};return this.__bidiEngine__.doBidiReorder=function(H,D,V){if(function(U,G){if(G)for(var ue=0;ue<U.length;ue++)G[ue]=ue;h===void 0&&(h=De(U)),v===void 0&&(v=De(U))}(H,D),l||!g||v)if(l&&g&&h^v)ge=h?1:0,H=Ve(H,D,V);else if(!l&&g&&v)ge=h?1:0,H=ce(H,D,V),H=Ve(H,D);else if(!l||h||g||v){if(l&&!g&&h^v)H=Ve(H,D),h?(ge=0,H=ce(H,D,V)):(ge=1,H=ce(H,D,V),H=Ve(H,D));else if(l&&h&&!g&&v)ge=1,H=ce(H,D,V),H=Ve(H,D);else if(!l&&!g&&h^v){var z=_;h?(ge=1,H=ce(H,D,V),ge=0,_=!1,H=ce(H,D,V),_=z):(ge=0,H=ce(H,D,V),H=Ve(H,D),ge=1,_=!1,H=ce(H,D,V),_=z,H=Ve(H,D))}}else ge=0,H=ce(H,D,V);else ge=h?1:0,H=ce(H,D,V);return H},this.__bidiEngine__.setOptions=function(H){H&&(l=H.isInputVisual,g=H.isOutputVisual,h=H.isInputRtl,v=H.isOutputRtl,_=H.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var i=r.text,o=(r.x,r.y,r.options||{}),l=(r.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var h=0;for(l=[],h=0;h<i.length;h+=1)Object.prototype.toString.call(i[h])==="[object Array]"?l.push([t.doBidiReorder(i[h][0]),i[h][1],i[h][2]]):l.push([t.doBidiReorder(i[h])]);r.text=l}else r.text=t.doBidiReorder(i);t.setOptions({isInputVisual:!0})}])}(fr),fr.API.TTFFont=function(){function e(n){var t;if(this.rawData=n,t=this.contents=new Pc(n),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new EN(this),this.registerTTF()}return e.open=function(n){return new e(n)},e.prototype.parse=function(){return this.directory=new dN(this.contents),this.head=new gN(this),this.name=new bN(this),this.cmap=new qb(this),this.toUnicode={},this.hhea=new mN(this),this.maxp=new wN(this),this.hmtx=new xN(this),this.post=new yN(this),this.os2=new vN(this),this.loca=new PN(this),this.glyf=new LN(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var n,t,r,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,h,g,v;for(v=[],l=0,h=(g=this.bbox).length;l<h;l++)n=g[l],v.push(Math.round(n*this.scaleFactor));return v}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(t=i>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(n){var t;return((t=this.cmap.unicode)!=null?t.codeMap[n]:void 0)||0},e.prototype.widthOfGlyph=function(n){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*t},e.prototype.widthOfString=function(n,t,r){var i,o,l,h;for(l=0,o=0,h=(n=""+n).length;0<=h?o<h:o>h;o=0<=h?++o:--o)i=n.charCodeAt(o),l+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(n,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*n},e}();var nu,Pc=function(){function e(n){this.data=n??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(n){return this.data[this.pos++]=n},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},e.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},e.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},e.prototype.readString=function(n){var t,r;for(r=[],t=0;0<=n?t<n:t>n;t=0<=n?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(n){var t,r,i;for(i=[],t=0,r=n.length;0<=r?t<r:t>r;t=0<=r?++t:--t)i.push(this.writeByte(n.charCodeAt(t)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(n){return this.writeInt16(n)},e.prototype.readLongLong=function(){var n,t,r,i,o,l,h,g;return n=this.readByte(),t=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),h=this.readByte(),g=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^o)+65536*(255^l)+256*(255^h)+(255^g)+1):72057594037927940*n+281474976710656*t+1099511627776*r+4294967296*i+16777216*o+65536*l+256*h+g},e.prototype.writeLongLong=function(n){var t,r;return t=Math.floor(n/4294967296),r=4294967295&n,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(n){return this.writeInt32(n)},e.prototype.read=function(n){var t,r;for(t=[],r=0;0<=n?r<n:r>n;r=0<=n?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(n){var t,r,i,o;for(o=[],r=0,i=n.length;r<i;r++)t=n[r],o.push(this.writeByte(t));return o},e}(),dN=function(){var e;function n(t){var r,i,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return n.prototype.encode=function(t){var r,i,o,l,h,g,v,_,x,E,b,R,$;for($ in b=Object.keys(t).length,g=Math.log(2),x=16*Math.floor(Math.log(b)/g),l=Math.floor(x/g),_=16*b-x,(i=new Pc).writeInt(this.scalarType),i.writeShort(b),i.writeShort(x),i.writeShort(l),i.writeShort(_),o=16*b,v=i.pos+o,h=null,R=[],t)for(E=t[$],i.writeString($),i.writeInt(e(E)),i.writeInt(v),i.writeInt(E.length),R=R.concat(E),$==="head"&&(h=v),v+=E.length;v%4;)R.push(0),v++;return i.write(R),r=2981146554-e(i.data),i.pos=h+8,i.writeUInt32(r),i.data},e=function(t){var r,i,o,l;for(t=Vb.call(t);t.length%4;)t.push(0);for(o=new Pc(t),i=0,r=0,l=t.length;r<l;r=r+=4)i+=o.readUInt32();return 4294967295&i},n}(),pN={}.hasOwnProperty,Mu=function(e,n){for(var t in n)pN.call(n,t)&&(e[t]=n[t]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};nu=function(){function e(n){var t;this.file=n,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var gN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="head",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},n.prototype.encode=function(t){var r;return(r=new Pc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},n}(),Wy=function(){function e(n,t){var r,i,o,l,h,g,v,_,x,E,b,R,$,Q,I,W,ge;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=t+n.readInt(),x=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(g=0;g<256;++g)this.codeMap[g]=n.readByte();break;case 4:for(b=n.readUInt16(),E=b/2,n.pos+=6,o=function(){var Se,De;for(De=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)De.push(n.readUInt16());return De}(),n.pos+=2,$=function(){var Se,De;for(De=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)De.push(n.readUInt16());return De}(),v=function(){var Se,De;for(De=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)De.push(n.readUInt16());return De}(),_=function(){var Se,De;for(De=[],g=Se=0;0<=E?Se<E:Se>E;g=0<=E?++Se:--Se)De.push(n.readUInt16());return De}(),i=(this.length-n.pos+this.offset)/2,h=function(){var Se,De;for(De=[],g=Se=0;0<=i?Se<i:Se>i;g=0<=i?++Se:--Se)De.push(n.readUInt16());return De}(),g=I=0,ge=o.length;I<ge;g=++I)for(Q=o[g],r=W=R=$[g];R<=Q?W<=Q:W>=Q;r=R<=Q?++W:--W)_[g]===0?l=r+v[g]:(l=h[_[g]/2+(r-R)-(E-g)]||0)!==0&&(l+=v[g]),this.codeMap[r]=65535&l}n.pos=x}return e.encode=function(n,t){var r,i,o,l,h,g,v,_,x,E,b,R,$,Q,I,W,ge,Se,De,Ye,Ve,O,K,ce,H,D,V,z,U,G,ue,ie,Ae,Me,st,X,Ee,N,Z,he,ne,te,ee,se,Pe,oe;switch(z=new Pc,l=Object.keys(n).sort(function(re,xe){return re-xe}),t){case"macroman":for($=0,Q=function(){var re=[];for(R=0;R<256;++R)re.push(0);return re}(),W={0:0},o={},U=0,Ae=l.length;U<Ae;U++)W[ee=n[i=l[U]]]==null&&(W[ee]=++$),o[i]={old:n[i],new:W[n[i]]},Q[i]=W[n[i]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(Q),{charMap:o,subtable:z.data,maxGlyphID:$+1};case"unicode":for(D=[],x=[],ge=0,W={},r={},I=v=null,G=0,Me=l.length;G<Me;G++)W[De=n[i=l[G]]]==null&&(W[De]=++ge),r[i]={old:De,new:W[De]},h=W[De]-i,I!=null&&h===v||(I&&x.push(I),D.push(i),v=h),I=i;for(I&&x.push(I),x.push(65535),D.push(65535),ce=2*(K=D.length),O=2*Math.pow(Math.log(K)/Math.LN2,2),E=Math.log(O/2)/Math.LN2,Ve=2*K-O,g=[],Ye=[],b=[],R=ue=0,st=D.length;ue<st;R=++ue){if(H=D[R],_=x[R],H===65535){g.push(0),Ye.push(0);break}if(H-(V=r[H].new)>=32768)for(g.push(0),Ye.push(2*(b.length+K-R)),i=ie=H;H<=_?ie<=_:ie>=_;i=H<=_?++ie:--ie)b.push(r[i].new);else g.push(V-H),Ye.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*K+2*b.length),z.writeUInt16(0),z.writeUInt16(ce),z.writeUInt16(O),z.writeUInt16(E),z.writeUInt16(Ve),ne=0,X=x.length;ne<X;ne++)i=x[ne],z.writeUInt16(i);for(z.writeUInt16(0),te=0,Ee=D.length;te<Ee;te++)i=D[te],z.writeUInt16(i);for(se=0,N=g.length;se<N;se++)h=g[se],z.writeUInt16(h);for(Pe=0,Z=Ye.length;Pe<Z;Pe++)Se=Ye[Pe],z.writeUInt16(Se);for(oe=0,he=b.length;oe<he;oe++)$=b[oe],z.writeUInt16($);return{charMap:r,subtable:z.data,maxGlyphID:ge+1}}},e}(),qb=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="cmap",n.prototype.parse=function(t){var r,i,o;for(t.pos=this.offset,this.version=t.readUInt16(),o=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)r=new Wy(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},n.encode=function(t,r){var i,o;return r==null&&(r="macroman"),i=Wy.encode(t,r),(o=new Pc).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},n}(),mN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="hhea",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},n}(),vN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="OS/2",n.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(t.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(t.readInt());return i}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(t.readInt());return i}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},n}(),yN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="post",n.prototype.parse=function(t){var r,i,o;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var l;for(i=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=i?l<i:l>i;l=0<=i?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],o=[];t.pos<this.offset+this.length;)r=t.readByte(),o.push(this.names.push(t.readString(r)));return o;case 151552:return i=t.readUInt16(),this.offsets=t.read(i);case 196608:break;case 262144:return this.map=(function(){var h,g,v;for(v=[],l=h=0,g=this.file.maxp.numGlyphs;0<=g?h<g:h>g;l=0<=g?++h:--h)v.push(t.readUInt32());return v}).call(this)}},n}(),_N=function(e,n){this.raw=e,this.length=e.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},bN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="name",n.prototype.parse=function(t){var r,i,o,l,h,g,v,_,x,E,b;for(t.pos=this.offset,t.readShort(),r=t.readShort(),g=t.readShort(),i=[],l=0;0<=r?l<r:l>r;l=0<=r?++l:--l)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+g+t.readShort()});for(v={},l=x=0,E=i.length;x<E;l=++x)o=i[l],t.pos=o.offset,_=t.readString(o.length),h=new _N(_,o),v[b=o.nameID]==null&&(v[b]=[]),v[o.nameID].push(h);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},n}(),wN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="maxp",n.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},n}(),xN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="hmtx",n.prototype.parse=function(t){var r,i,o,l,h,g,v;for(t.pos=this.offset,this.metrics=[],r=0,g=this.file.hhea.numberOfMetrics;0<=g?r<g:r>g;r=0<=g?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,x;for(x=[],r=_=0;0<=o?_<o:_>o;r=0<=o?++_:--_)x.push(t.readInt16());return x}(),this.widths=(function(){var _,x,E,b;for(b=[],_=0,x=(E=this.metrics).length;_<x;_++)l=E[_],b.push(l.advance);return b}).call(this),i=this.widths[this.widths.length-1],v=[],r=h=0;0<=o?h<o:h>o;r=0<=o?++h:--h)v.push(this.widths.push(i));return v},n.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},n}(),Vb=[].slice,LN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(t){var r,i,o,l,h,g,v,_,x,E;return t in this.cache?this.cache[t]:(l=this.file.loca,r=this.file.contents,i=l.indexOf(t),(o=l.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+i,h=(g=new Pc(r.read(o))).readShort(),_=g.readShort(),E=g.readShort(),v=g.readShort(),x=g.readShort(),this.cache[t]=h===-1?new CN(g,_,E,v,x):new SN(g,h,_,E,v,x),this.cache[t]))},n.prototype.encode=function(t,r,i){var o,l,h,g,v;for(h=[],l=[],g=0,v=r.length;g<v;g++)o=t[r[g]],l.push(h.length),o&&(h=h.concat(o.encode(i)));return l.push(h.length),{table:h,offsets:l}},n}(),SN=function(){function e(n,t,r,i,o,l){this.raw=n,this.numberOfContours=t,this.xMin=r,this.yMin=i,this.xMax=o,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),CN=function(){function e(n,t,r,i,o){var l,h;for(this.raw=n,this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;h=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&h;)l.pos+=1&h?4:2,128&h?l.pos+=8:64&h?l.pos+=4:8&h&&(l.pos+=2)}return e.prototype.encode=function(){var n,t,r;for(t=new Pc(Vb.call(this.raw.data)),n=0,r=this.glyphIDs.length;n<r;++n)t.pos=this.glyphOffsets[n];return t.data},e}(),PN=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return Mu(n,nu),n.prototype.tag="loca",n.prototype.parse=function(t){var r,i;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var o,l;for(l=[],i=0,o=this.length;i<o;i+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var o,l;for(l=[],i=0,o=this.length;i<o;i+=4)l.push(t.readUInt32());return l}).call(this)},n.prototype.indexOf=function(t){return this.offsets[t]},n.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},n.prototype.encode=function(t,r){for(var i=new Uint32Array(this.offsets.length),o=0,l=0,h=0;h<i.length;++h)if(i[h]=o,l<r.length&&r[l]==h){++l,i[h]=o;var g=this.offsets[h],v=this.offsets[h+1]-g;v>0&&(o+=v)}for(var _=new Array(4*i.length),x=0;x<i.length;++x)_[4*x+3]=255&i[x],_[4*x+2]=(65280&i[x])>>8,_[4*x+1]=(16711680&i[x])>>16,_[4*x]=(4278190080&i[x])>>24;return _},n}(),EN=function(){function e(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var n,t,r,i,o;for(t in i=this.font.cmap.tables[0].codeMap,n={},o=this.subset)r=o[t],n[t]=i[r];return n},e.prototype.glyphsFor=function(n){var t,r,i,o,l,h,g;for(i={},l=0,h=n.length;l<h;l++)i[o=n[l]]=this.font.glyf.glyphFor(o);for(o in t=[],i)(r=i[o])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(o in g=this.glyphsFor(t))r=g[o],i[o]=r;return i},e.prototype.encode=function(n,t){var r,i,o,l,h,g,v,_,x,E,b,R,$,Q,I;for(i in r=qb.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(n),b={0:0},I=r.charMap)b[(g=I[i]).old]=g.new;for(R in E=r.maxGlyphID,l)R in b||(b[R]=E++);return _=function(W){var ge,Se;for(ge in Se={},W)Se[W[ge]]=ge;return Se}(b),x=Object.keys(_).sort(function(W,ge){return W-ge}),$=function(){var W,ge,Se;for(Se=[],W=0,ge=x.length;W<ge;W++)h=x[W],Se.push(_[h]);return Se}(),o=this.font.glyf.encode(l,$,b),v=this.font.loca.encode(o.offsets,$),Q={cmap:this.font.cmap.raw(),glyf:o.table,loca:v,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(Q["OS/2"]=this.font.os2.raw()),this.font.directory.encode(Q)},e}();fr.API.PDFObject=function(){var e;function n(){}return e=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},n.convert=function(t){var r,i,o,l;if(Array.isArray(t))return"["+function(){var h,g,v;for(v=[],h=0,g=t.length;h<g;h++)r=t[h],v.push(n.convert(r));return v}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(i in o=["<<"],t)l=t[i],o.push("/"+i+" "+n.convert(l));return o.push(">>"),o.join(`
`)}return""+t},n}();const AN={class:"h-full flex"},MN={class:"flex-1 relative"},kN={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-sm z-[2000] flex items-center justify-center"},TN={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50 z-[3000]"},BN={class:"text-center max-w-lg mx-auto p-8"},NN={class:"space-y-4"},RN={class:"map-parent"},DN={key:0,class:"fixed top-16 left-0 right-0 z-[1500]"},ON={class:"map-content flex"},IN={class:"flex-1 relative"},FN={key:0,class:"w-64 bg-white border-l border-gray-200 flex-shrink-0 z-[2000]"},zN={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50"},jN={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-[9999] p-4 overflow-y-auto"},UN={class:"bg-white rounded-lg p-6 max-w-2xl w-full my-8 relative"},$N={class:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-4 border-b"},qN={class:"overflow-y-auto max-h-[calc(100vh-12rem)]"},VN={key:0,class:"space-y-4"},GN={key:0,class:"space-y-2"},HN={class:"grid grid-cols-1 gap-2"},WN=["onClick"],ZN={class:"font-medium text-gray-900"},KN={key:1,class:"space-y-2"},JN={class:"flex items-center mb-4"},YN={class:"text-sm text-gray-600"},XN={class:"grid grid-cols-1 gap-2"},QN=["onClick"],eR={class:"font-medium text-gray-900"},tR={key:2,class:"space-y-2"},nR={class:"flex items-center mb-4"},rR={class:"text-sm text-gray-600"},iR={class:"grid grid-cols-1 gap-2"},sR={key:0,class:"text-center py-8"},oR=["onClick"],aR={class:"font-medium text-gray-900"},lR={key:3,class:"space-y-2"},uR={class:"flex items-center mb-4"},cR={class:"text-sm text-gray-600"},hR={class:"grid grid-cols-1 gap-2"},fR=["onClick"],dR={class:"font-medium text-gray-900"},pR={class:"text-sm text-gray-500"},gR={class:"text-xs text-gray-400 mt-1"},mR={key:1,class:"space-y-4"},vR={key:0,class:"space-y-2"},yR={class:"grid grid-cols-1 gap-2"},_R={key:0,class:"text-center py-8"},bR=["onClick"],wR={class:"font-medium text-gray-900"},xR={key:1,class:"space-y-2"},LR={class:"flex items-center mb-4"},SR={class:"text-sm text-gray-600"},CR={class:"grid grid-cols-1 gap-2"},PR=["onClick"],ER={class:"font-medium text-gray-900"},AR={class:"text-sm text-gray-500"},MR={class:"text-xs text-gray-400 mt-1"},kR={key:2,class:"space-y-4"},TR={key:3,class:"space-y-4"},BR={key:0,class:"text-center py-8"},NR={key:1,class:"space-y-2"},RR=["onClick"],DR={class:"font-medium text-gray-900"},OR={class:"text-sm text-gray-500"},IR={class:"text-xs text-gray-400 mt-1"},Zy=Pa({__name:"MapView",emits:["shape-selected"],setup(e,{emit:n}){const t=un(null),r=Lm(),i=xb(),o=un([]),{currentTool:l,selectedShape:h,map:g,initMap:v,setDrawingTool:_,updateShapeStyle:x,updateShapeProperties:E,featureGroup:b,adjustView:R,clearActiveControlPoints:$,calculateConnectedCoverageArea:Q}=a7(),{initMap:I,changeBaseMap:W}=l7(),ge=un(!1),Se=un(!1),De=un(null),Ye=un(!1),Ve=un(null),O=Ga(),K=un([]),ce=un([]),H=un([]),D=un(null),V=un(null),z=un(null),U=un(!1),G=un(!1),ue=un(!1),ie=un(null),Ae=Rr(()=>{var wt,He;return console.log("[MapView][filteredClients] Computing with:",{userType:(wt=O.user)==null?void 0:wt.user_type,selectedSalarie:D.value,salarieVisiteurs:ce.value,visiteurCount:((He=ce.value)==null?void 0:He.length)||0}),O.isSalarie||D.value?ce.value:[]}),Me=Rr(()=>{var Bn,kn,et;if(!h.value)return null;console.log("[MapView][selectedShape] Initial layer state:",{layer:h.value,hasName:"name"in h.value,name:h.value.name,hasProperties:"properties"in h.value,propertiesName:(Bn=h.value.properties)==null?void 0:Bn.name,allLayerKeys:Object.keys(h.value),allPropertiesKeys:h.value.properties?Object.keys(h.value.properties):[],_leaflet_id:h.value._leaflet_id,_dbId:h.value._dbId,descriptor:Object.getOwnPropertyDescriptor(h.value,"name")});const wt=h.value.properties||{};let He;if(wt.style&&wt.style.name)He=wt.style.name,console.log("[MapView][selectedShape] Using name from style:",He);else if(wt.name)He=wt.name,console.log("[MapView][selectedShape] Using name from properties:",He);else if(h.value.name)He=h.value.name,console.log("[MapView][selectedShape] Using name from layer:",He);else{const On=Object.getOwnPropertyDescriptor(h.value,"name");On&&On.value&&(He=On.value,console.log("[MapView][selectedShape] Found name in non-enumerable layer property:",He));const Nn=["_name","displayName","title"];for(const mn of Nn)if(h.value[mn]){He=h.value[mn],console.log(`[MapView][selectedShape] Found name in ${mn}:`,He);break}}He&&(console.log(`[MapView][selectedShape] Ensuring name "${He}" is set everywhere`),h.value.properties||(h.value.properties={}),h.value.properties.name=He,h.value.properties.style||(h.value.properties.style={}),h.value.properties.style.name=He,h.value.name=He,typeof h.value.setName=="function"&&(h.value.setName(He),console.log(`[MapView][selectedShape] Used setName method to set name "${He}"`))),console.log("[MapView][selectedShape] Preparing properties for DrawingTools:",{type:wt.type,name:wt.name,foundName:He,hasNameProperty:"name"in wt,allPropertiesKeys:Object.keys(wt),layerId:h.value._leaflet_id,rawProperties:wt,layerName:h.value.name,layerPropertiesName:(kn=h.value.properties)==null?void 0:kn.name});const Kt={...wt,name:He||h.value.name||wt.name||void 0},on={type:Kt.type||"unknown",properties:Kt,layer:h.value};return console.log("[MapView][selectedShape] Final shape object for DrawingTools:",{type:on.type,hasName:"name"in on.properties,name:on.properties.name,layerName:on.layer.name,layerPropertiesName:(et=on.layer.properties)==null?void 0:et.name}),on});function st(wt){const He=wt.getCenter(),Kt=wt.getZoom(),on={lat:He.lat,lng:He.lng,zoom:Kt};document.cookie=`mapState=${JSON.stringify(on)};max-age=2592000;path=/`}function X(){const He=document.cookie.split(";").find(Kt=>Kt.trim().startsWith("mapState="));if(He)try{return JSON.parse(He.split("=")[1])}catch(Kt){return console.error("Erreur lors de la lecture du cookie de position:",Kt),null}return null}Bl(async()=>{var wt,He;try{if(await r.fetchPlans(),(O.isAdmin||O.isEntreprise)&&await gt(),O.isEntreprise){U.value=!0;try{const et=await Xn.get("/users/",{params:{role:"SALARIE",entreprise:(wt=O.user)==null?void 0:wt.id}});K.value=et.data}catch(et){console.error("Error loading salaries:",et),K.value=[]}finally{U.value=!1}}if(O.isSalarie){G.value=!0;try{const et=await O.fetchSalarieVisiteurs(((He=O.user)==null?void 0:He.id)||0);ce.value=Array.isArray(et)?et:[et]}catch(et){console.error("Error loading clients:",et)}finally{G.value=!1}}const Kt=X(),on=Kt?[Kt.lat,Kt.lng]:[46.603354,1.888334],Bn=(Kt==null?void 0:Kt.zoom)??6;if(t.value&&!g.value){const et=v(t.value,on,Bn);et.pm.setLang("fr"),et.pm.addControls({rotateMode:!1}),I(et),et.on("moveend",()=>{st(et)}),window.addEventListener("map-set-location",On=>{if(et&&On.detail){const{lat:Nn,lng:mn,zoom:Pn}=On.detail;et.flyTo([Nn,mn],Pn,{duration:1.5,easeLinearity:.25})}})}const kn=localStorage.getItem("lastPlanId");if(kn)try{console.log("[MapView][onMounted] Chargement immédiat du dernier plan:",kn),await Z(parseInt(kn));const et=document.querySelector(".map-parent");et instanceof HTMLElement&&(et.style.display="block")}catch(et){console.error("[MapView][onMounted] Erreur chargement dernier plan:",et),De.value=null,r.clearCurrentPlan(),i.clearCurrentPlan(),Ee(),localStorage.removeItem("lastPlanId")}else console.log("[MapView][onMounted] Aucun dernier plan à charger"),De.value=null,r.clearCurrentPlan(),i.clearCurrentPlan(),Ee();window.addEventListener("shape:created",et=>{const{shape:On,type:Nn,properties:mn}=et.detail;console.log("[MapView] Nouvelle forme créée",{shape:On,type:Nn,properties:mn}),i.addElement(On),_("")})}catch(Kt){console.error("Error during component mount:",Kt),De.value=null,r.clearCurrentPlan(),i.clearCurrentPlan(),Ee(),localStorage.removeItem("lastPlanId")}}),Co(()=>i.hasUnsavedChanges,wt=>{console.log("[MapView][watch drawingStore.hasUnsavedChanges]",wt),wt&&De.value&&r.markUnsavedChanges()}),Co(g,async wt=>{var He;console.log(`
[MapView][watch map] Nouvelle carte:`,!!wt),wt&&r.currentPlan&&!((He=b.value)!=null&&He.getLayers().length)&&(console.log("[MapView][watch map] Chargement initial des éléments du plan:",r.currentPlan.id),Ee(),await i.loadPlanElements(r.currentPlan.id))}),Co(()=>r.currentPlan,async(wt,He)=>{var Kt,on,Bn;if((wt==null?void 0:wt.id)===(He==null?void 0:He.id)){console.log("[MapView][watch currentPlan] Plan identique, pas de rechargement nécessaire");return}console.log(`
[MapView][watch currentPlan] ====== CHANGEMENT DE PLAN ======`),console.log("[MapView][watch currentPlan] Nouveau plan:",wt==null?void 0:wt.id);try{if(wt){console.log("[MapView][watch currentPlan] Mise à jour du plan courant..."),De.value=wt;const kn=document.querySelector(".map-parent");kn instanceof HTMLElement&&(kn.style.display="block"),console.log("[MapView][watch currentPlan] Plan mis à jour avec succès")}else{console.log("[MapView][watch currentPlan] Nettoyage du plan courant..."),De.value=null,Ee();const kn=document.querySelector(".map-parent");kn instanceof HTMLElement&&(kn.style.display="none")}}catch(kn){console.error("[MapView][watch currentPlan] ERREUR:",kn),De.value=null,Ee()}console.log("[MapView][watch currentPlan] État final:",{currentPlanId:(Kt=De.value)==null?void 0:Kt.id,storePlanId:(on=r.currentPlan)==null?void 0:on.id,mapVisible:g.value!==null,mapParentDisplay:(Bn=document.querySelector(".map-parent"))==null?void 0:Bn.getAttribute("style")}),console.log(`[MapView][watch currentPlan] ====== FIN CHANGEMENT ======
`)},{immediate:!0}),Ep(()=>{g.value&&g.value.off("moveend"),window.removeEventListener("shape:created",()=>{})});function Ee(){b.value&&b.value.clearLayers(),o.value=[],$(),h.value=null,l.value=""}async function N(wt){return await St.measureAsync("refreshMapWithPlan",async()=>{try{St.measure("refreshMapWithPlan:clearMap",()=>{Ee()},"MapView"),await St.measureAsync("refreshMapWithPlan:loadPlanElements",async()=>{await i.loadPlanElements(wt)},"MapView");const He=St.measure("refreshMapWithPlan:getPlanById",()=>r.getPlanById(wt),"MapView");He?(St.measure("refreshMapWithPlan:updateCurrentPlan",()=>{De.value=He,r.setCurrentPlan(He),i.setCurrentPlan(He.id),localStorage.setItem("lastPlanId",He.id.toString())},"MapView"),g.value&&b.value&&await St.measureAsync("refreshMapWithPlan:addShapesToMap",async()=>{console.log("[MapView][refreshMapWithPlan] Éléments disponibles:",{count:i.getCurrentElements.length,elements:i.getCurrentElements.map(kn=>{var et;return{id:kn.id,type:kn.type_forme,hasName:kn.data&&"name"in kn.data,name:(et=kn.data)==null?void 0:et.name}})});const Kt=i.getCurrentElements.reduce((kn,et)=>(kn[et.type_forme]||(kn[et.type_forme]=[]),kn[et.type_forme].push(et),kn),{}),on=10,Bn=Object.entries(Kt).map(async([kn,et])=>{for(let On=0;On<et.length;On+=on){const Nn=et.slice(On,On+on);await Promise.all(Nn.map(async mn=>{await St.measureAsync(`refreshMapWithPlan:createElement:${mn.type_forme}`,async()=>{var zr,Gn;if(!b.value||!mn.data)return;let Pn=null;switch(mn.type_forme){case"TextRectangle":{const Dt=mn.data;if(!Dt.bounds)return;const xr=vt.latLngBounds(vt.latLng(Dt.bounds.southWest[1],Dt.bounds.southWest[0]),vt.latLng(Dt.bounds.northEast[1],Dt.bounds.northEast[0]));Pn=new yu(xr,Dt.content||"Double-cliquez pour éditer",{...Dt.style,textStyle:Dt.style.textStyle}),Dt.rotation&&typeof Pn.setRotation=="function"&&Pn.setRotation(Dt.rotation),Dt.name&&(Pn.properties={name:Dt.name},Pn.name=Dt.name);break}case"Circle":{const Dt=mn.data;Dt.center&&Dt.radius&&(Pn=new Zc(vt.latLng(Dt.center[1],Dt.center[0]),{...Dt.style,radius:Dt.radius}),Dt.name&&(Pn.properties={type:"Circle",name:Dt.name,style:Dt.style,radius:Dt.radius,diameter:Dt.radius*2,surface:Math.PI*Dt.radius*Dt.radius,perimeter:2*Math.PI*Dt.radius},Pn.name=Dt.name));break}case"Semicircle":{const Dt=mn.data;if(Dt.center&&Dt.radius){const xr=vt.latLng(Dt.center[1],Dt.center[0]);Pn=new wu(xr,Dt.radius,Dt.startAngle||0,Dt.endAngle||180,{...Dt.style}),Pn.properties={type:"Semicircle",radius:Dt.radius,startAngle:Dt.startAngle||0,stopAngle:Dt.endAngle||180,style:{...Dt.style||{},name:((zr=Dt.style)==null?void 0:zr.name)||""},center:xr};const lr=((Dt.endAngle||180)-(Dt.startAngle||0)+360)%360,hi=Math.PI*Math.pow(Dt.radius,2)*lr/360,Ri=2*Math.PI*Dt.radius*lr/360,Fn=Ri+2*Dt.radius;Pn.properties.surface=hi,Pn.properties.arcLength=Ri,Pn.properties.perimeter=Fn,Pn.properties.openingAngle=lr,Pn.properties.diameter=Dt.radius*2,Pn.updateProperties()}break}case"Rectangle":{const Dt=mn.data;if(Dt.bounds){const xr=vt.latLngBounds(vt.latLng(Dt.bounds.southWest[1],Dt.bounds.southWest[0]),vt.latLng(Dt.bounds.northEast[1],Dt.bounds.northEast[0]));Pn=new $o(xr,Dt.style),Dt.name&&(Pn.properties={name:Dt.name},Pn.name=Dt.name)}break}case"Polygon":{const Dt=mn.data;if(Dt.points&&Dt.points.length>0){const xr=Dt.points.map(lr=>vt.latLng(lr[1],lr[0]));Pn=new zh(xr,Dt.style),Dt.name&&(Pn.properties={name:Dt.name},Pn.name=Dt.name)}break}case"Line":{const Dt=mn.data;if(Dt.points&&Dt.points.length>0){const xr=Dt.points.map(lr=>vt.latLng(lr[1],lr[0]));Pn=new Lo(xr,Dt.style),Dt.name&&(Pn.properties={name:Dt.name},Pn.name=Dt.name)}break}case"ElevationLine":{const Dt=mn.data;if(Dt.points&&Dt.points.length>0){const xr=Dt.points.map(lr=>vt.latLng(lr[1],lr[0]));Pn=new lh(xr,Dt.style),Dt.name&&(Pn.properties={name:Dt.name,type:"ElevationLine",elevationData:Dt.elevationData,minElevation:Dt.minElevation,maxElevation:Dt.maxElevation,elevationGain:Dt.elevationGain,elevationLoss:Dt.elevationLoss,averageSlope:Dt.averageSlope,maxSlope:Dt.maxSlope},Pn.name=Dt.name),Dt.elevationData&&(Pn.elevationData=Dt.elevationData)}break}case"CircleWithSections":{const Dt=mn.data;if(Dt.center&&Dt.radius){const xr=vt.latLng(Dt.center[1],Dt.center[0]);Pn=new eh(xr,{...Dt.style,radius:Dt.radius}),Dt.sections&&Dt.sections.forEach(lr=>{Pn.addSection(lr)}),Dt.name&&(Pn.properties={name:Dt.name},Pn.name=Dt.name)}break}}Pn&&(Pn._dbId=mn.id,(Gn=b.value)==null||Gn.addLayer(Pn),o.value.push({id:mn.id,type:mn.type_forme,layer:Pn,properties:Pn.properties}))},"MapView")})),await new Promise(mn=>setTimeout(mn,0))}});await Promise.all(Bn),St.measure("refreshMapWithPlan:adjustView",()=>{R()},"MapView")},"MapView"),console.log(`Plan ${wt} chargé avec succès avec ${i.getCurrentElements.length} formes`)):console.error(`Plan ${wt} introuvable après chargement`),Se.value=!1}catch(He){throw console.error("Erreur lors du rafraîchissement de la carte:",He),He}},"MapView")}async function Z(wt){return await St.measureAsync("loadPlan",async()=>{var He;console.log(`
[MapView][loadPlan] ====== DÉBUT CHARGEMENT PLAN ======`),console.log("[MapView][loadPlan] Tentative de chargement du plan:",wt);try{const Kt=await St.measureAsync("loadPlan:getPlanFromStore",async()=>r.getPlanById(wt),"MapView");if(console.log("[MapView][loadPlan] Plan trouvé dans le store:",!!Kt),!Kt){console.log("[MapView][loadPlan] Plan non trouvé dans le store, vérification API...");try{await St.measureAsync("loadPlan:apiCheck",async()=>{await Xn.get(`/plans/${wt}/`)},"MapView")}catch(on){throw((He=on.response)==null?void 0:He.status)===404&&(console.warn("[MapView][loadPlan] Plan non trouvé - Nettoyage du localStorage"),localStorage.removeItem("lastPlanId"),De.value=null,r.clearCurrentPlan(),i.clearCurrentPlan(),Ee()),on}}console.log("[MapView][loadPlan] Rafraîchissement de la carte..."),await St.measureAsync("loadPlan:refreshMap",async()=>{await N(wt)},"MapView"),Se.value=!1,console.log("[MapView][loadPlan] Invalidation de la taille de la carte..."),Ie(),console.log("[MapView][loadPlan] Plan chargé avec succès:",{planId:wt,elementsCount:i.getCurrentElements.length})}catch(Kt){throw console.error("Erreur lors du chargement du plan:",Kt),St.measure("loadPlan:errorRecovery",()=>{De.value=null,r.clearCurrentPlan(),i.clearCurrentPlan(),Ee(),localStorage.removeItem("lastPlanId")},"MapView"),Kt}},"MapView")}async function he(){var wt;if(!De.value||!b.value){console.warn("Aucun plan actif ou groupe de formes à sauvegarder");return}Ye.value=!0,Ve.value="saving";try{const He=[],Kt=new Set(i.getCurrentElements.filter(et=>et.id!==void 0).map(et=>et.id)),on=new Set;console.log("[savePlan] Début de la sauvegarde",{featureGroupLayers:b.value.getLayers().length,existingIds:Array.from(Kt),currentElements:i.getCurrentElements}),b.value.eachLayer(et=>{var Pn,zr,Gn,Dt,xr,lr,hi,Ri,Fn,xi,Lr,Gr,Qn,kt,Ei,Ai,fi,ei,Di,Qi,Yn,Mi,Xs,Ps,Tr,Cn,di,Dr,si,mi,Es,is,pr,fo,ti,ki,Br,_n,Xt,Tn,In,Oi,es,ss,ps,tr;console.log("[savePlan] Traitement de la couche",{type:(Pn=et.properties)==null?void 0:Pn.type,name:(zr=et.properties)==null?void 0:zr.name,isPolygon:et instanceof vt.Polygon,isCircleArc:et instanceof wu,properties:et.properties});let On,Nn;const mn={color:et.options.color||"#3388ff",weight:et.options.weight||3,opacity:et.options.opacity||1,fillColor:et.options.fillColor||"#3388ff",fillOpacity:et.options.fillOpacity||.2,dashArray:et.options.dashArray||""};if(et instanceof yu){On="TextRectangle";const pn=et.getBounds();Nn={bounds:{southWest:[pn.getSouthWest().lng,pn.getSouthWest().lat],northEast:[pn.getNorthEast().lng,pn.getNorthEast().lat]},content:((Gn=et.properties)==null?void 0:Gn.text)||"",name:((xr=(Dt=et.properties)==null?void 0:Dt.style)==null?void 0:xr.name)||"",style:{...mn,textStyle:{color:((Ri=(hi=(lr=et.properties)==null?void 0:lr.style)==null?void 0:hi.textStyle)==null?void 0:Ri.color)||"#000000",fontSize:((Lr=(xi=(Fn=et.properties)==null?void 0:Fn.style)==null?void 0:xi.textStyle)==null?void 0:Lr.fontSize)||"14px",fontFamily:((kt=(Qn=(Gr=et.properties)==null?void 0:Gr.style)==null?void 0:Qn.textStyle)==null?void 0:kt.fontFamily)||"Arial, sans-serif",textAlign:((fi=(Ai=(Ei=et.properties)==null?void 0:Ei.style)==null?void 0:Ai.textStyle)==null?void 0:fi.textAlign)||"center",backgroundColor:((Qi=(Di=(ei=et.properties)==null?void 0:ei.style)==null?void 0:Di.textStyle)==null?void 0:Qi.backgroundColor)||"#FFFFFF",backgroundOpacity:((Xs=(Mi=(Yn=et.properties)==null?void 0:Yn.style)==null?void 0:Mi.textStyle)==null?void 0:Xs.backgroundOpacity)??1,bold:((Cn=(Tr=(Ps=et.properties)==null?void 0:Ps.style)==null?void 0:Tr.textStyle)==null?void 0:Cn.bold)||!1,italic:((si=(Dr=(di=et.properties)==null?void 0:di.style)==null?void 0:Dr.textStyle)==null?void 0:si.italic)||!1}},rotation:((mi=et.properties)==null?void 0:mi.rotation)||0}}else if(et instanceof $o){On="Rectangle";const pn=et.getBounds();Nn={bounds:{southWest:[pn.getSouthWest().lng,pn.getSouthWest().lat],northEast:[pn.getNorthEast().lng,pn.getNorthEast().lat]},style:mn,name:((Es=et.properties)==null?void 0:Es.name)||"",rotation:et.getRotation(),width:et.getDimensions().width,height:et.getDimensions().height,center:[et.getCenter().lng,et.getCenter().lat]}}else if(et instanceof wu||((is=et.properties)==null?void 0:is.type)==="Semicircle"){On="Semicircle";let pn;typeof et.getLatLng=="function"?pn=et.getLatLng():et.getCenter&&typeof et.getCenter=="function"?pn=et.getCenter():et._latlng?pn=et._latlng:pn={lat:0,lng:0};const pi=et.getRadius?et.getRadius():0,$r=((pr=et.properties)==null?void 0:pr.startAngle)||0,oi=((fo=et.properties)==null?void 0:fo.stopAngle)||180;Nn={center:[pn.lng,pn.lat],radius:pi,startAngle:$r,endAngle:oi,name:((ti=et.properties)==null?void 0:ti.name)||"",style:mn}}else if(et instanceof eh||((ki=et.properties)==null?void 0:ki.type)==="CircleWithSections"){On="CircleWithSections";const pn=et.getLatLng(),pi=et.getRadius(),$r=et.getSections();Nn={center:[pn.lng,pn.lat],radius:pi,name:((Br=et.properties)==null?void 0:Br.name)||"",style:mn,sections:$r}}else if(et instanceof vt.Circle)On="Circle",Nn={center:[et.getLatLng().lng,et.getLatLng().lat],radius:et.getRadius(),name:((_n=et.properties)==null?void 0:_n.name)||"",style:mn};else if(et instanceof vt.Rectangle){On="Rectangle";const pn=et.getBounds();Nn={bounds:{southWest:[pn.getSouthWest().lng,pn.getSouthWest().lat],northEast:[pn.getNorthEast().lng,pn.getNorthEast().lat]},name:((Xt=et.properties)==null?void 0:Xt.name)||"",style:mn}}else et instanceof vt.Polyline&&!(et instanceof vt.Polygon)?((Tn=et.properties)==null?void 0:Tn.type)==="ElevationLine"?(On="ElevationLine",Nn={points:et.getLatLngs().map(pi=>[pi.lng,pi.lat]),style:{...mn,color:((In=et.properties.style)==null?void 0:In.color)||"#FF4500",weight:((Oi=et.properties.style)==null?void 0:Oi.weight)||4,opacity:((es=et.properties.style)==null?void 0:es.opacity)||.8},name:((ss=et.properties)==null?void 0:ss.name)||"",elevationData:et.properties.elevationData,samplePointStyle:et.properties.samplePointStyle,minMaxPointStyle:et.properties.minMaxPointStyle,minElevation:et.properties.minElevation,maxElevation:et.properties.maxElevation,elevationGain:et.properties.elevationGain,elevationLoss:et.properties.elevationLoss,averageSlope:et.properties.averageSlope,maxSlope:et.properties.maxSlope}):(On="Line",Nn={points:et.getLatLngs().map(pi=>[pi.lng,pi.lat]),name:((ps=et.properties)==null?void 0:ps.name)||"",style:mn}):et instanceof vt.Polygon&&!(et instanceof vt.Rectangle)&&(On="Polygon",Nn={points:et.getLatLngs()[0].map(pi=>[pi.lng,pi.lat]),name:((tr=et.properties)==null?void 0:tr.name)||"",style:mn});if(On&&Nn){let pn=et._elementId;et._dbId&&(pn=et._dbId,typeof pn=="number"&&on.add(pn)),He.push({id:pn,type_forme:On,data:Nn})}}),console.log("[savePlan] Éléments à sauvegarder",{totalElements:He.length,elements:He.map(et=>({type:et.type_forme,hasPoints:"points"in et.data,hasStyle:"style"in et.data}))});const Bn=Array.from(Kt).filter(et=>!on.has(et));i.elements=He;const kn=await i.saveToPlan(De.value.id,{elementsToDelete:Bn});if(kn&&((wt=De.value)!=null&&wt.id)){const et=De.value.id;De.value={...De.value,...kn},r.updatePlanDetails(et,kn)}Ve.value="success",setTimeout(()=>{Ve.value=null},3e3)}catch(He){console.error("Erreur lors de la sauvegarde du plan:",He),Ve.value=null}finally{Ye.value=!1}}Kh(()=>{O.user||oe(),r.clearCurrentPlan(),i.clearCurrentPlan()});function ne(wt){E(wt)}function te(wt){try{const He=new Date(wt);return isNaN(He.getTime())?(console.error("Date invalide reçue:",wt),"Date invalide"):new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Paris"}).format(He)}catch(He){return console.error("Erreur lors du formatage de la date:",He),"Date invalide"}}const ee=()=>{b.value&&R()},se=()=>{h.value&&b.value&&(_(""),b.value.removeLayer(h.value),h.value=null)};async function Pe(wt){console.log(`onPlanCreated - Tentative de chargement du plan ${wt}`),await r.fetchPlans();const He=r.getPlanById(wt);He?(console.log(`Plan ${wt} trouvé, chargement en cours...`),localStorage.setItem("lastPlanId",wt.toString()),De.value=He,r.setCurrentPlan(He),i.setCurrentPlan(He.id),ge.value=!1,Ie(),console.log(`Plan ${wt} chargé avec succès`)):console.error(`Plan ${wt} introuvable après création! Vérifiez les permissions.`)}Co(D,async wt=>{var He;if(wt&&((He=O.user)==null?void 0:He.user_type)==="admin"){G.value=!0;try{const Kt=await O.fetchSalarieVisiteurs(wt.id);ce.value=Array.isArray(Kt)?Kt:[Kt]}catch(Kt){console.error("[MapView][watch selectedSalarie] Error:",Kt),ce.value=[]}finally{G.value=!1}}});function oe(){localStorage.removeItem("lastPlanId")}function re(wt,He="m"){return He==="m²"?`${(wt/1e4).toFixed(2)} ha`:He==="m"?wt>=1e3?`${(wt/1e3).toFixed(2)} km`:`${wt.toFixed(2)} m`:`${wt.toFixed(2)} ${He}`}const xe=un(!1);function ye(wt){return{Circle:"Cercle",Rectangle:"Rectangle",Semicircle:"Demi-cercle",Line:"Ligne",Polygon:"Polygone",TextRectangle:"Annotation",ElevationLine:"Profil altimétrique"}[wt]||wt}async function le(){var He,Kt,on,Bn,kn,et,On,Nn,mn,Pn;if(!De.value||!g.value||!b.value){console.error("[generateSynthesis] Plan, map ou featureGroup manquant");return}const wt=De.value;try{console.log("[generateSynthesis] Début de la génération"),console.log("[generateSynthesis] Plan courant complet:",wt),await he();let xi=wt;if(!wt.salarie_details&&!wt.entreprise_details&&!wt.client_details){console.log("[generateSynthesis] Détails manquants, tentative de récupération...");try{const Yn=await Xn.get(`/plans/${wt.id}/`);Yn.status===200&&(console.log("[generateSynthesis] Plan mis à jour:",Yn.data),De.value={...wt,...Yn.data},xi=Yn.data,r.updatePlanDetails(wt.id,Yn.data))}catch(Yn){console.error("[generateSynthesis] Erreur lors de la récupération des détails:",Yn)}}await new Promise(Yn=>setTimeout(Yn,1e3)),xe.value=!0;const Lr=xi.salarie_details,Gr=xi.client_details,Qn=(Lr==null?void 0:Lr.entreprise_details)||xi.entreprise_details;console.log("[generateSynthesis] Détails du plan utilisé:",xi),console.log("[generateSynthesis] Détails des utilisateurs:",{salarie:Lr?{id:Lr.id,nom:`${Lr.first_name} ${Lr.last_name}`,company:Lr.company_name,logo:Lr.logo}:null,entreprise:Qn?{id:Qn.id,nom:`${Qn.first_name} ${Qn.last_name}`,company:Qn.company_name,logo:Qn.logo}:null,client:Gr?{id:Gr.id,nom:`${Gr.first_name} ${Gr.last_name}`,company:Gr.company_name}:null}),h.value&&($(),h.value=null);const kt=new fr("l","mm","a4");console.log("[generateSynthesis] Chargement du logo de l'application");const Ei=new Image;Ei.src=Eg,await new Promise(Yn=>{Ei.onload=()=>{console.log("[generateSynthesis] Logo application chargé"),Yn()},Ei.onerror=Mi=>{console.error("[generateSynthesis] Erreur chargement logo application:",Mi),Yn()}}),console.log("[generateSynthesis] Tentative de chargement du logo entreprise:",Qn==null?void 0:Qn.logo);let Ai=null;Qn!=null&&Qn.logo&&(Ai=new Image,Ai.src=Qn.logo,await new Promise(Yn=>{Ai?(Ai.onload=()=>{console.log("[generateSynthesis] Logo entreprise chargé avec succès"),Yn()},Ai.onerror=Mi=>{console.error("[generateSynthesis] Erreur chargement logo entreprise:",Mi),Yn()}):Yn()})),console.log("[generateSynthesis] Tentative de chargement du logo salarie:",Lr==null?void 0:Lr.logo);let fi=null;Lr!=null&&Lr.logo&&(fi=new Image,fi.src=Lr.logo,await new Promise(Yn=>{fi?(fi.onload=()=>{console.log("[generateSynthesis] Logo salarie chargé avec succès"),Yn()},fi.onerror=Mi=>{console.error("[generateSynthesis] Erreur chargement logo salarie:",Mi),Yn()}):Yn()})),console.log("[generateSynthesis] Ajout des logos au PDF:",{logoApplication:!0,logoEntreprise:Ai!==null,logoSalarie:fi!==null}),Ai!==null&&kt.addImage(Ai,"JPEG",148.5-40-30,20,40,40),kt.addImage(Ei,"JPEG",148.5-40/2,20,40,40),fi!==null&&kt.addImage(fi,"JPEG",148.5+30,20,40,40),kt.setFontSize(24),kt.setTextColor(0),kt.text(wt.nom||"Sans titre",297/2,100,{align:"center"});let ei=120;if(Qn&&(kt.setFontSize(14),kt.setFont("helvetica","bold"),kt.text("Entreprise:",20,ei),kt.setFont("helvetica","normal"),kt.text(`${Qn.first_name} ${Qn.last_name}${Qn.company_name?` (${Qn.company_name})`:""}`,20,ei+6),ei+=15),Lr&&(kt.setFontSize(14),kt.setFont("helvetica","bold"),kt.text("Salarie:",20,ei),kt.setFont("helvetica","normal"),kt.text(`${Lr.first_name} ${Lr.last_name}${Lr.company_name?` (${Lr.company_name})`:""}`,20,ei+6),ei+=15),Gr&&(kt.setFontSize(14),kt.setFont("helvetica","bold"),kt.text("Client:",20,ei),kt.setFont("helvetica","normal"),kt.text(`${Gr.first_name} ${Gr.last_name}${Gr.company_name?` (${Gr.company_name})`:""}`,20,ei+6),ei+=15),wt.description){kt.setFont("helvetica","bold"),kt.text("Description:",20,ei),kt.setFont("helvetica","normal");const Yn=kt.splitTextToSize(wt.description,150);kt.text(Yn,20,ei+6),ei+=8*Yn.length+10}ei=Math.min(ei,180),kt.setFontSize(10),kt.setTextColor(100),kt.text(`Date de création: ${te(wt.date_creation)}`,20,190),kt.text(`Dernière modification: ${te(wt.date_modification)}`,277,190,{align:"right"});const Di=[];b.value.eachLayer(Yn=>Di.push(Yn));const Qi=vt.simpleMapScreenshoter({hideElementsWithSelectors:[".leaflet-control-container",".leaflet-pm-toolbar",".leaflet-grid-layer",".leaflet-grid-label"],preventDownload:!0}).addTo(g.value);await new Promise(Yn=>setTimeout(Yn,3e3));for(let Yn=0;Yn<Di.length;Yn++){kt.addPage(),kt.setFillColor(248,250,252),kt.setDrawColor(226,232,240),kt.rect(0,0,297,25,"F"),kt.setFontSize(10),kt.setTextColor(50,50,50),kt.setFont("helvetica","bold"),kt.text(wt.nom||"Sans titre",20,12);let Ps=297-20-(15*(1+(Ai!==null?1:0)+(fi!==null?1:0))+5*(1+(Ai!==null?1:0)));Ai!==null&&(kt.addImage(Ai,"JPEG",Ps,5,15,15),Ps+=20),kt.addImage(Ei,"JPEG",Ps,5,15,15),Ps+=20,fi!==null&&kt.addImage(fi,"JPEG",Ps,5,15,15),kt.setDrawColor(200,200,200),kt.setLineWidth(.5),kt.line(0,25,297,25);const Tr=Di[Yn],Cn=Tr.properties;if(Cn){kt.setTextColor(0),kt.setFontSize(14),kt.setFont("helvetica","bold");const di=Cn.name||ye(Cn.type);let Dr="";if(Cn.type!=="TextRectangle"){const mi=Q(Di,Tr);Dr=mi>0?` (surface totale d'irrigation : ${re(mi,"m²")})`:""}const si=`${di}${Dr}`;kt.text(si,20,35)}if(Cn&&Cn.type==="ElevationLine")try{const di=((He=Tr.getBounds)==null?void 0:He.call(Tr))||((Kt=Tr.getLatLng)==null?void 0:Kt.call(Tr));di&&g.value.fitBounds(di instanceof vt.LatLng?vt.latLngBounds([di]):di,{padding:[50,50]});try{const _n=((on=Tr.getBounds)==null?void 0:on.call(Tr))||((Bn=Tr.getLatLng)==null?void 0:Bn.call(Tr));if(!_n||!g.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const Xt=_n instanceof vt.LatLng?vt.latLngBounds([_n]):_n;Xt&&Xt.isValid&&Xt.isValid()&&g.value.getContainer()&&document.body.contains(g.value.getContainer())&&g.value.fitBounds(Xt,{padding:[50,50],animate:!1})}}catch(_n){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",_n)}await new Promise(_n=>setTimeout(_n,2e3)),g.value.invalidateSize();try{g.value&&g.value.getContainer()&&document.body.contains(g.value.getContainer())?g.value.invalidateSize({animate:!1}):console.warn("[generateSynthesis] Carte non valide pour l'invalidation de taille")}catch(_n){console.warn("[generateSynthesis] Erreur lors de l'invalidation de la taille de la carte:",_n)}await new Promise(_n=>{const Xt=()=>{var es;const Tn=(es=g.value)==null?void 0:es.getContainer();if(!Tn){_n();return}const In=Tn.querySelectorAll(".leaflet-tile-loaded");Tn.querySelectorAll(".leaflet-tile-loading").length===0&&In.length>0?_n():setTimeout(Xt,100)};Xt()});const Dr=await Qi.takeScreen("image"),si=await new Promise((_n,Xt)=>{const Tn=new Image;Tn.onload=()=>_n(Tn),Tn.onerror=In=>Xt(In),Tn.src=Dr}),mi=40,Es=237/2,is=Math.min(70,si.height*Es/si.width);if(kt.addImage(si,"PNG",20,mi,Es,is),Cn.elevationData&&Cn.elevationData.length>0){const _n=document.createElement("canvas");_n.width=800,_n.height=400;const Xt=_n.getContext("2d");if(Xt){const Tn=Cn.elevationData,In=Cn.minElevation,Oi=Cn.maxElevation,ss=(Oi-In)*.05,ps=In-ss,tr=Oi+ss,pn=40,pi=_n.width-2*pn,$r=_n.height-2*pn,oi=jr=>pn+jr/Tn[Tn.length-1].distance*pi,Qs=jr=>pn+$r-(jr-ps)/(tr-ps)*$r;Xt.fillStyle="#f8fafc",Xt.fillRect(0,0,_n.width,_n.height),Xt.fillStyle="#334155",Xt.font="bold 20px Arial",Xt.textAlign="center",Xt.fillText("Profil altimétrique",_n.width/2,25),Xt.strokeStyle="#e2e8f0",Xt.lineWidth=1,Xt.beginPath(),Xt.moveTo(pn,pn),Xt.lineTo(pn,$r+pn),Xt.lineTo(pi+pn,$r+pn),Xt.strokeStyle="#94a3b8",Xt.stroke();const Ao=5;for(let jr=0;jr<=Ao;jr++){const lo=ps+jr/Ao*(tr-ps),Li=Qs(lo);Xt.beginPath(),Xt.strokeStyle="#e2e8f0",Xt.moveTo(pn,Li),Xt.lineTo(pi+pn,Li),Xt.stroke(),Xt.beginPath(),Xt.strokeStyle="#94a3b8",Xt.moveTo(pn-5,Li),Xt.lineTo(pn,Li),Xt.stroke(),Xt.fillStyle="#64748b",Xt.font="12px Arial",Xt.textAlign="right",Xt.fillText(`${Math.round(lo)}m`,pn-8,Li+4)}const oo=5,vi=Tn[Tn.length-1].distance;for(let jr=0;jr<=oo;jr++){const lo=jr/oo*vi,Li=oi(lo);Xt.beginPath(),Xt.strokeStyle="#e2e8f0",Xt.moveTo(Li,pn),Xt.lineTo(Li,$r+pn),Xt.stroke(),Xt.beginPath(),Xt.strokeStyle="#94a3b8",Xt.moveTo(Li,$r+pn),Xt.lineTo(Li,$r+pn+5),Xt.stroke(),Xt.fillStyle="#64748b",Xt.font="12px Arial",Xt.textAlign="center",Xt.fillText(`${Math.round(lo)}m`,Li,$r+pn+16)}const As=Xt.createLinearGradient(0,pn,0,$r+pn);As.addColorStop(0,"rgba(255, 69, 0, 0.8)"),As.addColorStop(1,"rgba(255, 69, 0, 0.2)"),Xt.beginPath(),Xt.moveTo(oi(Tn[0].distance),Qs(Tn[0].elevation)),Tn.forEach((jr,lo)=>{lo>0&&Xt.lineTo(oi(jr.distance),Qs(jr.elevation))}),Xt.strokeStyle="#FF4500",Xt.lineWidth=2,Xt.stroke(),Xt.lineTo(oi(Tn[Tn.length-1].distance),Qs(ps)),Xt.lineTo(oi(Tn[0].distance),Qs(ps)),Xt.closePath(),Xt.fillStyle=As,Xt.fill(),Tn.forEach(jr=>{Xt.beginPath(),Xt.arc(oi(jr.distance),Qs(jr.elevation),3,0,Math.PI*2),Xt.fillStyle="#FF4500",Xt.fill(),Xt.strokeStyle="white",Xt.lineWidth=1,Xt.stroke()});let ao=0,os=0;for(let jr=0;jr<Tn.length;jr++)Tn[jr].elevation===In&&(ao=jr),Tn[jr].elevation===Oi&&(os=jr);Xt.beginPath(),Xt.arc(oi(Tn[os].distance),Qs(Tn[os].elevation),6,0,Math.PI*2),Xt.fillStyle="#059669",Xt.fill(),Xt.strokeStyle="white",Xt.lineWidth=2,Xt.stroke(),Xt.beginPath(),Xt.arc(oi(Tn[ao].distance),Qs(Tn[ao].elevation),6,0,Math.PI*2),Xt.fillStyle="#DC2626",Xt.fill(),Xt.strokeStyle="white",Xt.lineWidth=2,Xt.stroke(),Xt.font="12px Arial",Xt.fillStyle="#059669",Xt.textAlign="left",Xt.fillText(`Point haut: ${re(Oi,"m")}`,pn,$r+pn+35),Xt.fillStyle="#DC2626",Xt.fillText(`Point bas: ${re(In,"m")}`,pn+200,$r+pn+35);const Ea=_n.toDataURL("image/png");kt.addImage(Ea,"PNG",20+Es+20,mi,Es,is)}}const pr=mi+is+15;kt.setFillColor(248,250,252),kt.setDrawColor(226,232,240),kt.roundedRect(20,pr,257,50,3,3,"FD"),kt.setFont("helvetica","bold"),kt.setFontSize(12),kt.setTextColor(51,65,85),kt.text("Caractéristiques",30,pr+10);const fo=[{label:"Distance totale",value:re(Cn.length||0)},{label:"Dénivelé positif",value:re(Cn.elevationGain||0,"m")},{label:"Dénivelé négatif",value:re(Cn.elevationLoss||0,"m")}],ti=[{label:"Pente moyenne",value:`${(Cn.averageSlope||0).toFixed(1)}%`},{label:"Pente maximale",value:`${(Cn.maxSlope||0).toFixed(1)}%`},{label:"Altitude min/max",value:`${re(Cn.minElevation||0,"m")} / ${re(Cn.maxElevation||0,"m")}`}];let ki=pr+20;kt.setFont("helvetica","normal"),kt.setFontSize(10),fo.forEach(_n=>{kt.setTextColor(100,116,139),kt.text(_n.label,30,ki),kt.setTextColor(15,23,42),kt.setFont("helvetica","bold"),kt.text(_n.value,110,ki),kt.setFont("helvetica","normal"),ki+=9}),ki=pr+20;const Br=297/2;ti.forEach(_n=>{kt.setTextColor(100,116,139),kt.text(_n.label,Br,ki),kt.setTextColor(15,23,42),kt.setFont("helvetica","bold"),kt.text(_n.value,Br+80,ki),kt.setFont("helvetica","normal"),ki+=9})}catch(di){console.error("[generateSynthesis] Erreur traitement profil altimétrique:",di)}else{const di=((kn=Tr.getBounds)==null?void 0:kn.call(Tr))||((et=Tr.getLatLng)==null?void 0:et.call(Tr));di&&g.value.fitBounds(di instanceof vt.LatLng?vt.latLngBounds([di]):di,{padding:[50,50]});try{const Dr=((On=Tr.getBounds)==null?void 0:On.call(Tr))||((Nn=Tr.getLatLng)==null?void 0:Nn.call(Tr));if(!Dr||!g.value)console.warn("[generateSynthesis] Bounds ou carte invalide");else{const si=Dr instanceof vt.LatLng?vt.latLngBounds([Dr]):Dr;si&&si.isValid&&si.isValid()&&g.value.getContainer()&&document.body.contains(g.value.getContainer())&&g.value.fitBounds(si,{padding:[50,50],animate:!1})}}catch(Dr){console.warn("[generateSynthesis] Erreur lors de l'ajustement de la vue:",Dr)}await new Promise(Dr=>setTimeout(Dr,2e3)),g.value.invalidateSize(),await new Promise(Dr=>{const si=()=>{var pr;const mi=(pr=g.value)==null?void 0:pr.getContainer();if(!mi){Dr();return}const Es=mi.querySelectorAll(".leaflet-tile-loaded");mi.querySelectorAll(".leaflet-tile-loading").length===0&&Es.length>0?Dr():setTimeout(si,100)};si()});try{const Dr=await Qi.takeScreen("image"),si=await new Promise((pr,fo)=>{const ti=new Image;ti.onload=()=>pr(ti),ti.onerror=ki=>fo(ki),ti.src=Dr}),mi=45,Es=297*.6-30;let is=si.height*Es/si.width;if(is>210*.9&&(is=210*.9),kt.addImage(si,"PNG",20,mi,Es,is),Cn){let pr=function(Xt,Tn,In,Oi,es){kt.setTextColor(100,116,139),kt.setFont("helvetica","normal"),kt.text(Xt,In+10,Oi),kt.setTextColor(15,23,42),kt.setFont("helvetica","bold"),kt.text(Tn,In+es-10,Oi,{align:"right"})},ti=0;if(Cn.type==="Circle")ti=4;else if(Cn.type==="Rectangle")ti=4;else if(Cn.type==="Line")ti=1,(mn=Cn.dimensions)!=null&&mn.width&&ti++,Cn.surfaceInfluence&&ti++;else if(Cn.type==="Semicircle")ti=6;else if(Cn.type==="Polygon")ti=2;else if(Cn.type==="CircleWithSections"&&(ti=3,Cn.sections&&Cn.sections.length>0)){const Xt=Math.ceil(Cn.sections.length/3);ti+=Xt*3}const ki=Math.max(15+ti*12+30,60),Br=297-188.2-20;kt.setFillColor(248,250,252),kt.setDrawColor(226,232,240),kt.roundedRect(188.2,mi,Br,ki,3,3,"FD"),kt.setFont("helvetica","bold"),kt.setFontSize(12),kt.setTextColor(51,65,85),kt.text("Caractéristiques",188.2+10,mi+15);let _n=mi+30;kt.setFontSize(10),Cn.type==="Circle"?(pr("Rayon",re(Cn.radius),188.2,_n,Br),_n+=12,pr("Diamètre",re(Cn.radius*2),188.2,_n,Br),_n+=12,pr("Surface",re(Cn.surface,"m²"),188.2,_n,Br),_n+=12,pr("Périmètre",re(Cn.perimeter),188.2,_n,Br)):Cn.type==="Rectangle"?(pr("Largeur",re(Cn.width),188.2,_n,Br),_n+=12,pr("Hauteur",re(Cn.height),188.2,_n,Br),_n+=12,pr("Surface",re(Cn.surface,"m²"),188.2,_n,Br),_n+=12,pr("Périmètre",re(Cn.perimeter),188.2,_n,Br)):Cn.type==="Line"?(pr("Longueur",re(Cn.length),188.2,_n,Br),_n+=12,(Pn=Cn.dimensions)!=null&&Pn.width&&(pr("Largeur d'influence",re(Cn.dimensions.width),188.2,_n,Br),_n+=12),Cn.surfaceInfluence&&pr("Surface d'influence",re(Cn.surfaceInfluence,"m²"),188.2,_n,Br)):Cn.type==="Semicircle"?(pr("Rayon",re(Cn.radius),188.2,_n,Br),_n+=12,pr("Diamètre",re(Cn.radius*2),188.2,_n,Br),_n+=12,pr("Surface",re(Cn.surface,"m²"),188.2,_n,Br),_n+=12,pr("Périmètre",re(Cn.perimeter),188.2,_n,Br),_n+=12,pr("Longueur d'arc",re(Cn.arcLength),188.2,_n,Br),_n+=12,pr("Angle d'ouverture",`${Cn.openingAngle.toFixed(1)}°`,188.2,_n,Br)):Cn.type==="Polygon"?(pr("Surface",re(Cn.surface,"m²"),188.2,_n,Br),_n+=12,pr("Périmètre",re(Cn.perimeter),188.2,_n,Br)):Cn.type==="CircleWithSections"&&(pr("Rayon",re(Cn.radius),188.2,_n,Br),_n+=12,pr("Surface totale",re(Cn.surface,"m²"),188.2,_n,Br),_n+=12,pr("Périmètre",re(Cn.perimeter),188.2,_n,Br),_n+=20,Cn.sections&&Cn.sections.length>0&&(_n=Zt(Cn.sections,kt,188.2,_n,Br)))}}catch(Dr){console.error(`[generateSynthesis] Erreur capture forme ${Yn+1}:`,Dr)}}}g.value.removeControl(Qi),kt.save(`synthese_${wt.nom}.pdf`)}catch(zr){console.error("[generateSynthesis] Erreur:",zr),alert("Une erreur est survenue lors de la génération de la synthèse. Veuillez réessayer.")}finally{xe.value=!1}}const Ue=wb.debounce(()=>{const wt=St.startMeasure("invalidateMapSize","MapView");if(!g.value){wt();return}Ds(()=>{St.measure("invalidateMapSize:nextTick",()=>{var He;try{if(g.value&&g.value.getContainer()&&document.body.contains(g.value.getContainer())){if(g.value.invalidateSize({animate:!1}),(He=b.value)!=null&&He.getLayers().length)try{R()}catch(Kt){console.warn("[invalidateMapSize] Erreur lors de l'ajustement de la vue:",Kt)}}else console.warn("[invalidateMapSize] Carte non valide pour l'invalidation")}catch(Kt){console.warn("[invalidateMapSize] Erreur lors de l'invalidation de la taille de la carte:",Kt)}wt()},"MapView")})},250);function Ie(){Ue()}Co(De,(wt,He)=>{wt&&wt.id!==(He==null?void 0:He.id)&&Ds(()=>{Ie()})});const Ce=un(null),qe=un(!1),Re=un([]),rt=Rr(()=>{if(console.log("[MapView][filteredSalaries] Computing with:",{selectedEntreprise:Ce.value,salaries:K.value,salariesLength:K.value.length}),!Ce.value)return[];const wt=K.value.filter(He=>{var Bn,kn,et;const Kt=He.entreprise,on=typeof Kt=="object"&&Kt!==null?Kt.id:Kt;return console.log("[MapView][filteredSalaries] Checking salarie:",{salarie:He,salarieEntreprise:Kt,salarieEntrepriseId:on,selectedEntrepriseId:(Bn=Ce.value)==null?void 0:Bn.id,matches:on===((kn=Ce.value)==null?void 0:kn.id)}),on===((et=Ce.value)==null?void 0:et.id)});return console.log("[MapView][filteredSalaries] Filtered result:",wt),wt});function Ze(wt){if(!wt)return"";const He=wt.first_name||"",Kt=wt.last_name?wt.last_name.toUpperCase():"",on=wt.company_name||wt.role||"";return`${He} ${Kt} (${on})`}async function gt(){qe.value=!0;try{const wt=await Xn.get("/users/",{params:{role:"ENTREPRISE"}});Re.value=wt.data}catch(wt){console.error("[MapView] Error loading entreprises:",wt),Re.value=[]}finally{qe.value=!1}}async function _t(wt){console.log("[MapView][selectEntreprise] Sélection de l'entreprise:",wt),Ce.value=wt,U.value=!0;try{console.log("[MapView][selectEntreprise] Envoi de la requête avec params:",{role:"SALARIE",entreprise:wt.id});const He=await Xn.get("/users/",{params:{role:"SALARIE",entreprise:wt.id}});console.log("[MapView][selectEntreprise] Réponse reçue:",He.data),K.value=He.data,console.log("[MapView][selectEntreprise] Salaries mis à jour:",K.value)}catch(He){console.error("[MapView] Error loading salaries for entreprise:",He),K.value=[]}finally{U.value=!1}}function $t(){Ce.value=null,D.value=null,z.value=null,K.value=[],ce.value=[],H.value=[]}function tn(){D.value=null,z.value=null,ce.value=[],H.value=[]}function Qe(){z.value=null,H.value=[]}async function Yt(wt){var He,Kt,on,Bn,kn,et;console.log(`
[MapView][selectSalarie] ====== DÉBUT SÉLECTION SALARIE ======`),console.log("Informations du salarie:",{id:wt.id,username:wt.username,company:wt.company_name,role:wt.role}),console.log("Contexte utilisateur:",{userType:(He=O.user)==null?void 0:He.user_type,userId:(Kt=O.user)==null?void 0:Kt.id,userRole:(on=O.user)==null?void 0:on.role,selectedEntrepriseId:(Bn=Ce.value)==null?void 0:Bn.id}),D.value=wt,G.value=!0;try{const On={role:"VISITEUR",salarie:wt.id};O.isEntreprise?(console.log("Ajout de l'ID de l'entreprise connectée:",(kn=O.user)==null?void 0:kn.id),On.entreprise=(et=O.user)==null?void 0:et.id):Ce.value&&(console.log("Ajout de l'ID de l'entreprise sélectionnée:",Ce.value.id),On.entreprise=Ce.value.id),console.log("Paramètres de la requête:",On);const Nn=await Xn.get("/users/",{params:On});console.log("Réponse reçue du serveur:",{status:Nn.status,dataLength:Array.isArray(Nn.data)?Nn.data.length:"non-array",data:Nn.data}),Array.isArray(Nn.data)?(ce.value=Nn.data,console.log(`${Nn.data.length} visiteurs chargés`),Nn.data.forEach((mn,Pn)=>{console.log(`Visiteur ${Pn+1}:`,{id:mn.id,username:mn.username,company:mn.company_name,salarie:mn.salarie})})):(console.warn("Format de réponse inattendu:",Nn.data),ce.value=[]),ce.value.length===0&&console.warn("Aucun visiteur trouvé pour ce salarie")}catch(On){if(console.error("ERREUR lors du chargement des visiteurs:",On),On&&typeof On=="object"&&"response"in On){const Nn=On;console.error("Détails de l'erreur:",{status:Nn.response.status,data:Nn.response.data})}ce.value=[]}finally{G.value=!1,console.log(`[MapView][selectSalarie] ====== FIN SÉLECTION SALARIE ======
`)}}async function Qt(wt){var He;z.value=wt,ue.value=!0;try{const Kt={visiteur:wt.id};O.isEntreprise?Kt.entreprise=(He=O.user)==null?void 0:He.id:Ce.value&&(Kt.entreprise=Ce.value.id),D.value&&(Kt.salarie=D.value.id);const on=await Xn.get("/plans/",{params:Kt});H.value=on.data}catch(Kt){console.error("[MapView] Error loading client plans:",Kt),H.value=[]}finally{ue.value=!1}}function Zt(wt,He,Kt,on,Bn){if(!wt||wt.length===0)return on;const kn=[...wt].sort((Dt,xr)=>(xr.surface||0)-(Dt.surface||0)),et=Bn,On=7,Nn=6,mn=2,Pn=[{header:"Nom",width:.3,align:"left"},{header:"Surface",width:.2,align:"right"},{header:"Angles",width:.25,align:"right"},{header:"Rayon",width:.15,align:"right"},{header:"Type",width:.1,align:"center"}],zr=On+Nn*kn.length;He.setFillColor(248,250,252),He.setDrawColor(226,232,240),He.roundedRect(Kt,on,et,zr+mn*2,2,2,"FD"),He.setFillColor(241,245,249),He.rect(Kt+mn,on+mn,et-mn*2,On,"F"),He.setFont("helvetica","bold"),He.setFontSize(7),He.setTextColor(51,65,85);let Gn=Kt+mn;return Pn.forEach(Dt=>{const xr=Dt.width*(et-mn*2);Dt.align==="right"?He.text(Dt.header,Gn+xr-mn,on+mn+5,{align:"right"}):Dt.align==="center"?He.text(Dt.header,Gn+xr/2,on+mn+5,{align:"center"}):He.text(Dt.header,Gn+mn/2,on+mn+5),Gn+=xr}),He.setFont("helvetica","normal"),He.setFontSize(6.5),He.setTextColor(71,85,105),kn.forEach((Dt,xr)=>{const lr=on+On+mn+xr*Nn;xr%2===0&&(He.setFillColor(250,252,254),He.rect(Kt+mn,lr,et-mn*2,Nn,"F"));let hi=Kt+mn;const Ri=Dt.name||`Section ${xr+1}`;He.text(Ri,hi+mn/2,lr+4),hi+=Pn[0].width*(et-mn*2);const Fn=re(Dt.surface||0,"m²");He.text(Fn,hi+Pn[1].width*(et-mn*2)-mn,lr+4,{align:"right"}),hi+=Pn[1].width*(et-mn*2);const xi=Dt.startAngle===0&&Dt.endAngle===360?"Complet":`${Dt.startAngle}°-${Dt.endAngle}°`;He.text(xi,hi+Pn[2].width*(et-mn*2)-mn,lr+4,{align:"right"}),hi+=Pn[2].width*(et-mn*2);const Lr=re(Dt.radius||0);He.text(Lr,hi+Pn[3].width*(et-mn*2)-mn,lr+4,{align:"right"}),hi+=Pn[3].width*(et-mn*2);const Gr=Dt.startAngle===0&&Dt.endAngle===360?"C":"P";He.text(Gr,hi+Pn[4].width*(et-mn*2)/2,lr+4,{align:"center"})}),He.setDrawColor(226,232,240),He.setLineWidth(.05),He.line(Kt+mn,on+On+mn,Kt+et-mn,on+On+mn),on+zr+mn*2}return(wt,He)=>{var Kt,on,Bn,kn;return Xe(),tt("div",AN,[M("div",MN,[xe.value?(Xe(),tt("div",kN,He[8]||(He[8]=[wc('<div class="bg-white/90 rounded-2xl p-8 max-w-md shadow-2xl border border-gray-100"><div class="flex flex-col items-center"><div class="relative w-24 h-24 mb-6"><div class="absolute inset-0 border-4 border-primary-200 rounded-full"></div><div class="absolute inset-0 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div><div class="absolute inset-2 border-2 border-primary-400/30 rounded-full animate-pulse"></div><div class="absolute inset-0 flex items-center justify-center"><svg class="w-8 h-8 text-primary-600 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div><h3 class="text-xl font-semibold text-gray-900 mb-2"> Génération de la synthèse </h3><div class="space-y-2 text-center"><p class="text-primary-600 font-medium"> Capture des formes en cours... </p><p class="text-sm text-gray-500"> Nous optimisons la qualité de vos captures pour un rendu parfait </p></div></div></div>',1)]))):yn("",!0),De.value?yn("",!0):(Xe(),tt("div",TN,[M("div",BN,[He[11]||(He[11]=wc('<div class="relative w-48 h-48 mx-auto mb-12 rounded-full bg-gradient-to-br from-primary-100 to-primary-50 p-8 shadow-lg ring-4 ring-white"><img src="'+Eg+'" alt="TagMap Logo" class="w-full h-full object-contain filter drop-shadow-md"><div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent to-white/10 pointer-events-none"></div></div><h1 class="text-3xl font-bold text-gray-900 mb-4">Bienvenue sur TagMap</h1><p class="text-gray-600 mb-8">Pour commencer à dessiner, vous devez d&#39;abord créer un nouveau plan ou charger un plan existant.</p>',3)),M("div",NN,[M("button",{onClick:He[0]||(He[0]=et=>ge.value=!0),class:"w-full flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},He[9]||(He[9]=[M("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ni(" Créer un nouveau plan ")])),M("button",{onClick:He[1]||(He[1]=et=>Se.value=!0),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors duration-200"},He[10]||(He[10]=[M("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Ni(" Charger un plan existant ")]))])])])),Dn(M("div",RN,[(Xe(),Cu(P0,{to:"body"},[De.value&&!xe.value?(Xe(),tt("div",DN,[Xi(i7,{"last-save":(Kt=De.value)!=null&&Kt.date_modification?new Date(De.value.date_modification):void 0,"plan-name":(on=De.value)==null?void 0:on.nom,"plan-description":(Bn=De.value)==null?void 0:Bn.description,"save-status":Ve.value,onChangeMapType:Kn(W),onCreateNewPlan:He[2]||(He[2]=et=>ge.value=!0),onLoadPlan:He[3]||(He[3]=et=>Se.value=!0),onSavePlan:he,onAdjustView:ee,onGenerateSummary:le},null,8,["last-save","plan-name","plan-description","save-status","onChangeMapType"])])):yn("",!0)])),M("div",ON,[M("div",IN,[M("div",{ref_key:"mapContainer",ref:t,class:"absolute inset-0 z-[1000]"},null,512)]),De.value&&!xe.value?(Xe(),tt("div",FN,[Xi(SB,{"current-tool":Kn(l),"selected-shape":Me.value,"all-layers":((kn=Kn(b))==null?void 0:kn.getLayers())||[],onToolChange:Kn(_),onStyleUpdate:Kn(x),onPropertiesUpdate:ne,onDeleteShape:se},null,8,["current-tool","selected-shape","all-layers","onToolChange","onStyleUpdate"])])):yn("",!0)]),xe.value?(Xe(),tt("div",zN,He[12]||(He[12]=[wc('<div class="text-center"><div class="mb-4"><svg class="animate-spin h-10 w-10 mx-auto text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-lg font-medium text-gray-900">Génération de la synthèse en cours...</p><p class="text-sm text-gray-500 mt-2">Veuillez patienter pendant que nous analysons votre plan.</p></div>',1)]))):yn("",!0)],512),[[_f,De.value]]),(Xe(),Cu(P0,{to:"body"},[Xi(Lb,{ref_key:"newPlanModalRef",ref:ie,modelValue:ge.value,"onUpdate:modelValue":He[4]||(He[4]=et=>ge.value=et),onCreated:Pe,onSalarieSelected:He[5]||(He[5]=et=>D.value=et),onVisiteurSelected:He[6]||(He[6]=et=>V.value=et)},null,8,["modelValue"])])),(Xe(),Cu(P0,{to:"body"},[Se.value?(Xe(),tt("div",jN,[M("div",UN,[M("div",$N,[He[14]||(He[14]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Charger un plan existant",-1)),M("button",{onClick:He[7]||(He[7]=et=>Se.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},He[13]||(He[13]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("div",qN,[Kn(O).isAdmin?(Xe(),tt("div",VN,[Ce.value?D.value?z.value?(Xe(),tt("div",lR,[M("div",uR,[M("button",{onClick:Qe,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},He[29]||(He[29]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ni(" Retour à la liste des clients ")])),He[30]||(He[30]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",cR,Ht(Ze(z.value)),1)]),He[32]||(He[32]=M("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),M("div",hR,[ue.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[31]||(He[31]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),M("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Xe(!0),tt(Un,{key:1},kr(H.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Z(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",dR,Ht(et.nom),1),M("div",pR,Ht(et.description),1),M("div",gR," Modifié le "+Ht(te(et.date_modification)),1)],8,fR))),128))])])):(Xe(),tt("div",tR,[M("div",nR,[M("button",{onClick:tn,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},He[23]||(He[23]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ni(" Retour à la liste des salaries ")])),He[24]||(He[24]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",rR,Ht(Ze(D.value)),1)]),He[28]||(He[28]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),M("div",iR,[G.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[25]||(He[25]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Xe(),tt(Un,{key:1},[Ae.value.length===0?(Xe(),tt("div",sR,He[26]||(He[26]=[M("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),M("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):(Xe(!0),tt(Un,{key:1},kr(Ae.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Qt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",aR,Ht(Ze(et)),1)]),He[27]||(He[27]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,oR))),128))],64))])])):(Xe(),tt("div",KN,[M("div",JN,[M("button",{onClick:$t,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},He[18]||(He[18]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ni(" Retour à la liste des entreprises ")])),He[19]||(He[19]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",YN,Ht(Ze(Ce.value)),1)]),He[22]||(He[22]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un salarie",-1)),M("div",XN,[U.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[20]||(He[20]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Xe(!0),tt(Un,{key:1},kr(rt.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Yt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",eR,Ht(Ze(et)),1)]),He[21]||(He[21]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,QN))),128))])])):(Xe(),tt("div",GN,[He[17]||(He[17]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez une entreprise",-1)),M("div",HN,[qe.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[15]||(He[15]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Xe(!0),tt(Un,{key:1},kr(Re.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>_t(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",ZN,Ht(Ze(et)),1)]),He[16]||(He[16]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,WN))),128))])]))])):Kn(O).isSalarie?(Xe(),tt("div",mR,[z.value?(Xe(),tt("div",xR,[M("div",LR,[M("button",{onClick:Qe,class:"flex items-center text-sm text-gray-600 hover:text-gray-900"},He[37]||(He[37]=[M("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ni(" Retour à la liste des clients ")])),He[38]||(He[38]=M("span",{class:"mx-2 text-gray-400"},"|",-1)),M("span",SR,Ht(Ze(z.value)),1)]),He[40]||(He[40]=M("h3",{class:"font-medium text-gray-700"},"Plans disponibles",-1)),M("div",CR,[ue.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[39]||(He[39]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-2/3 mb-2"}),M("div",{class:"h-3 bg-gray-50 rounded w-1/3"})],-1)]))),64)):(Xe(!0),tt(Un,{key:1},kr(H.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Z(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",ER,Ht(et.nom),1),M("div",AR,Ht(et.description),1),M("div",MR," Modifié le "+Ht(te(et.date_modification)),1)],8,PR))),128))])])):(Xe(),tt("div",vR,[He[36]||(He[36]=M("h3",{class:"font-medium text-gray-700"},"Sélectionnez un visiteur",-1)),M("div",yR,[G.value?(Xe(),tt(Un,{key:0},kr(3,et=>M("div",{key:et,class:"animate-pulse"},He[33]||(He[33]=[M("div",{class:"p-3 bg-white rounded-lg border border-gray-200"},[M("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),M("div",{class:"h-4 bg-gray-100 rounded w-1/2"})],-1)]))),64)):(Xe(),tt(Un,{key:1},[Ae.value.length===0?(Xe(),tt("div",_R,He[34]||(He[34]=[M("div",{class:"text-gray-500 mb-2"},"Aucun visiteur trouvé pour ce salarie",-1),M("div",{class:"text-sm text-gray-400"}," Veuillez vérifier que des visiteurs ont été assignés à ce salarie ",-1)]))):(Xe(!0),tt(Un,{key:1},kr(Ae.value,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Qt(et),class:"flex items-center p-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",null,[M("div",wR,Ht(Ze(et)),1)]),He[35]||(He[35]=M("svg",{class:"w-5 h-5 ml-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,bR))),128))],64))])]))])):Kn(O).isEntreprise?(Xe(),tt("div",kR,Ht(Kn(O).isEntreprise?"...":""),1)):(Xe(),tt("div",TR,[Kn(r).plans.length===0?(Xe(),tt("div",BR,He[41]||(He[41]=[M("p",{class:"text-gray-500"},"Aucun plan disponible",-1)]))):(Xe(),tt("div",NR,[(Xe(!0),tt(Un,null,kr(Kn(r).plans,et=>(Xe(),tt("button",{key:et.id,onClick:On=>Z(et.id),class:"w-full px-4 py-3 text-left bg-white hover:bg-gray-50 rounded-lg border border-gray-200 transition-colors duration-200"},[M("div",DR,Ht(et.nom),1),M("div",OR,Ht(et.description),1),M("div",IR," Modifié le "+Ht(te(et.date_modification)),1)],8,RR))),128))]))]))])])])):yn("",!0)]))])])}}}),FR={class:"fixed inset-0 z-50 overflow-y-auto"},zR={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},jR={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},UR={class:"mt-3 text-center sm:mt-0 sm:text-left"},$R={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},qR={class:"mt-4"},VR={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},GR={class:"flex"},HR={class:"ml-3"},WR={class:"text-sm font-medium text-red-800"},ZR={key:0},KR={key:1},JR=["value"],YR={key:2},XR={key:3},QR=["value"],eD={class:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2"},tD={key:0,class:"mt-2 text-sm text-red-600"},nD={key:0,class:"mt-2 text-sm text-red-600"},rD={key:4},iD={key:5},sD={key:0,class:"mt-2 text-sm text-red-600"},oD={class:"flex justify-end space-x-3"},aD=["disabled"],lD={key:0,class:"mr-2"},uD=Pa({__name:"UserFormModal",props:{user:{type:Object,default:()=>({})},salaries:{type:Array,default:()=>[]},entreprises:{type:Array,default:()=>[]},isAdmin:{type:Boolean,default:!1},isEntreprise:{type:Boolean,default:!1},currentSalarie:{type:String,default:void 0},currentEntreprise:{type:String,default:void 0},apiErrors:{type:Array,default:()=>[]},refreshKey:{type:Number,default:0}},emits:["close","save","refresh"],setup(e,{emit:n}){const t=e,r=n,i=un(!1),o=un(""),l=un(""),h=un(""),g=un(""),v=un(""),_=Au({id:void 0,first_name:"",last_name:"",username:"",email:"",password:"",company_name:"",role:t.isEntreprise?"SALARIE":t.isAdmin?"ADMIN":"VISITEUR",salarie:null,entreprise:null,is_active:!0});Bl(()=>{var E;(E=t.user)!=null&&E.id?(_.id=t.user.id,_.first_name=t.user.first_name||"",_.last_name=t.user.last_name||"",_.username=t.user.username||"",_.email=t.user.email||"",_.company_name=t.user.company_name||"",_.role=t.user.role||"VISITEUR",_.is_active=t.user.is_active??!0,t.user.salarie?typeof t.user.salarie=="object"?_.salarie=t.user.salarie.id:_.salarie=t.user.salarie:t.user.salarie_id?_.salarie=t.user.salarie_id:t.currentSalarie&&(_.salarie=parseInt(t.currentSalarie)),t.user.entreprise?typeof t.user.entreprise=="object"?_.entreprise=t.user.entreprise.id:_.entreprise=t.user.entreprise:t.user.entreprise_id?_.entreprise=t.user.entreprise_id:t.currentEntreprise&&(_.entreprise=parseInt(t.currentEntreprise))):(t.currentSalarie&&(_.salarie=parseInt(t.currentSalarie)),t.currentEntreprise&&(_.entreprise=parseInt(t.currentEntreprise)),t.isEntreprise?_.role="SALARIE":t.isAdmin||(_.role="VISITEUR"))}),cg(()=>{_.role==="ADMIN"||_.role==="ENTREPRISE"?(_.salarie=null,_.entreprise=null):_.role==="SALARIE"&&(_.salarie=null,t.isEntreprise&&t.currentEntreprise&&(_.entreprise=parseInt(t.currentEntreprise)))}),cg(()=>{o.value="",l.value="",h.value="",g.value="",t.apiErrors&&t.apiErrors.length>0&&t.apiErrors.forEach(E=>{switch(E.field){case"email":o.value=E.message;break;case"username":l.value=E.message;break;case"password":h.value=E.message;break;case"non_field_error":default:g.value=E.message;break}})});async function x(){o.value="",l.value="",h.value="",g.value="";let E=!0;if(_.id||(_.password!==v.value?(h.value="Les mots de passe ne correspondent pas",E=!1):_.password.length<8&&(h.value="Le mot de passe doit contenir au moins 8 caractères",E=!1)),!!E){i.value=!0;try{const b={..._};_.id&&delete b.password,t.isEntreprise&&["SALARIE","VISITEUR"].includes(_.role)&&(b.entreprise_id=t.currentEntreprise?parseInt(t.currentEntreprise):void 0),b.salarie&&(b.salarie_id=b.salarie,delete b.salarie),t.currentSalarie&&_.role==="VISITEUR"&&(b.salarie_id=parseInt(t.currentSalarie)),await r("save",b),r("refresh")}catch(b){console.error("Erreur locale:",b)}finally{i.value=!1}}}return(E,b)=>(Xe(),tt("div",FR,[M("div",zR,[b[29]||(b[29]=M("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[M("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),b[30]||(b[30]=M("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),M("div",jR,[M("div",null,[M("div",UR,[M("h3",$R,Ht(e.user?"Modifier l'utilisateur":"Nouvel utilisateur"),1),M("div",qR,[g.value?(Xe(),tt("div",VR,[M("div",GR,[b[12]||(b[12]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",HR,[M("h3",WR,Ht(g.value),1)])])])):yn("",!0),M("form",{onSubmit:Tp(x,["prevent"]),class:"space-y-6"},[e.isAdmin?(Xe(),tt("div",ZR,[b[14]||(b[14]=M("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Dn(M("select",{id:"role","onUpdate:modelValue":b[0]||(b[0]=R=>_.role=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[13]||(b[13]=[M("option",{value:"ADMIN"},"Administrateur",-1),M("option",{value:"ENTREPRISE"},"Entreprise",-1),M("option",{value:"SALARIE"},"Salarie",-1),M("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[Hs,_.role]])])):yn("",!0),e.isAdmin&&_.role==="SALARIE"?(Xe(),tt("div",KR,[b[16]||(b[16]=M("label",{for:"entreprise",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Dn(M("select",{id:"entreprise","onUpdate:modelValue":b[1]||(b[1]=R=>_.entreprise=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[b[15]||(b[15]=M("option",{value:null},"-- Sélectionner une entreprise --",-1)),(Xe(!0),tt(Un,null,kr(e.entreprises,R=>(Xe(),tt("option",{key:R.id,value:R.id},Ht(R.first_name)+" "+Ht(R.last_name)+" ("+Ht(R.company_name||"Entreprise")+") ",9,JR))),128))],512),[[Hs,_.entreprise]])])):yn("",!0),e.isEntreprise&&!_.id?(Xe(),tt("div",YR,[b[18]||(b[18]=M("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Type d'utilisateur",-1)),Dn(M("select",{id:"role","onUpdate:modelValue":b[2]||(b[2]=R=>_.role=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},b[17]||(b[17]=[M("option",{value:"SALARIE"},"Salarie",-1),M("option",{value:"VISITEUR"},"Visiteur",-1)]),512),[[Hs,_.role]])])):yn("",!0),(e.isAdmin||e.isEntreprise)&&_.role==="VISITEUR"&&!e.currentSalarie?(Xe(),tt("div",XR,[b[20]||(b[20]=M("label",{for:"salarie",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Dn(M("select",{id:"salarie","onUpdate:modelValue":b[3]||(b[3]=R=>_.salarie=R),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:""},[b[19]||(b[19]=M("option",{value:null},"-- Sélectionner un salarie --",-1)),(Xe(!0),tt(Un,null,kr(e.salaries,R=>(Xe(),tt("option",{key:R.id,value:R.id},Ht(R.first_name)+" "+Ht(R.last_name)+" ("+Ht(R.company_name||"Salarie")+") ",9,QR))),128))],512),[[Hs,_.salarie]])])):yn("",!0),M("div",eD,[M("div",null,[b[21]||(b[21]=M("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),Dn(M("input",{type:"text",id:"first_name","onUpdate:modelValue":b[4]||(b[4]=R=>_.first_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.first_name]])]),M("div",null,[b[22]||(b[22]=M("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Nom",-1)),Dn(M("input",{type:"text",id:"last_name","onUpdate:modelValue":b[5]||(b[5]=R=>_.last_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.last_name]])])]),M("div",null,[b[23]||(b[23]=M("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),Dn(M("input",{type:"email",id:"email","onUpdate:modelValue":b[6]||(b[6]=R=>_.email=R),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.email]]),o.value?(Xe(),tt("div",tD,Ht(o.value),1)):yn("",!0)]),M("div",null,[b[24]||(b[24]=M("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),Dn(M("input",{type:"text",id:"username","onUpdate:modelValue":b[7]||(b[7]=R=>_.username=R),required:"",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.username]]),l.value?(Xe(),tt("div",nD,Ht(l.value),1)):yn("",!0)]),M("div",null,[b[25]||(b[25]=M("label",{for:"company_name",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Dn(M("input",{type:"text",id:"company_name","onUpdate:modelValue":b[8]||(b[8]=R=>_.company_name=R),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.company_name]])]),_.id?yn("",!0):(Xe(),tt("div",rD,[b[26]||(b[26]=M("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Mot de passe",-1)),Dn(M("input",{type:"password",id:"password","onUpdate:modelValue":b[9]||(b[9]=R=>_.password=R),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,_.password]])])),_.id?yn("",!0):(Xe(),tt("div",iD,[b[27]||(b[27]=M("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),Dn(M("input",{type:"password",id:"password_confirm","onUpdate:modelValue":b[10]||(b[10]=R=>v.value=R),required:"",autocomplete:"new-password",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[Mr,v.value]]),h.value?(Xe(),tt("div",sD,Ht(h.value),1)):yn("",!0)])),M("div",oD,[M("button",{type:"button",onClick:b[11]||(b[11]=R=>E.$emit("close")),class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Annuler "),M("button",{type:"submit",disabled:i.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[i.value?(Xe(),tt("span",lD,b[28]||(b[28]=[M("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):yn("",!0),Ni(" "+Ht(_.id?"Enregistrer":"Créer"),1)],8,aD)])],32)])])])])])]))}}),cD={class:"fixed inset-0 z-50 overflow-y-auto"},hD={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},fD={class:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"},dD={class:"sm:flex sm:items-start"},pD={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},gD={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline"},mD={class:"mt-2"},vD={class:"text-sm text-gray-500"},yD={class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},Gb=Pa({__name:"ConfirmationModal",props:{title:{type:String,required:!0},message:{type:String,required:!0}},emits:["confirm","cancel"],setup(e){return(n,t)=>(Xe(),tt("div",cD,[M("div",hD,[t[3]||(t[3]=M("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[M("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[4]||(t[4]=M("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),M("div",fD,[M("div",dD,[t[2]||(t[2]=M("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[M("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),M("div",pD,[M("h3",gD,Ht(e.title),1),M("div",mD,[M("p",vD,Ht(e.message),1)])])]),M("div",yD,[M("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[0]||(t[0]=r=>n.$emit("confirm"))}," Confirmer "),M("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:t[1]||(t[1]=r=>n.$emit("cancel"))}," Annuler ")])])])]))}}),_D={class:"h-full bg-gray-50"},bD={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},wD={class:"flex justify-between items-center mb-8"},xD={class:"text-3xl font-extrabold text-gray-900"},LD={key:0},SD={key:1},CD={key:2},PD={key:0},ED={key:1},AD={key:2},MD={class:"bg-white shadow rounded-lg mb-6 p-4"},kD={class:"space-y-4"},TD={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},BD={key:0},ND={key:0,value:"ADMIN"},RD={key:1,value:"ENTREPRISE"},DD={key:1},OD=["value"],ID={key:2},FD=["value"],zD={class:"w-full"},jD={class:"bg-white shadow rounded-lg"},UD={class:"overflow-x-auto"},$D={class:"min-w-full divide-y divide-gray-200"},qD={class:"bg-gray-50"},VD={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},GD={key:1,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},HD={class:"bg-white divide-y divide-gray-200"},WD={key:0,class:"animate-pulse"},ZD={key:1},KD={class:"px-6 py-4 whitespace-nowrap"},JD={class:"flex items-center"},YD={class:"flex-shrink-0 h-10 w-10"},XD={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center"},QD={class:"text-primary-600 font-medium"},eO={class:"ml-4"},tO={class:"text-sm font-medium text-gray-900"},nO={class:"text-sm text-gray-500"},rO={class:"px-6 py-4 whitespace-nowrap"},iO={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},sO={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oO={key:1,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},aO={class:"px-6 py-4 whitespace-nowrap"},lO={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},uO=["onClick"],cO=["onClick"],hO=Pa({__name:"UserListView",setup(e){const n=Ga(),t=Rf(),r=un([]),i=un([]),o=un([]),l=un(!1),h=un(!1),g=un(null),v=un(null),_=un(!0),x=un([]),E=Au({role:"",search:"",salarie:"",entreprise:""}),b=Rr(()=>n.isAdmin),R=Rr(()=>n.isEntreprise),$=Rr(()=>n.isSalarie),Q=Rr(()=>b.value?r.value.filter(z=>z.role==="SALARIE"):R.value?r.value.filter(z=>{var U,G;return z.role==="SALARIE"&&((U=z.entreprise)==null?void 0:U.id)===((G=n.user)==null?void 0:G.id)}):[]),I=Rr(()=>{let z=r.value;if(R.value&&(z=z.filter(U=>{var G,ue,ie,Ae,Me;return U.role==="SALARIE"?((G=U.entreprise)==null?void 0:G.id)===((ue=n.user)==null?void 0:ue.id):U.role==="VISITEUR"?((Ae=(ie=U.salarie)==null?void 0:ie.entreprise)==null?void 0:Ae.id)===((Me=n.user)==null?void 0:Me.id):!1})),$.value&&(z=z.filter(U=>{var G,ue;return U.role==="VISITEUR"&&(U.salarie_id===((G=n.user)==null?void 0:G.id)||U.salarie&&U.salarie.id===((ue=n.user)==null?void 0:ue.id))})),(b.value||R.value)&&(E.role&&(z=z.filter(U=>U.role===E.role)),E.salarie&&(z=z.filter(U=>{var ue;const G=((ue=U.salarie)==null?void 0:ue.id)||U.salarie_id;return(G==null?void 0:G.toString())===E.salarie.toString()})),E.entreprise&&b.value&&(z=z.filter(U=>{var G,ue,ie,Ae,Me;return U.role==="SALARIE"?((ue=(G=U.entreprise)==null?void 0:G.id)==null?void 0:ue.toString())===E.entreprise.toString():U.role==="VISITEUR"?((Me=(Ae=(ie=U.salarie)==null?void 0:ie.entreprise)==null?void 0:Ae.id)==null?void 0:Me.toString())===E.entreprise.toString():!1}))),E.search){const U=E.search.toLowerCase();z=z.filter(G=>{var ue,ie,Ae,Me;return((ue=G.username)==null?void 0:ue.toLowerCase().includes(U))||((ie=G.email)==null?void 0:ie.toLowerCase().includes(U))||((Ae=G.first_name)==null?void 0:Ae.toLowerCase().includes(U))||((Me=G.last_name)==null?void 0:Me.toLowerCase().includes(U))||G.company_name&&G.company_name.toLowerCase().includes(U)})}return z});Bl(async()=>{await W(),await ge()});async function W(){var z,U,G;_.value=!0;try{if(b.value)r.value=await n.fetchUsers();else if(R.value){const[ue,ie]=await Promise.all([qd({role:"SALARIE",entrepriseId:(z=n.user)==null?void 0:z.id}),qd({role:"VISITEUR",entrepriseId:(U=n.user)==null?void 0:U.id})]);r.value=[...ue,...ie]}else $.value&&(r.value=await qd({role:"VISITEUR",salarieId:(G=n.user)==null?void 0:G.id,includeDetails:!0}),console.log("Visiteurs récupérés:",r.value))}catch(ue){console.error("Erreur lors de la récupération des utilisateurs:",ue),t.error("Erreur lors de la récupération des utilisateurs")}finally{_.value=!1}}async function ge(){try{b.value?await Promise.all([Se(),Ye()]):R.value&&await De()}catch(z){console.error("Erreur lors de la récupération des dépendances:",z)}}async function Se(){var z;try{b.value?i.value=await n.fetchUsersByRole({role:"SALARIE"}):R.value&&(i.value=await n.fetchEntrepriseSalaries((z=n.user)==null?void 0:z.id))}catch(U){console.error("Erreur lors de la récupération des salaries:",U)}}async function De(){var z,U;if(!(!R.value||!((z=n.user)!=null&&z.id)))try{i.value=await n.fetchEntrepriseSalaries((U=n.user)==null?void 0:U.id)}catch(G){console.error("Erreur lors de la récupération des salaries de l'entreprise:",G)}}async function Ye(){try{o.value=await n.fetchEnterprises()}catch(z){console.error("Erreur lors de la récupération des entreprises:",z)}}function Ve(){g.value=null,l.value=!0}function O(z){g.value={...z},l.value=!0}function K(){l.value=!1,g.value=null,x.value=[]}async function ce(z){var G,ue,ie,Ae,Me,st;x.value=[];const U=!!z.id;try{const X={...z};b.value?(X.entreprise&&typeof X.entreprise=="object"?X.entreprise_id=X.entreprise.id:typeof X.entreprise=="number"&&(X.entreprise_id=X.entreprise),X.salarie&&typeof X.salarie=="object"?X.salarie_id=X.salarie.id:typeof X.salarie=="number"&&(X.salarie_id=X.salarie)):R.value?(X.entreprise_id=(G=n.user)==null?void 0:G.id,X.role==="VISITEUR"&&(X.salarie&&typeof X.salarie=="object"?X.salarie_id=X.salarie.id:typeof X.salarie=="number"&&(X.salarie_id=X.salarie))):$.value&&(X.role="VISITEUR",X.salarie_id=(ue=n.user)==null?void 0:ue.id),X.role==="SALARIE"?((ie=X.entreprise)!=null&&ie.id?(X.entreprise_id=X.entreprise.id,delete X.entreprise):typeof X.entreprise=="number"&&(X.entreprise_id=X.entreprise,delete X.entreprise),delete X.salarie):X.role==="VISITEUR"&&((Ae=X.salarie)!=null&&Ae.id?(X.salarie_id=X.salarie.id,delete X.salarie):typeof X.salarie=="number"&&(X.salarie_id=X.salarie,delete X.salarie),delete X.entreprise,delete X.entreprise_id),U?(await n.updateUser(z.id,X),t.success("Utilisateur modifié avec succès")):(await n.createUser(X),t.success("Utilisateur créé avec succès")),await Promise.all([W(),ge()]),K()}catch(X){console.error("Error saving user:",((Me=X.response)==null?void 0:Me.data)||X),x.value=nE(X),t.error("Erreur lors de la sauvegarde de l'utilisateur");const Ee=((st=X.response)==null?void 0:st.data)||{};let N="";throw typeof Ee=="object"&&(N=Object.entries(Ee).map(([Z,he])=>Array.isArray(he)?`${Z}: ${he[0]}`:`${Z}: ${he}`).filter(Z=>Z).join(`
`)),N||(N="Une erreur est survenue lors de la sauvegarde"),new Error(N)}}function H(z){v.value=z,h.value=!0}async function D(){if(v.value)try{await n.deleteUser(v.value.id),t.success("Utilisateur supprimé avec succès"),await Promise.all([W(),ge()]),h.value=!1,v.value=null}catch(z){throw console.error("Erreur lors de la suppression de l'utilisateur:",z),t.error("Erreur lors de la suppression de l'utilisateur"),z}}function V(z){var U,G,ue,ie,Ae,Me,st,X;return b.value?!0:R.value?z.role==="SALARIE"?((U=z.entreprise)==null?void 0:U.id)===((G=n.user)==null?void 0:G.id):z.role==="VISITEUR"?((ie=(ue=z.salarie)==null?void 0:ue.entreprise)==null?void 0:ie.id)===((Ae=n.user)==null?void 0:Ae.id):!1:$.value?z.role==="VISITEUR"&&(z.salarie_id===((Me=n.user)==null?void 0:Me.id)||((st=z.salarie)==null?void 0:st.id)===((X=n.user)==null?void 0:X.id)):!1}return(z,U)=>{var G,ue,ie,Ae;return Xe(),tt("div",_D,[M("div",bD,[M("div",wD,[M("h1",xD,[b.value?(Xe(),tt("span",LD,"Gestion des utilisateurs")):R.value?(Xe(),tt("span",SD,"Gestion des salaries et visiteurs")):$.value?(Xe(),tt("span",CD,"Gestion des visiteurs")):yn("",!0)]),M("button",{onClick:Ve,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[U[5]||(U[5]=M("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1)),b.value?(Xe(),tt("span",PD,"Nouvel utilisateur")):R.value?(Xe(),tt("span",ED,"Nouveau salarie/visiteur")):$.value?(Xe(),tt("span",AD,"Nouvel visiteur")):yn("",!0)])]),M("div",MD,[M("div",kD,[M("div",TD,[b.value||R.value?(Xe(),tt("div",BD,[U[9]||(U[9]=M("label",{for:"role-filter",class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),Dn(M("select",{id:"role-filter","onUpdate:modelValue":U[0]||(U[0]=Me=>E.role=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[6]||(U[6]=M("option",{value:""},"Tous les rôles",-1)),b.value?(Xe(),tt("option",ND,"Administrateur")):yn("",!0),b.value?(Xe(),tt("option",RD,"Entreprise")):yn("",!0),U[7]||(U[7]=M("option",{value:"SALARIE"},"Salarie",-1)),U[8]||(U[8]=M("option",{value:"VISITEUR"},"Visiteur",-1))],512),[[Hs,E.role]])])):yn("",!0),b.value?(Xe(),tt("div",DD,[U[11]||(U[11]=M("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Entreprise",-1)),Dn(M("select",{id:"entreprise-filter","onUpdate:modelValue":U[1]||(U[1]=Me=>E.entreprise=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[10]||(U[10]=M("option",{value:""},"Toutes les entreprises",-1)),(Xe(!0),tt(Un,null,kr(o.value,Me=>(Xe(),tt("option",{key:Me.id,value:Me.id},Ht(Kn(al)(Me)),9,OD))),128))],512),[[Hs,E.entreprise]])])):yn("",!0),b.value||R.value?(Xe(),tt("div",ID,[U[13]||(U[13]=M("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Salarie",-1)),Dn(M("select",{id:"salarie-filter","onUpdate:modelValue":U[2]||(U[2]=Me=>E.salarie=Me),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[U[12]||(U[12]=M("option",{value:""},"Tous les salaries",-1)),(Xe(!0),tt(Un,null,kr(Q.value,Me=>(Xe(),tt("option",{key:Me.id,value:Me.id},Ht(Kn(al)(Me)),9,FD))),128))],512),[[Hs,E.salarie]])])):yn("",!0)]),M("div",zD,[U[14]||(U[14]=M("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Recherche",-1)),Dn(M("input",{type:"text",id:"search","onUpdate:modelValue":U[3]||(U[3]=Me=>E.search=Me),placeholder:"Rechercher par nom, email, entreprise...",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[Mr,E.search]])])])]),M("div",jD,[M("div",UD,[M("table",$D,[M("thead",qD,[M("tr",null,[U[15]||(U[15]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur ",-1)),U[16]||(U[16]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle ",-1)),U[17]||(U[17]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email ",-1)),b.value||R.value?(Xe(),tt("th",VD," Entreprise ")):yn("",!0),b.value||R.value?(Xe(),tt("th",GD," Salarie ")):yn("",!0),U[18]||(U[18]=M("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ",-1)),U[19]||(U[19]=M("th",{scope:"col",class:"relative px-6 py-3"},[M("span",{class:"sr-only"},"Actions")],-1))])]),M("tbody",HD,[_.value?(Xe(),tt("tr",WD,U[20]||(U[20]=[M("td",{colspan:"7",class:"py-4 px-6"},[M("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))):I.value.length===0?(Xe(),tt("tr",ZD,U[21]||(U[21]=[M("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun utilisateur trouvé ",-1)]))):yn("",!0),(Xe(!0),tt(Un,null,kr(I.value,Me=>{var st;return Xe(),tt("tr",{key:Me.id},[M("td",KD,[M("div",JD,[M("div",YD,[M("div",XD,[M("span",QD,Ht(Kn(iE)(Me.first_name,Me.last_name)),1)])]),M("div",eO,[M("div",tO,Ht(Kn(al)(Me)),1),M("div",nO,Ht(Me.username),1)])])]),M("td",rO,[M("span",{class:Yi(Kn(aE)())},Ht(Kn(oE)(Me.role)),3)]),M("td",iO,Ht(Me.email),1),b.value||R.value?(Xe(),tt("td",sO,[Me.role==="ENTREPRISE"?(Xe(),tt(Un,{key:0},[Ni(" - ")],64)):Me.role==="SALARIE"?(Xe(),tt(Un,{key:1},[Ni(Ht(Me.entreprise?Kn(al)(Me.entreprise):"Non assigné"),1)],64)):Me.role==="VISITEUR"?(Xe(),tt(Un,{key:2},[Ni(Ht((st=Me.salarie)!=null&&st.entreprise?Kn(al)(Me.salarie.entreprise):"Non assigné"),1)],64)):(Xe(),tt(Un,{key:3},[Ni(" - ")],64))])):yn("",!0),b.value||R.value?(Xe(),tt("td",oO,[Me.role==="ENTREPRISE"||Me.role==="ADMIN"?(Xe(),tt(Un,{key:0},[Ni(" - ")],64)):Me.role==="SALARIE"?(Xe(),tt(Un,{key:1},[Ni(" - ")],64)):(Xe(),tt(Un,{key:2},[Ni(Ht(Me.salarie?Kn(al)(Me.salarie):"Non assigné"),1)],64))])):yn("",!0),M("td",aO,[M("span",{class:Yi(Kn(lE)(Me.is_active))},Ht(Me.is_active?"Actif":"Inactif"),3)]),M("td",lO,[M("button",{onClick:X=>O(Me),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,uO),V(Me)?(Xe(),tt("button",{key:0,onClick:X=>H(Me),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,cO)):yn("",!0)])])}),128))])])])])]),l.value?(Xe(),Cu(uD,{key:0,user:g.value,salaries:i.value,entreprises:o.value,"is-admin":b.value,"is-entreprise":R.value,"current-salarie":$.value?(ue=(G=Kn(n).user)==null?void 0:G.id)==null?void 0:ue.toString():void 0,"current-entreprise":R.value?(Ae=(ie=Kn(n).user)==null?void 0:ie.id)==null?void 0:Ae.toString():void 0,"api-errors":x.value,onClose:K,onSave:ce},null,8,["user","salaries","entreprises","is-admin","is-entreprise","current-salarie","current-entreprise","api-errors"])):yn("",!0),h.value?(Xe(),Cu(Gb,{key:1,title:"Supprimer l'utilisateur",message:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible.",onConfirm:D,onCancel:U[4]||(U[4]=Me=>h.value=!1)})):yn("",!0)])}}}),fO={class:"h-full bg-gray-50"},dO={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},pO={class:"sm:flex sm:items-center"},gO={class:"sm:flex-auto"},mO={class:"text-2xl font-semibold text-gray-900"},vO={class:"mt-2 text-sm text-gray-700"},yO={key:0,class:"mt-8"},_O={class:"mb-6"},bO=["value"],wO={class:"mb-6"},xO={value:null},LO=["value"],SO={key:0,class:"mb-6"},CO={value:null},PO=["value"],EO={key:1,class:"mt-8"},AO={class:"mb-6"},MO=["value"],kO={class:"mt-8"},TO={class:"overflow-hidden shadow-sm ring-1 ring-black ring-opacity-5 rounded-lg"},BO={class:"overflow-x-auto"},NO={class:"min-w-full divide-y divide-gray-300"},RO={class:"bg-gray-50"},DO={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},OO={class:"ml-2 flex-none rounded"},IO={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},FO={class:"ml-2 flex-none rounded"},zO={class:"divide-y divide-gray-200 bg-white"},jO={key:0},UO={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},$O={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},qO={class:"px-3 py-4 text-sm text-gray-900"},VO={key:0,class:"flex items-center"},GO={class:"h-8 w-8 flex-shrink-0"},HO={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},WO={class:"text-primary-700 font-medium text-sm"},ZO={class:"ml-3"},KO={class:"font-medium"},JO={key:1,class:"text-gray-500"},YO={class:"px-3 py-4 text-sm text-gray-900"},XO={key:0,class:"flex items-center"},QO={class:"h-8 w-8 flex-shrink-0"},eI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},tI={class:"text-primary-700 font-medium text-sm"},nI={class:"ml-3"},rI={class:"font-medium"},iI={key:1,class:"text-gray-500"},sI={class:"px-3 py-4 text-sm text-gray-900"},oI={key:0,class:"flex items-center"},aI={class:"h-8 w-8 flex-shrink-0"},lI={class:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center"},uI={class:"text-primary-700 font-medium text-sm"},cI={class:"ml-3"},hI={class:"font-medium"},fI={key:1,class:"text-gray-500"},dI={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},pI={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8"},gI=["onClick"],mI=["onClick"],vI=["onClick"],yI={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]"},_I={class:"bg-white rounded-lg p-6 max-w-md w-full"},bI={class:"flex justify-between items-center mb-4"},wI=["disabled"],xI=["disabled"],LI={key:0,class:"space-y-4"},SI={key:0},CI=["disabled"],PI=["value"],EI=["disabled"],AI=["value"],MI={key:0,class:"mt-1 text-sm text-gray-500"},kI=["disabled"],TI=["value"],BI={key:0,class:"mt-1 text-sm text-gray-500"},NI={key:1,class:"mt-4 bg-red-50 p-4 rounded-md"},RI={class:"flex"},DI={class:"ml-3"},OI={class:"text-sm font-medium text-red-800"},II={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3"},FI=["disabled"],zI={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},jI=Pa({__name:"PlansView",setup(e){const n=qp(),t=Lm(),r=Ga(),i=un([]),o=un([]),l=un([]),h=un([]),g=un(!1),v=un(!1),_=un(!1),x=un(null),E=un({nom:"",description:"",client:null}),b=un({id:0,nom:"",description:"",entreprise:null,salarie:null,visiteur:null}),R=un(!1),$=un(null),Q=un(null),I=un(null),W=un("date_modification"),ge=un("desc"),Se=un(null),De=Rr(()=>Q.value?h.value.filter(te=>typeof te.salarie=="object"&&te.salarie?te.salarie.id===Q.value:te.salarie===Q.value||te.salarie_id===Q.value):h.value),Ye=Rr(()=>{let te=i.value;console.log(`
[PlansView] Filtering plans:`,te.map(se=>({id:se.id,entreprise:se.entreprise,salarie:se.salarie,visiteur:se.visiteur}))),r.isAdmin?(Se.value&&(te=te.filter(se=>{var Pe;return typeof se.entreprise=="object"?((Pe=se.entreprise)==null?void 0:Pe.id)===Se.value:se.entreprise===Se.value})),Q.value&&(te=te.filter(se=>{var Pe;return typeof se.salarie=="object"?((Pe=se.salarie)==null?void 0:Pe.id)===Q.value:se.salarie===Q.value}),I.value&&(te=te.filter(se=>{var Pe;return typeof se.visiteur=="object"?((Pe=se.visiteur)==null?void 0:Pe.id)===I.value:se.visiteur===I.value})))):r.isSalarie&&(te=te.filter(se=>{var Pe,oe,re;return typeof se.salarie=="object"?((Pe=se.salarie)==null?void 0:Pe.id)===((oe=r.user)==null?void 0:oe.id):se.salarie===((re=r.user)==null?void 0:re.id)}),I.value&&(te=te.filter(se=>{var Pe;return typeof se.visiteur=="object"?((Pe=se.visiteur)==null?void 0:Pe.id)===I.value:se.visiteur===I.value})));const ee=[...te].sort((se,Pe)=>{if(W.value==="nom")return ge.value==="asc"?se.nom.localeCompare(Pe.nom):Pe.nom.localeCompare(se.nom);{const oe=new Date(se[W.value]).getTime(),re=new Date(Pe[W.value]).getTime();return ge.value==="asc"?oe-re:re-oe}});return console.log("[PlansView] Final filtered and sorted plans:",ee.map(se=>({id:se.id,entreprise:se.entreprise,salarie:se.salarie,visiteur:se.visiteur}))),ee}),Ve=Rr(()=>r.isAdmin?{title:"Tous les plans",description:"Liste complète des plans",plans:i.value}:r.isSalarie?{title:"Plans des visiteurs",description:"Plans où vous êtes assigné comme salarie",plans:i.value.filter(te=>{var ee,se,Pe;return typeof te.salarie=="object"?((ee=te.salarie)==null?void 0:ee.id)===((se=r.user)==null?void 0:se.id):te.salarie===((Pe=r.user)==null?void 0:Pe.id)})}:{title:"Mes plans",description:"Plans qui vous sont assignés ou que vous avez créés",plans:i.value.filter(te=>{var Pe,oe,re,xe;const ee=te.createur.id===((Pe=r.user)==null?void 0:Pe.id);let se=!1;return typeof te.visiteur=="object"?se=((oe=te.visiteur)==null?void 0:oe.id)===((re=r.user)==null?void 0:re.id):se=te.visiteur===((xe=r.user)==null?void 0:xe.id),se||ee})}),O=Rr(()=>Se.value?o.value.filter(te=>{var ee;return typeof te.entreprise=="object"?((ee=te.entreprise)==null?void 0:ee.id)===Se.value:te.entreprise_id===Se.value}):o.value),K=Rr(()=>b.value.entreprise?o.value.filter(te=>{var ee;return typeof te.entreprise=="object"?((ee=te.entreprise)==null?void 0:ee.id)===b.value.entreprise:te.entreprise_id===b.value.entreprise}):[]),ce=Rr(()=>!b.value.entreprise||!b.value.salarie?[]:h.value.filter(te=>typeof te.salarie=="object"&&te.salarie?te.salarie.id===b.value.salarie:te.salarie===b.value.salarie||te.salarie_id===b.value.salarie));Bl(async()=>{var te;await H(),r.isAdmin?await D():r.isSalarie&&await z(((te=r.user)==null?void 0:te.id)||0)});async function H(){try{const te=await t.fetchPlansWithDetails();i.value=te.data}catch(te){console.error("Erreur lors du chargement des plans:",te)}}async function D(){try{console.log("Chargement des entreprises..."),l.value=await r.fetchEntreprises(),console.log("Entreprises chargées:",l.value)}catch(te){console.error("Erreur lors du chargement des entreprises:",te)}}async function V(te){try{if(console.log("Chargement des salaries pour l'entreprise:",te),te===void 0){const ee=await r.fetchUsersByRole({role:"SALARIE"});o.value=ee}else o.value=await r.fetchEntrepriseSalaries(te);console.log("Salaries chargés:",o.value)}catch(ee){console.error("Erreur lors du chargement des salaries:",ee)}}async function z(te){try{console.log("Chargement des visiteurs pour le salarie:",te);const ee=await qd({role:"VISITEUR",salarieId:te});h.value=ee.map(se=>({...se,salarie_id:te})),console.log("Visiteurs chargés:",h.value)}catch(ee){console.error("Erreur lors du chargement des visiteurs:",ee)}}function U(){g.value=!0,E.value={nom:"",description:"",client:null}}async function G(te){console.log(`
[PlansView][editPlan] ====== DÉBUT ÉDITION PLAN ======`),console.log("[PlansView][editPlan] Plan reçu:",{id:te.id,nom:te.nom,entreprise:te.entreprise,salarie:te.salarie,visiteur:te.visiteur});try{console.log("[PlansView][editPlan] Définition du plan courant dans le store..."),t.setCurrentPlan(te),console.log("[PlansView][editPlan] Sauvegarde de l'ID dans localStorage:",te.id),localStorage.setItem("lastPlanId",te.id.toString()),console.log("[PlansView][editPlan] Redirection vers la vue carte..."),await n.push("/"),console.log(`[PlansView][editPlan] ====== FIN ÉDITION PLAN ======
`)}catch(ee){console.error("[PlansView][editPlan] ERREUR:",ee),ee instanceof Error&&console.error("[PlansView][editPlan] Stack trace:",ee.stack),alert("Une erreur est survenue lors du chargement du plan")}}async function ue(te){te!=null&&te.id&&(x.value=te,_.value=!0)}async function ie(){var te,ee;if((te=x.value)!=null&&te.id)try{await t.deletePlan(x.value.id),await H(),((ee=t.currentPlan)==null?void 0:ee.id)===x.value.id&&t.clearCurrentPlan()}catch(se){console.error("Erreur lors de la suppression du plan:",se),alert("Une erreur est survenue lors de la suppression du plan")}finally{_.value=!1,x.value=null}}function Ae(){_.value=!1,x.value=null}function Me(te){return new Date(te).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function st(te){if(!te)return"";const ee=te.first_name||"",se=te.last_name||"";return(ee.charAt(0)+se.charAt(0)).toUpperCase()}async function X(te){R.value=!0,$.value=null;try{r.isAdmin&&!l.value.length&&await D();const ee=typeof te.entreprise=="object"&&te.entreprise?te.entreprise.id:te.entreprise,se=typeof te.salarie=="object"&&te.salarie?te.salarie.id:te.salarie,Pe=typeof te.visiteur=="object"&&te.visiteur?te.visiteur.id:te.visiteur;b.value={id:te.id,nom:te.nom,description:te.description,entreprise:ee||null,salarie:se||null,visiteur:Pe||null},ee&&await V(ee),se&&await z(se),v.value=!0}catch(ee){console.error("Erreur lors de l'ouverture du modal:",ee),$.value="Erreur lors du chargement des données"}finally{R.value=!1}}async function Ee(){var te,ee,se,Pe,oe;$.value=null,R.value=!0;try{if(!b.value.nom.trim())throw new Error("Le nom du plan est requis");if(b.value.visiteur&&!b.value.salarie)throw new Error("Un salarie doit être sélectionné pour assigner un visiteur");if(b.value.salarie&&!b.value.entreprise)throw new Error("Une entreprise doit être sélectionnée pour assigner un salarie");console.log("Données envoyées pour la mise à jour:",{id:b.value.id,nom:b.value.nom.trim(),description:b.value.description.trim(),entreprise_id:b.value.entreprise,salarie_id:b.value.salarie,visiteur_id:b.value.visiteur});const re=await t.updatePlanDetails(b.value.id,{nom:b.value.nom.trim(),description:b.value.description.trim(),entreprise_id:b.value.entreprise,salarie_id:b.value.salarie,visiteur_id:b.value.visiteur});console.log("Réponse de la mise à jour:",re),re&&(v.value=!1,await H())}catch(re){if(console.error("Erreur lors de la mise à jour du plan:",re),(ee=(te=re.response)==null?void 0:te.data)!=null&&ee.detail)$.value=re.response.data.detail;else if((Pe=(se=re.response)==null?void 0:se.data)!=null&&Pe.non_field_errors)$.value=re.response.data.non_field_errors[0];else if((oe=re.response)!=null&&oe.data){const xe=Object.entries(re.response.data).map(([ye,le])=>`${ye}: ${Array.isArray(le)?le[0]:le}`);$.value=xe.join(`
`)}else $.value=re.message||"Une erreur est survenue lors de la mise à jour du plan"}finally{R.value=!1}}Co(()=>Se.value,async te=>{Q.value=null,I.value=null,te?await V(te):await V()}),Co(()=>Q.value,async te=>{I.value=null,te&&await z(te)}),Co(()=>b.value.entreprise,async te=>{te===null?(b.value.salarie=null,b.value.visiteur=null):await V(te)}),Co(()=>b.value.salarie,async te=>{b.value.visiteur=null,te&&await z(te)});function N(te){var oe,re,xe;const ee=r.user;if(!ee)return!1;if(ee.user_type==="admin")return!0;if(ee.user_type==="entreprise")return typeof te.entreprise=="object"?((oe=te.entreprise)==null?void 0:oe.id)===ee.id:te.entreprise===ee.id;if(ee.user_type==="salarie")return typeof te.salarie=="object"?((re=te.salarie)==null?void 0:re.id)===ee.id:te.salarie===ee.id;const se=te.createur.id===ee.id;let Pe=!1;return typeof te.visiteur=="object"?Pe=((xe=te.visiteur)==null?void 0:xe.id)===ee.id:Pe=te.visiteur===ee.id,Pe||se}async function Z(te){await H(),localStorage.setItem("lastPlanId",te.toString()),console.log(`Plan ${te} créé et défini comme plan actif`),n.push("/")}function he(te){W.value===te?ge.value=ge.value==="asc"?"desc":"asc":(W.value=te,ge.value="desc")}function ne(te){return te?al(te):""}return(te,ee)=>{var se;return Xe(),tt("div",fO,[M("div",dO,[M("div",pO,[M("div",gO,[M("h1",mO,Ht(Ve.value.title),1),M("p",vO,Ht(Ve.value.description),1)]),M("div",{class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},[M("button",{onClick:U,class:"inline-flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:w-auto"}," Nouveau plan ")])]),Kn(r).isAdmin?(Xe(),tt("div",yO,[M("div",_O,[ee[15]||(ee[15]=M("label",{for:"entreprise-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par entreprise",-1)),Dn(M("select",{id:"entreprise-filter","onUpdate:modelValue":ee[0]||(ee[0]=Pe=>Se.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[14]||(ee[14]=M("option",{value:null},"Toutes les entreprises",-1)),(Xe(!0),tt(Un,null,kr(l.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,bO))),128))],512),[[Hs,Se.value]])]),M("div",wO,[ee[16]||(ee[16]=M("label",{for:"salarie-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par salarie",-1)),Dn(M("select",{id:"salarie-filter","onUpdate:modelValue":ee[1]||(ee[1]=Pe=>Q.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[M("option",xO,Ht(O.value.length?"Tous les salaries":"Aucun salarie disponible"),1),(Xe(!0),tt(Un,null,kr(O.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,LO))),128))],512),[[Hs,Q.value]])]),Q.value?(Xe(),tt("div",SO,[ee[17]||(ee[17]=M("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Dn(M("select",{id:"visiteur-filter","onUpdate:modelValue":ee[2]||(ee[2]=Pe=>I.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[M("option",CO,Ht(De.value.length?"Tous les visiteurs":"Aucun visiteur disponible"),1),(Xe(!0),tt(Un,null,kr(De.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,PO))),128))],512),[[Hs,I.value]])])):yn("",!0)])):Kn(r).isSalarie?(Xe(),tt("div",EO,[M("div",AO,[ee[19]||(ee[19]=M("label",{for:"visiteur-filter",class:"block text-sm font-medium text-gray-700"},"Filtrer par visiteur",-1)),Dn(M("select",{id:"visiteur-filter","onUpdate:modelValue":ee[3]||(ee[3]=Pe=>I.value=Pe),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[ee[18]||(ee[18]=M("option",{value:null},"Tous les visiteurs",-1)),(Xe(!0),tt(Un,null,kr(h.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,MO))),128))],512),[[Hs,I.value]])])])):yn("",!0),M("div",kO,[M("div",TO,[M("div",BO,[M("table",NO,[M("thead",RO,[M("tr",null,[M("th",DO,[M("button",{onClick:ee[4]||(ee[4]=Pe=>he("nom")),class:"group inline-flex items-center"},[ee[21]||(ee[21]=Ni(" Nom ")),M("span",OO,[(Xe(),tt("svg",{class:Yi(["h-5 w-5",{"text-gray-900":W.value==="nom","text-gray-400":W.value!=="nom","rotate-180":W.value==="nom"&&ge.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[20]||(ee[20]=[M("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[24]||(ee[24]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Description ",-1)),ee[25]||(ee[25]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Entreprise ",-1)),ee[26]||(ee[26]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Salarie ",-1)),ee[27]||(ee[27]=M("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Visiteur ",-1)),M("th",IO,[M("button",{onClick:ee[5]||(ee[5]=Pe=>he("date_modification")),class:"group inline-flex items-center"},[ee[23]||(ee[23]=Ni(" Dernière modification ")),M("span",FO,[(Xe(),tt("svg",{class:Yi(["h-5 w-5",{"text-gray-900":W.value==="date_modification","text-gray-400":W.value!=="date_modification","rotate-180":W.value==="date_modification"&&ge.value==="asc"}]),viewBox:"0 0 20 20",fill:"currentColor"},ee[22]||(ee[22]=[M("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]),2))])])]),ee[28]||(ee[28]=M("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[M("span",{class:"sr-only"},"Actions")],-1))])]),M("tbody",zO,[Ye.value.length===0?(Xe(),tt("tr",jO,ee[29]||(ee[29]=[M("td",{colspan:"7",class:"py-4 px-6 text-center text-gray-500"}," Aucun plan disponible ",-1)]))):yn("",!0),(Xe(!0),tt(Un,null,kr(Ye.value,Pe=>(Xe(),tt("tr",{key:Pe.id,class:"hover:bg-gray-50"},[M("td",UO,Ht(Pe.nom),1),M("td",$O,Ht(Pe.description||"-"),1),M("td",qO,[Pe.entreprise&&typeof Pe.entreprise=="object"?(Xe(),tt("div",VO,[M("div",GO,[M("div",HO,[M("span",WO,Ht(st(Pe.entreprise)),1)])]),M("div",ZO,[M("div",KO,Ht(Kn(al)(Pe.entreprise)),1)])])):(Xe(),tt("div",JO," Non assigné "))]),M("td",YO,[Pe.salarie&&typeof Pe.salarie=="object"?(Xe(),tt("div",XO,[M("div",QO,[M("div",eI,[M("span",tI,Ht(st(Pe.salarie)),1)])]),M("div",nI,[M("div",rI,Ht(Kn(al)(Pe.salarie)),1)])])):(Xe(),tt("div",iI," Non assigné "))]),M("td",sI,[Pe.visiteur&&typeof Pe.visiteur=="object"?(Xe(),tt("div",oI,[M("div",aI,[M("div",lI,[M("span",uI,Ht(st(Pe.visiteur)),1)])]),M("div",cI,[M("div",hI,Ht(Kn(al)(Pe.visiteur)),1)])])):(Xe(),tt("div",fI," Non assigné "))]),M("td",dI,Ht(Me(Pe.date_modification)),1),M("td",pI,[M("button",{onClick:oe=>G(Pe),class:"text-primary-600 hover:text-primary-900 mr-4"}," Ouvrir ",8,gI),M("button",{onClick:oe=>X(Pe),class:"text-primary-600 hover:text-primary-900 mr-4"}," Modifier ",8,mI),N(Pe)?(Xe(),tt("button",{key:0,onClick:oe=>ue(Pe),class:"text-red-600 hover:text-red-900"}," Supprimer ",8,vI)):yn("",!0)])]))),128))])])])])]),Xi(Lb,{modelValue:g.value,"onUpdate:modelValue":ee[6]||(ee[6]=Pe=>g.value=Pe),salaries:o.value,clients:h.value,onCreated:Z},null,8,["modelValue","salaries","clients"]),v.value?(Xe(),tt("div",yI,[M("div",_I,[M("div",bI,[ee[31]||(ee[31]=M("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier le plan",-1)),M("button",{onClick:ee[7]||(ee[7]=Pe=>v.value=!1),class:"text-gray-400 hover:text-gray-500 focus:outline-none"},ee[30]||(ee[30]=[M("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[M("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M("form",{onSubmit:Tp(Ee,["prevent"]),class:"space-y-4"},[M("div",null,[ee[32]||(ee[32]=M("label",{for:"edit-nom",class:"block text-sm font-medium text-gray-700"}," Nom ",-1)),Dn(M("input",{type:"text",id:"edit-nom","onUpdate:modelValue":ee[8]||(ee[8]=Pe=>b.value.nom=Pe),disabled:R.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",required:""},null,8,wI),[[Mr,b.value.nom]])]),M("div",null,[ee[33]||(ee[33]=M("label",{for:"edit-description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),Dn(M("textarea",{id:"edit-description","onUpdate:modelValue":ee[9]||(ee[9]=Pe=>b.value.description=Pe),disabled:R.value,rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"},null,8,xI),[[Mr,b.value.description]])]),Kn(r).isAdmin||((se=Kn(r).user)==null?void 0:se.user_type)==="entreprise"?(Xe(),tt("div",LI,[Kn(r).isAdmin?(Xe(),tt("div",SI,[ee[35]||(ee[35]=M("label",{for:"edit-entreprise",class:"block text-sm font-medium text-gray-700"}," Entreprise ",-1)),Dn(M("select",{id:"edit-entreprise","onUpdate:modelValue":ee[10]||(ee[10]=Pe=>b.value.entreprise=Pe),disabled:R.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[34]||(ee[34]=M("option",{value:null},"Sélectionner une entreprise",-1)),(Xe(!0),tt(Un,null,kr(l.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,PI))),128))],8,CI),[[Hs,b.value.entreprise]])])):yn("",!0),M("div",null,[ee[37]||(ee[37]=M("label",{for:"edit-salarie",class:"block text-sm font-medium text-gray-700"}," Salarie ",-1)),Dn(M("select",{id:"edit-salarie","onUpdate:modelValue":ee[11]||(ee[11]=Pe=>b.value.salarie=Pe),disabled:Kn(r).isAdmin&&!b.value.entreprise||R.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[36]||(ee[36]=M("option",{value:null},"Sélectionner un salarie",-1)),(Xe(!0),tt(Un,null,kr(K.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,AI))),128))],8,EI),[[Hs,b.value.salarie]]),Kn(r).isAdmin&&!b.value.entreprise?(Xe(),tt("p",MI," Veuillez d'abord sélectionner une entreprise ")):yn("",!0)]),M("div",null,[ee[39]||(ee[39]=M("label",{for:"edit-visiteur",class:"block text-sm font-medium text-gray-700"}," Visiteur ",-1)),Dn(M("select",{id:"edit-visiteur","onUpdate:modelValue":ee[12]||(ee[12]=Pe=>b.value.visiteur=Pe),disabled:!b.value.salarie||R.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed"},[ee[38]||(ee[38]=M("option",{value:null},"Sélectionner un visiteur",-1)),(Xe(!0),tt(Un,null,kr(ce.value,Pe=>(Xe(),tt("option",{key:Pe.id,value:Pe.id},Ht(ne(Pe)),9,TI))),128))],8,kI),[[Hs,b.value.visiteur]]),b.value.salarie?yn("",!0):(Xe(),tt("p",BI," Veuillez d'abord sélectionner un salarie "))])])):yn("",!0),$.value?(Xe(),tt("div",NI,[M("div",RI,[ee[40]||(ee[40]=M("div",{class:"flex-shrink-0"},[M("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[M("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),M("div",DI,[M("p",OI,Ht($.value),1)])])])):yn("",!0),M("div",II,[M("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:mt-0 sm:text-sm",onClick:ee[13]||(ee[13]=Pe=>v.value=!1)}," Annuler "),M("button",{type:"submit",disabled:R.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 sm:text-sm disabled:opacity-50"},[R.value?(Xe(),tt("svg",zI,ee[41]||(ee[41]=[M("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),M("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):yn("",!0),Ni(" "+Ht(R.value?"Enregistrement...":"Enregistrer"),1)],8,FI)])],32)])])):yn("",!0),_.value?(Xe(),Cu(Gb,{key:3,title:"Supprimer le plan",message:"Êtes-vous sûr de vouloir supprimer ce plan ? Cette action est irréversible.",onConfirm:ie,onCancel:Ae})):yn("",!0)])])}}}),Hb=uA({history:jE("/"),routes:[{path:"/",name:"home",component:Zy,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/plans",name:"plans",component:jI,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/users",name:"users",component:hO,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie"]}},{path:"/profile",name:"profile",component:()=>Qc(()=>import("./ProfileView.js"),[]),meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/login",name:"login",component:_k,meta:{requiresGuest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>Qc(()=>import("./ForgotPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/reset-password/:token",name:"reset-password",component:()=>Qc(()=>import("./ResetPasswordView.js"),[]),meta:{requiresGuest:!0}},{path:"/change-password",name:"changePassword",component:tk,meta:{requiresAuth:!0,allowedRoles:["admin","entreprise","salarie","visiteur"]}},{path:"/map",name:"map",component:Zy,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>Qc(()=>import("./NotFoundView.js"),[])}]});Hb.beforeEach(async(e,n,t)=>{var h,g;const r=Ga();if(console.log("Route:",e.path,"Auth state:",{initialized:r.initialized,isAuthenticated:r.isAuthenticated,user:r.user}),!r.initialized)try{await r.initialize(window.INITIAL_STATE)}catch(v){console.error("Error initializing auth store:",v)}const i=r.isAuthenticated,o=(h=r.user)==null?void 0:h.must_change_password,l=(g=r.user)==null?void 0:g.user_type;if(e.meta.requiresAuth&&!i){t("/login");return}if(i&&o&&e.name!=="changePassword"){t({name:"changePassword"});return}if(e.name==="changePassword"&&!o){t({name:"home"});return}if(e.meta.allowedRoles&&l&&!e.meta.allowedRoles.includes(l)){t({name:"home"});return}if(e.meta.requiresGuest&&i){t({name:"home"});return}t()});const Em=pC(N6),Wb=vC();Em.use(Wb);Em.use(Hb);const UI=Ga(Wb);window.INITIAL_STATE&&UI.initialize(window.INITIAL_STATE);Em.mount("#app");export{Bi as _,Au as a,M as b,tt as c,Pa as d,yn as e,Kn as f,Ni as g,Dn as h,Xe as i,wc as j,Xi as k,vc as l,VL as m,Yi as n,Bl as o,aF as p,qp as q,un as r,qo as s,Ht as t,Ga as u,Mr as v,Tp as w,sb as x};
